create sequence csrimp.csrimp_session_id_seq;

CREATE TABLE CSRIMP.CSRIMP_SESSION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HOST							VARCHAR2(255) NOT NULL,
	STEP							NUMBER(10) DEFAULT 0 NOT NULL,
	TABLE_NUMBER					NUMBER(10) DEFAULT 0 NOT NULL,
	TABLE_ROW						NUMBER(10) DEFAULT 0 NOT NULL,
	CONSTRAINT PK_CSRIMP_SESSION PRIMARY KEY (CSRIMP_SESSION_ID)
);

CREATE UNIQUE INDEX CSRIMP.IX_CSRIMP_SESSION_HOST ON CSRIMP.CSRIMP_SESSION (LOWER(HOST));

CREATE TABLE CSRIMP.ASPEN2_APPLICATION
(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MENU_PATH						VARCHAR2(512),
	METADATA_CONNECTION_STRING		VARCHAR2(512),
	COMMERCE_STORE_PATH				VARCHAR2(512),
	ADMIN_EMAIL						VARCHAR2(512),
	LOGON_URL						VARCHAR2(512),
	REFERER_URL						VARCHAR2(512),
	CONFIRM_USER_DETAILS			NUMBER(1) NOT NULL,
	DEFAULT_STYLESHEET				VARCHAR2(512),
	DEFAULT_URL						VARCHAR2(512),
	DEFAULT_CSS						VARCHAR2(512),
	EDIT_CSS						VARCHAR2(512),
	LOGON_AUTOCOMPLETE				NUMBER(1) NOT NULL,
	MONITOR_WITH_NEW_RELIC			NUMBER(1) NOT NULL,
	UL_DESIGN_SYSTEM_ENABLED		NUMBER(1) NOT NULL,
	DEFAULT_SCRIPT					VARCHAR2(512),
	CDN_SERVER						VARCHAR2(512),
	BRANDING_SERVICE_ENABLED		NUMBER(1) NOT NULL,
	GA4_ENABLED						NUMBER(1) NOT NULL,
	DISPLAY_COOKIE_POLICY			NUMBER(1) NOT NULL,
	MEGA_MENU_ENABLED				NUMBER(1) DEFAULT 0 NOT NULL,
	MAXMIND_ENABLED				    NUMBER(1) DEFAULT 1 NOT NULL,
	CONSTRAINT CK_ENABLE_UL_DESIGN_SYSTEM CHECK (UL_DESIGN_SYSTEM_ENABLED IN (0,1)),
	CONSTRAINT CK_BRANDING_SERVICE_ENABLED CHECK (BRANDING_SERVICE_ENABLED IN (0,1)),
	CONSTRAINT CK_MEGA_MENU_ENABLED CHECK (MEGA_MENU_ENABLED IN (0,1)),
	CONSTRAINT CK_GA4_ENABLED CHECK (GA4_ENABLED IN (0,1,2)),
	CONSTRAINT CK_DISP_COOKIE_POLICY CHECK (DISPLAY_COOKIE_POLICY IN (0,1,2)),
	CONSTRAINT CK_MAXMIND_ENABLED CHECK (MAXMIND_ENABLED IN (0,1)),
	CONSTRAINT PK_ASPEN2_APPLICATION PRIMARY KEY (CSRIMP_SESSION_ID),
	CONSTRAINT FK_ASPEN2_APPLICATION_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TIDY_DDL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	POS								NUMBER(10) NOT NULL,
	DDL								CLOB NOT NULL,
    CONSTRAINT PK_CMS_TIDY_DDL PRIMARY KEY (CSRIMP_SESSION_ID, POS),
    CONSTRAINT FK_CMS_TIDY_DDL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REPORTING_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REPORTING_PERIOD_SID    NUMBER(10, 0)    NOT NULL,
    NAME                    VARCHAR2(255)    NOT NULL,
    START_DTM               DATE             NOT NULL,
    END_DTM                 DATE             NOT NULL,
    CONSTRAINT PK_REPORTING_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, REPORTING_PERIOD_SID),
    CONSTRAINT FK_REPORTING_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_ALERT_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CUSTOMER_ALERT_TYPE_ID		NUMBER(10, 0)    NOT NULL,
    STD_ALERT_TYPE_ID    		NUMBER(10, 0)    NULL,
    GET_PARAMS_SP               VARCHAR2(255),
    CONSTRAINT PK_CUSTOMER_ALERT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_ALERT_TYPE_ID),
    CONSTRAINT FK_CUSTOMER_ALERT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACCURACY_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ACCURACY_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    LABEL               VARCHAR2(255)    NOT NULL,
    Q_OR_C              CHAR(1)          NOT NULL,
    MAX_SCORE           NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ACCURACY_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, ACCURACY_TYPE_ID),
    CONSTRAINT FK_ACCURACY_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACCURACY_TYPE_OPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ACCURACY_TYPE_OPTION_ID    NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_ID           NUMBER(10, 0)    NOT NULL,
    LABEL                      VARCHAR2(255)    NOT NULL,
    ACCURACY_WEIGHTING         NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ACCURACY_TYPE_OPTION PRIMARY KEY (CSRIMP_SESSION_ID, ACCURACY_TYPE_OPTION_ID),
    CONSTRAINT FK_ACCURACY_TYPE_OPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_FRAME (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ALERT_FRAME_ID    NUMBER(10, 0)     NOT NULL,
    NAME              VARCHAR2(1000)    NOT NULL,
    CONSTRAINT PK_ALERT_FRAME PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_FRAME_ID),
    CONSTRAINT FK_ALERT_FRAME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_FRAME_BODY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ALERT_FRAME_ID    NUMBER(10, 0)    NOT NULL,
    LANG              VARCHAR2(10)     NOT NULL,
    HTML              CLOB             NOT NULL,
    CONSTRAINT PK_ALERT_FRAME_BODY PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_FRAME_ID, LANG),
    CONSTRAINT FK_ALERT_FRAME_BODY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_TEMPLATE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOMER_ALERT_TYPE_ID  NUMBER(10, 0)    NOT NULL,
    ALERT_FRAME_ID    		NUMBER(10, 0)    NOT NULL,
    SEND_TYPE         		VARCHAR2(10)     NOT NULL,
    REPLY_TO_NAME     		VARCHAR2(255),
    REPLY_TO_EMAIL    		VARCHAR2(255),
    FROM_NAME         		VARCHAR2(255),
    FROM_EMAIL        		VARCHAR2(255),
    CONSTRAINT CK_ALERT_TEMPLATE_SEND_TYPE CHECK (SEND_TYPE IN ('manual', 'automatic', 'inactive')),
    CONSTRAINT PK_ALERT_TEMPLATE PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_ALERT_TYPE_ID),
    CONSTRAINT FK_ALERT_TPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_TEMPLATE_BODY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOMER_ALERT_TYPE_ID  NUMBER(10, 0)    NOT NULL,
    LANG            		VARCHAR2(10)     NOT NULL,
    SUBJECT          		CLOB             NOT NULL,
    BODY_HTML        		CLOB             NOT NULL,
    ITEM_HTML        		CLOB             NOT NULL,
    CONSTRAINT PK_ALERT_TEMPLATE_BODY PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_ALERT_TYPE_ID, LANG),
    CONSTRAINT FK_ALERT_FTPL_BODY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ROLE_SID                 NUMBER(10, 0)    NOT NULL,
    NAME                     VARCHAR2(255)    NOT NULL,
    LOOKUP_KEY               VARCHAR2(255),
    REGION_PERMISSION_SET    NUMBER(10, 0),
    IS_METERING              NUMBER(1, 0)     NOT NULL,
    IS_PROPERTY_MANAGER      NUMBER(1, 0)     NOT NULL,
    IS_DELEGATION            NUMBER(1, 0)     NOT NULL,
    IS_SUPPLIER              NUMBER(1, 0)     NOT NULL,
	IS_HIDDEN        		 NUMBER(1),
	IS_SYSTEM_MANAGED 		NUMBER(1),
    CONSTRAINT CHK_ROLE_IS_METERING CHECK (IS_METERING IN (0,1)),
    CONSTRAINT CHK_ROLE_IS_PROP_MGR CHECK (IS_PROPERTY_MANAGER IN (0,1)),
    CONSTRAINT CHK_ROLE_IS_DELEG CHECK (IS_DELEGATION IN (0,1)),
    CONSTRAINT CHK_ROLE_IS_SUPPLIER CHECK (IS_SUPPLIER IN (0,1)),
    CONSTRAINT PK_ROLE PRIMARY KEY (CSRIMP_SESSION_ID, ROLE_SID),
    CONSTRAINT FK_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAG (
    CSRIMP_SESSION_ID                 NUMBER(10)        DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID                            NUMBER(10, 0)     NOT NULL,
    LOOKUP_KEY                        VARCHAR2(30),
    EXCLUDE_FROM_DATAVIEW_GROUPING    NUMBER(1, 0)      NOT NULL,
	PARENT_ID						  NUMBER(10),
    CONSTRAINT PK_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TAG_ID),
    CONSTRAINT FK_TAG_BODY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAG_DESCRIPTION(
	CSRIMP_SESSION_ID	NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAG_ID				NUMBER(10, 0)		NOT NULL,
	LANG				VARCHAR2(10)		NOT NULL,
	TAG					VARCHAR2(255)		NOT NULL,
	EXPLANATION			VARCHAR2(1024),
	LAST_CHANGED_DTM	DATE,
	CONSTRAINT PK_TAG_DESCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, TAG_ID, LANG),
	CONSTRAINT FK_TAG_DESCRIPTION_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAG_GROUP (
    CSRIMP_SESSION_ID                 NUMBER(10)       DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_GROUP_ID                      NUMBER(10, 0)    NOT NULL,
    MULTI_SELECT                      NUMBER(10, 0)    NOT NULL,
    MANDATORY                         NUMBER(10, 0)    NOT NULL,
    APPLIES_TO_INDS                   NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_REGIONS                NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_NON_COMPLIANCES        NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_SUPPLIERS              NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_INITIATIVES            NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_CHAIN                  NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_CHAIN_ACTIVITIES       NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_CHAIN_PRODUCT_TYPES    NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_QUICK_SURVEY           NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_AUDITS                 NUMBER(1,0),
    APPLIES_TO_COMPLIANCES            NUMBER(1, 0)     NOT NULL,
    LOOKUP_KEY                        VARCHAR2(64),
    APPLIES_TO_CHAIN_PRODUCTS		  NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_CHAIN_PRODUCT_SUPPS    NUMBER(1, 0)     NOT NULL,
	IS_HIERARCHICAL					  NUMBER(1, 0)	   NOT NULL,
    CONSTRAINT PK_TAG_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, TAG_GROUP_ID),
	CONSTRAINT CHK_APPLIES_TO_CHAIN_1_0 CHECK (APPLIES_TO_CHAIN IN (1, 0)),
	CONSTRAINT CHK_APPLIES_TO_CHAIN_ACTVS_1_0 CHECK (APPLIES_TO_CHAIN_ACTIVITIES IN (1, 0)),
	CONSTRAINT CHK_APPLIES_TO_CHAIN_PRD_T_1_0 CHECK (APPLIES_TO_CHAIN_PRODUCT_TYPES IN (1, 0)),
    CONSTRAINT CHK_APPLIES_TO_CHAIN_PRD_1_0 CHECK (APPLIES_TO_CHAIN_PRODUCTS IN (1, 0)),
    CONSTRAINT CHK_APPLIES_TO_CHAIN_PRD_S_1_0 CHECK (APPLIES_TO_CHAIN_PRODUCT_SUPPS IN (1, 0)),
	CONSTRAINT CHK_APPLIES_TO_QK_SURVEY_1_0 CHECK (APPLIES_TO_QUICK_SURVEY IN (1, 0)),
	CONSTRAINT CHK_APPLIES_TO_COMPLIANCES CHECK (APPLIES_TO_COMPLIANCES IN (0, 1)),
	CONSTRAINT CHK_IS_HIERARCHICAL CHECK (IS_HIERARCHICAL IN (0, 1)),
    CONSTRAINT FK_TAG_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAG_GROUP_DESCRIPTION(
	CSRIMP_SESSION_ID	NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAG_GROUP_ID		NUMBER(10, 0)		NOT NULL,
	LANG 				VARCHAR2(10)		NOT NULL,
	NAME				VARCHAR2(255)		NOT NULL,
	LAST_CHANGED_DTM	DATE,
	CONSTRAINT PK_TAG_GROUP_DESCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, TAG_GROUP_ID, LANG),
	CONSTRAINT FK_TAG_GROUP_DESCRIPTION_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAG_GROUP_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_GROUP_ID    NUMBER(10, 0)    NOT NULL,
    TAG_ID          NUMBER(10, 0)    NOT NULL,
    POS             NUMBER(10, 0)    NOT NULL,
    ACTIVE          NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CHK_TAG_GRP_MEM_ACTIVE CHECK (ACTIVE IN (0,1)),
    CONSTRAINT PK_TAG_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, TAG_GROUP_ID, TAG_ID),
    CONSTRAINT FK_TAG_GROUP_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_id (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	sequence_owner					VARCHAR2(30),
	sequence_name					VARCHAR2(30),
	old_id							NUMBER(10),
	new_id							NUMBER(10),
	CONSTRAINT pk_map_id			PRIMARY KEY (csrimp_session_id, sequence_owner, sequence_name, old_id),
	CONSTRAINT uk_map_id 			UNIQUE (csrimp_session_id, sequence_name, new_id),
	CONSTRAINT fk_map_id 			FOREIGN KEY (csrimp_session_id) 
										REFERENCES csrimp.csrimp_session (csrimp_session_id) 
										ON DELETE CASCADE,
	CONSTRAINT ck_map_id_uc			CHECK (sequence_owner = UPPER(sequence_owner) AND
										   sequence_name = UPPER(sequence_name))
);

CREATE TABLE CSRIMP.MEASURE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MEASURE_SID                  NUMBER(10, 0)     NOT NULL,
    NAME                         VARCHAR2(255)     NOT NULL,
    DESCRIPTION                  VARCHAR2(255),
    SCALE                        NUMBER(10, 0)     NOT NULL,
    FORMAT_MASK                  VARCHAR2(255)     NOT NULL,
    REGIONAL_AGGREGATION         VARCHAR2(255)     NOT NULL,
    CUSTOM_FIELD                 VARCHAR2(4000),
    OPTION_SET_ID                NUMBER(10, 0),
    PCT_OWNERSHIP_APPLIES        NUMBER(1, 0)      NOT NULL,
    STD_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    FACTOR                       NUMBER(24, 10),
    M                            NUMBER(10, 0),
    KG                           NUMBER(10, 0),
    S                            NUMBER(10, 0),
    A                            NUMBER(10, 0),
    K                            NUMBER(10, 0),
    MOL                          NUMBER(10, 0),
    CD                           NUMBER(10, 0),
	DIVISIBILITY				 NUMBER(10, 0)     NOT NULL,
	LOOKUP_KEY					 VARCHAR2(64),
    CONSTRAINT CK_MEASURE_SI_DETAIL CHECK (( factor is not null and m is not null and kg is not null and s is not null and a is not null and k is not null and mol is not null and cd is not null ) or
	( factor is null and m is null and kg is null and s is null and a is null and k is null and mol is null and cd is null )),
    CONSTRAINT PK_MEASURE PRIMARY KEY (CSRIMP_SESSION_ID, MEASURE_SID),
    CONSTRAINT FK_MEASURE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MEASURE_CONVERSION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MEASURE_CONVERSION_ID        NUMBER(10, 0)     NOT NULL,
    MEASURE_SID                  NUMBER(10, 0)     NOT NULL,
    STD_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    DESCRIPTION                  VARCHAR2(255),
    A                            NUMBER(24, 10),
    B                            NUMBER(24, 10),
    C                            NUMBER(24, 10),
    LOOKUP_KEY                   VARCHAR2(64),
    CONSTRAINT CK_MCONV_COMPLETED CHECK ((a is null and b is null and c is null) or (a is not null and b is not null and c is not null)),
    CONSTRAINT PK_MEASURE_CONVERSION PRIMARY KEY (CSRIMP_SESSION_ID, MEASURE_CONVERSION_ID),
    CONSTRAINT FK_MEASURE_CONVERSION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MEASURE_CONVERSION_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MEASURE_CONVERSION_ID    NUMBER(10, 0)    NOT NULL,
    START_DTM                DATE             NOT NULL,
    END_DTM                  DATE,
    A                        NUMBER(24, 10)    NOT NULL,
    B                        NUMBER(24, 10)    NOT NULL,
    C                        NUMBER(24, 10)    NOT NULL,
    CONSTRAINT CK_MCONV_PERIOD_COMPLETED CHECK ((a is null and b is null and c is null) or (a is not null and b is not null and c is not null)),
    CONSTRAINT PK_MEASURE_CONVERSION_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, MEASURE_CONVERSION_ID, START_DTM),
    CONSTRAINT FK_MEASURE_CONV_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INCIDENT_TYPE(
	CSRIMP_SESSION_ID		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAB_SID                 NUMBER(10, 0)     NOT NULL,
	GROUP_KEY               VARCHAR2(255)     NOT NULL,
	LABEL                   VARCHAR2(500)     NOT NULL,
	PLURAL                  VARCHAR2(255)     NOT NULL,
	BASE_CSS_CLASS          VARCHAR2(255)     NOT NULL,
	POS                     NUMBER(10, 0)     NOT NULL,
	LIST_URL                VARCHAR2(2000)    NOT NULL,
	EDIT_URL                VARCHAR2(2000)    NOT NULL,
	NEW_CASE_URL            VARCHAR2(2000),
	MOBILE_FORM_PATH        VARCHAR2(2000),
	MOBILE_FORM_SID		    NUMBER(10, 0),
	DESCRIPTION             CLOB,
	CONSTRAINT PK_INCIDENT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, TAB_SID),
	CONSTRAINT CK_INCIDENT_MOBILE_FORM CHECK ( MOBILE_FORM_PATH IS NULL OR MOBILE_FORM_SID IS NULL ),
	CONSTRAINT FK_INCIDENT_TYPE_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID                       NUMBER(10, 0)     NOT NULL,
    PARENT_SID                    NUMBER(10, 0),
    NAME                          VARCHAR2(255)     NOT NULL,
    IND_TYPE                      NUMBER(10, 0)     NOT NULL,
    TOLERANCE_TYPE                NUMBER(2, 0)      NOT NULL,
    PCT_UPPER_TOLERANCE           NUMBER(10, 4)     NOT NULL,
    PCT_LOWER_TOLERANCE           NUMBER(10, 4)     NOT NULL,
    TOLERANCE_NUMBER_OF_PERIODS   NUMBER(10, 0),
    TOLERANCE_NUMBER_OF_STANDARD_DEVIATIONS_FROM_AVERAGE    NUMBER(10, 4),
    MEASURE_SID                   NUMBER(10, 0),
    MULTIPLIER                    NUMBER(10, 0)     NOT NULL,
    SCALE                         NUMBER(10, 0),
    FORMAT_MASK                   VARCHAR2(255),
    LAST_MODIFIED_DTM             DATE,
    ACTIVE                        NUMBER(10, 0),
    TARGET_DIRECTION              NUMBER(10, 0)     NOT NULL,
    POS                           NUMBER(10, 0)     NOT NULL,
    INFO_XML                      SYS.XMLType,
    START_MONTH                   NUMBER(10, 0),
    DIVISIBILITY                  NUMBER(10, 0),
    NULL_MEANS_NULL               NUMBER(10, 0),
    AGGREGATE                     VARCHAR2(24)      NOT NULL,
    PERIOD_SET_ID				  NUMBER(10),
    PERIOD_INTERVAL_ID			  NUMBER(10),
    CALC_START_DTM_ADJUSTMENT     NUMBER(10, 0)     NOT NULL,
    CALC_END_DTM_ADJUSTMENT       NUMBER(10, 0)     NOT NULL,
    CALC_FIXED_START_DTM          DATE,
    CALC_FIXED_END_DTM            DATE,
    CALC_XML                      CLOB,
    GRI                           VARCHAR2(255),
    LOOKUP_KEY                    VARCHAR2(255),
    OWNER_SID                     NUMBER(10, 0),
    IND_ACTIVITY_TYPE_ID          NUMBER(10, 0),
    CORE                          NUMBER(1, 0)      NOT NULL,
    ROLL_FORWARD                  NUMBER(1, 0)      NOT NULL,
    FACTOR_TYPE_ID                NUMBER(10, 0),
    MAP_TO_IND_SID                NUMBER(10, 0),
    GAS_MEASURE_SID               NUMBER(10, 0),
    GAS_TYPE_ID                   NUMBER(10, 0),
    CALC_DESCRIPTION              VARCHAR2(4000),
    NORMALIZE                     NUMBER(1, 0)      NOT NULL,
    DO_TEMPORAL_AGGREGATION       NUMBER(1, 0)      NOT NULL,
	PROP_DOWN_REGION_TREE_SID     NUMBER(10),
	IS_SYSTEM_MANAGED			  NUMBER(1)			NOT NULL,
	CALC_OUTPUT_ROUND_DP		  NUMBER(10),
    CONSTRAINT IND_TOLERANCE CHECK (tolerance_type = 0 OR (pct_upper_tolerance IS NOT NULL AND pct_lower_tolerance IS NOT NULL)),
    CONSTRAINT CK_IND_AGGR CHECK (aggregate IN ('SUM', 'FORCE SUM', 'AVERAGE', 'NONE', 'DOWN', 'FORCE DOWN', 'LOWEST', 'FORCE LOWEST', 'HIGHEST', 'FORCE HIGHEST')),
    CONSTRAINT CK_IND_TYPE CHECK (IND_TYPE IN (0,1,2,3,4)),
    CHECK (CORE IN (0,1)),
    CONSTRAINT CK_IND_ROLL_FORWARD CHECK (ROLL_FORWARD IN (0, 1)),
    CONSTRAINT CK_IND_NORMALIZE CHECK (NORMALIZE IN (0,1)),
    CHECK (DO_TEMPORAL_AGGREGATION IN (0,1)),
    CONSTRAINT CK_IND_START_MONTH CHECK (start_month between 1 and 12),
    CONSTRAINT CK_IND_MUST_BE_MANAGED CHECK (( gas_type_id is not null and is_system_managed = 1 ) or
	( ind_type = 3 and is_system_managed = 1 ) or
	( ind_type != 3 and gas_type_id is null )),
    CONSTRAINT CK_IND_IS_SYSTEM_MANAGED CHECK (IS_SYSTEM_MANAGED IN (0,1)),
    CONSTRAINT PK_IND PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID),
    CONSTRAINT FK_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)  LOB ("CALC_XML") STORE AS (ENABLE STORAGE IN ROW );

CREATE TABLE CSRIMP.IND_DESCRIPTION (
    CSRIMP_SESSION_ID             NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID                       NUMBER(10, 0)     NOT NULL,
    LANG                          VARCHAR2(10)      NOT NULL,
    DESCRIPTION                   VARCHAR2(1023)	NOT NULL,
    LAST_CHANGED_DTM              DATE,
    CONSTRAINT PK_IND_DESCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, LANG),
    CONSTRAINT FK_IND_DESCRIPTION_IS FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_FLAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID          NUMBER(10, 0)    NOT NULL,
    FLAG             NUMBER(10, 0)    NOT NULL,
    DESCRIPTION      VARCHAR2(256)    NOT NULL,
    REQUIRES_NOTE    NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_IND_FLAG PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, FLAG),
    CONSTRAINT FK_IND_FLAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_TAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID     NUMBER(10, 0)    NOT NULL,
    IND_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IND_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TAG_ID, IND_SID),
    CONSTRAINT FK_IND_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_ACCURACY_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID             NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IND_ACCURACY_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, ACCURACY_TYPE_ID),
    CONSTRAINT FK_IND_ACCURACY_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_REGION_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_TYPE    NUMBER(2, 0)     NOT NULL,
    CONSTRAINT PK_CUSTOMER_REGION_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, REGION_TYPE),
    CONSTRAINT FK_CUSTOMER_REGION_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_TREE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_TREE_ROOT_SID    NUMBER(10, 0)    NOT NULL,
    LAST_RECALC_DTM         DATE,
    IS_PRIMARY              NUMBER(1, 0)     NOT NULL,
    IS_DIVISIONS            NUMBER(1, 0)     NOT NULL,
    IS_FUND		            NUMBER(1, 0)     NOT NULL,
    CHECK (IS_DIVISIONS IN (0,1)),
    CONSTRAINT PK_REGION_TREE PRIMARY KEY (CSRIMP_SESSION_ID, REGION_TREE_ROOT_SID),
    CONSTRAINT FK_REGION_TREE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION (
    CSRIMP_SESSION_ID       NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID              NUMBER(10, 0)     NOT NULL,
    LINK_TO_REGION_SID      NUMBER(10, 0),
    PARENT_SID              NUMBER(10, 0),
    NAME                    VARCHAR2(255)     NOT NULL,
    ACTIVE                  NUMBER(10, 0),
    POS                     NUMBER(10, 0)     NOT NULL,
    INFO_XML                SYS.XMLType,
    FLAG                    NUMBER(1, 0),
    ACQUISITION_DTM         DATE,
    DISPOSAL_DTM            DATE,
    REGION_TYPE             NUMBER(2, 0)      NOT NULL,
    LOOKUP_KEY              VARCHAR2(1024),
    GEO_COUNTRY             VARCHAR2(2),
    GEO_REGION              VARCHAR2(2),
    GEO_CITY_ID             NUMBER(10, 0),
    GEO_LONGITUDE           NUMBER,
    GEO_LATITUDE            NUMBER,
    GEO_TYPE                NUMBER(10, 0),
    MAP_ENTITY              VARCHAR2(32),
    EGRID_REF               VARCHAR2(4),
    EGRID_REF_OVERRIDDEN    NUMBER(1, 0)      NOT NULL,
    LAST_MODIFIED_DTM       DATE              NOT NULL,
    REGION_REF              VARCHAR2(255),
    CONSTRAINT CK_GEO_TYPE CHECK ((GEO_TYPE = 0 AND GEO_LONGITUDE IS NOT NULL AND GEO_LATITUDE IS NOT NULL) OR
(GEO_TYPE = 1 AND GEO_COUNTRY IS NOT NULL AND GEO_LONGITUDE IS NOT NULL AND GEO_LATITUDE IS NOT NULL) OR
(GEO_TYPE = 2 AND MAP_ENTITY IS NOT NULL) OR
(GEO_TYPE = 3 AND GEO_COUNTRY IS NOT NULL AND GEO_REGION IS NOT NULL) OR
(GEO_TYPE = 4 AND GEO_COUNTRY IS NOT NULL AND GEO_REGION IS NOT NULL AND GEO_CITY_ID IS NOT NULL AND GEO_LONGITUDE IS NOT NULL AND GEO_LATITUDE IS NOT NULL) OR
(GEO_TYPE = 5 AND GEO_COUNTRY IS NULL AND GEO_REGION IS NULL AND GEO_CITY_ID IS NULL AND GEO_LONGITUDE IS NULL AND GEO_LATITUDE IS NULL) OR
(GEO_TYPE = 6)),
    CONSTRAINT PK_REGION PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID),
    CONSTRAINT FK_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_DESCRIPTION (
    CSRIMP_SESSION_ID               NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID                      NUMBER(10, 0)     NOT NULL,
    LANG                            VARCHAR2(10)      NOT NULL,
    DESCRIPTION                     VARCHAR2(1023)    NOT NULL,
    LAST_CHANGED_DTM                DATE,
    CONSTRAINT PK_REGION_DESCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, LANG),
    CONSTRAINT FK_REGION_DESCRIPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_TAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID        NUMBER(10, 0)    NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_REGION_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TAG_ID, REGION_SID),
    CONSTRAINT FK_REGION_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PCT_OWNERSHIP (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    START_DTM     DATE             NOT NULL,
    END_DTM       DATE,
    PCT           NUMBER(10, 5)    NOT NULL,
    CONSTRAINT PK_PCT_OWNERSHIP PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, START_DTM),
    CONSTRAINT FK_PCT_OWNERSHIP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CSR_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CSR_USER_SID                   NUMBER(10, 0)    NOT NULL,
    EMAIL                          VARCHAR2(256),
    GUID                           CHAR(36)         NOT NULL,
    FULL_NAME                      VARCHAR2(256),
    USER_NAME                      VARCHAR2(256)    NOT NULL,
    FRIENDLY_NAME                  VARCHAR2(255)    NOT NULL,
    INFO_XML                       SYS.XMLType,
    SEND_ALERTS                    NUMBER(1, 0)     NOT NULL,
    SHOW_PORTAL_HELP               NUMBER(1, 0)     NOT NULL,
    DONATIONS_REPORTS_FILTER_ID    NUMBER(10, 0),
    DONATIONS_BROWSE_FILTER_ID     NUMBER(10, 0),
    HIDDEN                         NUMBER(1, 0)     NOT NULL,
    PHONE_NUMBER                   VARCHAR2(100),
    JOB_TITLE                      VARCHAR2(100),
    SHOW_SAVE_CHART_WARNING        NUMBER(1, 0)     NOT NULL,
    ENABLE_ARIA                    NUMBER(1, 0)     NOT NULL,
    CREATED_DTM                    DATE             NOT NULL,
    LAST_MODIFIED_DTM              DATE             NOT NULL,
    LAST_LOGON_TYPE_ID             NUMBER(10, 0)    NOT NULL,
    LINE_MANAGER_SID               NUMBER(10, 0),
    AVATAR                         BLOB,
    AVATAR_LAST_MODIFIED_DTM       DATE,
    AVATAR_SHA1                    RAW(20),
    AVATAR_MIME_TYPE               VARCHAR2(2000),
    PRIMARY_REGION_SID             NUMBER(10, 0),
    REMOVE_ROLES_ON_DEACTIVATION   NUMBER(1,0),
    USER_REF                       VARCHAR2(255),
    ANONYMISED                     NUMBER(1) DEFAULT 0 NOT NULL,
    CHECK (HIDDEN IN (0, 1)),
    CONSTRAINT CK_USER_AVATAR CHECK ((AVATAR IS NULL AND AVATAR_LAST_MODIFIED_DTM IS NULL AND AVATAR_SHA1 IS NULL AND AVATAR_MIME_TYPE IS NULL)
        OR (AVATAR IS NOT NULL AND AVATAR_LAST_MODIFIED_DTM IS NOT NULL AND AVATAR_SHA1 IS NOT NULL AND AVATAR_MIME_TYPE IS NOT NULL)),
    CONSTRAINT PK_CSR_USER PRIMARY KEY (CSRIMP_SESSION_ID, CSR_USER_SID),
    CONSTRAINT FK_CSR_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COOKIE_POLICY_CONSENT (
	CSRIMP_SESSION_ID			NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COOKIE_POLICY_CONSENT_ID	NUMBER(10, 0)	NOT NULL,
    CSR_USER_SID				NUMBER(10, 0)	NOT NULL,
    CREATED_DTM 				DATE			NOT NULL,
    ACCEPTED					NUMBER(1),
    CHECK (ACCEPTED IN (0, 1)),
    CONSTRAINT PK_COOKIE_POLICY_CONSENT PRIMARY KEY (CSRIMP_SESSION_ID, COOKIE_POLICY_CONSENT_ID),
    CONSTRAINT FK_COOKIE_POLICY_CONSENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SUPERADMIN (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CSR_USER_SID     NUMBER(10, 0)    NOT NULL,
    EMAIL            VARCHAR2(256),
    GUID             CHAR(36)         NOT NULL,
    FULL_NAME        VARCHAR2(256),
    USER_NAME        VARCHAR2(256)    NOT NULL,
    FRIENDLY_NAME    VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_SUPERADMIN PRIMARY KEY (CSRIMP_SESSION_ID, CSR_USER_SID),
    CONSTRAINT FK_SUPERADMIN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SUPERADMIN_FOLDER (
    CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CSR_USER_SID					NUMBER(10) 		NOT NULL,
	SID_ID							NUMBER(10) 		NOT NULL,
	NAME							VARCHAR2(255)	NOT NULL,
	CONSTRAINT PK_SUPERADMIN_FOLDER PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_SUPERADMIN_FOLDER_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_START_POINT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID     NUMBER(10, 0)    NOT NULL,
    USER_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IND_START_POINT PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, USER_SID),
    CONSTRAINT FK_IND_START_POINT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_START_POINT(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    USER_SID    					NUMBER(10, 0)    NOT NULL,
    REGION_SID  					NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_REGION_START_POINT PRIMARY KEY (CSRIMP_SESSION_ID, USER_SID, REGION_SID),
    CONSTRAINT FK_REGION_START_POINT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_ROLE_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    USER_SID              NUMBER(10, 0)    NOT NULL,
    REGION_SID            NUMBER(10, 0)    NOT NULL,
    ROLE_SID              NUMBER(10, 0)    NOT NULL,
    INHERITED_FROM_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_REGION_ROLE_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, USER_SID, REGION_SID, ROLE_SID, INHERITED_FROM_SID),
    CONSTRAINT FK_REGION_ROLE_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_DATASET (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_DATASET_ID      NUMBER(10, 0)    NOT NULL,
    LABEL                   VARCHAR2(255)    NOT NULL,
    REPORTING_PERIOD_SID    NUMBER(10, 0)    NOT NULL,
    HELPER_PKG              VARCHAR2(255),
    CONSTRAINT PK_PENDING_DATASET PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_DATASET_ID),
    CONSTRAINT FK_PENDING_DATASET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_IND_ID           NUMBER(10, 0)     NOT NULL,
    PENDING_DATASET_ID       NUMBER(10, 0),
    PARENT_IND_ID            NUMBER(10, 0),
    MAPS_TO_IND_SID          NUMBER(10, 0),
    LINK_TO_IND_ID           NUMBER(10, 0),
    DESCRIPTION              VARCHAR2(2047)    NOT NULL,
    TOLERANCE_TYPE           NUMBER(2, 0)      NOT NULL,
    PCT_UPPER_TOLERANCE      NUMBER(10, 4)     NOT NULL,
    PCT_LOWER_TOLERANCE      NUMBER(10, 4)     NOT NULL,
    VAL_MANDATORY            NUMBER(1, 0)      NOT NULL,
    NOTE_MANDATORY           NUMBER(1, 0)      NOT NULL,
    FILE_UPLOAD_MANDATORY    NUMBER(1, 0)      NOT NULL,
    MEASURE_SID              NUMBER(10, 0),
    POS                      NUMBER(10, 0)     NOT NULL,
    FORMAT_XML               SYS.XMLType,
    ELEMENT_TYPE             NUMBER(10, 0)     NOT NULL,
    READ_ONLY                NUMBER(1, 0)      NOT NULL,
    DP                       NUMBER(10, 0),
    INFO_XML                 SYS.XMLType,
    DEFAULT_VAL_NUMBER       NUMBER(24, 10),
    DEFAULT_VAL_STRING       VARCHAR2(255),
    LOOKUP_KEY               VARCHAR2(64),
    AGGREGATE                VARCHAR2(24)      NOT NULL,
    ALLOW_FILE_UPLOAD        NUMBER(1, 0)      NOT NULL,
    CONSTRAINT PENDING_IND_TOLERANCE CHECK (tolerance_type = 0 OR (pct_upper_tolerance IS NOT NULL AND pct_lower_tolerance IS NOT NULL)),
    CONSTRAINT CK_PENDING_IND_FILUPLOAD_MAND CHECK (FILE_UPLOAD_MANDATORY IN (0,1)),
    CONSTRAINT PK_PENDING_IND PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_IND_ID),
    CONSTRAINT FK_PENDING_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_REGION_ID     NUMBER(10, 0)    NOT NULL,
    PARENT_REGION_ID      NUMBER(10, 0),
    PENDING_DATASET_ID    NUMBER(10, 0)    NOT NULL,
    MAPS_TO_REGION_SID    NUMBER(10, 0),
    DESCRIPTION           VARCHAR2(255)    NOT NULL,
    POS                   NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_PENDING_REGION PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_REGION_ID),
    CONSTRAINT FK_PENDING_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.PENDING_IND_ACCURACY_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_IND_ID      NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_PENDING_IND_ACCURACY_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_IND_ID, ACCURACY_TYPE_ID),
    CONSTRAINT FK_PENDING_IND_ACC_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_STEP (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID               NUMBER(10, 0)    NOT NULL,
    PARENT_STEP_ID                 NUMBER(10, 0),
    PENDING_DATASET_ID             NUMBER(10, 0)    NOT NULL,
    BASED_ON_STEP_ID               NUMBER(10, 0),
    LABEL                          VARCHAR2(255)    NOT NULL,
    LAYOUT_TYPE                    NUMBER(10, 0)    NOT NULL,
    MAX_SHEET_VALUE_COUNT          NUMBER(10, 0)    NOT NULL,
    WORKING_DAY_OFFSET_FROM_DUE    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_STEP_ID),
    CONSTRAINT FK_APPROVAL_STEP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_STEP_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID     NUMBER(10, 0)    NOT NULL,
    USER_SID             NUMBER(10, 0)    NOT NULL,
    FALLBACK_USER_SID    NUMBER(10, 0),
    READ_ONLY            NUMBER(1, 0)     NOT NULL,
    IS_LURKER            NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP_USER PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_STEP_ID, USER_SID),
    CONSTRAINT FK_APPROVAL_STEP_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.APPROVAL_STEP_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID    NUMBER(10, 0)    NOT NULL,
    PENDING_IND_ID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP_IND PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_STEP_ID, PENDING_IND_ID),
    CONSTRAINT FK_APPROVAL_STEP_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_STEP_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID         NUMBER(10, 0)    NOT NULL,
    ROLLS_UP_TO_REGION_ID    NUMBER(10, 0),
    PENDING_REGION_ID        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP_REGION PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_STEP_ID, PENDING_REGION_ID),
    CONSTRAINT FK_APPROVAL_STEP_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.APPROVAL_STEP_SHEET (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID             NUMBER(10, 0)     NOT NULL,
    SHEET_KEY                    VARCHAR2(255)     NOT NULL,
    LABEL                        VARCHAR2(1204)    NOT NULL,
    PENDING_PERIOD_ID            NUMBER(10, 0),
    PENDING_IND_ID               NUMBER(10, 0),
    PENDING_REGION_ID            NUMBER(10, 0),
    SUBMITTED_VALUE_COUNT        NUMBER(10, 0)     NOT NULL,
    SUBMIT_BLOCKED               NUMBER(1, 0)      NOT NULL,
    VISIBLE                      NUMBER(1, 0)      NOT NULL,
    DUE_DTM                      DATE,
    REMINDER_DTM                 DATE              NOT NULL,
    APPROVER_RESPONSE_DUE_DTM    DATE,
    CONSTRAINT PK_APPROVAL_STEP_SHEET PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_STEP_ID, SHEET_KEY),
    CONSTRAINT FK_APPROVAL_STEP_SHEET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_STEP_SHEET_LOG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID    NUMBER(10, 0)    NOT NULL,
    SHEET_KEY           VARCHAR2(255)    NOT NULL,
    DTM                 DATE             NOT NULL,
    BY_USER_SID         NUMBER(10, 0)    NOT NULL,
    UP_OR_DOWN          NUMBER(1, 0)     NOT NULL,
    NOTE                CLOB
);

CREATE TABLE CSRIMP.APPROVAL_STEP_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID    NUMBER(10, 0)    NOT NULL,
    ROLE_SID            NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP_ROLE PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_STEP_ID, ROLE_SID),
    CONSTRAINT FK_APPROVAL_STEP_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_VAL_ID                NUMBER(10, 0)     NOT NULL,
    PENDING_IND_ID                NUMBER(10, 0)     NOT NULL,
    PENDING_REGION_ID             NUMBER(10, 0)     NOT NULL,
    PENDING_PERIOD_ID             NUMBER(10, 0)     NOT NULL,
    APPROVAL_STEP_ID              NUMBER(10, 0),
    VAL_NUMBER                    NUMBER(24, 10),
    VAL_STRING                    VARCHAR2(4000),
    FROM_VAL_NUMBER               NUMBER(24, 10),
    FROM_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    NOTE                          CLOB,
    ACTION                        CHAR(1)           NOT NULL,
    MERGED_STATE                  CHAR(1)           NOT NULL,
    CONSTRAINT CK_MERGED_STATE CHECK (MERGED_STATE IN ('U', 'S', 'R')),
    CONSTRAINT PK_PENDING_VAL PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_VAL_ID),
    CONSTRAINT FK_PENDING_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_VAL_ACCURACY_TYPE_OPT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_VAL_ID             NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_OPTION_ID    NUMBER(10, 0)    NOT NULL,
    PCT                        NUMBER(10, 4)    NOT NULL,
    CONSTRAINT PK_PENDING_VAL_ACC_TYPE_OPT PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_VAL_ID, ACCURACY_TYPE_OPTION_ID),
    CONSTRAINT FK_PENDING_VAL_ACC_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_VAL_VARIANCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_VAL_ID             NUMBER(10, 0)    NOT NULL,
    COMPARED_WITH_START_DTM    DATE             NOT NULL,
    COMPARED_WITH_END_DTM      DATE             NOT NULL,
    VARIANCE                   NUMBER(14, 4)    NOT NULL,
    EXPLANATION                CLOB,
    CONSTRAINT PK_PENDING_VAL_VARIANCE PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_VAL_ID),
    CONSTRAINT FK_PENDING_VAL_VAR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID           		NUMBER(10, 0)     NOT NULL,
    PARENT_SID               		NUMBER(10, 0),
    NAME                     		VARCHAR2(1023)    NOT NULL,
    MASTER_DELEGATION_SID    		NUMBER(10, 0),
    CREATED_BY_SID           		NUMBER(10, 0)     NOT NULL,
    SCHEDULE_XML             		CLOB,
    SUBMISSION_OFFSET		 		NUMBER(10)		   NOT NULL,
    NOTE                     		CLOB,
    PERIOD_SET_ID			 		NUMBER(10),
    PERIOD_INTERVAL_ID		 		NUMBER(10),
    GROUP_BY                 		VARCHAR2(64)      NOT NULL,
    ALLOCATE_USERS_TO        		VARCHAR2(64)      NOT NULL,
    START_DTM                		DATE              NOT NULL,
    END_DTM                  		DATE              NOT NULL,
    REMINDER_OFFSET          		NUMBER(10, 0)     NOT NULL,
    IS_NOTE_MANDATORY        		NUMBER(10, 0)     NOT NULL,
    SECTION_XML              		CLOB,
    EDITING_URL              		VARCHAR2(255)     NOT NULL,
    FULLY_DELEGATED          		NUMBER(1, 0)      NOT NULL,
    GRID_XML                 		CLOB,
    IS_FLAG_MANDATORY        		NUMBER(1, 0)      NOT NULL,
    SHOW_AGGREGATE           		NUMBER(1, 0)      NOT NULL,
	HIDE_SHEET_PERIOD        		NUMBER(1, 0)      NOT NULL,
	DELEGATION_DATE_SCHEDULE_ID 	NUMBER(10, 0),
    LAYOUT_ID                		NUMBER(10, 0),
	TAG_VISIBILITY_MATRIX_GROUP_ID	NUMBER(10),
	ALLOW_MULTI_PERIOD		 		NUMBER(1)		   NOT NULL,
    CONSTRAINT CK_DELEGATION_DATES CHECK (END_DTM > START_DTM),
    CONSTRAINT PK_DELEGATION PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID),
    CONSTRAINT FK_DELEGATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_DESCRIPTION (
	CSRIMP_SESSION_ID		NUMBER(10) 			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DELEGATION_SID      	NUMBER(10)          NOT NULL,
	LANG                	VARCHAR2(10)        NOT NULL,
	DESCRIPTION             VARCHAR2(1023)    	NOT NULL,
	LAST_CHANGED_DTM		DATE,
	CONSTRAINT PK_DELEGATION_DESCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, LANG),
	CONSTRAINT FK_DELEGATION_DESCRIPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_POLICY (
	CSRIMP_SESSION_ID		    NUMBER(10) 			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DELEGATION_SID      	    NUMBER(10)          NOT NULL,
	SUBMIT_CONFIRMATION_TEXT	VARCHAR2(500)       NOT NULL,
	CONSTRAINT PK_DELEGATION_POLICY PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID),
	CONSTRAINT FK_DELEGATION_POLICY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID        NUMBER(10, 0)     NOT NULL,
    IND_SID               NUMBER(10, 0)     NOT NULL,
    MANDATORY             NUMBER(10, 0)     NOT NULL,
    POS                   NUMBER(10, 0)     NOT NULL,
    SECTION_KEY           VARCHAR2(128),
    VAR_EXPL_GROUP_ID     NUMBER(10, 0),
    VISIBILITY            VARCHAR2(32)      NOT NULL,
    CSS_CLASS             VARCHAR2(64),
    META_ROLE             VARCHAR2(32),
    ALLOWED_NA            NUMBER(1, 0)      NOT NULL,
    CONSTRAINT CK_DELEG_IND_VISIBLE CHECK (VISIBILITY IN ('SHOW','READONLY','HIDE', 'VALIDATE')),
    CONSTRAINT CK_META_ROLE CHECK (META_ROLE IN('MERGED','MERGED_ON_TIME', 'DP_COMPLETE', 'COMP_TOTAL_DP', 'IND_SEL_COUNT', 'IND_SEL_TOTAL', 'DP_NOT_CHANGED_COUNT', 'ACC_TOTAL_DP')),
    CONSTRAINT PK_DELEGATION_IND PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, IND_SID),
    CONSTRAINT FK_DELEGATION_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID             NUMBER(10, 0)    NOT NULL,
    REGION_SID                 NUMBER(10, 0)    NOT NULL,
    MANDATORY                  NUMBER(10, 0)    NOT NULL,
    POS                        NUMBER(10, 0)    NOT NULL,
    AGGREGATE_TO_REGION_SID    NUMBER(10, 0)    NOT NULL,
    VISIBILITY                 VARCHAR2(255)    NOT NULL,
    ALLOWED_NA                 NUMBER(1, 0)     NOT NULL,
    HIDE_AFTER_DTM             DATE,
    HIDE_INCLUSIVE             NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CK_DELEG_REGION_VISIBLE CHECK (VISIBILITY IN ('HIDE','SHOW','READONLY')),
    CONSTRAINT PK_DELEGATION_REGION PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, REGION_SID),
    CONSTRAINT FK_DELEGATION_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_REGION_DESCRIPTION
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DELEGATION_SID				 	NUMBER(10, 0) 		NOT NULL,
	REGION_SID						NUMBER(10, 0)		NOT NULL,
	LANG 							VARCHAR2(10) 		NOT NULL,
	DESCRIPTION						VARCHAR2(1023) 		NOT NULL,
	CONSTRAINT PK_DELEGATION_REGION_DESC PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, REGION_SID, LANG),
    CONSTRAINT FK_DELEGATION_RGN_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    				NUMBER(10, 0)    NOT NULL,
    USER_SID          				NUMBER(10, 0)    NOT NULL,
	DELEG_PERMISSION_SET			NUMBER(10, 0)	 NOT NULL,
	INHERITED_FROM_SID				NUMBER(10, 0)	 NOT NULL, 
    CONSTRAINT PK_DELEGATION_USER PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, USER_SID, INHERITED_FROM_SID),
    CONSTRAINT FK_DELEGATION_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_SID             NUMBER(10, 0)    NOT NULL,
    PARENT_SID           NUMBER(10, 0)    NOT NULL,
    NAME                 VARCHAR2(256)    NOT NULL,
    NOTE                 CLOB,
    START_DTM            DATE             NOT NULL,
    END_DTM              DATE             NOT NULL,
    GROUP_BY             VARCHAR2(128)    NOT NULL,
    PERIOD_SET_ID		 NUMBER(10),
    PERIOD_INTERVAL_ID	 NUMBER(10),
    ALLOCATE_USERS_TO    VARCHAR2(10)     NOT NULL,
    TAB_DIRECTION        NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CK_FORM_TAB_DIRECTION CHECK (TAB_DIRECTION IN (0,1)),
    CONSTRAINT PK_FORM PRIMARY KEY (CSRIMP_SESSION_ID, FORM_SID),
    CONSTRAINT FK_FORM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_IND_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_SID                NUMBER(10, 0)     NOT NULL,
    IND_SID                  NUMBER(10, 0)     NOT NULL,
    DESCRIPTION              VARCHAR2(1023)    NOT NULL,
    POS                      NUMBER(10, 0)     NOT NULL,
    SCALE                    NUMBER(10, 0),
    FORMAT_MASK              VARCHAR2(255),
    MEASURE_DESCRIPTION      VARCHAR2(255),
    SHOW_TOTAL				 NUMBER(10, 0)     NOT NULL,
    MULTIPLIER_IND_SID       NUMBER(10, 0),
    MEASURE_CONVERSION_ID    NUMBER(10, 0),
    CONSTRAINT PK_FORM_IND_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, FORM_SID, IND_SID),
    CONSTRAINT FK_FORM_IND_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_REGION_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_SID       NUMBER(10, 0)    NOT NULL,
    REGION_SID     NUMBER(10, 0)    NOT NULL,
    DESCRIPTION    VARCHAR2(255)    NOT NULL,
    POS            NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FORM_REGION_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, FORM_SID, REGION_SID),
    CONSTRAINT FK_FORM_REG_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_ALLOCATION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_ALLOCATION_ID    NUMBER(10, 0)    NOT NULL,
    FORM_SID              NUMBER(10, 0)    NOT NULL,
    NOTE                  CLOB,
    CONSTRAINT PK_FORM_ALLOCATION PRIMARY KEY (CSRIMP_SESSION_ID, FORM_ALLOCATION_ID),
    CONSTRAINT FK_FORM_ALLOCATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_ALLOCATION_ITEM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_ALLOCATION_ID    NUMBER(10, 0)    NOT NULL,
    ITEM_SID		      NUMBER(10, 0)	   NOT NULL
);

CREATE TABLE CSRIMP.FORM_ALLOCATION_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_ALLOCATION_ID    NUMBER(10, 0)    NOT NULL,
    USER_SID              NUMBER(10, 0)    NOT NULL,
    READ_ONLY             NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_FORM_ALLOCATION_USER PRIMARY KEY (CSRIMP_SESSION_ID, FORM_ALLOCATION_ID, USER_SID),
    CONSTRAINT FK_FORM_ALLOC_USR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_COMMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_SID               NUMBER(10, 0)    NOT NULL,
    Z_KEY                  VARCHAR2(255)    NOT NULL,
    FORM_COMMENT           CLOB,
    LAST_UPDATED_BY_SID    NUMBER(10, 0)    NOT NULL,
    LAST_UPDATED_DTM       DATE             NOT NULL,
    FORM_ALLOCATION_ID     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FORM_COMMENT PRIMARY KEY (CSRIMP_SESSION_ID, FORM_SID, Z_KEY, FORM_ALLOCATION_ID),
    CONSTRAINT FK_FORM_COMMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATA_BUCKET (
    CSRIMP_SESSION_ID              NUMBER(10)		 DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATA_BUCKET_SID                NUMBER(10, 0)		NOT NULL,
    DESCRIPTION                    VARCHAR2(1024)		NOT NULL,
    ENABLED                        NUMBER(1, 0)		DEFAULT 1 NOT NULL,
    ACTIVE_INSTANCE_ID             NUMBER(10, 0),
    CONSTRAINT CK_DATA_BUCKET_ENABLED CHECK (ENABLED IN (0,1)),
    CONSTRAINT PK_DATA_BUCKET PRIMARY KEY (CSRIMP_SESSION_ID, DATA_BUCKET_SID),
    CONSTRAINT FK_DATA_BUCKET_IS FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW (
	CSRIMP_SESSION_ID			   NUMBER(10)		 DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID                   NUMBER(10, 0)     NOT NULL,
    PARENT_SID                     NUMBER(10, 0)     NOT NULL,
    NAME                           VARCHAR2(256),
    START_DTM                      DATE              NOT NULL,
    END_DTM                        DATE,
    GROUP_BY                       VARCHAR2(128)     NOT NULL,
    PERIOD_SET_ID		 		   NUMBER(10),
    PERIOD_INTERVAL_ID	 		   NUMBER(10),
    CHART_CONFIG_XML               CLOB,
    CHART_STYLE_XML                CLOB,
    POS                            NUMBER(10, 0)	 NOT NULL,
    DESCRIPTION                    VARCHAR2(2048),
    DATAVIEW_TYPE_ID               NUMBER(6, 0)      NOT NULL,
    SHOW_CALC_TRACE                NUMBER(1, 0)      NOT NULL,
    SHOW_VARIANCE                  NUMBER(1, 0)      NOT NULL,
    SHOW_ABS_VARIANCE              NUMBER(1, 0)      NOT NULL,
    SORT_BY_MOST_RECENT            NUMBER(1, 0)      NOT NULL,
    INCLUDE_PARENT_REGION_NAMES    NUMBER(10, 0)     NOT NULL,
    LAST_UPDATED_DTM               DATE              NOT NULL,
    LAST_UPDATED_SID               NUMBER(10, 0),
    RANK_LIMIT_LEFT                NUMBER(10, 0)     NOT NULL,
    RANK_LIMIT_LEFT_TYPE           NUMBER(10, 0)     NOT NULL,
    RANK_IND_SID                   NUMBER(10, 0),
    RANK_FILTER_TYPE               NUMBER(10, 0),
    RANK_LIMIT_RIGHT               NUMBER(10, 0)     NOT NULL,
    RANK_LIMIT_RIGHT_TYPE          NUMBER(10, 0)     NOT NULL,
    RANK_REVERSE                   NUMBER(1)         NOT NULL,
    REGION_GROUPING_TAG_GROUP      NUMBER(10, 0),
    SUPPRESS_UNMERGED_DATA_MESSAGE NUMBER(1, 0)      NOT NULL,
    VERSION_NUM                    NUMBER(10, 0),
    ANONYMOUS_REGION_NAMES         NUMBER(1)         NOT NULL,
    INCLUDE_NOTES_IN_TABLE         NUMBER(1)         NOT NULL,
    SHOW_REGION_EVENTS             NUMBER(1)         NOT NULL,
    AGGREGATION_PERIOD_ID		   NUMBER(10,0),
	TREAT_NULL_AS_ZERO			   NUMBER(1)		 NOT NULL,
	SHOW_VARIANCE_EXPLANATIONS	   NUMBER(1,0)		 NOT NULL,
	HIGHLIGHT_CHANGED_SINCE		   NUMBER(1, 0)	     NOT NULL,
	HIGHLIGHT_CHANGED_SINCE_DTM	   DATE,
	SHOW_LAYER_VARIANCE_PCT		   NUMBER(1,0)		 NOT NULL,
	SHOW_LAYER_VARIANCE_ABS		   NUMBER(1,0)		 NOT NULL,
	SHOW_LAYER_VARIANCE_START	   NUMBER(10,0)		 NOT NULL,
	SHOW_LAYER_VARIANCE_PCT_BASE   NUMBER(1,0)		 NOT NULL,
	SHOW_LAYER_VARIANCE_ABS_BASE   NUMBER(1,0)		 NOT NULL,
	REGION_SELECTION			   NUMBER(1,0)		 NOT NULL,
    CONSTRAINT CK_DATAVIEW_SHOW_CALC_TRACE CHECK (SHOW_CALC_TRACE IN (0,1)),
    CONSTRAINT CK_DATAVIEW_SHOW_VARIANCE CHECK (SHOW_VARIANCE IN (0,1)),
    CONSTRAINT CK_DATAVIEW_SHOW_ABS_VARIANCE CHECK (SHOW_ABS_VARIANCE IN (0,1)),
	CONSTRAINT CK_DATAVIEW_TREAT_NULL_AS_ZRO CHECK (TREAT_NULL_AS_ZERO IN (0,1)),
 	CONSTRAINT CK_DATAVIEW_HGHLGHT_CHGD_SNCE CHECK (HIGHLIGHT_CHANGED_SINCE IN (0,1)),
    CONSTRAINT PK_DATAVIEW PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID),
    CONSTRAINT FK_DATAVIEW_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_IND_MEMBER (
	CSRIMP_SESSION_ID        NUMBER(10)        DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID             NUMBER(10, 0)     NOT NULL,
    IND_SID                  NUMBER(10, 0)     NOT NULL,
    NORMALIZATION_IND_SID    NUMBER(10, 0),
    CALCULATION_TYPE_ID      NUMBER(10, 0),
    POS                      NUMBER(10, 0)     NOT NULL,
    FORMAT_MASK              VARCHAR2(255),
    MEASURE_CONVERSION_ID    NUMBER(10, 0),
    SHOW_AS_RANK             NUMBER(1)         NOT NULL,
    CONSTRAINT FK_DATAVIEW_IND_MEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_IND_DESCRIPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID             NUMBER(10, 0)     NOT NULL,
    POS                      NUMBER(10, 0)     NOT NULL,
    LANG					 VARCHAR2(10)      NOT NULL,
    DESCRIPTION				 VARCHAR2(1023)	   NOT NULL,
    CONSTRAINT PK_DATAVIEW_IND_DESCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, POS, LANG),
    CONSTRAINT FK_DATAVIEW_IND_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_REGION_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID    NUMBER(10, 0)     NOT NULL,
    REGION_SID      NUMBER(10, 0)     NOT NULL,
    POS             NUMBER(10, 0)     NOT NULL,
    TAB_LEVEL       NUMBER(10, 0),
    CONSTRAINT PK_DATAVIEW_REGION_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, REGION_SID),
    CONSTRAINT FK_DATAVIEW_REG_MEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_REGION_DESCRIPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID             NUMBER(10, 0)     NOT NULL,
    REGION_SID				 NUMBER(10, 0)     NOT NULL,
    LANG					 VARCHAR2(10)      NOT NULL,
    DESCRIPTION				 VARCHAR2(1023)	   NOT NULL,
    CONSTRAINT PK_DATAVIEW_REGION_DESC PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, REGION_SID, LANG),
    CONSTRAINT FK_DATAVIEW_REG_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_HISTORY (
	CSRIMP_SESSION_ID					NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DATAVIEW_SID						NUMBER(10,0)	NOT NULL,
	VERSION_NUM							NUMBER(10,0)	NOT NULL,
	NAME								VARCHAR2(256)	NOT NULL,
	START_DTM							DATE			NOT NULL,
	END_DTM								DATE,
	GROUP_BY							VARCHAR2(128)	NOT NULL,
	CHART_CONFIG_XML					CLOB,
	CHART_STYLE_XML						CLOB,
	POS									NUMBER(10,0)	NOT NULL,
	DESCRIPTION							VARCHAR2(2048),
	DATAVIEW_TYPE_ID					NUMBER(6,0)		NOT NULL,
	SHOW_CALC_TRACE						NUMBER(1,0)		NOT NULL,
	SHOW_VARIANCE						NUMBER(1,0)		NOT NULL,
	SHOW_ABS_VARIANCE					NUMBER(1,0)		NOT NULL,
	SORT_BY_MOST_RECENT					NUMBER(1,0)		NOT NULL,
	INCLUDE_PARENT_REGION_NAMES			NUMBER(10,0)	NOT NULL,
	LAST_UPDATED_DTM					DATE			NOT NULL,
	LAST_UPDATED_SID					NUMBER(10,0),
	RANK_FILTER_TYPE					NUMBER(10,0)	NOT NULL,
	RANK_LIMIT_LEFT						NUMBER(10,0)	NOT NULL,
	RANK_IND_SID						NUMBER(10,0),
	RANK_LIMIT_RIGHT					NUMBER(10,0)	NOT NULL,
	RANK_LIMIT_LEFT_TYPE				NUMBER(10,0)	NOT NULL,
	RANK_LIMIT_RIGHT_TYPE				NUMBER(10,0)	NOT NULL,
	RANK_REVERSE						NUMBER(1,0)		NOT NULL,
	REGION_GROUPING_TAG_GROUP			NUMBER(10,0),
	ANONYMOUS_REGION_NAMES				NUMBER(1,0)		NOT NULL,
	INCLUDE_NOTES_IN_TABLE				NUMBER(1,0)		NOT NULL,
	SHOW_REGION_EVENTS					NUMBER(1,0)		NOT NULL,
	SUPPRESS_UNMERGED_DATA_MESSAGE		NUMBER(1,0)		NOT NULL,
	PERIOD_SET_ID						NUMBER(10,0)	NOT NULL,
	PERIOD_INTERVAL_ID					NUMBER(10,0)	NOT NULL,
	AGGREGATION_PERIOD_ID				NUMBER(10,0),
	TREAT_NULL_AS_ZERO					NUMBER(1,0)     NOT NULL,
	SHOW_VARIANCE_EXPLANATIONS			NUMBER(1,0)		NOT NULL,
	HIGHLIGHT_CHANGED_SINCE				NUMBER(1, 0)	NOT NULL,
	HIGHLIGHT_CHANGED_SINCE_DTM			DATE,
	SHOW_LAYER_VARIANCE_PCT		  		NUMBER(1,0)		NOT NULL,
	SHOW_LAYER_VARIANCE_ABS		   		NUMBER(1,0)		NOT NULL,
	SHOW_LAYER_VARIANCE_START	   		NUMBER(10,0)	NOT NULL,
	SHOW_LAYER_VARIANCE_PCT_BASE  		NUMBER(1,0)		NOT NULL,
	SHOW_LAYER_VARIANCE_ABS_BASE   		NUMBER(1,0)		NOT NULL,
	REGION_SELECTION					NUMBER(1,0)		NOT NULL,
    CONSTRAINT PK_DATAVIEW_HISTORY PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, VERSION_NUM),
	CONSTRAINT CK_DV_HIST_TREAT_NULL_AS_ZERO CHECK (TREAT_NULL_AS_ZERO IN (0,1)),
	CONSTRAINT CK_DV_HIST_HIGHLIGHT_CHGD_SNCE CHECK (HIGHLIGHT_CHANGED_SINCE IN (0,1)),
    CONSTRAINT FK_DATAVIEW_HISTORY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_ARBITRARY_PERIOD (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DATAVIEW_SID		NUMBER(10),
	START_DTM			DATE,
	END_DTM				DATE,
	CONSTRAINT PK_DATAVIEW_ARB_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, START_DTM),
    CONSTRAINT FK_DATAVIEW_ARB_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_ARBITRARY_PERIOD_HIST (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DATAVIEW_SID		NUMBER(10),
	VERSION_NUM         NUMBER(10),
	START_DTM			DATE,
	END_DTM				DATE,
	CONSTRAINT PK_DATAVIEW_ARB_PERIOD_HIST PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, VERSION_NUM, START_DTM),
    CONSTRAINT FK_DATAVIEW_ARB_PERIOD_HIST_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    VAL_ID                         NUMBER(20, 0)     NOT NULL,
    IND_SID                        NUMBER(10, 0)     NOT NULL,
    REGION_SID                     NUMBER(10, 0)     NOT NULL,
    PERIOD_START_DTM               DATE              NOT NULL,
    PERIOD_END_DTM                 DATE,
    VAL_NUMBER                     NUMBER(24, 10),
    ERROR_CODE					   NUMBER(10),
    ALERT                          VARCHAR2(255),
    SOURCE_TYPE_ID                 NUMBER(10, 0)     NOT NULL,
    FLAGS                          NUMBER(10, 0)     NOT NULL,
    SOURCE_ID                      NUMBER(20, 0),
    ENTRY_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    ENTRY_VAL_NUMBER               NUMBER(24, 10),
    NOTE                           CLOB,
    CHANGED_DTM                    DATE              NOT NULL,
    CHANGED_BY_SID                 NUMBER(10, 0)     NOT NULL,
    CONSTRAINT CK_VAL_NUM CHECK ((val_number IS NOT NULL AND entry_val_number IS NOT NULL) OR (val_number IS NULL AND entry_val_number IS NULL)),
    CONSTRAINT CK_VAL_DATES CHECK (PERIOD_START_DTM = TRUNC(PERIOD_START_DTM, 'DD') AND PERIOD_END_DTM = TRUNC(PERIOD_END_DTM, 'DD') AND PERIOD_END_DTM > PERIOD_START_DTM),
    CONSTRAINT PK_VAL PRIMARY KEY (CSRIMP_SESSION_ID, VAL_ID),
    CONSTRAINT FK_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAL_CHANGE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    VAL_CHANGE_ID                  NUMBER(12, 0)     NOT NULL,
    IND_SID                        NUMBER(10, 0)     NOT NULL,
    REGION_SID                     NUMBER(10, 0)     NOT NULL,
    PERIOD_START_DTM               DATE              NOT NULL,
    PERIOD_END_DTM                 DATE              NOT NULL,
    VAL_NUMBER                     NUMBER(24, 10),
    SOURCE_TYPE_ID                 NUMBER(10, 0)     NOT NULL,
    SOURCE_ID                      NUMBER,
    ENTRY_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    ENTRY_VAL_NUMBER               NUMBER(24, 10),
    NOTE                           CLOB,
    CHANGED_BY_SID                 NUMBER(10, 0)     NOT NULL,
    CHANGED_DTM                    DATE              NOT NULL,
    REASON                         VARCHAR2(1024)    NOT NULL,
    CONSTRAINT CK_VAL_CHANGE_DATES CHECK (PERIOD_START_DTM = TRUNC(PERIOD_START_DTM, 'DD') AND PERIOD_END_DTM = TRUNC(PERIOD_END_DTM, 'DD') AND PERIOD_END_DTM > PERIOD_START_DTM),
    CONSTRAINT PK_VAL_CHANGE PRIMARY KEY (CSRIMP_SESSION_ID, VAL_CHANGE_ID),
    CONSTRAINT FK_VAL_CHANGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_MODULE (
    CSRIMP_SESSION_ID        NUMBER(10)        DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODULE_ROOT_SID          NUMBER(10, 0)     NOT NULL,
    LABEL                    VARCHAR2(1024)    NOT NULL,
    SHOW_SUMMARY_TAB         NUMBER(1, 0)      NOT NULL,
    DEFAULT_STATUS_SID       NUMBER(10, 0)     NOT NULL,
    FLOW_SID                 NUMBER(10, 0),
    REGION_SID               NUMBER(10, 0),
    SHOW_FLOW_SUMMARY_TAB    NUMBER(1, 0)      NOT NULL,
    PREVIOUS_MODULE_SID      NUMBER(10, 0),
    LIBRARY_SID              NUMBER(10, 0),
    ACTIVE                   NUMBER(1, 0)      NOT NULL,
    REMINDER_OFFSET          NUMBER(10, 0)     NOT NULL,
    START_DTM                DATE,
    END_DTM                  DATE,
    SHOW_FACT_ICON           NUMBER(1, 0)      NOT NULL,
    CONSTRAINT PK_SECTION_MODULE PRIMARY KEY (CSRIMP_SESSION_ID, MODULE_ROOT_SID),
    CONSTRAINT FK_SECTION_MODULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_STATUS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_STATUS_SID    NUMBER(10, 0)    NOT NULL,
    DESCRIPTION           VARCHAR2(255)    NOT NULL,
    COLOUR                NUMBER(10, 0)    NOT NULL,
    POS                   NUMBER(10, 0)    NOT NULL,
    ICON_PATH             VARCHAR2(256),
    CONSTRAINT PK_SECTION_STATUS PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_STATUS_SID),
    CONSTRAINT FK_SECTION_STATUS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_TRANSITION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SECTION_TRANSITION_SID  		NUMBER(10, 0)    NOT NULL,
	FROM_SECTION_STATUS_SID 		NUMBER(10, 0)    NOT NULL,
	TO_SECTION_STATUS_SID   		NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SECTION_TRANSITION PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_TRANSITION_SID),
	CONSTRAINT FK_SECTION_TRANSITION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_SID                   NUMBER(10, 0)     NOT NULL,
    PARENT_SID                    NUMBER(10, 0),
    CHECKED_OUT_TO_SID            NUMBER(10, 0),
    CHECKED_OUT_DTM               DATE,
    CHECKED_OUT_VERSION_NUMBER    NUMBER(10, 0),
    VISIBLE_VERSION_NUMBER        NUMBER(10, 0),
    SECTION_POSITION              NUMBER(10, 0)     NOT NULL,
    ACTIVE                        NUMBER(1, 0)      NOT NULL,
    MODULE_ROOT_SID               NUMBER(10, 0)     NOT NULL,
    TITLE_ONLY                    NUMBER(10, 0)     NOT NULL,
    REF                           VARCHAR2(64),
    PLUGIN                        VARCHAR2(255),
    PLUGIN_CONFIG                 VARCHAR2(2048),
    SECTION_STATUS_SID            NUMBER(10, 0)     NOT NULL,
    FURTHER_INFO_URL              VARCHAR2(1024),
    HELP_TEXT					  CLOB,
    FLOW_ITEM_ID	              NUMBER(10, 0),
    CURRENT_ROUTE_STEP_ID	      NUMBER(10, 0),
    IS_SPLIT                      NUMBER(1, 0)      NOT NULL,
    PREVIOUS_SECTION_SID          NUMBER(10, 0),
    DISABLE_GENERAL_ATTACHMENTS   NUMBER(1, 0)      NOT NULL,
    CONSTRAINT PK_SECTION PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_SID),
    CONSTRAINT FK_SECTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_VERSION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_SID          NUMBER(10, 0)     NOT NULL,
    VERSION_NUMBER       NUMBER(10, 0)     NOT NULL,
    TITLE                VARCHAR2(2047 BYTE)    NOT NULL,
    BODY                 CLOB,
    CHANGED_BY_SID       NUMBER(10, 0),
    CHANGED_DTM          DATE,
    REASON_FOR_CHANGE    CLOB,
    APPROVED_BY_SID      NUMBER(10, 0),
    APPROVED_DTM         DATE,
    CONSTRAINT PK_SECTION_VERSION PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_SID, VERSION_NUMBER),
    CONSTRAINT FK_SECTION_VERSION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ATTACHMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ATTACHMENT_ID                 NUMBER(10, 0)     NOT NULL,
    FILENAME                      VARCHAR2(1024)    NOT NULL,
    MIME_TYPE                     VARCHAR2(255)     NOT NULL,
    DATA                          BLOB,
    EMBED                         NUMBER(1, 0)      NOT NULL,
    DATAVIEW_SID                  NUMBER(10, 0),
    LAST_UPDATED_FROM_DATAVIEW    DATE,
    VIEW_AS_TABLE                 NUMBER(1, 0),
    INDICATOR_SID                 NUMBER(10, 0),
    DOC_ID                        NUMBER(10, 0),
    URL                           VARCHAR2(1023),
    CONSTRAINT PK_ATTACHMENT PRIMARY KEY (CSRIMP_SESSION_ID, ATTACHMENT_ID),
    CONSTRAINT FK_ATTACHMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ATTACHMENT_HISTORY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_SID       NUMBER(10, 0)    NOT NULL,
    VERSION_NUMBER    NUMBER(10, 0)    NOT NULL,
    ATTACHMENT_ID     NUMBER(10, 0)    NOT NULL,
    ATTACH_NAME       VARCHAR2(255),
    PG_NUM            VARCHAR2(255),
    ATTACH_COMMENT    CLOB,
    CONSTRAINT PK_ATTACHMENT_HISTORY PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_SID, VERSION_NUMBER, ATTACHMENT_ID),
    CONSTRAINT FK_ATTACHMENT_HISTORY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_COMMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_COMMENT_ID    NUMBER(10, 0)    NOT NULL,
    SECTION_SID           NUMBER(10, 0),
    IN_REPLY_TO_ID        NUMBER(10, 0),
    COMMENT_TEXT          CLOB             NOT NULL,
    ENTERED_BY_SID        NUMBER(10, 0)    NOT NULL,
    ENTERED_DTM           DATE,
    IS_CLOSED             NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_SECTION_COMMENT PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_COMMENT_ID),
    CONSTRAINT FK_SECTION_COMMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_TRANS_COMMENT(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_TRANS_COMMENT_ID    NUMBER(10, 0)    NOT NULL,
    SECTION_SID                 NUMBER(10, 0)    NOT NULL,
    ENTERED_BY_SID              NUMBER(10, 0)    NOT NULL,
    ENTERED_DTM                 DATE             NOT NULL,
    COMMENT_TEXT                CLOB             NOT NULL,
    CONSTRAINT PK_SECTION_TRANS_COMMENT PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_TRANS_COMMENT_ID),
    CONSTRAINT FK_SECTION_TRANS_COMMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.SECTION_ALERT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SECTION_ALERT_ID          NUMBER(10, 0)    NOT NULL,
    CUSTOMER_ALERT_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    SECTION_SID               NUMBER(10, 0)    NOT NULL,
    RAISED_DTM                DATE             NOT NULL,
    FROM_USER_SID             NUMBER(10, 0)    NOT NULL,
    NOTIFY_USER_SID           NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_ID             NUMBER(10, 0)    NOT NULL,
    ROUTE_STEP_ID             NUMBER(10, 0),
    SENT_DTM                  DATE,
    CANCELLED_DTM             DATE,
    CONSTRAINT PK_SECTION_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_ALERT_ID, SECTION_SID),
    CONSTRAINT FK_SECTION_ALERT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ROUTE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ROUTE_ID         NUMBER(10, 0)    NOT NULL,
    SECTION_SID      NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_SID         NUMBER(10, 0)    NOT NULL,
    DUE_DTM          DATE             NOT NULL,
    COMPLETED_DTM    DATE,
    CONSTRAINT PK_ROUTE PRIMARY KEY (CSRIMP_SESSION_ID, ROUTE_ID),
    CONSTRAINT FK_ROUTE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ROUTE_STEP(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ROUTE_STEP_ID       NUMBER(10, 0)    NOT NULL,
    ROUTE_ID            NUMBER(10, 0)    NOT NULL,
    WORK_DAYS_OFFSET    NUMBER(2, 0)     NOT NULL,
    STEP_DUE_DTM        DATE             NOT NULL,
    POS                 NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ROUTE_STEP PRIMARY KEY (CSRIMP_SESSION_ID, ROUTE_STEP_ID),
    CONSTRAINT FK_ROUTE_STEP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ROUTE_STEP_USER(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ROUTE_STEP_ID    	NUMBER(10, 0)    NOT NULL,
    CSR_USER_SID     	NUMBER(10, 0)    NOT NULL,
    REMINDER_SENT_DTM   DATE,
    OVERDUE_SENT_DTM    DATE,
    DECLINED_SENT_DTM   DATE,
    CONSTRAINT PK_ROUTE_STEP_USER PRIMARY KEY (CSRIMP_SESSION_ID, ROUTE_STEP_ID, CSR_USER_SID),
    CONSTRAINT FK_ROUTE_STEP_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_CART_FOLDER (
	CSRIMP_SESSION_ID 		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SECTION_CART_FOLDER_ID	NUMBER(10, 0)	NOT NULL,
	PARENT_ID				NUMBER(10, 0),
	NAME					VARCHAR2(255)	NOT NULL,
	IS_VISIBLE				NUMBER(1, 0)	NOT NULL,
	IS_ROOT					NUMBER(1, 0)	NOT NULL,
	CONSTRAINT PK_CSRIMP_SECTION_CART_FOLDER PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_CART_FOLDER_ID),
	CONSTRAINT CK_CSRIMP_SECTION_CART_FOLDER CHECK ((PARENT_ID IS NULL AND IS_ROOT = 1) OR (PARENT_ID IS NOT NULL)),
	CONSTRAINT FK_SECTION_CART_FOLDER_SES FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_CART(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_CART_ID    NUMBER(10, 0)    NOT NULL,
    NAME               VARCHAR2(255)    NOT NULL,
	SECTION_CART_FOLDER_ID	NUMBER(10, 0) NOT NULL,
    CONSTRAINT PK_SECTION_CART PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_CART_ID),
    CONSTRAINT FK_SECTION_CART_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_CART_MEMBER(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_CART_ID    NUMBER(10, 0)    NOT NULL,
    SECTION_SID        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SECTION_CART_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_CART_ID, SECTION_SID),
    CONSTRAINT FK_SECTION_CART_MEMBER FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_TAG(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PARENT_ID         NUMBER(10, 0),
    SECTION_TAG_ID    NUMBER(10, 0)    NOT NULL,
    TAG               VARCHAR2(255)    NOT NULL,
    ACTIVE            NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_SECTION_TAG PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_TAG_ID),
    CONSTRAINT FK_SECTION_TAG FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_TAG_MEMBER(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_TAG_ID    NUMBER(10, 0)    NOT NULL,
    SECTION_SID       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SECTION_TAG_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, SECTION_TAG_ID, SECTION_SID),
    CONSTRAINT FK_SECTION_TAG_MEMBER FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_ROUTED_FLOW_STATE(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_SID         			NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_ID    			NUMBER(10, 0)    NOT NULL,
    REJECT_FS_TRANSITION_ID    	NUMBER(10, 0),
    CONSTRAINT PK_SECTION_ROUTED_FLOW_STATE PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_SID, FLOW_STATE_ID),
    CONSTRAINT FK_SECTION_ROUT_FLOW_STATE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_FLOW(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_SID    NUMBER(10, 0)       NOT NULL,
    SPLIT_QUESTION_FLOW_STATE_ID    NUMBER(10, 0),
    DFLT_RET_AFT_INC_USR_SUBMIT     NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_SECTION_FLOW PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_SID),
    CONSTRAINT FK_SECTION_FLOW_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    NAME                             VARCHAR2(255)     NOT NULL,
    HOST                             VARCHAR2(255)     NOT NULL,
    SYSTEM_MAIL_ADDRESS              VARCHAR2(255)     NOT NULL,
    TRACKER_MAIL_ADDRESS             VARCHAR2(255)     NOT NULL,
    ALERT_MAIL_ADDRESS               VARCHAR2(255)     NOT NULL,
    ALERT_MAIL_NAME                  VARCHAR2(255)     NOT NULL,
    ALERT_BATCH_RUN_TIME             INTERVAL DAY (2) TO SECOND (6) NOT NULL,
    TRASH_SID                        NUMBER(10, 0)     NOT NULL,
    AGGREGATION_ENGINE_VERSION       NUMBER(1, 0)      NOT NULL,
    CONTACT_EMAIL                    VARCHAR2(255),
    EDITING_URL                      VARCHAR2(255)     NOT NULL,
    MESSAGE                          CLOB,
    IND_INFO_XML_FIELDS              SYS.XMLType,
    REGION_INFO_XML_FIELDS           SYS.XMLType,
    USER_INFO_XML_FIELDS             SYS.XMLType,
    RAISE_REMINDERS                  NUMBER(1, 0)      NOT NULL,
    ACCOUNT_POLICY_SID               NUMBER(10, 0)     NOT NULL,
    STATUS                           NUMBER(2, 0)      NOT NULL,
    RAISE_SPLIT_DELEG_ALERTS         NUMBER(10, 0)     NOT NULL,
    CURRENT_REPORTING_PERIOD_SID     NUMBER(10, 0),
    LOCK_START_DTM                   DATE              NOT NULL,
    LOCK_END_DTM                     DATE              NOT NULL,
    REGION_ROOT_SID                  NUMBER(10, 0),
    IND_ROOT_SID                     NUMBER(10, 0),
    REPORTING_IND_ROOT_SID			 NUMBER(10, 0),
    CASCADE_REJECT                   NUMBER(1, 0)      NOT NULL,
    APPROVER_RESPONSE_WINDOW         NUMBER(10, 0)     NOT NULL,
    SELF_REG_GROUP_SID               NUMBER(10, 0),
    SELF_REG_NEEDS_APPROVAL          NUMBER(1, 0)      NOT NULL,
    SELF_REG_APPROVER_SID            NUMBER(10, 0),
    ALLOW_PARTIAL_SUBMIT             NUMBER(1, 0)      NOT NULL,
    HELPER_ASSEMBLY                  VARCHAR2(255),
    APPROVAL_STEP_SHEET_URL          VARCHAR2(255)     NOT NULL,
    USE_TRACKER                      NUMBER(1, 0)      NOT NULL,
    USE_USER_SHEETS                  NUMBER(1, 0)      NOT NULL,
    ALLOW_VAL_EDIT                   NUMBER(1, 0)      NOT NULL,
    FULLY_HIDE_SHEETS                NUMBER(1, 0)      NOT NULL,
    CALC_SUM_ZERO_FILL               NUMBER(1, 0)      NOT NULL,
	EQUALITY_EPSILON				 NUMBER			   NOT NULL,
    CREATE_SHEETS_AT_PERIOD_END      NUMBER(1, 0)      NOT NULL,
    AUDIT_CALC_CHANGES               NUMBER(1, 0)      NOT NULL,
    ORACLE_SCHEMA                    VARCHAR2(255),
    IND_CMS_TABLE                    VARCHAR2(255),
    TARGET_LINE_COL_FROM_GRADIENT    NUMBER(1, 0)      NOT NULL,
    USE_CARBON_EMISSION              NUMBER(1, 0)      NOT NULL,
    HELPER_PKG                       VARCHAR2(255),
    CHAIN_INVITE_LANDING_PREABLE     VARCHAR2(4000),
    CHAIN_INVITE_LANDING_QSTN        VARCHAR2(4000),
    ALLOW_DELEG_PLAN                 NUMBER(1, 0)      NOT NULL,
    SUPPLIER_REGION_ROOT_SID         NUMBER(10, 0),
    TRUCOST_COMPANY_ID               NUMBER(10, 0),
    TRUCOST_PORTLET_TAB_ID           NUMBER(10, 0),
    FOGBUGZ_IXPROJECT                NUMBER(10, 0),
    FOGBUGZ_SAREA                    VARCHAR2(50),
    PROPAGATE_DELEG_VALUES_DOWN      NUMBER(1, 0)      NOT NULL,
    ENABLE_SAVE_CHART_WARNING        NUMBER(1, 0)      NOT NULL,
    ISSUE_EDITOR_URL                 VARCHAR2(200)     NOT NULL,
    ALLOW_MAKE_EDITABLE              NUMBER(1, 0)      NOT NULL,
    ALERT_URI_FORMAT                 VARCHAR2(250),
    UNMERGED_CONSISTENT              NUMBER(1, 0)      NOT NULL,
    UNMERGED_SCENARIO_RUN_SID        NUMBER(10, 0),
    IND_SELECTIONS_ENABLED           NUMBER(1, 0)      NOT NULL,
    CHECK_TOLERANCE_AGAINST_ZERO     NUMBER(1, 0)      NOT NULL,
    SCENARIOS_ENABLED                NUMBER(1, 0)      NOT NULL,
    CALC_JOB_PRIORITY                NUMBER(10, 0)     NOT NULL,
    COPY_VALS_TO_NEW_SHEETS          NUMBER(1, 0)      NOT NULL,
    USE_VAR_EXPL_GROUPS              NUMBER(1, 0)      NOT NULL,
	APPLY_FACTORS_TO_CHILD_REGIONS  NUMBER(1, 0)      NOT NULL,
	MERGED_SCENARIO_RUN_SID          NUMBER(10, 0),
	BOUNCE_TRACKING_ENABLED			 NUMBER(1, 0)	   NOT NULL,
	ISSUE_ESCALATION_ENABLED         NUMBER(1)         NOT NULL,
	INCL_INACTIVE_REGIONS	        NUMBER(1),
	CHECK_DIVISIBILITY				 NUMBER(1)		   NOT NULL,
	PROPERTY_FLOW_SID				 NUMBER(10, 0),
	AUDIT_HELPER_PKG				 VARCHAR2(255),
	START_MONTH						NUMBER(1)         NOT NULL,
	CHART_XSL						 VARCHAR2(512),
	SHOW_REGION_DISPOSAL_DATE		NUMBER(1)         NOT NULL,
	DATA_EXPLORER_SHOW_MARKERS		NUMBER(1)         NOT NULL,
	SHOW_ALL_SHEETS_FOR_REP_PRD		NUMBER(1)         NOT NULL,
	DELEG_BROWSER_SHOW_RAG			NUMBER(1)         NOT NULL,
	TGTDASH_IGNORE_ESTIMATED		NUMBER(1)         NOT NULL,
	TGTDASH_HIDE_TOTALS				NUMBER(1)         NOT NULL,
	TGTDASH_SHOW_CHG_FROM_LAST_YR	NUMBER(1)         NOT NULL,
	TGTDASH_SHOW_LAST_YEAR			NUMBER(1)         NOT NULL,
	TGTDASH_COLOUR_TEXT				NUMBER(1)         NOT NULL,
	TGTDASH_SHOW_TARGET_FIRST		NUMBER(1)         NOT NULL,
	TGTDASH_SHOW_FLASH				NUMBER(1)         NOT NULL,
	USE_REGION_EVENTS				NUMBER(1)         NOT NULL,
	METERING_ENABLED				NUMBER(1)         NOT NULL,
	CRC_METERING_ENABLED			NUMBER(1)         NOT NULL,
	CRC_METERING_IND_CORE			NUMBER(1)         NOT NULL,
	CRC_METERING_AUTO_CORE			NUMBER(1)         NOT NULL,
	ISS_VIEW_SRC_TO_DEEPEST_SHEET	NUMBER(1)         NOT NULL,
	DELEGS_ALWAYS_SHOW_ADV_OPTS		NUMBER(1)         NOT NULL,
	DEFAULT_ADMIN_CSS				 VARCHAR2(512),
	CHEMICAL_FLOW_SID 				 NUMBER(10, 0),
    MAX_DATAVIEW_HISTORY            NUMBER(10, 0),
    ntfy_days_before_user_inactive  NUMBER(10),
	DATA_EXPLORER_SHOW_RANKING		NUMBER(1)         NOT NULL,
	DATA_EXPLORER_SHOW_TRENDS		NUMBER(1)         NOT NULL,
	DATA_EXPLORER_SHOW_SCATTER		NUMBER(1)         NOT NULL,
	DATA_EXPLORER_SHOW_RADAR		NUMBER(1)         NOT NULL,
	DATA_EXPLORER_SHOW_GAUGE		NUMBER(1)         NOT NULL,
	DATA_EXPLORER_SHOW_WATERFALL	NUMBER(1)         NOT NULL,
	TOLERANCE_CHECKER_REQ_MERGED 	NUMBER(1)         NOT NULL,
	MULTIPLE_AUDIT_SURVEYS			 NUMBER(1),
	INCLUDE_NULLS_IN_TA				 NUMBER(1)		  NOT NULL,
	AUDITS_ON_USERS					 NUMBER(1),
	ADJ_FACTORSET_STARTMONTH		NUMBER(1)         NOT NULL,
	ALLOW_CUSTOM_ISSUE_TYPES		NUMBER(1, 0)      NOT NULL,
	ALLOW_SECTION_IN_MANY_CARTS		NUMBER(1, 0)      NOT NULL,
	CALC_JOB_NOTIFY_ADDRESS			VARCHAR2(512),
	CALC_JOB_NOTIFY_AFTER_ATTEMPTS	NUMBER(10),
	DEFAULT_COUNTRY					VARCHAR2(2),
	EST_JOB_NOTIFY_ADDRESS			VARCHAR2(512),
	EST_JOB_NOTIFY_AFTER_ATTEMPTS	NUMBER(10),
	FAILED_CALC_JOB_RETRY_DELAY		NUMBER(10, 0)     NOT NULL,
	LEGACY_PERIOD_FORMATTING		NUMBER(1,0),
	LIVE_METERING_SHOW_GAPS			NUMBER(1)         NOT NULL,
	LOCK_PREVENTS_EDITING			NUMBER(1, 0)      NOT NULL,
	MAX_CONCURRENT_CALC_JOBS		NUMBER(10),
	METERING_GAPS_FROM_ACQUISITION	NUMBER(1)         NOT NULL,
	RESTRICT_ISSUE_VISIBILITY		NUMBER(1)         NOT NULL,
	SCRAG_QUEUE						VARCHAR2(100),
	STATUS_FROM_PARENT_ON_SUBDELEG	NUMBER(1, 0)      NOT NULL,
	TRANSLATION_CHECKBOX			NUMBER(1)         NOT NULL,
	USER_ADMIN_HELPER_PKG			VARCHAR2(255),
	USER_DIRECTORY_TYPE_ID			NUMBER(10, 0)     NOT NULL,
	QUICK_SURVEY_FIXED_STRUCTURE	NUMBER(1)		  NOT NULL,
	REMOVE_ROLES_ON_ACCOUNT_EXPIR   NUMBER(1, 0)      NOT NULL,
	LIKE_FOR_LIKE_SLOTS 			NUMBER(10) 		  NOT NULL,
	SHOW_AGGREGATE_OVERRIDE			NUMBER(1)		  NOT NULL,
	ALLOW_OLD_CHART_ENGINE			NUMBER(1)		  NOT NULL,
	SHOW_MAP_ON_AUDIT_LIST			NUMBER(1)		  NOT NULL,
	ALLOW_MULTIPERIOD_FORMS			NUMBER(1)		  NOT NULL,
	RSTRCT_MULTIPRD_FRM_EDIT_TO_YR	NUMBER(1)		  NOT NULL,
	COPY_FORWARD_ALLOW_NA			NUMBER(1)		  NOT NULL,
	TEAR_OFF_DELEG_HEADER			NUMBER(1)		  NOT NULL,
	DELEG_DROPDOWN_THRESHOLD		NUMBER(10)		  NOT NULL,
	USER_PICKER_EXTRA_FIELDS		VARCHAR2(255),
	FORECASTING_SLOTS 				NUMBER(10) 		  NOT NULL,
	DIVISIBILITY_BUG				NUMBER(1)		  NOT NULL,
	REST_API_GUEST_ACCESS			NUMBER(1)		  NOT NULL,
	QUESTION_LIBRARY_ENABLED		NUMBER(1)		  NOT NULL,
	CALC_SUM_TO_DT_CUST_YR_START	NUMBER(1)		  NOT NULL,
    CALC_START_DTM                  DATE              NOT NULL,
    CALC_END_DTM                    DATE              NOT NULL,
    SHOW_ADDITIONAL_AUDIT_INFO      NUMBER(1)         NOT NULL,
	LAZY_LOAD_ROLE_MEMBERSHIP 		NUMBER(1)		  NOT NULL,
	CALC_FUTURE_WINDOW				NUMBER(2)		  NOT NULL,
	SITE_TYPE						VARCHAR(10)		  NOT NULL,
	REQUIRE_SA_LOGIN_REASON			NUMBER(1)		  NOT NULL,
	ALLOW_CC_ON_ALERTS 				NUMBER(1) 		  NOT NULL,
	CHART_ALGORITHM_VERSION			NUMBER(10),
	MARKED_FOR_ZAP					NUMBER(1)		  NOT NULL,
	ZAP_AFTER_DTM					DATE,
	BATCH_JOBS_DISABLED				NUMBER(1)		  NOT NULL,
	CALC_JOBS_DISABLED				NUMBER(1)		  NOT NULL,
	SCHEDULED_TASKS_DISABLED		NUMBER(1)		  NOT NULL,
	ALERTS_DISABLED					NUMBER(1)		  NOT NULL,
	PREVENT_LOGON					NUMBER(1)		  NOT NULL,
	MOBILE_BRANDING_ENABLED			NUMBER(1)		  NOT NULL,
	ENABLE_JAVA_AUTH				NUMBER(1)		  NOT NULL,
	RENDER_CHARTS_AS_SVG			NUMBER(1)		  NOT NULL,
	SHOW_DATA_APPROVE_CONFIRM		NUMBER(1)		  NOT NULL,
    AUTO_ANONYMISATION_ENABLED         NUMBER(1,0)    NOT NULL,
	INACTIVE_DAYS_BEFORE_ANONYMISATION NUMBER(10,0)   NOT NULL,
    CHECK (ALLOW_PARTIAL_SUBMIT IN (0,1)),
    CHECK (USE_TRACKER IN (0,1)),
    CONSTRAINT CK_CUST_USE_USER_SHEETS CHECK (USE_USER_SHEETS IN (0,1)),
    CONSTRAINT CK_AGGREGATION_ENGINE_VERSION CHECK (AGGREGATION_ENGINE_VERSION IN (4)),
    CHECK (ALLOW_VAL_EDIT IN (0,1)),
    CONSTRAINT CK_CUST_FULLY_HIDE_SHEETS CHECK (FULLY_HIDE_SHEETS IN (0,1)),
    CONSTRAINT CK_CUSTOMER_CALC_SUM_0_FILL CHECK (CALC_SUM_ZERO_FILL IN (0,1)),
    CONSTRAINT CK_CUSTOMER_AUDIT_CALC_CHANGES CHECK (AUDIT_CALC_CHANGES IN (0,1)),
    CHECK (TARGET_LINE_COL_FROM_GRADIENT IN (0,1)),
    CHECK (USE_CARBON_EMISSION IN (0,1)),
    CHECK (ALLOW_DELEG_PLAN IN (0,1)),
    CONSTRAINT CK_UNMERGED_CONSISTENT CHECK (unmerged_consistent in (0,1)),
    CONSTRAINT CK_CUSTOMER_IND_SEL_ENABLED CHECK (IND_SELECTIONS_ENABLED IN (0,1)),
    CONSTRAINT CHK_CUS_CHK_TOL_ZERO CHECK (CHECK_TOLERANCE_AGAINST_ZERO IN (0,1)),
    CONSTRAINT CK_CUSTOMER_SCENARIOS_ENABLED CHECK (scenarios_enabled in (0,1)),
    CONSTRAINT CHK_CPY_VAL_TO_NEW_SHT CHECK (COPY_VALS_TO_NEW_SHEETS IN (0,1)),
    CONSTRAINT CK_USE_VAR_EXPL_GROUPS CHECK (USE_VAR_EXPL_GROUPS IN (0,1)),
	CONSTRAINT CHK_CUS_APPLY_FCTRS_CHLDRN CHECK (APPLY_FACTORS_TO_CHILD_REGIONS IN (0,1)),
	CONSTRAINT CK_CUST_BOUNCE_TRACK_ENABLED CHECK (BOUNCE_TRACKING_ENABLED IN (0,1)),
	CONSTRAINT CK_CUST_ISSUE_ESC_ENABLED CHECK (ISSUE_ESCALATION_ENABLED IN (0,1)),
	CONSTRAINT CK_CUSTOMER_CHECK_DIVIS CHECK (CHECK_DIVISIBILITY IN (0,1)),
	CONSTRAINT CK_CUST_START_MONTH CHECK (START_MONTH BETWEEN 1 AND 12),
	CONSTRAINT CK_CUST_SHO_REGION_DISP_DATE CHECK (SHOW_REGION_DISPOSAL_DATE IN (0, 1)),
	CONSTRAINT CK_CUST_SHO_ALL_SHT_REP_PRD CHECK (SHOW_ALL_SHEETS_FOR_REP_PRD IN (0, 1)),
	CONSTRAINT CK_CUST_DELEG_BROWSER_SHO_RAG CHECK (DELEG_BROWSER_SHOW_RAG IN (0, 1)),
	CONSTRAINT CK_CUST_TGTDASH_IGNORE_EST CHECK (TGTDASH_IGNORE_ESTIMATED IN (0, 1)),
	CONSTRAINT CK_CUST_TGTDASH_HIDE_TOTALS CHECK (TGTDASH_HIDE_TOTALS IN (0, 1)),
	CONSTRAINT CK_CUST_TGTDSH_SHO_CHG_LST_YR CHECK (TGTDASH_SHOW_CHG_FROM_LAST_YR IN (0, 1)),
	CONSTRAINT CK_CUST_TGTDASH_SHOW_LAST_YR CHECK (TGTDASH_SHOW_LAST_YEAR IN (0, 1)),
	CONSTRAINT CK_CUST_TGTDASH_COLOUR_TEXT CHECK (TGTDASH_COLOUR_TEXT IN (0, 1)),
	CONSTRAINT CK_CUST_TGTDASH_SHO_TGT_FIRST CHECK (TGTDASH_SHOW_TARGET_FIRST IN (0, 1)),
	CONSTRAINT CK_CUST_TGTDASH_SHOW_FLASH CHECK (TGTDASH_SHOW_FLASH IN (0, 1)),
	CONSTRAINT CK_CUST_USE_REGION_EVENTS CHECK (USE_REGION_EVENTS IN (0, 1)),
	CONSTRAINT CK_CUST_METERING_ENABLED CHECK (METERING_ENABLED IN (0, 1)),
	CONSTRAINT CK_CUST_CRC_METERING_ENABLED CHECK (CRC_METERING_ENABLED IN (0, 1)),
	CONSTRAINT CK_CUST_CRC_METERING_IND_CORE CHECK (CRC_METERING_IND_CORE IN (0, 1)),
	CONSTRAINT CK_CUST_CRC_METERNG_AUTO_CORE CHECK (CRC_METERING_AUTO_CORE IN (0, 1)),
	CONSTRAINT CK_CUST_ISS_VW_SRC_DPST_SHT CHECK (ISS_VIEW_SRC_TO_DEEPEST_SHEET IN (0, 1)),
	CONSTRAINT CK_CUST_DE_SHOW_MARKERS CHECK (DATA_EXPLORER_SHOW_MARKERS IN (0, 1)),
	CONSTRAINT CK_CUST_DE_SHOW_RANKING CHECK (DATA_EXPLORER_SHOW_RANKING IN (0, 1)),
	CONSTRAINT CK_CUST_DE_SHOW_TRENDS CHECK (DATA_EXPLORER_SHOW_TRENDS IN (0, 1)),
	CONSTRAINT CK_CUST_DE_SHOW_SCATTER CHECK (DATA_EXPLORER_SHOW_SCATTER IN (0, 1)),
	CONSTRAINT CK_CUST_DE_SHOW_RADAR CHECK (DATA_EXPLORER_SHOW_RADAR IN (0, 1)),
	CONSTRAINT CK_CUST_DE_SHOW_GAUGE CHECK (DATA_EXPLORER_SHOW_GAUGE IN (0, 1)),
	CONSTRAINT CK_CUST_DE_SHOW_WATERFALL CHECK (DATA_EXPLORER_SHOW_WATERFALL IN (0, 1)),
	CONSTRAINT CK_DLGS_ALWAYS_SHOW_ADV_OPTS CHECK (DELEGS_ALWAYS_SHOW_ADV_OPTS IN (0, 1)),
	CONSTRAINT CK_CUSTOMER_TOL_CHK_REQ_MRGD CHECK (TOLERANCE_CHECKER_REQ_MERGED IN (0, 1, 2)),
	CONSTRAINT CK_CUSTOMER_INCL_NULLS_IN_TA CHECK (INCLUDE_NULLS_IN_TA IN (0,1)),
	CONSTRAINT CHK_CUSTOMER_ALLOW_CUSTOM_IT CHECK (ALLOW_CUSTOM_ISSUE_TYPES IN (0,1)),
	CONSTRAINT CK_CUSTOMER_ISSUE_VISIBILITY CHECK (RESTRICT_ISSUE_VISIBILITY IN (0,1)),
	CONSTRAINT CHK_QS_FIXED_STRUCTURE CHECK (QUICK_SURVEY_FIXED_STRUCTURE IN (0, 1)),
	CONSTRAINT CK_CUST_ALLOW_OLD_CHART_ENGINE CHECK (ALLOW_OLD_CHART_ENGINE IN (0,1)),
	CONSTRAINT CHK_SHOW_MAP_ON_AUDIT_LIST CHECK (SHOW_MAP_ON_AUDIT_LIST IN (0, 1)),
	CONSTRAINT CK_CUSTOMER_COPY_FOR_ALLOW_NA CHECK (copy_forward_allow_na IN (0,1)),
	CONSTRAINT CK_CUSTOMER_DIVISIBILITY_BUG CHECK (DIVISIBILITY_BUG IN (0,1)),
	CONSTRAINT CK_CUST_REST_API_GUEST_ACCESS CHECK (rest_api_guest_access IN (0,1)),
	CONSTRAINT CK_QUESTION_LIBRARY_ENABLED CHECK (QUESTION_LIBRARY_ENABLED IN (0,1)),
	CONSTRAINT CK_CALC_SUM_TO_DT_CUST_YR CHECK (CALC_SUM_TO_DT_CUST_YR_START IN (0,1)),
    CONSTRAINT CHK_SHOW_ADDITONAL_AUDIT_INFO CHECK (SHOW_ADDITIONAL_AUDIT_INFO IN (0,1)),
	CONSTRAINT CHK_LAZY_LOAD_ROLE_MEMBERSHIP CHECK (LAZY_LOAD_ROLE_MEMBERSHIP IN (0,1)),
	CONSTRAINT CHK_CALC_FUTURE_WINDOW CHECK (CALC_FUTURE_WINDOW >= 1 AND CALC_FUTURE_WINDOW < 15),
	CONSTRAINT CHK_ADJ_FACTORSET_STARTMONTH CHECK (ADJ_FACTORSET_STARTMONTH IN (0,1)),
	CONSTRAINT CK_REQUIRE_SA_LOGIN_REASON CHECK (REQUIRE_SA_LOGIN_REASON IN (0, 1)),
	CONSTRAINT CK_ALLOW_CC_ON_ALERTS CHECK (ALLOW_CC_ON_ALERTS IN (0,1)),
	CONSTRAINT CK_ALLOW_MARKED_FOR_ZAP CHECK (MARKED_FOR_ZAP IN (0,1)),
	CONSTRAINT CK_ALLOW_BATCH_JOBS_DISABLED CHECK (BATCH_JOBS_DISABLED IN (0,1)),
	CONSTRAINT CK_ALLOW_CALC_JOBS_DISABLED CHECK (CALC_JOBS_DISABLED IN (0,1)),
	CONSTRAINT CK_ALLOW_SCHEDULED_TASKS_DISABLED CHECK (SCHEDULED_TASKS_DISABLED IN (0,1)),
	CONSTRAINT CK_ALLOW_ALERTS_DISABLED CHECK (ALERTS_DISABLED IN (0,1)),
	CONSTRAINT CK_ALLOW_PREVENT_LOGON CHECK (PREVENT_LOGON IN (0,1)),
	CONSTRAINT CK_ENABLE_MOBILE_BRANDING CHECK (MOBILE_BRANDING_ENABLED IN (0,1)),
    CONSTRAINT CK_RENDER_CHARTS_AS_SVG CHECK (RENDER_CHARTS_AS_SVG IN (0,1)),
    CONSTRAINT CK_SHOW_DATA_APPROVE_CONFIRM CHECK (SHOW_DATA_APPROVE_CONFIRM IN (0,1)),
	CONSTRAINT FK_CUSTOMER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_PERIOD_ID     NUMBER(10, 0)    NOT NULL,
    PENDING_DATASET_ID    NUMBER(10, 0)    NOT NULL,
    START_DTM             DATE             NOT NULL,
    END_DTM               DATE             NOT NULL,
    LABEL                 VARCHAR2(255)    NOT NULL,
    DEFAULT_DUE_DTM       DATE             NOT NULL,
    CONSTRAINT PK_PENDING_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_PERIOD_ID),
    CONSTRAINT FK_PENDING_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_VAL_LOG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_VAL_LOG_ID    NUMBER(10, 0)     NOT NULL,
    PENDING_VAL_ID        NUMBER(10, 0)     NOT NULL,
    SET_DTM               DATE              NOT NULL,
    SET_BY_USER_SID       NUMBER(10, 0)     NOT NULL,
    DESCRIPTION           VARCHAR2(255)     NOT NULL,
    PARAM_1               VARCHAR2(4000),
    PARAM_2               VARCHAR2(4000),
    PARAM_3               VARCHAR2(4000),
    CONSTRAINT PK_PENDING_VAL_LOG PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_VAL_LOG_ID),
    CONSTRAINT FK_PENDING_VAL_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET (
    CSRIMP_SESSION_ID            NUMBER(10)       DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_ID                     NUMBER(10, 0)    NOT NULL,
    DELEGATION_SID               NUMBER(10, 0)    NOT NULL,
    START_DTM                    DATE             NOT NULL,
    END_DTM                      DATE             NOT NULL,
    SUBMISSION_DTM               DATE             NOT NULL,
    REMINDER_DTM                 DATE             NOT NULL,
    LAST_SHEET_HISTORY_ID        NUMBER(10, 0),
    IS_VISIBLE                   NUMBER(1, 0)     NOT NULL,
    IS_COPIED_FORWARD            NUMBER(1, 0)     NOT NULL,
    AUTOMATIC_APPROVAL_DTM       DATE,
    AUTOMATIC_APPROVAL_STATUS    CHAR,
    IS_READ_ONLY                 NUMBER(1, 0),
    PERCENT_COMPLETE             NUMBER(10, 0),
    CONSTRAINT CK_SHEET_DATES CHECK (END_DTM > START_DTM),
    CONSTRAINT CK_AASTATUS CHECK (AUTOMATIC_APPROVAL_STATUS IN ('P', 'Q', 'A', 'R')),
    CONSTRAINT PK_SHEET PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_ID),
    CONSTRAINT FK_SHEET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_ALERT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_ID             NUMBER(10, 0)    NOT NULL,
    USER_SID             NUMBER(10, 0)    NOT NULL,
    REMINDER_SENT_DTM    DATE,
    OVERDUE_SENT_DTM     DATE,
    CONSTRAINT PK_SHEET_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_ID, USER_SID),
    CONSTRAINT FK_SHEET_ALERT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_HISTORY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_HISTORY_ID     NUMBER(10, 0)    NOT NULL,
    SHEET_ID             NUMBER(10, 0)    NOT NULL,
    FROM_USER_SID        NUMBER(10, 0)    NOT NULL,
    TO_DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    ACTION_DTM           DATE             NOT NULL,
    NOTE                 CLOB,
    SHEET_ACTION_ID      NUMBER(10, 0)    NOT NULL,
	IS_SYSTEM_NOTE	     NUMBER (1, 0)	  NOT NULL,
    CONSTRAINT PK_SHEET_HISTORY PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_HISTORY_ID),
    CONSTRAINT FK_SHEET_HISTORY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_INHERITED_VALUE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID        NUMBER(10, 0)    NOT NULL,
    INHERITED_VALUE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SHEET_INHERITED_VALUE PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_ID, INHERITED_VALUE_ID),
    CONSTRAINT FK_SHEET_INHERITED_VALUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID                 NUMBER(10, 0)     NOT NULL,
    SHEET_ID                       NUMBER(10, 0)     NOT NULL,
    IND_SID                        NUMBER(10, 0)     NOT NULL,
    REGION_SID                     NUMBER(10, 0)     NOT NULL,
    VAL_NUMBER                     NUMBER(24, 10),
    SET_BY_USER_SID                NUMBER(10, 0)     NOT NULL,
    SET_DTM                        DATE              NULL,
    NOTE                           CLOB,
    ENTRY_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    ENTRY_VAL_NUMBER               NUMBER(24, 10),
    IS_INHERITED                   NUMBER(10, 0)     NOT NULL,
    STATUS                         NUMBER(10, 0)     NOT NULL,
    LAST_SHEET_VALUE_CHANGE_ID     NUMBER(10, 0),
    ALERT                          VARCHAR2(255),
    FLAG                           NUMBER(10, 0),
    VAR_EXPL_NOTE                  VARCHAR2(2000),
    IS_NA                          NUMBER(1, 0)      NOT NULL,
    CONSTRAINT PK_SHEET_VALUE PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_ID),
    CONSTRAINT FK_SHEET_VALUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_ACCURACY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID             NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_OPTION_ID    NUMBER(10, 0)    NOT NULL,
    PCT                        NUMBER(10, 4)    NOT NULL,
    CONSTRAINT PK_SHEET_VALUE_ACCURACY PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_ID, ACCURACY_TYPE_OPTION_ID),
    CONSTRAINT FK_SHEET_VALUE_ACC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_CHANGE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_CHANGE_ID          NUMBER(10, 0)     NOT NULL,
    SHEET_VALUE_ID                 NUMBER(10, 0)     NOT NULL,
    IND_SID                        NUMBER(10, 0)     NOT NULL,
    REGION_SID                     NUMBER(10, 0)     NOT NULL,
    VAL_NUMBER                     NUMBER(24, 10),
    REASON                         VARCHAR2(1024),
    CHANGED_BY_SID                 NUMBER(10, 0)     NOT NULL,
    CHANGED_DTM                    DATE              NOT NULL,
    ENTRY_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    ENTRY_VAL_NUMBER               NUMBER(24, 10),
    NOTE                           CLOB,
    FLAG                           NUMBER(10, 0),
    CONSTRAINT PK_SHEET_VALUE_CHANGE PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_CHANGE_ID),
    CONSTRAINT FK_SHEET_VALUE_CHANGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_VAR_EXPL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID    NUMBER(10, 0)    NOT NULL,
    VAR_EXPL_ID       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SHEET_VALUE_VAR_EXPL PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_ID, VAR_EXPL_ID),
    CONSTRAINT FK_SHEET_VALUE_VAR_EXPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_FILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID     NUMBER(10, 0)    NOT NULL,
    FILE_UPLOAD_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SHEET_VALUE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_ID, FILE_UPLOAD_SID),
    CONSTRAINT FK_SHEET_VALUE_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_FILE_HIDDEN_CACHE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID                 NUMBER(10, 0)     NOT NULL,
	FILE_UPLOAD_SID                NUMBER(10,0)      NOT NULL,
    CONSTRAINT PK_SVFHC PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_ID, FILE_UPLOAD_SID),
    CONSTRAINT FK_SVFHC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.SHEET_VALUE_HIDDEN_CACHE(
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SHEET_VALUE_ID				NUMBER(10,0)	NOT NULL,
	VAL_NUMBER					NUMBER(24,10),
	NOTE						CLOB,
	ENTRY_MEASURE_CONVERSION_ID	NUMBER(10, 0),
	ENTRY_VAL_NUMBER			NUMBER(24, 10),
	CONSTRAINT PK_SHEET_VALUE_HIDDEN_CACHE PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_ID),
	CONSTRAINT FK_SHEET_VALUE_HIDDEN_CACHE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.IMP_CONFLICT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_CONFLICT_ID         NUMBER(10, 0)    NOT NULL,
    IMP_SESSION_SID         NUMBER(10, 0)    NOT NULL,
    RESOLVED_BY_USER_SID    NUMBER(10, 0),
    START_DTM               DATE             NOT NULL,
    END_DTM                 DATE             NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    IND_SID                 NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IMP_CONFLICT PRIMARY KEY (CSRIMP_SESSION_ID, IMP_CONFLICT_ID),
    CONSTRAINT FK_IMP_CONFLICT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_CONFLICT_VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_CONFLICT_ID    NUMBER(10, 0)    NOT NULL,
    IMP_VAL_ID         NUMBER(10, 0)    NOT NULL,
    ACCEPT             NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IMP_CONFLICT_VAL PRIMARY KEY (CSRIMP_SESSION_ID, IMP_CONFLICT_ID, IMP_VAL_ID),
    CONSTRAINT FK_IMP_CONFLICT_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IMP_IND_ID						NUMBER(10, 0)	NOT NULL,
	DESCRIPTION						VARCHAR2(4000)	NOT NULL,
	MAPS_TO_IND_SID					NUMBER(10, 0),
	IGNORE							NUMBER(1, 0)	NOT NULL,
	CONSTRAINT PK_IMP_IND PRIMARY KEY (CSRIMP_SESSION_ID, IMP_IND_ID),
	CONSTRAINT FK_IMP_IND_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_MEASURE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_MEASURE_ID                   NUMBER(10, 0)    NOT NULL,
    DESCRIPTION                      VARCHAR2(255)    NOT NULL,
    MAPS_TO_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    MAPS_TO_MEASURE_SID              NUMBER(10, 0),
    IMP_IND_ID                       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IMP_MEASURE PRIMARY KEY (CSRIMP_SESSION_ID, IMP_MEASURE_ID),
    CONSTRAINT FK_IMP_MEASURE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IMP_REGION_ID					NUMBER(10, 0)	NOT NULL,
	DESCRIPTION						VARCHAR2(4000)	NOT NULL,
	MAPS_TO_REGION_SID				NUMBER(10, 0),
	IGNORE							NUMBER(1, 0)	NOT NULL,
	CONSTRAINT PK_IMP_REGION PRIMARY KEY (CSRIMP_SESSION_ID, IMP_REGION_ID),
	CONSTRAINT FK_IMP_REGION_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_SESSION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_SESSION_SID      NUMBER(10, 0)     NOT NULL,
    PARENT_SID           NUMBER(10, 0)     NOT NULL,
    NAME                 VARCHAR2(256),
    OWNER_SID            NUMBER(10, 0)     NOT NULL,
    UPLOADED_DTM         DATE,
    FILE_PATH            VARCHAR2(256)     NOT NULL,
    PARSE_STARTED_DTM    DATE,
    PARSED_DTM           DATE,
    MERGED_DTM           DATE,
    RESULT_CODE          NUMBER(10, 0),
    MESSAGE              VARCHAR2(2048),
    UNMERGED_DTM         DATE,
    CONSTRAINT PK_IMP_SESSION PRIMARY KEY (CSRIMP_SESSION_ID, IMP_SESSION_SID),
    CONSTRAINT FK_IMP_SESSION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_VAL (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_VAL_ID                  NUMBER(10, 0)     NOT NULL,
    IMP_IND_ID                  NUMBER(10, 0)     NOT NULL,
    IMP_REGION_ID               NUMBER(10, 0)     NOT NULL,
    IMP_MEASURE_ID              NUMBER(10, 0),
    UNKNOWN                     VARCHAR2(2048),
    START_DTM                   DATE              NOT NULL,
    END_DTM                     DATE              NOT NULL,
    VAL                         NUMBER(24, 10),
    FILE_SID                    NUMBER(10, 0),
    A                           NUMBER(10, 0),
    B                           NUMBER(10, 0),
    C                           NUMBER(10, 0),
    IMP_SESSION_SID             NUMBER(10, 0)     NOT NULL,
    SET_VAL_ID                  NUMBER(20, 0),
    NOTE                        CLOB,
    SET_REGION_METRIC_VAL_ID    NUMBER(10, 0),
    CONSTRAINT CK_IMP_VAL_DATES CHECK (START_DTM = TRUNC(START_DTM, 'DD') AND END_DTM = TRUNC(END_DTM, 'DD') AND END_DTM > START_DTM),
    CONSTRAINT CK_IMP_VAL_CONV_COMPLETED CHECK ((a is null and b is null and c is null) or (a is not null and b is not null and c is not null)),
    CONSTRAINT PK_IMP_VAL PRIMARY KEY (CSRIMP_SESSION_ID, IMP_VAL_ID),
    CONSTRAINT FK_IMP_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FILE_UPLOAD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FILE_UPLOAD_SID      NUMBER(10, 0)    NOT NULL,
    FILENAME             VARCHAR2(255)    NOT NULL,
    MIME_TYPE            VARCHAR2(256)    NOT NULL,
    PARENT_SID           NUMBER(10, 0)    NOT NULL,
    DATA                 BLOB,
    SHA1                 RAW(20)          NOT NULL,
    LAST_MODIFIED_DTM    DATE             NOT NULL,
    CONSTRAINT PK_FILE_UPLOAD PRIMARY KEY (CSRIMP_SESSION_ID, FILE_UPLOAD_SID),
    CONSTRAINT FK_FILE_UPLOAD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CALC_DEPENDENCY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID         NUMBER(10, 0)    NOT NULL,
    CALC_IND_SID    NUMBER(10, 0)    NOT NULL,
    DEP_TYPE        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_CALC_DEPENDENCY PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, CALC_IND_SID, DEP_TYPE),
    CONSTRAINT FK_CALC_DEPENDENCY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_VALIDATION_RULE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_VALIDATION_RULE_ID    NUMBER(10, 0)     NOT NULL,
    IND_SID                   NUMBER(10, 0)     NOT NULL,
    EXPR                      VARCHAR2(2000)    NOT NULL,
    MESSAGE                   VARCHAR2(2000)    NOT NULL,
    POSITION                  NUMBER(10, 0)     NOT NULL,
    TYPE                      VARCHAR2(1)       NOT NULL,
    CONSTRAINT CHK_IND_VALID_RULE_TYPE CHECK (TYPE IN ('E','W','X','N')),
    CONSTRAINT PK_IND_VALIDATION_RULE PRIMARY KEY (CSRIMP_SESSION_ID, IND_VALIDATION_RULE_ID),
    CONSTRAINT FK_IND_VAIDATION_RULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ROLE_GRANT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ROLE_SID          NUMBER(10, 0)    NOT NULL,
    GRANT_ROLE_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ROLE_GRANT PRIMARY KEY (CSRIMP_SESSION_ID, ROLE_SID, GRANT_ROLE_SID),
    CONSTRAINT FK_ROLE_GRANT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


/*****************************************/
/*********** DELEGATION STUFF ************/
/*****************************************/
CREATE TABLE CSRIMP.DELEGATION_LAYOUT (
    CSRIMP_SESSION_ID   NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LAYOUT_ID           NUMBER(10)          NOT NULL,
    LAYOUT_XHTML        SYS.XMLTYPE         NOT NULL,
    NAME				VARCHAR2(255)		NOT NULL,
	VALID 				NUMBER(1) 			NOT NULL,
    CONSTRAINT PK_DELEGATION_LAYOUT PRIMARY KEY (CSRIMP_SESSION_ID, LAYOUT_ID),
	CONSTRAINT FK_DELEGATION_LAYOUT_IS FOREIGN KEY (CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);


/*****************************************/
/******** OTHER DELEGATION STUFF *********/
/*****************************************/
CREATE TABLE CSRIMP.DELEGATION_GRID (
    CSRIMP_SESSION_ID         NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID                   NUMBER(10, 0)    NOT NULL,
    NAME                      VARCHAR2(255)    NOT NULL,
    PATH                      VARCHAR2(255),
    FORM_SID                  NUMBER(10, 0),
    HELPER_PKG                VARCHAR2(255),
    AGGREGATION_XML           SYS.XMLType,
    VARIANCE_VALIDATION_SP    VARCHAR2(255),
    CONSTRAINT CHK_DELE_GRID_CMS_FORM CHECK (PATH IS NOT NULL OR FORM_SID IS NOT NULL),
    CONSTRAINT PK_DELEGATION_GRID PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID),
    CONSTRAINT FK_DELEGATION_GRID_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_GRID_AGGREGATE_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID                 NUMBER(10, 0)    NOT NULL,
    AGGREGATE_TO_IND_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEGATION_GRID_AGGR_IND PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, AGGREGATE_TO_IND_SID),
    CONSTRAINT FK_DELEG_GRID_AGGR_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    				NUMBER(10, 0)    NOT NULL,
    ROLE_SID          				NUMBER(10, 0)    NOT NULL,
    IS_READ_ONLY      				NUMBER(1, 0)     NOT NULL,
	DELEG_PERMISSION_SET			NUMBER(10, 0)	 NOT NULL,
	INHERITED_FROM_SID				NUMBER(10, 0)	 NOT NULL,
    CONSTRAINT PK_DELEGATION_ROLE PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, ROLE_SID, INHERITED_FROM_SID),
    CONSTRAINT FK_DELEGATION_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEGATION_IND_COND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID            NUMBER(10, 0)    NOT NULL,
    IND_SID                   NUMBER(10, 0)    NOT NULL,
    DELEGATION_IND_COND_ID    NUMBER(10, 0)    NOT NULL,
    EXPR                      VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_DELEGATION_IND_COND PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, IND_SID, DELEGATION_IND_COND_ID),
    CONSTRAINT FK_DELEG_IND_COND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEGATION_IND_COND_ACTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID            NUMBER(10, 0)    NOT NULL,
    IND_SID                   NUMBER(10, 0)    NOT NULL,
    DELEGATION_IND_COND_ID    NUMBER(10, 0)    NOT NULL,
    ACTION                    VARCHAR2(255)    NOT NULL,
    TAG                       VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_DELEG_IND_COND_ACTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



CREATE TABLE CSRIMP.DELEGATION_IND_TAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    IND_SID           NUMBER(10, 0)    NOT NULL,
    TAG               VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_DELEGATION_IND_TAG PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, IND_SID, TAG),
    CONSTRAINT FK_DELEG_IND_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEGATION_IND_TAG_LIST (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    TAG               VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_DELEGATION_IND_TAG_LIST PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, TAG),
    CONSTRAINT FK_DELEG_IND_TAG_LIST_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



/*****************************************/
/************** DELEG PLANS **************/
/*****************************************/
CREATE TABLE CSRIMP.DELEG_PLAN (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_SID     				NUMBER(10, 0)     NOT NULL,
    NAME               				VARCHAR2(1023)    NOT NULL,
    START_DTM          				DATE              NOT NULL,
    END_DTM            				DATE              NOT NULL,
    PERIOD_SET_ID					NUMBER(10),
    PERIOD_INTERVAL_ID				NUMBER(10),
    REMINDER_OFFSET    				NUMBER(10, 0)     NOT NULL,
    SCHEDULE_XML       				CLOB              NOT NULL,
    NAME_TEMPLATE      				VARCHAR2(1000),
    ACTIVE             				NUMBER(1, 0)      NOT NULL,
    NOTES              				CLOB,
    DYNAMIC            				NUMBER(1, 0)      NOT NULL,
    LAST_APPLIED_DTM   				DATE,
    LAST_APPLIED_DYNAMIC            NUMBER(1, 0),
    CONSTRAINT CK_DELEG_TPL_DATES CHECK (END_DTM > START_DTM),
    CONSTRAINT CHK_DELEG_PLAN_ACTIVE CHECK (ACTIVE IN (0,1)),
    CONSTRAINT CK_DYNAMIC CHECK (dynamic in (0,1)),
    CONSTRAINT PK_DELEG_PLAN PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_SID),
    CONSTRAINT FK_DELEG_PLAN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEG_PLAN_APPLIED (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_APPLIED_ID    NUMBER(10, 0)    NOT NULL,
    DELEG_PLAN_SID           NUMBER(10, 0)    NOT NULL,
    APPLIED_BY_USER_SID      NUMBER(10, 0)    NOT NULL,
    APPLIED_DTM              DATE             NOT NULL,
    CONSTRAINT PK_DELEG_PLAN_APPLIED PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_APPLIED_ID),
    CONSTRAINT FK_DELEG_PLAN_APPLIED_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



CREATE TABLE CSRIMP.DELEG_PLAN_COL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_ID           NUMBER(10, 0)    NOT NULL,
    DELEG_PLAN_SID              NUMBER(10, 0),
    IS_HIDDEN                   NUMBER(1, 0)     NOT NULL,
    DELEG_PLAN_COL_DELEG_ID     NUMBER(10, 0),
    DELEG_PLAN_COL_SURVEY_ID    NUMBER(10, 0),
    QS_CAMPAIGN_SID             NUMBER(10, 0),
    CONSTRAINT CHK_DELEG_PLAN_ENTITY_HIDDEN CHECK (IS_HIDDEN IN (0,1)),
    CONSTRAINT PK_DELEG_PLAN_COL PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_COL_ID),
    CONSTRAINT FK_DELEG_PLAN_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_COL_DELEG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_DELEG_ID    NUMBER(10, 0)    NOT NULL,
    DELEGATION_SID             NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEG_PLAN_COL_DELEG PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_COL_DELEG_ID),
    CONSTRAINT FK_DLG_PLAN_COL_DLG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEG_PLAN_COL_SURVEY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_SURVEY_ID    NUMBER(10, 0)    NOT NULL,
    SURVEY_SID                  NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEG_PLAN_COL_SURVEY PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_COL_SURVEY_ID, SURVEY_SID),
    CONSTRAINT UK_DELEG_PLAN_COL_SURVEY  UNIQUE (CSRIMP_SESSION_ID, DELEG_PLAN_COL_SURVEY_ID),
    CONSTRAINT FK_DLG_PLAN_COL_SURVEY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_DELEG_REGION (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_DELEG_ID		NUMBER(10, 0)    NOT NULL,
    REGION_SID					NUMBER(10, 0)    NOT NULL,
    PENDING_DELETION			NUMBER(1, 0)     NOT NULL,
    REGION_SELECTION			VARCHAR2(2)      NOT NULL,
    REGION_COLLATION			VARCHAR2(1)      NOT NULL,
    TAG_ID						NUMBER(10, 0),
	REGION_TYPE					NUMBER(10, 0),
    CONSTRAINT CHK_DELEG_PLAN_DR_PENDING_DEL CHECK (PENDING_DELETION IN (0,1,2)),
    CONSTRAINT CHK_DLG_PLN_DLG_RGN_RS CHECK (REGION_SELECTION IN ('R','L','P','RT','LT','PT')),
    CONSTRAINT CHK_DLG_PLN_DLG_RGN_RC CHECK (REGION_COLLATION IN ('S','M')),
    CONSTRAINT PK_DELEG_PLAN_DELEG_REGION PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_COL_DELEG_ID, REGION_SID),
    CONSTRAINT FK_DLG_PLN_DLG_REG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_DELEG_REGION_DELEG (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_DELEG_ID		NUMBER(10, 0)    NOT NULL,
    REGION_SID					NUMBER(10, 0)    NOT NULL,
    APPLIED_TO_REGION_SID		NUMBER(10, 0)    NOT NULL,
    HAS_MANUAL_AMENDS			NUMBER(1, 0)     NOT NULL,
    MAPS_TO_ROOT_DELEG_SID		NUMBER(10, 0)    NOT NULL,
    CONSTRAINT CK_DELGPLNDLGREGDELG_MAN_AMND CHECK (HAS_MANUAL_AMENDS IN (0,1)),
    CONSTRAINT PK_DLG_PLAN_DLG_REG_DLG PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_COL_DELEG_ID, REGION_SID, APPLIED_TO_REGION_SID),
    CONSTRAINT FK_DLG_PLN_DLG_REG_DLG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEG_PLAN_REGION (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_SID		NUMBER(10, 0)    NOT NULL,
    REGION_SID			NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEG_PLAN_REGION PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_SID, REGION_SID),
    CONSTRAINT FK_DLG_PLN_REG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_ROLE (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_SID		NUMBER(10, 0)    NOT NULL,
    ROLE_SID			NUMBER(10, 0)    NOT NULL,
    POS					NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEG_PLAN_ROLE PRIMARY KEY (CSRIMP_SESSION_ID, DELEG_PLAN_SID, ROLE_SID),
    CONSTRAINT FK_DLG_PLN_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_GRID_VARIANCE (
	CSRIMP_SESSION_ID		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ID						VARCHAR2(255) NOT NULL,
	ROOT_DELEGATION_SID		NUMBER(10) NOT NULL,
	REGION_SID				NUMBER(10) NOT NULL,
	START_DTM				DATE NOT NULL,
	END_DTM					DATE NOT NULL,
	GRID_IND_SID			NUMBER(10) NOT NULL,
	LABEL					VARCHAR2(255) NOT NULL,
	VARIANCE				VARCHAR2(255) NOT NULL,
	EXPLANATION				CLOB,
	ACTIVE					NUMBER(1),
	CURR_VALUE				NUMBER,
	PREV_VALUE				NUMBER,
	CONSTRAINT PK_DELEG_GRID_VAR PRIMARY KEY (CSRIMP_SESSION_ID, ID, ROOT_DELEGATION_SID, REGION_SID, START_DTM, END_DTM, GRID_IND_SID),
	CONSTRAINT FK_DELEG_GRID_VAR_IMP_S FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MASTER_DELEG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_MASTER_DELEG PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID),
    CONSTRAINT FK_MASTER_DELEG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


/************************************/
/************ IMG CHARTS ************/
/************************************/
CREATE TABLE CSRIMP.IMG_CHART (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMG_CHART_SID        NUMBER(10, 0)     NOT NULL,
    PARENT_SID           NUMBER(10, 0)     NOT NULL,
    LABEL                VARCHAR2(1023)    NOT NULL,
    MIME_TYPE            VARCHAR2(255)     NOT NULL,
    DATA                 BLOB              NOT NULL,
    SHA1                 RAW(20)           NOT NULL,
    LAST_MODIFIED_DTM    DATE              NOT NULL,
    SCENARIO_RUN_SID     NUMBER(10, 0),
    SCENARIO_RUN_TYPE    NUMBER(1, 0)      NOT NULL,
    CONSTRAINT PK_IMG_CHART PRIMARY KEY (CSRIMP_SESSION_ID, IMG_CHART_SID),
    CONSTRAINT FK_IMG_CHART_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.IMG_CHART_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMG_CHART_SID            NUMBER(10, 0)     NOT NULL,
    IND_SID                  NUMBER(10, 0)     NOT NULL,
    DESCRIPTION              VARCHAR2(1023),
    MEASURE_CONVERSION_ID    NUMBER(10, 0),
    X                        NUMBER(10, 0)     NOT NULL,
    Y                        NUMBER(10, 0)     NOT NULL,
    BACKGROUND_COLOR         NUMBER(10, 0)     NOT NULL,
    BORDER_COLOR             NUMBER(10, 0)     NOT NULL,
    FONT_SIZE                NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_IMG_CHART_IND PRIMARY KEY (CSRIMP_SESSION_ID, IMG_CHART_SID, IND_SID),
    CONSTRAINT FK_IMG_CHART_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



CREATE TABLE CSRIMP.FORM_EXPR
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_EXPR_ID            NUMBER(10, 0) NOT NULL,
    DELEGATION_SID          NUMBER(10, 0) NOT NULL,
    DESCRIPTION             VARCHAR2(255 BYTE),
    EXPR                    SYS.XMLType NOT NULL,
    CONSTRAINT PK_FORM_EXPR PRIMARY KEY (CSRIMP_SESSION_ID, FORM_EXPR_ID),
    CONSTRAINT FK_FORM_EXPR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_IND_FORM_EXPR
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID          NUMBER(10, 0) NOT NULL,
    IND_SID                 NUMBER(10, 0) NOT NULL,
    FORM_EXPR_ID            NUMBER(10, 0) NOT NULL,
    CONSTRAINT PK_DELEG_IND_FORM_EXPR PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, IND_SID, FORM_EXPR_ID),
    CONSTRAINT FK_DELEG_IND_FORM_EXPR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_IND_GROUP
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_IND_GROUP_ID      NUMBER(10, 0) NOT NULL,
    DELEGATION_SID          NUMBER(10, 0) NOT NULL,
    TITLE                   VARCHAR2(255 BYTE),
    START_COLLAPSED         NUMBER(1, 0)  NOT NULL,
    CONSTRAINT PK_DELEG_IND_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, DELEG_IND_GROUP_ID),
    CONSTRAINT FK_DELEG_IND_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_IND_GROUP_MEMBER
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID          NUMBER(10, 0) NOT NULL,
    IND_SID                 NUMBER(10, 0) NOT NULL,
    DELEG_IND_GROUP_ID      NUMBER(10, 0) NOT NULL,
    CONSTRAINT PK_DEL_IND_DEL_IND_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, IND_SID, DELEG_IND_GROUP_ID),
    CONSTRAINT FK_DELEG_IND_GRP_MEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FACTOR
 (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FACTOR_ID                   NUMBER(10, 0)     NOT NULL,
    FACTOR_TYPE_ID              NUMBER(10, 0)     NOT NULL,
    GAS_TYPE_ID                 NUMBER(10, 0)     NOT NULL,
    REGION_SID                  NUMBER(10, 0),
    GEO_COUNTRY                 VARCHAR2(2),
    GEO_REGION                  VARCHAR2(2),
    EGRID_REF                   VARCHAR2(4),
    IS_SELECTED                 NUMBER(1, 0)      NOT NULL,
    START_DTM                   DATE              NOT NULL,
    END_DTM                     DATE,
    VALUE                       NUMBER(24, 10)    NOT NULL,
    NOTE                        CLOB,
    STD_MEASURE_CONVERSION_ID   NUMBER(10, 0)     NOT NULL,
    STD_FACTOR_ID               NUMBER(10, 0),
    ORIGINAL_FACTOR_ID          NUMBER(10, 0),
	CUSTOM_FACTOR_ID			NUMBER(10, 0),
	PROFILE_ID					NUMBER(10, 0),
	IS_VIRTUAL					NUMBER(1, 0),
	CONSTRAINT CK_FACTOR_DATES CHECK ((START_DTM = TRUNC(START_DTM, 'MON') AND END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM)),
	CONSTRAINT CK_FACTOR_IS_VIRTUAL CHECK (IS_VIRTUAL IN (1, 0)),
	CONSTRAINT PK_FACTOR PRIMARY KEY (CSRIMP_SESSION_ID, FACTOR_ID),
	CONSTRAINT FK_FACTOR_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOM_FACTOR_HISTORY (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CUSTOM_FACTOR_HISTORY_ID	NUMBER(10) NOT NULL,
	FACTOR_CAT_ID				NUMBER(10) NOT NULL,
	FACTOR_TYPE_ID				NUMBER(10) NOT NULL,
	FACTOR_SET_ID				NUMBER(10) NOT NULL,
	GEO_COUNTRY					VARCHAR2(2),
	GEO_REGION					VARCHAR2(2),
	EGRID_REF					VARCHAR2(4),
	REGION_SID					NUMBER(10),
	GAS_TYPE_ID					NUMBER(10),
	START_DTM					DATE NOT NULL,
	END_DTM						DATE,
	FIELD_NAME					VARCHAR2(1024),
	OLD_VAL						VARCHAR2(1024),
	NEW_VAL						VARCHAR2(1024),
	MESSAGE						VARCHAR2(1024),
	AUDIT_DATE					DATE NOT NULL,
	USER_SID					NUMBER(10) NOT NULL,
	CONSTRAINT PK_CUSTOM_FACTOR_HISTORY PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOM_FACTOR_HISTORY_ID),
	CONSTRAINT FK_CUSTOM_FACTOR_HISTORY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_IND_DESCRIPTION
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DELEGATION_SID				 	NUMBER(10, 0) 		NOT NULL,
	IND_SID							NUMBER(10, 0)		NOT NULL,
	LANG 							VARCHAR2(10) 		NOT NULL,
	DESCRIPTION						VARCHAR2(1023) 		NOT NULL,
	CONSTRAINT PK_DELEGATION_IND_DESCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, IND_SID, LANG),
    CONSTRAINT FK_DELEG_IND_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAR_EXPL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    VAR_EXPL_ID          NUMBER(10, 0)    NOT NULL,
    VAR_EXPL_GROUP_ID    NUMBER(10, 0)    NOT NULL,
    LABEL                VARCHAR2(255)    NOT NULL,
    REQUIRES_NOTE        NUMBER(1, 0)     NOT NULL,
    POS                  NUMBER(10, 0),
    HIDDEN 				 NUMBER(1)        NOT NULL,
    CONSTRAINT CHK_REQUIRES_NOTE CHECK (REQUIRES_NOTE IN (0,1)),
    CONSTRAINT PK_VAR_EXPL PRIMARY KEY (CSRIMP_SESSION_ID, VAR_EXPL_ID),
    CONSTRAINT CK_VAR_EXPL_HIDDEN CHECK (HIDDEN IN (0,1)),
    CONSTRAINT FK_VAR_EXPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAR_EXPL_GROUP (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    VAR_EXPL_GROUP_ID    NUMBER(10, 0)    NOT NULL,
    LABEL                VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_VAR_EXPL_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, VAR_EXPL_GROUP_ID),
    CONSTRAINT FK_VAR_EXPL_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACCOUNT_POLICY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                         NUMBER(10, 0)    NOT NULL,
    MAX_LOGON_FAILURES             NUMBER(10, 0),
    EXPIRE_INACTIVE                NUMBER(10, 0),
    MAX_PASSWORD_AGE               NUMBER(10, 0),
    REMEMBER_PREVIOUS_PASSWORDS    NUMBER(10, 0),
    REMEMBER_PREVIOUS_DAYS         NUMBER(10, 0),
    SINGLE_SESSION                 NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_ACCOUNT_POLICY PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_ACCOUNT_POLICY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACC_POLICY_PWD_REGEXP  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACCOUNT_POLICY_SID				NUMBER(10, 0) NOT NULL,
	PASSWORD_REGEXP_ID				NUMBER(10, 0) NOT NULL,
	CONSTRAINT PK_ACC_POLICY_PWD_REGEXP PRIMARY KEY (CSRIMP_SESSION_ID, ACCOUNT_POLICY_SID, PASSWORD_REGEXP_ID),
    CONSTRAINT FK_ACC_POL_PWD_REG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ACL_ID            NUMBER(10, 0)    NOT NULL,
    ACL_INDEX         NUMBER(10, 0)    NOT NULL,
    ACE_TYPE          NUMBER(10, 0)    NOT NULL,
    ACE_FLAGS         NUMBER(10, 0)    NOT NULL,
    SID_ID            NUMBER(10, 0)    NOT NULL,
    PERMISSION_SET    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ACL PRIMARY KEY (CSRIMP_SESSION_ID, ACL_ID, ACL_INDEX),
    CONSTRAINT FK_ACL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPLICATION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPLICATION_SID_ID    NUMBER(10, 0)    NOT NULL,
    EVERYONE_SID_ID       NUMBER(10, 0)    NOT NULL,
    LANGUAGE              VARCHAR2(20),
    CULTURE               VARCHAR2(20),
    TIMEZONE              VARCHAR2(100),
    CONSTRAINT PK_APPLICATION PRIMARY KEY (CSRIMP_SESSION_ID, APPLICATION_SID_ID),
    CONSTRAINT FK_APPLICATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ATTRIBUTES (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ATTRIBUTE_ID    NUMBER(10, 0)    NOT NULL,
    CLASS_ID        NUMBER(10, 0)    NOT NULL,
    NAME            VARCHAR2(255),
    FLAGS           NUMBER(10, 0)    NOT NULL,
    EXTERNAL_PKG    VARCHAR2(255),
    CONSTRAINT PK_ATTRIBUTES PRIMARY KEY (CSRIMP_SESSION_ID, ATTRIBUTE_ID),
    CONSTRAINT FK_ATTRIBUTES_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HOME_PAGE (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID     			NUMBER(10, 0)    NOT NULL,
    URL        			VARCHAR2(900)    NOT NULL,
	CREATED_BY_HOST     VARCHAR2(255)    NOT NULL,
    PRIORITY   			NUMBER(10),
    CONSTRAINT PK_HOME_PAGE PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_HOME_PAGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IP_RULE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IP_RULE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IP_RULE PRIMARY KEY (CSRIMP_SESSION_ID, IP_RULE_ID),
    CONSTRAINT FK_IP_RULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IP_RULE_ENTRY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IP_RULE_ID       NUMBER(10, 0)    NOT NULL,
    IP_RULE_INDEX    NUMBER(10, 0)    NOT NULL,
    IPV4_ADDRESS     NUMBER(10, 0),
    IPV4_BITMASK     NUMBER(10, 0),
    REQUIRE_SSL      NUMBER(1, 0),
    ALLOW            NUMBER(1, 0),
    CONSTRAINT PK_IP_RULE_ENTRY PRIMARY KEY (CSRIMP_SESSION_ID, IP_RULE_ID, IP_RULE_INDEX),
    CONSTRAINT FK_IP_RULE_ENTRY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERMISSION_MAPPING (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PARENT_CLASS_ID      NUMBER(10, 0)    NOT NULL,
    PARENT_PERMISSION    NUMBER(10, 0)    NOT NULL,
    CHILD_CLASS_ID       NUMBER(10, 0)    NOT NULL,
    CHILD_PERMISSION     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_PERMISSION_MAPPING PRIMARY KEY (CSRIMP_SESSION_ID, PARENT_CLASS_ID, PARENT_PERMISSION, CHILD_CLASS_ID, CHILD_PERMISSION),
    CONSTRAINT FK_PERMISSION_MAPPING_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERMISSION_NAME (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CLASS_ID           NUMBER(10, 0)    NOT NULL,
    PERMISSION         NUMBER(10, 0)    NOT NULL,
    PERMISSION_NAME    VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_PERMISSION_NAME PRIMARY KEY (CSRIMP_SESSION_ID, CLASS_ID, PERMISSION),
    CONSTRAINT FK_PERMISSION_NAME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECURABLE_OBJECT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                NUMBER(10, 0)    NOT NULL,
    PARENT_SID_ID         NUMBER(10, 0),
    DACL_ID               NUMBER(10, 0),
    CLASS_ID              NUMBER(10, 0)    NOT NULL,
    NAME                  VARCHAR2(255),
    FLAGS                 NUMBER(10, 0),
    OWNER                 NUMBER(10, 0),
    LINK_SID_ID           NUMBER(10, 0),
    APPLICATION_SID_ID    NUMBER(10, 0),
    CONSTRAINT PK_SECURABLE_OBJECT PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_SECURABLE_OBJECT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECURABLE_OBJECT_ATTRIBUTES (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID          NUMBER(10, 0)     NOT NULL,
    ATTRIBUTE_ID    NUMBER(10, 0)     NOT NULL,
    STRING_VALUE    VARCHAR2(511),
    NUMBER_VALUE    NUMBER(36, 10),
    DATE_VALUE      DATE,
    BLOB_VALUE      BLOB,
    ISOBJECT        NUMBER(1, 0),
    CLOB_VALUE      CLOB,
    CONSTRAINT PK_SEC_OBJ_ATTRIBUTES PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID, ATTRIBUTE_ID),
    CONSTRAINT FK_SEC_OBJ_ATTR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECURABLE_OBJECT_CLASS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CLASS_ID           NUMBER(10, 0)    NOT NULL,
    CLASS_NAME         VARCHAR2(255)    NOT NULL,
    HELPER_PKG         VARCHAR2(255),
    HELPER_PROG_ID     VARCHAR2(255),
    PARENT_CLASS_ID    NUMBER(10, 0),
    CONSTRAINT PK_SECURABLE_OBJECT_CLASS PRIMARY KEY (CSRIMP_SESSION_ID, CLASS_ID),
    CONSTRAINT FK_SEC_OBJECT_CLASS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECURABLE_OBJECT_KEYED_ACL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID    NUMBER(10, 0)    NOT NULL,
    KEY_ID    NUMBER(10, 0)    NOT NULL,
    ACL_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SECURABLE_OBJECT_KEYED_ACL PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID, KEY_ID, ACL_ID),
    CONSTRAINT FK_SEC_OBJECT_KEYED_ACL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.GROUP_MEMBERS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    GROUP_SID_ID     NUMBER(10, 0)    NOT NULL,
    MEMBER_SID_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_GROUP_MEMBERS PRIMARY KEY (CSRIMP_SESSION_ID, GROUP_SID_ID, MEMBER_SID_ID),
    CONSTRAINT FK_GROUP_MEMBERS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.GROUP_TABLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID        NUMBER(10, 0)    NOT NULL,
    GROUP_TYPE    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_GROUP_TABLE PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_GROUP_TABLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MENU (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID         NUMBER(10, 0)     NOT NULL,
    DESCRIPTION    VARCHAR2(1000)    NOT NULL,
    ACTION         VARCHAR2(2000)    NOT NULL,
    POS            NUMBER(10, 0)     NOT NULL,
    CONTEXT        NUMBER(10, 0),
    CONSTRAINT PK_MENU PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_MENU_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_CERTIFICATES (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID          NUMBER(10, 0)    NOT NULL,
    CERT_HASH       RAW(64)          NOT NULL,
    CERT            BLOB             NOT NULL,
    WEBSITE_NAME    VARCHAR2(256),
    CONSTRAINT PK_USER_CERTIFICATES PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID, CERT_HASH),
    CONSTRAINT FK_USER_CERTIFICATES_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_PASSWORD_HISTORY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                 NUMBER(10, 0)    NOT NULL,
    SERIAL                 NUMBER(10, 0)    NOT NULL,
    LOGIN_PASSWORD         VARCHAR2(127),
    LOGIN_PASSWORD_SALT    NUMBER(10, 0),
    RETIRED_DTM            DATE             NOT NULL,
    CONSTRAINT PK_USER_PASSWORD_HISTORY PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID, SERIAL),
    CONSTRAINT FK_USER_PASS_HIST_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_TABLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                   NUMBER(10, 0)    NOT NULL,
    LOGIN_PASSWORD           VARCHAR2(127),
    LOGIN_PASSWORD_SALT      NUMBER(10, 0),
    ACCOUNT_ENABLED          NUMBER(1, 0)     NOT NULL
                             CHECK (ACCOUNT_ENABLED IN (0,1)),
    LAST_PASSWORD_CHANGE     DATE             NOT NULL,
    LAST_LOGON               DATE             NOT NULL,
    LAST_BUT_ONE_LOGON       DATE             NOT NULL,
    FAILED_LOGON_ATTEMPTS    NUMBER(10, 0)    NOT NULL,
    EXPIRATION_DTM           DATE,
    LANGUAGE                 VARCHAR2(20),
    CULTURE                  VARCHAR2(20),
    TIMEZONE                 VARCHAR2(100),
	JAVA_LOGIN_PASSWORD		 VARCHAR(1024),
	JAVA_AUTH_ENABLED		 NUMBER(1) DEFAULT 0
                             CHECK (JAVA_AUTH_ENABLED IN (0,1)),
    ACCOUNT_EXPIRY_ENABLED   NUMBER(1, 0)     NOT NULL
                             CHECK (ACCOUNT_EXPIRY_ENABLED IN (0,1)),
    ACCOUNT_DISABLED_DTM     DATE,
    CONSTRAINT PK_USER_TABLE PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_USER_TABLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WEB_RESOURCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    WEB_ROOT_SID_ID    NUMBER(10, 0)    NOT NULL,
    PATH               VARCHAR2(900)    NOT NULL,
    SID_ID             NUMBER(10, 0)    NOT NULL,
    IP_RULE_ID         NUMBER(10, 0),
    REWRITE_PATH       VARCHAR2(900),
    CONSTRAINT PK_WEB_RESOURCE PRIMARY KEY (CSRIMP_SESSION_ID, WEB_ROOT_SID_ID, PATH),
    CONSTRAINT FK_WEB_RESOURCE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WEBSITE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    WEBSITE_NAME          VARCHAR2(256)    NOT NULL,
    SERVER_GROUP          VARCHAR2(256),
    WEB_ROOT_SID_ID       NUMBER(10, 0)    NOT NULL,
    DENIED_PAGE           VARCHAR2(256)    NOT NULL,
    ACT_TIMEOUT           NUMBER(10, 0)    NOT NULL,
    CERT_ACT_TIMEOUT      NUMBER(10, 0)    NOT NULL,
    SECURE_ONLY           NUMBER(1, 0)     NOT NULL
                          CHECK (SECURE_ONLY IN (0, 1)),
    HTTP_ONLY_COOKIES     NUMBER(1, 0)     NOT NULL
                          CHECK (HTTP_ONLY_COOKIES IN (0, 1)),
    XSRF_CHECK_ENABLED    NUMBER(1, 0)     NOT NULL
                          CHECK (XSRF_CHECK_ENABLED IN (0, 1)),
    APPLICATION_SID_ID    NUMBER(10, 0)    NOT NULL,
    PROXY_SECURE          NUMBER(1, 0)     NOT NULL
                          CHECK (PROXY_SECURE IN (0, 1)),
    IP_RULE_ID            NUMBER(10, 0),
    CONSTRAINT FK_WEBSITE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.KNOWN_SO (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SID_ID					NUMBER(10) NOT NULL,
	PATH					VARCHAR2(4000) NOT NULL,
	CONSTRAINT PK_KNOWN_SO PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_KNOWN_SO_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.MAIL_ACCOUNT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ACCOUNT_SID         NUMBER(10, 0)    NOT NULL,
    EMAIL_ADDRESS       VARCHAR2(255)    NOT NULL,
    ROOT_MAILBOX_SID    NUMBER(10, 0),
    INBOX_SID           NUMBER(10, 0),
    PASSWORD            VARCHAR2(255),
    PASSWORD_SALT       NUMBER(10, 0),
    APOP_SECRET         VARCHAR2(255),
    DESCRIPTION         VARCHAR2(511),
    CONSTRAINT PK_ACCOUNT PRIMARY KEY (CSRIMP_SESSION_ID, ACCOUNT_SID),
    CONSTRAINT FK_MAIL_ACCOUNT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MAILBOX (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MAILBOX_SID                    NUMBER(10, 0)    NOT NULL,
    PARENT_SID                     NUMBER(10, 0),
    LINK_TO_MAILBOX_SID            NUMBER(10, 0),
    MAILBOX_NAME                   VARCHAR2(255)    NOT NULL,
    LAST_MESSAGE_UID               NUMBER(38, 0)    NOT NULL,
    FILTER_DUPLICATE_MESSAGE_ID    NUMBER(1, 0)     NOT NULL
                                   CHECK (FILTER_DUPLICATE_MESSAGE_ID IN (0,1)),
    CONSTRAINT PK_MAILBOX PRIMARY KEY (CSRIMP_SESSION_ID, MAILBOX_SID),
    CONSTRAINT FK_MAIL_MAILBOX_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MAILBOX_MESSAGE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MAILBOX_SID        NUMBER(10, 0)    NOT NULL,
    MESSAGE_UID        NUMBER(10, 0)    NOT NULL,
    MESSAGE_ID         NUMBER(10, 0)    NOT NULL,
    FLAGS              NUMBER(10, 0)    NOT NULL,
    RECEIVED_DTM       DATE             NOT NULL,
	MODSEQ             NUMBER(20, 0)    NOT NULL,
    CONSTRAINT PK_MAILBOX_MESSAGE PRIMARY KEY (CSRIMP_SESSION_ID, MAILBOX_SID, MESSAGE_UID),
    CONSTRAINT FK_MAIL_MAILBOX_MESSAGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MESSAGE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MESSAGE_ID         NUMBER(10, 0)    NOT NULL,
    SUBJECT            VARCHAR2(4000), -- The live mail schema has this as 4000, the current clean build has this at 255
    MESSAGE_DTM        DATE,
    MESSAGE_ID_HDR     VARCHAR2(255),
    IN_REPLY_TO        VARCHAR2(255),
    PRIORITY           NUMBER(1, 0),
    HAS_ATTACHMENTS    NUMBER(1, 0)     NOT NULL,
    BODY               BLOB,
    SHA512			   RAW(64) NOT NULL,
    CONSTRAINT PK_MAIL_MESSAGE PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_ID),
    CONSTRAINT FK_MAIL_MESSAGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MESSAGE_ADDRESS_FIELD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MESSAGE_ID     NUMBER(10, 0)    NOT NULL,
    FIELD_ID       NUMBER(10, 0)    NOT NULL,
    POSITION       NUMBER(10, 0)    NOT NULL,
    ADDRESS        VARCHAR2(255),
    NAME           VARCHAR2(255),
    CONSTRAINT PK_MAIL_MESSAGE_ADDRESS_FIELD PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_ID, FIELD_ID, POSITION),
    CONSTRAINT FK_MAIL_MSG_ADDR_FLD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MESSAGE_HEADER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MESSAGE_ID     NUMBER(10, 0)     NOT NULL,
    POSITION       NUMBER(10, 0)     NOT NULL,
    NAME           VARCHAR2(255)     NOT NULL,
    VALUE          VARCHAR2(1023),
    CONSTRAINT PK_MAIL_MESSAGE_HEADER PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_ID, POSITION),
    CONSTRAINT FK_MAIL_MESSAGE_HEADER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SO_RENAME (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                NUMBER(10, 0)    NOT NULL,
    NAME                  VARCHAR2(255),
    CONSTRAINT FK_SO_RENAME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CORRESPONDENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CORRESPONDENT_ID    NUMBER(10, 0)     NOT NULL,
    FULL_NAME           VARCHAR2(255)     NOT NULL,
    EMAIL               VARCHAR2(255),
    PHONE               VARCHAR2(255),
    GUID                RAW(16)           NOT NULL,
    MORE_INFO_1         VARCHAR2(1000),
    CONSTRAINT PK_CORRESPONDENT PRIMARY KEY (CSRIMP_SESSION_ID, CORRESPONDENT_ID),
    CONSTRAINT FK_CORRESPONDENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_SID            NUMBER(10, 0)    NOT NULL,
    LABEL               VARCHAR2(255)    NOT NULL,
    DEFAULT_STATE_ID    NUMBER(10, 0)	 NOT NULL,
    HELPER_PKG          VARCHAR2(255),
    OWNER_CAN_CREATE    NUMBER(1)        NOT NULL,
    AGGREGATE_IND_GROUP_ID NUMBER(10),
	FLOW_ALERT_CLASS	VARCHAR2(256),
    CONSTRAINT PK_FLOW PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_SID),
    CONSTRAINT FK_FLOW_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.FLOW_ALERT_TYPE (
	CSRIMP_SESSION_ID			NUMBER(10) 		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOMER_ALERT_TYPE_ID    	NUMBER(10, 0)   NOT NULL,
    FLOW_SID                  	NUMBER(10, 0)   NOT NULL,
    LABEL                     	VARCHAR2(255)   NOT NULL,
	DELETED						NUMBER(1,0) 	NOT NULL,
    LOOKUP_KEY                	VARCHAR2(256),
    CONSTRAINT PK_FLOW_ALERT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_ALERT_TYPE_ID),
    CONSTRAINT UK_FLOW_ALERT_TYPE  UNIQUE (CSRIMP_SESSION_ID, CUSTOMER_ALERT_TYPE_ID, FLOW_SID),
    CONSTRAINT FK_FLOW_ALERT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

-- Exclude AUTO_FAILURE_COUNT column as its a transient value. 
CREATE TABLE CSRIMP.FLOW_ITEM (
	CSRIMP_SESSION_ID				        NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_ITEM_ID                            NUMBER(10, 0)    NOT NULL,
    FLOW_SID                                NUMBER(10, 0)    NOT NULL,
    CURRENT_STATE_ID                        NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID                      NUMBER(10, 0),
    DASHBOARD_INSTANCE_ID                   NUMBER(10, 0),
    LAST_FLOW_STATE_TRANSITION_ID           NUMBER(10),
	LAST_FLOW_STATE_LOG_ID                  NUMBER(10),
    CONSTRAINT PK_FLOW_ITEM PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_ITEM_ID),
    CONSTRAINT FK_FLOW_ITEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_ITEM_REGION (
	CSRIMP_SESSION_ID				        NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_ITEM_ID                            NUMBER(10, 0)    NOT NULL,
    REGION_SID                              NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FLOW_ITEM_REGION PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_ITEM_ID, REGION_SID),
    CONSTRAINT FK_FLOW_ITEM_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_ITEM_GENERATED_ALERT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_ITEM_GENERATED_ALERT_ID	NUMBER(10, 0)    NOT NULL,
    FLOW_ITEM_ID               		NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_LOG_ID           	NUMBER(10, 0)    NOT NULL,
    FLOW_TRANSITION_ALERT_ID    	NUMBER(10, 0)    NOT NULL,
    PROCESSED_DTM               	DATE,
    CREATED_DTM		               	DATE,
    FROM_USER_SID	               	NUMBER(10, 0),
    TO_USER_SID		               	NUMBER(10, 0),
    TO_COLUMN_SID	               	NUMBER(10, 0),
    SUBJECT_OVERRIDE				CLOB NULL,
    BODY_OVERRIDE					CLOB NULL,
    CONSTRAINT PK_FLOW_ITEM_GENERATED_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_ITEM_GENERATED_ALERT_ID),
    CONSTRAINT FK_FLOW_ITEM_GEN_ALERT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE (
	CSRIMP_SESSION_ID		NUMBER(10) 		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_ID     		NUMBER(10, 0)   NOT NULL,
    FLOW_SID          		NUMBER(10, 0)   NOT NULL,
    LABEL             		VARCHAR2(255)   NOT NULL,
    LOOKUP_KEY        		VARCHAR2(255),
    ATTRIBUTES_XML    		SYS.XMLType,
    IS_DELETED        		NUMBER(1, 0)    NOT NULL,
    STATE_COLOUR      		NUMBER(10, 0),
    POS               		NUMBER(10, 0)   NOT NULL,
    IS_FINAL          		NUMBER(1)       NOT NULL,
    IS_EDITABLE_BY_OWNER 	NUMBER(1)     	NOT NULL,
    IND_SID           		NUMBER(10),
    MOVE_FROM_FLOW_STATE_ID	NUMBER(10, 0),
    FLOW_STATE_NATURE_ID	NUMBER(10, 0),
	TIME_SPENT_IND_SID		NUMBER(10, 0),
	SURVEY_EDITABLE          NUMBER(10, 0)    NOT NULL,
    CONSTRAINT CHK_FLOW_STATE_DELETED CHECK (IS_DELETED IN (0,1)),
    CONSTRAINT CK_IS_EDITABLE_BY_OWNER CHECK (IS_EDITABLE_BY_OWNER IN (0,1)),
    CONSTRAINT PK_FLOW_STATE PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_ID),
    CONSTRAINT CONS_FLOW_STATE  UNIQUE (CSRIMP_SESSION_ID, FLOW_STATE_ID, FLOW_SID),
    CONSTRAINT FK_FLOW_STATE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_GROUP(
	CSRIMP_SESSION_ID		NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	FLOW_STATE_GROUP_ID		NUMBER(10, 0)	NOT NULL,
	LOOKUP_KEY				VARCHAR2(256)	NOT NULL,
	LABEL					VARCHAR2(1024)	NOT NULL,
	COUNT_IND_SID			NUMBER(10, 0),
	CONSTRAINT PK_FLOW_STATE_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_GROUP_ID),
	CONSTRAINT FK_FLOW_STATE_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_GROUP_MEMBER(
	CSRIMP_SESSION_ID		NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	FLOW_STATE_GROUP_ID		NUMBER(10, 0)	NOT NULL,
	FLOW_STATE_ID			NUMBER(10, 0)	NOT NULL,
	BEFORE_REPORT_DATE		NUMBER(1, 0)	NOT NULL,
	AFTER_REPORT_DATE		NUMBER(1, 0)	NOT NULL,
	CONSTRAINT CK_BEFORE_REPORT_DATE CHECK (BEFORE_REPORT_DATE IN(0,1)),
	CONSTRAINT CK_AFTER_REPORT_DATE CHECK (AFTER_REPORT_DATE IN(0,1)),
	CONSTRAINT PK_FLOW_STATE_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_GROUP_ID, FLOW_STATE_ID),
	CONSTRAINT FK_FLOW_STATE_GROUP_MEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_SURVEY_TAG(
	CSRIMP_SESSION_ID		NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	FLOW_STATE_ID          NUMBER(10, 0)    NOT NULL,
	TAG_ID                 NUMBER(10, 0)    NOT NULL,
	CONSTRAINT PK_FLOW_STATE_SURVEY_TAG PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_ID, TAG_ID),
	CONSTRAINT FK_FLOW_STATE_SURVEY_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



CREATE TABLE CSRIMP.FLOW_STATE_LOG (
	CSRIMP_SESSION_ID	 NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_LOG_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_ITEM_ID         NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_ID        NUMBER(10, 0)    NOT NULL,
    SET_BY_USER_SID      NUMBER(10, 0)    NOT NULL,
    SET_DTM              DATE             NOT NULL,
    COMMENT_TEXT         CLOB,
    CONSTRAINT PK_FLOW_STATE_LOG PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_LOG_ID),
    CONSTRAINT UK_FLOW_STATE_LOG  UNIQUE (CSRIMP_SESSION_ID, FLOW_STATE_LOG_ID, FLOW_ITEM_ID),
    CONSTRAINT FK_FLOW_STATE_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_LOG_FILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_LOG_FILE_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_LOG_ID         NUMBER(10, 0)    NOT NULL,
    FILENAME                  VARCHAR2(255)    NOT NULL,
    MIME_TYPE                 VARCHAR2(256)    NOT NULL,
    DATA                      BLOB             NOT NULL,
    SHA1                      RAW(20)          NOT NULL,
    UPLOADED_DTM              DATE             NOT NULL,
    CONSTRAINT PK_FLOW_STATE_LOG_FILE PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_LOG_FILE_ID),
    CONSTRAINT FK_FLOW_ST_LOG_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_ID    NUMBER(10, 0)    NOT NULL,
    ROLE_SID         NUMBER(10, 0)    NULL,
    GROUP_SID        NUMBER(10, 0)    NULL,
    IS_EDITABLE      NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CHK_FLOW_STATE_ROLE_EDIT CHECK (IS_EDITABLE IN (0,1)),
    CONSTRAINT UC_FLOW_STATE_ROLE UNIQUE (CSRIMP_SESSION_ID, FLOW_STATE_ID, ROLE_SID, GROUP_SID),
    CONSTRAINT FK_FLOW_STATE_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_TRANS_HELPER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_SID     NUMBER(10, 0)    NOT NULL,
    HELPER_SP    VARCHAR2(255)    NOT NULL,
    LABEL        VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_FLOW_STATE_TRANS_HELPER PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_SID, HELPER_SP),
    CONSTRAINT FK_FLOW_ST_TRANS_HELP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_TRANSITION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    FROM_STATE_ID               NUMBER(10, 0)    NOT NULL,
    TO_STATE_ID                 NUMBER(10, 0)    NOT NULL,
    FLOW_SID                    NUMBER(10, 0)    NOT NULL,
    VERB                        VARCHAR2(255)    NOT NULL,
    ASK_FOR_COMMENT             VARCHAR2(16)     NOT NULL,
    POS                         NUMBER(10, 0)    NOT NULL,
    ATTRIBUTES_XML              SYS.XMLType,
    HELPER_SP                   VARCHAR2(255),
    LOOKUP_KEY                  VARCHAR2(255),
    MANDATORY_FIELDS_MESSAGE    VARCHAR2(255),
	HOURS_BEFORE_AUTO_TRAN		NUMBER(10, 0),
    BUTTON_ICON_PATH            VARCHAR2(255),
    OWNER_CAN_SET               NUMBER(1)        NOT NULL,
    GROUP_SID_CAN_SET           NUMBER(10, 0),
	AUTO_SCHEDULE_XML			SYS.XMLType,
	AUTO_TRANS_TYPE             NUMBER(10)       NOT NULL,
    LAST_RUN_DTM                DATE,
	ENFORCE_VALIDATION			NUMBER(1) NOT NULL,
    CHECK (ASK_FOR_COMMENT IN ('none','required','optional')),
    CONSTRAINT CK_OWNER_CAN_SET CHECK (OWNER_CAN_SET IN (0,1)),
	CONSTRAINT CK_ENFORCE_VALIDATION CHECK (ENFORCE_VALIDATION IN (0,1)),
    CONSTRAINT PK_FLOW_STATE_TRANSITION PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_TRANSITION_ID),
    CONSTRAINT UK_FLOW_STATE_TRANSITION  UNIQUE (CSRIMP_SESSION_ID, FROM_STATE_ID, TO_STATE_ID),
    CONSTRAINT UK_FLOW_STATE_TRANS_FROM  UNIQUE (CSRIMP_SESSION_ID, FLOW_STATE_TRANSITION_ID, FROM_STATE_ID),
    CONSTRAINT FK_FLOW_STATE_TRANS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_TRANSITION_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    FROM_STATE_ID               NUMBER(10, 0)    NOT NULL,
    ROLE_SID                    NUMBER(10, 0)    NULL,
    GROUP_SID                    NUMBER(10, 0)   NULL,
    CONSTRAINT UC_FLOW_STATE_TRANS_ROLE UNIQUE (CSRIMP_SESSION_ID, FLOW_STATE_TRANSITION_ID, FROM_STATE_ID, ROLE_SID, GROUP_SID),
    CONSTRAINT FK_FL_ST_TRANS_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.FLOW_ALERT_HELPER(
    CSRIMP_SESSION_ID    NUMBER(10, 0)     DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_ALERT_HELPER    VARCHAR2(256)     NOT NULL,
    LABEL                VARCHAR2(1024)    NOT NULL,
    CONSTRAINT PK_FLOW_ALERT_HELPER PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_ALERT_HELPER),
	CONSTRAINT FK_CUSTOMER_FLALHELPER FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION(CSRIMP_SESSION_ID) ON DELETE CASCADE
);


CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT (
	CSRIMP_SESSION_ID			NUMBER(10) 		 DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_TRANSITION_ALERT_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    CUSTOMER_ALERT_TYPE_ID      NUMBER(10, 0)    NOT NULL,
    DESCRIPTION					VARCHAR2(500),
    HELPER_SP					VARCHAR2(100),
    DELETED						NUMBER(1)		NOT NULL,
	TO_INITIATOR				NUMBER(1)		NOT NULL,
    FLOW_ALERT_HELPER           VARCHAR2(256),
    CAN_BE_EDITED_BEFORE_SENDING	NUMBER(1) NOT NULL,
    CONSTRAINT PK_FLOW_TRANSITION_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_TRANSITION_ALERT_ID),
    CONSTRAINT CK_FLOW_TRANS_ALERT_DELETED CHECK (DELETED IN (0,1)),
	CONSTRAINT CK_FLOW_TR_ALERT_TO_INITIATOR CHECK (to_initiator IN (0,1)),
    CONSTRAINT FK_FL_TRANS_ALERT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT_CMS_COL(
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_TRANSITION_ALERT_ID	NUMBER(10, 0)	NOT NULL,
	COLUMN_SID					NUMBER(10, 0)	NOT NULL,
	ALERT_MANAGER_FLAG			NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_FLOW_TRANS_ALERT_CMS_COL PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_TRANSITION_ALERT_ID, COLUMN_SID),
	CONSTRAINT FK_FLOW_CMS_COL FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_TRANSITION_ALERT_ID    NUMBER(10, 0)    NOT NULL,
    ROLE_SID                    NUMBER(10, 0)    NULL,
    GROUP_SID                   NUMBER(10, 0)    NULL,
    CONSTRAINT UC_FLOW_TRANSITION_ALERT_ROLE UNIQUE (CSRIMP_SESSION_ID, FLOW_TRANSITION_ALERT_ID, ROLE_SID, GROUP_SID),
    CONSTRAINT FK_FL_TRANS_ALERT_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT_USER(
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_TRANSITION_ALERT_ID	NUMBER(10, 0)	NOT NULL,
	USER_SID					NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_FLOW_TRANS_ALERT_USER PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_TRANSITION_ALERT_ID, USER_SID),
	CONSTRAINT FK_FLOW_CSR_USER FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT_CC_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_TRANSITION_ALERT_ID    NUMBER(10, 0)    NOT NULL,
    ROLE_SID                    NUMBER(10, 0)    NULL,
    GROUP_SID                   NUMBER(10, 0)    NULL,
    CONSTRAINT UC_FLOW_TRANS_ALERT_CC_ROLE UNIQUE (CSRIMP_SESSION_ID, FLOW_TRANSITION_ALERT_ID, ROLE_SID, GROUP_SID),
    CONSTRAINT FK_FL_TRANS_ALERT_CC_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT_CC_USER(
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_TRANSITION_ALERT_ID	NUMBER(10, 0)	NOT NULL,
	USER_SID					NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_FLOW_TRANS_ALERT_CC_USER PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_TRANSITION_ALERT_ID, USER_SID),
	CONSTRAINT FK_FLOW_Cc_CSR_USER FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_CMS_COL(
    CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_ID    NUMBER(10, 0)    NOT NULL,
    COLUMN_SID       NUMBER(10, 0)    NOT NULL,
    IS_EDITABLE      NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CHK_FLOW_STATE_CMS_COL_EDIT CHECK (IS_EDITABLE IN (0,1)),
    CONSTRAINT PK_FLOW_STATE_CMS_COL PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_ID, COLUMN_SID),
    CONSTRAINT FK_FLOW_STATE_CMS_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.FLOW_STATE_TRANSITION_CMS_COL(
    CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    FROM_STATE_ID               NUMBER(10, 0)    NOT NULL,
    COLUMN_SID                  NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FLOW_STATE_TRANS_COL PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_TRANSITION_ID, FROM_STATE_ID, COLUMN_SID),
    CONSTRAINT FK_FLOW_STATE_TRANS_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.FLOW_STATE_INVOLVEMENT (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_STATE_ID				NUMBER(10) NOT NULL,
	FLOW_INVOLVEMENT_TYPE_ID	NUMBER(10) NOT NULL,
	CONSTRAINT PK_FLOW_STATE_INVOLVEMENT PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_ID, FLOW_INVOLVEMENT_TYPE_ID),
    CONSTRAINT FK_FLOW_STATE_INVOLVEMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_ROLE_CAPABILITY (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_STATE_RL_CAP_ID		NUMBER(10) NOT NULL,
	FLOW_STATE_ID				NUMBER(10) NOT NULL,
	FLOW_CAPABILITY_ID			NUMBER(10) NOT NULL,
	ROLE_SID					NUMBER(10),
	GROUP_SID					NUMBER(10),
	FLOW_INVOLVEMENT_TYPE_ID	NUMBER(10),
	PERMISSION_SET				NUMBER(10) NOT NULL,
	CONSTRAINT PK_FLOW_STATE_ROLE_CAPABILITY PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_RL_CAP_ID),
	CONSTRAINT UK_FLOW_STATE_ROLE_CAPABILITY UNIQUE (CSRIMP_SESSION_ID, FLOW_STATE_ID, FLOW_CAPABILITY_ID, ROLE_SID, GROUP_SID, FLOW_INVOLVEMENT_TYPE_ID),
	CONSTRAINT CHK_FLOW_STATE_ROLE_CAPABILITY CHECK ((ROLE_SID IS NULL AND GROUP_SID IS NOT NULL AND FLOW_INVOLVEMENT_TYPE_ID IS NULL) OR
		(ROLE_SID IS NOT NULL AND GROUP_SID IS NULL AND FLOW_INVOLVEMENT_TYPE_ID IS NULL) OR
		(ROLE_SID IS NULL AND GROUP_SID IS NULL AND FLOW_INVOLVEMENT_TYPE_ID IS NOT NULL)),
    CONSTRAINT FK_FLOW_STATE_ROLE_CAPBLTY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT_INV (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_TRANSITION_ALERT_ID	NUMBER(10) NOT NULL,
	FLOW_INVOLVEMENT_TYPE_ID	NUMBER(10) NOT NULL,
	CONSTRAINT PK_FLOW_TRANSITION_ALERT_INV PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_TRANSITION_ALERT_ID, FLOW_INVOLVEMENT_TYPE_ID),
    CONSTRAINT FK_FLOW_TRANSITION_ALRT_INV_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_TRANSITION_INV (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_STATE_TRANSITION_ID	NUMBER(10) NOT NULL,
	FROM_STATE_ID				NUMBER(10) NOT NULL,
	FLOW_INVOLVEMENT_TYPE_ID	NUMBER(10) NOT NULL,
	CONSTRAINT PK_FLOW_STATE_TRANSITION_INV PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_TRANSITION_ID, FLOW_INVOLVEMENT_TYPE_ID),
    CONSTRAINT FK_FS_TRANSITION_INV_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_AGGREGATE_TYPE (
    CSRIMP_SESSION_ID			    NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CMS_AGGREGATE_TYPE_ID           NUMBER(10)      NOT NULL,
    TAB_SID                         NUMBER(10)      NOT NULL,
    FIRST_ARG_COLUMN_SID            NUMBER(10)      NOT NULL,
	SECOND_ARG_COLUMN_SID           NUMBER(10),
    DESCRIPTION                     VARCHAR2(255)   NOT NULL,
    ANALYTIC_FUNCTION               NUMBER(10)      NOT NULL,
	OPERATION                       CHAR(1),
	SCORE_TYPE_ID                   NUMBER(10),
	FORMAT_MASK				        VARCHAR2(50),
    NORMALIZE_BY_AGGREGATE_TYPE_ID  NUMBER(10),
    CONSTRAINT PK_CMS_AGGREGATE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, CMS_AGGREGATE_TYPE_ID),
	CONSTRAINT CHK_AGG_TYPE_2ND_COL_NUL CHECK ((OPERATION IS NULL AND SECOND_ARG_COLUMN_SID IS NULL) OR (OPERATION IS NOT NULL AND SECOND_ARG_COLUMN_SID IS NOT NULL)),
	CONSTRAINT CHK_AGG_TYPE_OPERATION CHECK (OPERATION IN ('+','-','/','*')),
    CONSTRAINT FK_CMS_AGGREGATE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_APP_SCHEMA  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ORACLE_SCHEMA VARCHAR2(30) NOT NULL,
    CONSTRAINT PK_APP_SCHEMA PRIMARY KEY (CSRIMP_SESSION_ID, ORACLE_SCHEMA),
    CONSTRAINT FK_CMS_APP_SCHEMA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_APP_SCHEMA_TABLE  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ORACLE_SCHEMA VARCHAR2(30) NOT NULL,
    ORACLE_TABLE VARCHAR2(30) NOT NULL,
    CONSTRAINT PK_APP_SCHEMA_TABLE PRIMARY KEY (CSRIMP_SESSION_ID, ORACLE_SCHEMA, ORACLE_TABLE),
    CONSTRAINT FK_CMS_APP_SCHEMA_TABLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

/*
XXX: no app_sid -- but needed for cms editor

CREATE TABLE CSRIMP.CMS_CONTEXT  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CONTEXT_ID NUMBER(10) NOT NULL,
    PARENT_CONTEXT_ID NUMBER(10),
    CONSTRAINT FK_CMS_CONTEXT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FAST_CONTEXT  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CONTEXT_ID NUMBER(10) NOT NULL,
    PARENT_CONTEXT_ID NUMBER(10) NOT NULL,
    CONSTRAINT PK_FAST_CONTEXT PRIMARY KEY (CSRIMP_SESSION_ID, CONTEXT_ID, PARENT_CONTEXT_ID),
    CONSTRAINT FK_CMS_FAST_CONTEXT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);
*/

CREATE TABLE CSRIMP.CMS_IMAGE  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMAGE_ID NUMBER(10) NOT NULL,
    MIME_TYPE VARCHAR2(100) NOT NULL,
    SHA1 RAW(20) NOT NULL,
    FILENAME VARCHAR2(200) NOT NULL,
    DESCRIPTION VARCHAR2(1000),
    DATA BLOB NOT NULL,
    MODIFIED_DTM TIMESTAMP,
    WIDTH NUMBER(10),
    HEIGHT NUMBER(10),
    RECYCLED NUMBER(1) NOT NULL,
    CONSTRAINT PK_IMAGE PRIMARY KEY (CSRIMP_SESSION_ID, IMAGE_ID),
    CHECK (RECYCLED IN (0,1)),
    CONSTRAINT FK_CMS_IMAGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


/*
XXX: no app sid -- but needed for cms editor

CREATE TABLE CSRIMP.CMS_SECURABLE_OBJECT_WHITELIST  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID NUMBER(10) NOT NULL,
    CONSTRAINT PK_SECURABLE_OBJECT_WHITELIST PRIMARY KEY (CSRIMP_SESSION_ID, SID_ID),
    CONSTRAINT FK_CMS_CK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);
*/

CREATE TABLE CSRIMP.CMS_CK_CONS  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CK_CONS_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    SEARCH_CONDITION CLOB,
	CONSTRAINT_OWNER VARCHAR2(30) NOT NULL,
	CONSTRAINT_NAME VARCHAR2(30) NOT NULL,
    CONSTRAINT PK_CK_CONS PRIMARY KEY (CSRIMP_SESSION_ID, CK_CONS_ID),
    CONSTRAINT FK_CMS_CK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_CK_CONS_COL  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CK_CONS_ID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    CONSTRAINT PK_CK_CONS_COL PRIMARY KEY (CSRIMP_SESSION_ID, CK_CONS_ID, COLUMN_SID),
    CONSTRAINT FK_CMS_CK_CONS_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_DISPLAY_TEMPLATE  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DISPLAY_TEMPLATE_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10),
    TEMPLATE_URL VARCHAR2(500) NOT NULL,
    PRIORITY NUMBER(10) NOT NULL,
    NAME VARCHAR2(1000) NOT NULL,
    DESCRIPTION VARCHAR2(2000),
    CONSTRAINT PK_DISPLAY_TEMPLATE PRIMARY KEY (CSRIMP_SESSION_ID, DISPLAY_TEMPLATE_ID),
    CONSTRAINT FK_CMS_DISPLAY_TPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_ENUM_GROUP_TAB (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAB_SID							NUMBER(10) NOT NULL,
	LABEL							VARCHAR2(255) NOT NULL,
	REPLACE_EXISTING_FILTERS		NUMBER(1) NOT NULL,
	CONSTRAINT PK_ENUM_GROUP_TAB PRIMARY KEY (CSRIMP_SESSION_ID, TAB_SID),
	CONSTRAINT CHK_ENUM_G_TAB_REP_FILTER_1_0 CHECK (REPLACE_EXISTING_FILTERS IN (1,0)),
	CONSTRAINT FK_CMS_ENUM_GROUP_TAB_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_ENUM_GROUP (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAB_SID							NUMBER(10) NOT NULL,
	ENUM_GROUP_ID					NUMBER(10) NOT NULL,
	GROUP_LABEL						VARCHAR2(255),
	CONSTRAINT PK_ENUM_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, ENUM_GROUP_ID),
	CONSTRAINT FK_CMS_ENUM_GROUP_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_ENUM_GROUP_MEMBER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ENUM_GROUP_ID					NUMBER(10) NOT NULL,
	ENUM_GROUP_MEMBER_ID	 		NUMBER(10) NOT NULL,
	CONSTRAINT PK_ENUM_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, ENUM_GROUP_ID, ENUM_GROUP_MEMBER_ID),
	CONSTRAINT FK_CMS_ENUM_GROUP_MEMBER_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FILTER  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FILTER_SID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    NAME VARCHAR2(500) NOT NULL,
    CREATED_BY_USER_SID NUMBER(10),
    FILTER_XML XMLTYPE NOT NULL,
    PARENT_SID NUMBER(10) NOT NULL,
    CONSTRAINT PK_FILTER PRIMARY KEY (CSRIMP_SESSION_ID, FILTER_SID),
    CONSTRAINT FK_CMS_FILTER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FK_CONS  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FK_CONS_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    R_CONS_ID NUMBER(10) NOT NULL,
    DELETE_RULE VARCHAR2(1) NOT NULL,
	CONSTRAINT_OWNER VARCHAR2(30) NOT NULL,
	CONSTRAINT_NAME VARCHAR2(30) NOT NULL,
    CONSTRAINT PK_FK_CONS PRIMARY KEY (CSRIMP_SESSION_ID, FK_CONS_ID),
    CHECK (delete_rule in ('R','C','N')),
    CONSTRAINT FK_CMS_FK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FK_CONS_COL  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FK_CONS_ID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    POS NUMBER(10) NOT NULL,
    CONSTRAINT PK_FK_CONS_COL PRIMARY KEY (CSRIMP_SESSION_ID, FK_CONS_ID, COLUMN_SID),
    CONSTRAINT FK_CMS_FK_CONS_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FORM  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FORM_SID 						NUMBER(10) NOT NULL,
	DESCRIPTION 					VARCHAR2(2000) NOT NULL,
	PARENT_TAB_SID 					NUMBER(10),
	LOOKUP_KEY 						VARCHAR2(255),
	CURRENT_VERSION 				NUMBER(10),
	IS_REPORT_BUILDER 				NUMBER(1) NOT NULL,
	SHORT_PATH 						VARCHAR2(255),
	USE_QUICK_CHART 				NUMBER(1) NOT NULL,
	DRAFT_FORM_XML					XMLTYPE,
	DRAFT_FILE_NAME					VARCHAR2(255),
	CONSTRAINT PK_CMS_FORM PRIMARY KEY (CSRIMP_SESSION_ID, FORM_SID),
	CONSTRAINT CK_CMS_FORM_USE_QUICK_CHART CHECK (USE_QUICK_CHART IN (0,1)),
	CONSTRAINT CK_FORM_IS_REPORT_BUILDER_1_0 CHECK (IS_REPORT_BUILDER IN (0,1)),
	CONSTRAINT FK_CMS_FORM_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE UNIQUE INDEX CSRIMP.UK_CMS_FORM_LKUP_KEY ON CSRIMP.CMS_FORM(CSRIMP_SESSION_ID,NVL(UPPER(LOOKUP_KEY),TO_CHAR(FORM_SID)));
CREATE UNIQUE INDEX CSRIMP.IDX_FORM_SHORT_PATH ON CSRIMP.CMS_FORM(CSRIMP_SESSION_ID,NVL(LOWER(SHORT_PATH),TO_CHAR(FORM_SID)));

CREATE TABLE CSRIMP.CMS_FORM_VERSION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FORM_SID						NUMBER(10) NOT NULL,
	FORM_VERSION					NUMBER(10) NOT NULL,
	FILE_NAME						VARCHAR2(255) NOT NULL,
	FORM_XML						XMLTYPE NOT NULL,
	PUBLISHED_DTM					DATE NOT NULL,
	PUBLISHED_BY_SID				NUMBER(10) NOT NULL,
	VERSION_COMMENT					VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_FORM_VERSION PRIMARY KEY (CSRIMP_SESSION_ID, FORM_SID, FORM_VERSION),
	CONSTRAINT FK_CMS_FORM_VERSION_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_DATA_HELPER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LOOKUP_KEY 						VARCHAR2(255) NOT NULL,
    HELPER_PROCEDURE 				VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_DATA_HELPER PRIMARY KEY (CSRIMP_SESSION_ID, LOOKUP_KEY),
	CONSTRAINT FK_CMS_DATA_HELPER_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_DOC_TEMPLATE (
	CSRIMP_SESSION_ID		NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DOC_TEMPLATE_ID			NUMBER(10)		NOT NULL,
	NAME					VARCHAR2(128)	NOT NULL,
	LOOKUP_KEY				VARCHAR2(128)	NOT NULL,
	LANG					VARCHAR2(10),
	CONSTRAINT PK_CMS_DOC_TEMPLATE PRIMARY KEY (CSRIMP_SESSION_ID, DOC_TEMPLATE_ID),
	CONSTRAINT UK_CMS_DOC_TEMPLATE UNIQUE (CSRIMP_SESSION_ID, LOOKUP_KEY, LANG),
	CONSTRAINT FK_CMS_DOC_TEMPLATE FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_DOC_TEMPLATE_FILE (
	CSRIMP_SESSION_ID		NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DOC_TEMPLATE_FILE_ID	NUMBER(10)	NOT NULL,
	FILE_NAME				VARCHAR2(256),
	FILE_MIME				VARCHAR2(256),
	FILE_DATA				BLOB,
	UPLOADED_DTM			DATE		NOT NULL,
	CONSTRAINT PK_CMS_DOC_TEMPLATE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, DOC_TEMPLATE_FILE_ID),
	CONSTRAINT FK_CMS_DOC_TEMPLATE_FILE FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_DOC_TEMPLATE_VERSION (
	CSRIMP_SESSION_ID		NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DOC_TEMPLATE_ID			NUMBER(10)	NOT NULL,
	VERSION					NUMBER(10)	NOT NULL,
	COMMENTS				CLOB		NOT NULL,
	DOC_TEMPLATE_FILE_ID	NUMBER(10)	NOT NULL,
	LOG_DTM					DATE		NOT NULL,
	USER_SID				NUMBER(10)	NOT NULL,
	PUBLISHED_DTM			DATE,
	ACTIVE					NUMBER(1)	NOT NULL,
	CONSTRAINT PK_CMS_DOC_TEMPLATE_VERS PRIMARY KEY (CSRIMP_SESSION_ID, DOC_TEMPLATE_ID, VERSION),
	CONSTRAINT FK_CMS_DOC_TEMPLATE_VERSION FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_IMAGE_TAG  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PARENT_TAG_ID NUMBER(10) NOT NULL,
    IMAGE_ID NUMBER(10) NOT NULL,
    CONSTRAINT PK_IMAGE_TAG PRIMARY KEY (CSRIMP_SESSION_ID, PARENT_TAG_ID, IMAGE_ID),
    CONSTRAINT FK_CMS_IMAGE_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_LINK_TRACK  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ITEM_ID NUMBER(10) NOT NULL,
    CONTEXT_ID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10),
    PATH VARCHAR2(1000) NOT NULL,
    QUERY_STRING VARCHAR2(2000),
    CONSTRAINT FK_CMS_LINK_TRACK_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    ORACLE_SCHEMA VARCHAR2(30) NOT NULL,
    ORACLE_TABLE VARCHAR2(30) NOT NULL,
    DESCRIPTION VARCHAR2(2000),
    FORMAT_SQL VARCHAR2(500),
    PK_CONS_ID NUMBER(10),
    MANAGED NUMBER(1) NOT NULL,
    AUTO_REGISTERED NUMBER(1) NOT NULL,
    CMS_EDITOR NUMBER(10) NOT NULL,
    ISSUES NUMBER(1) NOT NULL,
    FLOW_SID NUMBER(10),
	POLICY_FUNCTION VARCHAR2(100),
	POLICY_VIEW VARCHAR2(1024),
	IS_VIEW NUMBER(1) NOT NULL,
	HELPER_PKG VARCHAR2(255),
	SHOW_IN_COMPANY_FILTER NUMBER(1) NOT NULL,
	PARENT_TAB_SID NUMBER(10) NULL,
	SHOW_IN_PROPERTY_FILTER NUMBER(1) NOT NULL,
	SECURABLE_FK_CONS_ID		NUMBER(10),
	IS_BASEDATA NUMBER(1) NOT NULL,
	ENUM_TRANSLATION_TAB_SID NUMBER(10),
	SHOW_IN_PRODUCT_FILTER NUMBER(1) NOT NULL,
	STORAGE_LOCATION	VARCHAR2(255) NOT NULL,
	managed_version		NUMBER(10),
    CONSTRAINT PK_CMS_TAB PRIMARY KEY (CSRIMP_SESSION_ID, TAB_SID),
	CONSTRAINT chk_mngd_version CHECK (managed = 1 AND managed_version IS NOT NULL OR managed = 0),
    CHECK (CMS_EDITOR IN (0,1)),
    CHECK (managed in (0,1)),
    CHECK (auto_registered in (0,1)),
    CHECK (ISSUES IN (0,1)),
    CHECK (IS_VIEW IN (0,1)),
	CONSTRAINT chk_tab_show_in_prop_filter CHECK (show_in_property_filter IN (0,1)),
	CONSTRAINT CK_TAB_IS_BASEDATA_1_0 CHECK (is_basedata IN (0,1)),
    CONSTRAINT FK_CMS_TAB_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_COLUMN  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10),
    ORACLE_COLUMN VARCHAR2(30) NOT NULL,
    DESCRIPTION VARCHAR2(2000),
    POS NUMBER(10) NOT NULL,
    COL_TYPE NUMBER(10) NOT NULL,
    MASTER_COLUMN_SID NUMBER(10),
    ENUMERATED_DESC_FIELD VARCHAR2(30),
    ENUMERATED_POS_FIELD VARCHAR2(30),
    ENUMERATED_COLPOS_FIELD VARCHAR2(30),
    ENUMERATED_HIDDEN_FIELD VARCHAR2(30),
	ENUMERATED_COLOUR_FIELD			VARCHAR2(30),
	ENUMERATED_EXTRA_FIELDS			VARCHAR2(4000),
    HELP CLOB,
    CHECK_MSG VARCHAR2(2000),
    CALC_XML XMLTYPE,
    DATA_TYPE VARCHAR2(106),
    DATA_LENGTH NUMBER,
    DATA_PRECISION NUMBER,
    DATA_SCALE NUMBER,
    NULLABLE VARCHAR2(1),
    CHAR_LENGTH NUMBER,
    VALUE_PLACEHOLDER NUMBER(1) CONSTRAINT NN_TAB_COLUMN_VAL_PLACEHOLDER NOT NULL,
    HELPER_PKG VARCHAR2(255),
    TREE_DESC_FIELD VARCHAR2(30),
    TREE_ID_FIELD VARCHAR2(30),
    TREE_PARENT_ID_FIELD VARCHAR2(30),
    FULL_TEXT_INDEX_NAME	VARCHAR2(255),
	INCL_IN_ACTIVE_USER_FILTER NUMBER(1) CONSTRAINT NN_TAB_COLUMN_INCL_USR_FLTR NOT NULL,
	OWNER_PERMISSION                      NUMBER(1) NULL,
	COVERABLE NUMBER(1) CONSTRAINT NN_TAB_COLUMN_COVERABLE NOT NULL,
	DEFAULT_LENGTH NUMBER(10),
	DATA_DEFAULT VARCHAR2(255),
	MEASURE_SID                           NUMBER(10),
	MEASURE_CONV_COLUMN_SID               NUMBER(10),
	MEASURE_CONV_DATE_COLUMN_SID          NUMBER(10),
	AUTO_SEQUENCE                         VARCHAR2(65),
	SHOW_IN_FILTER					NUMBER(1) NOT NULL,
	SHOW_IN_BREAKDOWN				NUMBER(1) NOT NULL,
	INCLUDE_IN_SEARCH				NUMBER(1) NOT NULL,
	FORM_SELECTION_DESC_FIELD 		VARCHAR2(30),
	FORM_SELECTION_POS_FIELD 		VARCHAR2(30),
	FORM_SELECTION_FORM_FIELD 		VARCHAR2(30),
	FORM_SELECTION_HIDDEN_FIELD		VARCHAR2(30),
	RESTRICTED_BY_POLICY			NUMBER(1) NOT NULL,
	FORMAT_MASK						VARCHAR2(200),
    CONSTRAINT PK_TAB_COLUMN PRIMARY KEY (CSRIMP_SESSION_ID, COLUMN_SID),
    CONSTRAINT CC_TAB_COLUMN_VAL_PLACEHOLDER CHECK (VALUE_PLACEHOLDER IN(0,1)),
    CONSTRAINT CK_TAB_COL_CALC_XML CHECK ((calc_xml is null and col_type != 25) or (calc_xml is not null and col_type = 25)),
	CONSTRAINT CK_TAB_COL_USR_FILTER CHECK (INCL_IN_ACTIVE_USER_FILTER IN (1, 0)),
	CONSTRAINT CK_TAB_COL_COVERABLE CHECK (COVERABLE IN (1, 0)),
	CONSTRAINT CHK_SHOW_IN_FILTER_1_0 CHECK (SHOW_IN_FILTER IN (1, 0)),
	CONSTRAINT CHK_SHOW_IN_BREAKDOWN_1_0 CHECK (SHOW_IN_BREAKDOWN IN (1, 0)),
	CONSTRAINT CHK_INCLUDE_IN_SEARCH_1_0 CHECK (INCLUDE_IN_SEARCH IN (1, 0)),
	CONSTRAINT CHK_RESTRICTED_BY_POLICY_1_0 CHECK (RESTRICTED_BY_POLICY IN (1, 0)),
    CONSTRAINT FK_CMS_TAB_COLUMN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_COLUMN_LINK (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_COLUMN_LINK_ID NUMBER(10) NOT NULL,
    COLUMN_SID_1 NUMBER(10) NOT NULL,
    ITEM_ID_1 NUMBER(10) NOT NULL,
    COLUMN_SID_2 NUMBER(10) NOT NULL,
    ITEM_ID_2 NUMBER(10) NOT NULL,
    CONSTRAINT PK_TAB_COLUMN_LINK PRIMARY KEY (CSRIMP_SESSION_ID, TAB_COLUMN_LINK_ID),
    CONSTRAINT UK_TAB_COLUMN_LINK UNIQUE (CSRIMP_SESSION_ID, COLUMN_SID_1, ITEM_ID_1, COLUMN_SID_2, ITEM_ID_2),
	CONSTRAINT FK_CMS_TAB_COLUMN_LINK_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_COLUMN_LINK_TYPE (
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    LINK_COLUMN_SID NUMBER(10) NOT NULL,
    LABEL VARCHAR2(255) NOT NULL,
    BASE_LINK_URL VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_TAB_COLUMN_LINK_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, COLUMN_SID, LINK_COLUMN_SID),
	CONSTRAINT FK_CMS_TAB_COLUMN_LINK_TYP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_COLUMN_MEASURE  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    MEASURE_SID NUMBER(10) NOT NULL,
    CONSTRAINT PK_TAB_COLUMN_MEASURE PRIMARY KEY (CSRIMP_SESSION_ID, COLUMN_SID, MEASURE_SID),
    CONSTRAINT FK_CMS_TAB_COL_MEAS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAG  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID NUMBER(10) NOT NULL,
    TAG VARCHAR2(300) NOT NULL,
    PARENT_TAG_ID NUMBER(10),
    CONSTRAINT PK_CMS_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TAG_ID),
    CONSTRAINT FK_CMS_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_UK_CONS  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UK_CONS_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
	CONSTRAINT_OWNER VARCHAR2(30) NOT NULL,
	CONSTRAINT_NAME VARCHAR2(30) NOT NULL,
    CONSTRAINT PK_UK_CONS PRIMARY KEY (CSRIMP_SESSION_ID, UK_CONS_ID),
    CONSTRAINT FK_CMS_UK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_UK_CONS_COL  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UK_CONS_ID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    POS NUMBER(10) NOT NULL,
    CONSTRAINT PK_UK_CONS_COL PRIMARY KEY (CSRIMP_SESSION_ID, UK_CONS_ID, COLUMN_SID),
    CONSTRAINT FK_CMS_UK_CONS_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_WEB_PUBLICATION  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    WEB_PUBLICATION_ID NUMBER(10) NOT NULL,
    DISPLAY_TEMPLATE_ID NUMBER(10) NOT NULL,
    ITEM_ID NUMBER(10) NOT NULL,
    CONSTRAINT PK_WEB_PUBLICATION PRIMARY KEY (CSRIMP_SESSION_ID, WEB_PUBLICATION_ID),
    CONSTRAINT FK_CMS_WEB_PUBL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_COLUMN_ROLE_PERMISSION  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    ROLE_SID NUMBER(10) NOT NULL,
    PERMISSION NUMBER(1) NOT NULL,
    POLICY_FUNCTION VARCHAR2(100),
    CONSTRAINT PK_TAB_COLUMN_ROLE_PERMISSION PRIMARY KEY (CSRIMP_SESSION_ID, COLUMN_SID, ROLE_SID),
    CONSTRAINT FK_CMS_TAB_COL_ROL_PERM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FLOW_TAB_COLUMN_CONS  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    FLOW_STATE_ID NUMBER NOT NULL,
    NULLABLE NUMBER(1) NOT NULL,
    CONSTRAINT PK_FLOW_TAB_COLUMN_CONS PRIMARY KEY (CSRIMP_SESSION_ID, COLUMN_SID, FLOW_STATE_ID),
    CHECK (NULLABLE IN (0, 1)),
    CONSTRAINT FK_CMS_FLOW_TAB_COL_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ALL_METER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REGION_SID						NUMBER(10, 0)     NOT NULL,
	METER_TYPE_ID					NUMBER(10)        NOT NULL,
	NOTE							VARCHAR2(4000),
	METER_SOURCE_TYPE_ID			NUMBER(10, 0)     NOT NULL,
	REFERENCE						VARCHAR2(256),
	CRC_METER						NUMBER(1, 0)      NOT NULL,
	ACTIVE							NUMBER(1, 0)      NOT NULL,
	EXPORT_LIVE_DATA_AFTER_DTM		DATE,
	DAYS_MEASURE_CONVERSION_ID		NUMBER(10, 0),
	COSTDAYS_MEASURE_CONVERSION_ID	NUMBER(10, 0),
	APPROVED_BY_SID					NUMBER(10, 0),
	APPROVED_DTM					DATE,
	IS_CORE							NUMBER(1, 0)      NOT NULL,
	URJANET_METER_ID 				VARCHAR2(256),
	METERING_VERSION				NUMBER(10, 0),
	LOWER_THRESHOLD_PERCENTAGE		NUMBER(10, 2),
	UPPER_THRESHOLD_PERCENTAGE		NUMBER(10, 2),
	MANUAL_DATA_ENTRY				NUMBER(1) NOT NULL,
	CONSTRAINT CHK_MANUAL_DATA_ENTRY_1_0 CHECK (MANUAL_DATA_ENTRY IN (1,0)),
	CHECK (CRC_METER IN (0,1)),
	CHECK (ACTIVE IN (0, 1)),
	CONSTRAINT CK_ALL_METER_IS_CORE CHECK (IS_CORE IN (0,1)),
	CONSTRAINT PK_ALL_METER PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID),
	CONSTRAINT FK_ALL_METER_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.LINKED_METER(
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID          NUMBER(10, 0)    NOT NULL,
    LINKED_METER_SID    NUMBER(10, 0)    NOT NULL,
    POS                 NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_LINKED_METER PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, LINKED_METER_SID),
    CONSTRAINT FK_LINKED_METER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.EVENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    EVENT_ID                 NUMBER(10, 0)     NOT NULL,
    LABEL                    VARCHAR2(4000)    NOT NULL,
    RAISED_BY_USER_SID       NUMBER(10, 0)     NOT NULL,
    RAISED_DTM               DATE              NOT NULL,
    EVENT_TEXT               CLOB              NOT NULL,
    RAISED_FOR_REGION_SID    NUMBER(10, 0)     NOT NULL,
    EVENT_DTM                DATE              NOT NULL,
    CONSTRAINT PK_EVENT PRIMARY KEY (CSRIMP_SESSION_ID, EVENT_ID),
    CONSTRAINT FK_EVENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_BUCKET (
	CSRIMP_SESSION_ID	 	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_BUCKET_ID      	NUMBER(10, 0)    NOT NULL,
    DURATION            	NUMBER(10, 0),
    DESCRIPTION          	VARCHAR2(256)    NOT NULL,
    IS_MINUTES           	NUMBER(1, 0)     NOT NULL,
    IS_HOURS             	NUMBER(1, 0)     NOT NULL,
    IS_WEEKS             	NUMBER(1, 0)     NOT NULL,
    IS_MONTHS            	NUMBER(1, 0)     NOT NULL,
    WEEK_START_DAY      	NUMBER(10, 0),
    START_MONTH          	NUMBER(10, 0),
    PERIOD_SET_ID			NUMBER(10, 0),
	PERIOD_INTERVAL_ID		NUMBER(10, 0),
	IS_EXPORT_PERIOD     	NUMBER(1, 0)     NOT NULL,
    HIGH_RESOLUTION_ONLY    NUMBER(1, 0)     NOT NULL,
    CORE_WORKING_HOURS      NUMBER(1, 0)     NOT NULL,
	CHECK (IS_HOURS = 0 OR (IS_HOURS  = 1 AND IS_MINUTES = 0 AND IS_WEEKS = 0 AND IS_MONTHS = 0 AND PERIOD_SET_ID IS NULL AND PERIOD_INTERVAL_ID IS NULL)),
    CHECK (IS_WEEKS = 0 OR (IS_WEEKS = 1 AND IS_MINUTES = 0 AND IS_HOURS = 0 AND IS_MONTHS = 0 AND PERIOD_SET_ID IS NULL AND PERIOD_INTERVAL_ID IS NULL)),
    CHECK (IS_MINUTES = 0 OR (IS_MINUTES  = 1 AND IS_HOURS = 0 AND IS_WEEKS = 0 AND IS_MONTHS = 0 AND PERIOD_SET_ID IS NULL AND PERIOD_INTERVAL_ID IS NULL)),
    CHECK (IS_MONTHS = 0 OR (IS_MONTHS = 1 AND IS_MINUTES = 0 AND IS_HOURS = 0 AND IS_WEEKS = 0  AND PERIOD_SET_ID IS NULL AND PERIOD_INTERVAL_ID IS NULL)),
    CHECK (WEEK_START_DAY IS NULL OR IS_WEEKS = 1),
    CHECK (START_MONTH IS NULL OR IS_MONTHS = 1),
    CHECK (IS_EXPORT_PERIOD IN (0,1)),
    CHECK (HIGH_RESOLUTION_ONLY IN (0,1)),
    CHECK ((PERIOD_SET_ID IS NULL AND PERIOD_INTERVAL_ID IS NULL) OR (PERIOD_SET_ID IS NOT NULL AND PERIOD_INTERVAL_ID IS NOT NULL AND IS_MONTHS = 0 AND IS_MINUTES = 0 AND IS_HOURS = 0 AND IS_WEEKS = 0)),
    CHECK (CORE_WORKING_HOURS IN (0,1)),
    CONSTRAINT PK_METER_BUCKET PRIMARY KEY (CSRIMP_SESSION_ID, METER_BUCKET_ID),
    CONSTRAINT FK_METER_BUCKET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DUFF_METER_REGION (
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	URJANET_METER_ID				VARCHAR2(256)	NOT NULL,
	METER_NAME						VARCHAR2(1024)	NOT NULL,
	METER_NUMBER					VARCHAR2(256),
	REGION_REF						VARCHAR2(256),
	SERVICE_TYPE					VARCHAR2(256)	NOT NULL,
	AUTOMATED_IMPORT_INSTANCE_ID	NUMBER(10)		NOT NULL,
	AUTOMATED_IMPORT_CLASS_SID		NUMBER(10)		NOT NULL,
	METER_RAW_DATA_ID				NUMBER(10),
	METER_RAW_DATA_ERROR_ID			NUMBER(10),
	REGION_SID						NUMBER(10),
	ISSUE_ID						NUMBER(10),
	MESSAGE							VARCHAR2(4000),
	ERROR_TYPE_ID					NUMBER(10) 		NOT NULL,
	CREATED_DTM						DATE			NOT NULL,
	UPDATED_DTM						DATE			NOT NULL,
	CONSTRAINT PK_DUFF_METER_REGION PRIMARY KEY (CSRIMP_SESSION_ID, URJANET_METER_ID),
	CONSTRAINT FK_DUFF_METER_REGION_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FIRST_PRIORITY_SET_DTM        DATE,
    ISSUE_ID                      NUMBER(10, 0)     NOT NULL,
    LABEL                         VARCHAR2(2048),
    LAST_LABEL                    VARCHAR2(2048),
    DESCRIPTION                   CLOB,
    LAST_DESCRIPTION              CLOB,
    SOURCE_LABEL                  VARCHAR2(2000),
    CORRESPONDENT_ID              NUMBER(10, 0),
    CORRESPONDENT_NOTIFIED        NUMBER(1, 0)      NOT NULL,
    RAISED_BY_USER_SID            NUMBER(10, 0)     NOT NULL,
    RAISED_DTM                    DATE              NOT NULL,
    OWNER_USER_SID                NUMBER(10, 0),
    OWNER_ROLE_SID                NUMBER(10, 0),
    RESOLVED_BY_USER_SID          NUMBER(10, 0),
    RESOLVED_DTM                  DATE,
    CLOSED_BY_USER_SID            NUMBER(10, 0),
    CLOSED_DTM                    DATE,
    ASSIGNED_TO_USER_SID          NUMBER(10, 0),
    ASSIGNED_TO_ROLE_SID          NUMBER(10, 0),
    REGION_SID                    NUMBER(10, 0),
    REJECTED_DTM                  DATE,
    REJECTED_BY_USER_SID          NUMBER(10, 0),
    DUE_DTM                       DATE,
    LAST_DUE_DTM                  DATE,
    GUID                          RAW(16),
    ISSUE_PENDING_VAL_ID          NUMBER(10, 0),
    ISSUE_SHEET_VALUE_ID          NUMBER(10, 0),
    ISSUE_SURVEY_ANSWER_ID        NUMBER(10, 0),
    ISSUE_TYPE_ID                 NUMBER(10, 0)     NOT NULL,
    ISSUE_NON_COMPLIANCE_ID       NUMBER(10, 0),
    ISSUE_ACTION_ID               NUMBER(10, 0),
    ISSUE_METER_ID                NUMBER(10, 0),
    ISSUE_METER_ALARM_ID          NUMBER(10, 0),
    ISSUE_METER_RAW_DATA_ID       NUMBER(10, 0),
	ISSUE_METER_MISSING_DATA_ID   NUMBER(10) NULL,
	ISSUE_COMPLIANCE_REGION_ID		NUMBER(10),
    ISSUE_PRIORITY_ID             NUMBER(10, 0),
    LAST_ISSUE_PRIORITY_ID        NUMBER(10, 0),
    ISSUE_METER_DATA_SOURCE_ID    NUMBER(10, 0),
    ISSUE_SUPPLIER_ID             NUMBER(10, 0),
    IS_VISIBLE                    NUMBER(1, 0)      NOT NULL,
    SOURCE_URL                    VARCHAR2(2000),
    DELETED                       NUMBER(1, 0)      NOT NULL,
    PARENT_ID                     NUMBER(10, 0),
    IS_PUBLIC                     NUMBER(1)         NOT NULL,
    ISSUE_ESCALATED               NUMBER(1)         NOT NULL,
    ALLOW_AUTO_CLOSE              NUMBER(1)         NOT NULL,
    FIRST_ISSUE_LOG_ID            NUMBER(10, 0),
    LAST_ISSUE_LOG_ID             NUMBER(10, 0),
	IS_PENDING_ASSIGNMENT		  NUMBER(1)			NOT NULL,
	REGION_2_SID				  NUMBER(10),
	FORECAST_DTM 				  DATE,
	LAST_FORECAST_DTM 			  DATE,
	RAG_STATUS_ID 				  NUMBER(10),
	LAST_RAG_STATUS_ID 			  NUMBER(10),
	VAR_EXPL 					  CLOB,
	ISSUE_REF			  		  NUMBER(10, 0),
	ISSUE_INITIATIVE_ID           NUMBER(10, 0),
	LAST_REGION_SID				  NUMBER(10, 0),
	MANUAL_COMPLETION_DTM		  DATE,
	MANUAL_COMP_DTM_SET_DTM		  DATE,
	ISSUE_DUE_SOURCE_ID				NUMBER(10,0) NULL,
	ISSUE_DUE_OFFSET_DAYS			NUMBER(10,0) NULL,
	ISSUE_DUE_OFFSET_MONTHS			NUMBER(10,0) NULL,
	ISSUE_DUE_OFFSET_YEARS			NUMBER(10,0) NULL,
	PERMIT_ID						NUMBER(10,0) NULL,
	IS_CRITICAL						NUMBER(1) NOT NULL,
	notified_overdue				NUMBER(1) NOT NULL,
	copied_from_id					NUMBER(10) NULL,
	CONSTRAINT CHK_ISSUE_FKS CHECK (
		CASE WHEN ISSUE_PENDING_VAL_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_SHEET_VALUE_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_SURVEY_ANSWER_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_NON_COMPLIANCE_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_ACTION_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_METER_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_METER_ALARM_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_METER_RAW_DATA_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_METER_DATA_SOURCE_ID IS NOT NULL THEN 1 ELSE 0 END +
		-- pending new columns
		-- CASE WHEN ISSUE_METER_MISSING_DATA_ID IS NOT NULL THEN 1 ELSE 0 END +
		CASE WHEN ISSUE_SUPPLIER_ID IS NOT NULL THEN 1 ELSE 0 END +
		-- CASE WHEN ISSUE_INITIATIVE_ID IS NOT NULL THEN 1 ELSE 0 END
		CASE WHEN ISSUE_COMPLIANCE_REGION_ID IS NOT NULL THEN 1 ELSE 0 END
		IN (0, 1)),
    CONSTRAINT CHK_ISSUE_XOR_IS_ASSIGNED CHECK (
		(ASSIGNED_TO_USER_SID IS NOT NULL OR ASSIGNED_TO_ROLE_SID IS NOT NULL)
		AND
		(ASSIGNED_TO_USER_SID IS NULL OR ASSIGNED_TO_ROLE_SID IS NULL)),
    CONSTRAINT CHK_ISSUE_XOR_OWNER CHECK (
		(OWNER_USER_SID IS NOT NULL OR OWNER_ROLE_SID IS NOT NULL)
		AND
		(OWNER_USER_SID IS NULL OR OWNER_ROLE_SID IS NULL)),
    CONSTRAINT CHK_ISSUE_IS_VISIBLE CHECK (IS_VISIBLE IN (0,1)),
    CONSTRAINT CHK_DELETED_0_OR_1 CHECK (DELETED IN (0,1)),
	CONSTRAINT CHK_IS_PUBLIC CHECK (IS_PUBLIC IN (0,1)),
	CONSTRAINT CHK_ISSUE_ESCALATED_0_OR_1 CHECK (ISSUE_ESCALATED IN (0,1)),
	CONSTRAINT CHK_ALLOW_AUTO_CLOSE CHECK (ALLOW_AUTO_CLOSE IN (0,1)),
	CONSTRAINT CHK_IS_CRITICAL CHECK (IS_CRITICAL IN (0,1)),
    CONSTRAINT PK_ISSUE PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_ID),
    CONSTRAINT FK_ISSUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_ACTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ACTION_ID    NUMBER(10, 0)    NOT NULL,
    TASK_SID           NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_ACTION PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_ACTION_ID),
    CONSTRAINT FK_ISSUE_ACTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_ACTION_LOG (
	CSRIMP_SESSION_ID			  NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ACTION_LOG_ID           NUMBER(10, 0)     NOT NULL,
    ISSUE_ACTION_TYPE_ID          NUMBER(10, 0)     NOT NULL,
    ISSUE_ID                      NUMBER(10, 0),
    ISSUE_LOG_ID                  NUMBER(10, 0),
    LOGGED_BY_USER_SID            NUMBER(10, 0),
    LOGGED_BY_CORRESPONDENT_ID    NUMBER(10, 0),
    LOGGED_DTM                    DATE              NOT NULL,
    ASSIGNED_TO_ROLE_SID          NUMBER(10, 0),
    ASSIGNED_TO_USER_SID          NUMBER(10, 0),
    RE_USER_SID                   NUMBER(10, 0),
    RE_ROLE_SID                   NUMBER(10, 0),
    OLD_LABEL                     VARCHAR2(2048),
    NEW_LABEL                     VARCHAR2(2048),
    OLD_DUE_DTM                   DATE,
    NEW_DUE_DTM                   DATE,
    OLD_PRIORITY_ID               NUMBER(10, 0),
    NEW_PRIORITY_ID               NUMBER(10, 0),
    OLD_DESCRIPTION               CLOB,
    NEW_DESCRIPTION               CLOB,
	OLD_FORECAST_DTM 			  DATE,
	NEW_FORECAST_DTM 			  DATE,
    OWNER_USER_SID 				  NUMBER(10, 0),
	OLD_REGION_SID				  NUMBER(10, 0),
	NEW_REGION_SID				  NUMBER(10, 0),
	NEW_MANUAL_COMP_DTM_SET_DTM	  DATE,
	NEW_MANUAL_COMP_DTM			  DATE,
	IS_PUBLIC					  NUMBER(1, 0),
	INVOLVED_USER_SID			  NUMBER(10, 0),
	INVOLVED_USER_SID_REMOVED	  NUMBER(10, 0),	
	CONSTRAINT CHK_IAL_XOR_ASSIGNED CHECK (ISSUE_ACTION_TYPE_ID NOT IN (1)
OR
(
	(ASSIGNED_TO_USER_SID IS NOT NULL OR ASSIGNED_TO_ROLE_SID IS NOT NULL)
	AND
	(ASSIGNED_TO_USER_SID IS NULL OR ASSIGNED_TO_ROLE_SID IS NULL)
)),
    CONSTRAINT CHK_IAL_XOR_LOGGED_BY CHECK ((LOGGED_BY_USER_SID IS NOT NULL OR LOGGED_BY_CORRESPONDENT_ID IS NOT NULL)
AND
(LOGGED_BY_USER_SID IS NULL OR LOGGED_BY_CORRESPONDENT_ID IS NULL)),
    CONSTRAINT PK_ISSUE_ACTION_LOG PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_ACTION_LOG_ID),
    CONSTRAINT FK_ISSUE_ACTION_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_COMPLIANCE_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_COMPLIANCE_REGION_ID		NUMBER(10) NOT NULL,
	FLOW_ITEM_ID					NUMBER(10) NOT NULL,
	CONSTRAINT PK_ISSUE_COMPLIANCE_REGION PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_COMPLIANCE_REGION_ID),
	CONSTRAINT FK_ISSUE_COMPLIANCE_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_CUSTOM_FIELD_ID    NUMBER(10, 0)    NOT NULL,
    ISSUE_TYPE_ID            NUMBER(10, 0)    NOT NULL,
    FIELD_TYPE               CHAR(1)          NOT NULL,
    LABEL                    VARCHAR2(64)     NOT NULL,
	IS_MANDATORY			 NUMBER(1)		  NOT NULL,
	POS						 NUMBER(10),
	FIELD_REFERENCE_NAME     VARCHAR2(255),
	RESTRICT_TO_GROUP_SID    NUMBER(10),
    CONSTRAINT CHK_ISS_CUST_FLD_TYP CHECK (FIELD_TYPE IN ('T', 'O', 'M', 'D')),
    CONSTRAINT PK_ISSUE_CUSTOM_FIELD PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_CUSTOM_FIELD_ID),
    CONSTRAINT FK_ISSUE_CUSTOM_FIELD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD_OPT_SEL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ID                     NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_ID        NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_OPT_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_CUSTOM_FIELD_OPT_SEL PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_ID, ISSUE_CUSTOM_FIELD_ID, ISSUE_CUSTOM_FIELD_OPT_ID),
    CONSTRAINT FK_ISS_CUST_FLD_OPT_SEL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD_OPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_CUSTOM_FIELD_ID        NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_OPT_ID    NUMBER(10, 0)    NOT NULL,
    LABEL                        VARCHAR2(64)     NOT NULL,
    CONSTRAINT PK_ISSUE_CUSTOM_FIELD_OPTION PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_CUSTOM_FIELD_ID, ISSUE_CUSTOM_FIELD_OPT_ID),
    CONSTRAINT FK_ISSUE_CUST_FLD_OPT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD_DATE_VAL(
    CSRIMP_SESSION_ID        NUMBER(10, 0)    DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
    DATE_VALUE               DATE             NOT NULL,
    ISSUE_ID                 NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_CUST_FIELD_DATE_VAL PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_ID, ISSUE_CUSTOM_FIELD_ID),
    CONSTRAINT FK_ISS_CUST_FLD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD_STR_VAL (
	CSRIMP_SESSION_ID		 NUMBER(10) 	  DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ID                 NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_ID    NUMBER(10, 0)    NOT NULL,
    STRING_VALUE             VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_ISSUE_CUSTOM_FIELD_STR_VAL PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_ID, ISSUE_CUSTOM_FIELD_ID),
    CONSTRAINT FK_ISSUE_CUST_FLD_STR_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.issue_due_source (
	csrimp_session_id				NUMBER(10,0) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	issue_due_source_id				NUMBER(10,0) NOT NULL,
	issue_type_id					NUMBER(10,0) NOT NULL,
	source_description				VARCHAR2(1024) NOT NULL,
	fetch_proc						VARCHAR2(256) NOT NULL,
    CONSTRAINT pk_issue_due_source	PRIMARY KEY (csrimp_session_id, issue_due_source_id),
    CONSTRAINT fk_issue_due_source_is 
		FOREIGN KEY (CSRIMP_SESSION_ID) 
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) 
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_LOG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_LOG_ID                  NUMBER(10, 0)     NOT NULL,
    ISSUE_ID                      NUMBER(10, 0),
    MESSAGE                       CLOB,
    LOGGED_DTM                    DATE              NOT NULL,
    IS_SYSTEM_GENERATED           NUMBER(1, 0)      NOT NULL,
    LOGGED_BY_USER_SID            NUMBER(10, 0),
    LOGGED_BY_CORRESPONDENT_ID    NUMBER(10, 0),
    PARAM_1                       VARCHAR2(2048),
    PARAM_2                       VARCHAR2(2048),
    PARAM_3                       VARCHAR2(2048),
    CONSTRAINT CHK_IL_XOR_LOGGED_BY CHECK ((LOGGED_BY_USER_SID IS NOT NULL OR LOGGED_BY_CORRESPONDENT_ID IS NOT NULL)
AND
(LOGGED_BY_USER_SID IS NULL OR LOGGED_BY_CORRESPONDENT_ID IS NULL)),
    CONSTRAINT PK_ISSUE_LOG PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_LOG_ID),
    CONSTRAINT FK_ISSUE_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_LOG_FILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_LOG_FILE_ID    NUMBER(10, 0)    NOT NULL,
    ISSUE_LOG_ID         NUMBER(10, 0)    NOT NULL,
    FILENAME             VARCHAR2(255)    NOT NULL,
    MIME_TYPE            VARCHAR2(256)    NOT NULL,
    DATA                 BLOB             NOT NULL,
    SHA1                 RAW(20),
    UPLOADED_DTM         DATE             NOT NULL,
	ARCHIVE_FILE_ID      VARCHAR2(50),
	ARCHIVE_FILE_SIZE    NUMBER(10),
    CONSTRAINT PK_ISSUE_LOG_FILE PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_LOG_FILE_ID),
    CONSTRAINT FK_ISSUE_LOG_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_LOG_READ (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_LOG_ID    NUMBER(10, 0)    NOT NULL,
    READ_DTM        TIMESTAMP(6)     NOT NULL,
    CSR_USER_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_LOG_READ PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_LOG_ID, CSR_USER_SID),
    CONSTRAINT FK_ISSUE_LOG_READ_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_METER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_METER_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID        NUMBER(10, 0)    NOT NULL,
    ISSUE_DTM         DATE,
    CONSTRAINT PK_ISSUE_METER PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_METER_ID),
    CONSTRAINT FK_ISSUE_METER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_METER_ALARM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_METER_ALARM_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    METER_ALARM_ID          NUMBER(10, 0)    NOT NULL,
    ISSUE_DTM               DATE             NOT NULL,
    CONSTRAINT PK_ISSUE_METER_ALARM PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_METER_ALARM_ID),
    CONSTRAINT FK_ISSUE_METER_ALRM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_METER_DATA_SOURCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_METER_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    RAW_DATA_SOURCE_ID            NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_METER_DATA_SOURCE PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_METER_DATA_SOURCE_ID),
    CONSTRAINT FK_ISSUE_MTR_DAT_SRC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_METER_RAW_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_METER_RAW_DATA_ID    NUMBER(10, 0)    NOT NULL,
    METER_RAW_DATA_ID          NUMBER(10, 0)    NOT NULL,
    REGION_SID                 NUMBER(10, 0),
    CONSTRAINT PK_ISSUE_METER_RAW_DATA PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_METER_RAW_DATA_ID),
    CONSTRAINT FK_ISSUE_MTR_RAW_DAT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_NON_COMPLIANCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_NON_COMPLIANCE_ID    NUMBER(10, 0)    NOT NULL,
    NON_COMPLIANCE_ID          NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_NON_COMPLIANCE PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_NON_COMPLIANCE_ID),
    CONSTRAINT FK_ISSUE_NON_COMPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_PENDING_VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_PENDING_VAL_ID    NUMBER(10, 0)    NOT NULL,
    PENDING_REGION_ID       NUMBER(10, 0)    NOT NULL,
    PENDING_IND_ID          NUMBER(10, 0)    NOT NULL,
    PENDING_PERIOD_ID       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_PENDING_VAL PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_PENDING_VAL_ID),
    CONSTRAINT UK_ISSUE_PENDING_VAL  UNIQUE (CSRIMP_SESSION_ID, PENDING_IND_ID, PENDING_REGION_ID, PENDING_PERIOD_ID),
    CONSTRAINT FK_ISSUE_PENDING_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_PRIORITY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_PRIORITY_ID    NUMBER(10, 0)     NOT NULL,
    DESCRIPTION          VARCHAR2(1000)    NOT NULL,
    DUE_DATE_OFFSET      NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_ISSUE_PRIORITY PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_PRIORITY_ID),
    CONSTRAINT FK_ISSUE_PRIORITY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_SCHEDULED_TASK (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_SCHEDULED_TASK_ID			NUMBER(10, 0)	NOT NULL,
	LABEL					  		VARCHAR2(255)	NOT NULL,
	SCHEDULE_XML			   		SYS.XMLType		NOT NULL,
	PERIOD_XML				 		SYS.XMLType		NOT NULL,
	LAST_CREATED			   		DATE,
	ASSIGN_TO_USER_SID		 		NUMBER(10, 0)	NOT NULL,
	RAISED_BY_USER_SID		 		NUMBER(10, 0)	NOT NULL,
	NEXT_RUN_DTM			   		TIMESTAMP(6),
	DUE_DTM_RELATIVE		   		NUMBER(10),
	DUE_DTM_RELATIVE_UNIT	  		CHAR(1),
	ISSUE_TYPE_ID					NUMBER(10),
	SCHEDULED_ON_DUE_DATE			NUMBER(1) NOT NULL,
	CREATE_CRITICAL					NUMBER(1) NOT NULL,
	COPIED_FROM_ID					NUMBER(10) NULL,
	REGION_SID						NUMBER(10),
	CONSTRAINT PK_ISSUE_SCHEDULED_TASK PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_SCHEDULED_TASK_ID),
	CONSTRAINT CHK_SCHEDULED_ON_DUE_DATE_1_0 CHECK (SCHEDULED_ON_DUE_DATE IN (1, 0)),
	CONSTRAINT CHK_CREATE_CRITICAL CHECK(CREATE_CRITICAL IN (0,1)),
	CONSTRAINT FK_ISSUE_SCH_TASK_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_SHEET_VALUE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_SHEET_VALUE_ID    NUMBER(10, 0)    NOT NULL,
    IND_SID                 NUMBER(10, 0)    NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    START_DTM               DATE             NOT NULL,
    END_DTM                 DATE             NOT NULL,
    CONSTRAINT PK_ISSUE_SHEET_VALUE PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_SHEET_VALUE_ID),
    CONSTRAINT FK_ISSUE_SHEET_VALUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_SUPPLIER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_SUPPLIER_ID              NUMBER(10, 0)    NOT NULL,
    QS_EXPR_NON_COMPL_ACTION_ID    NUMBER(10, 0),
    COMPANY_SID                    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_SUPPLIER PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_SUPPLIER_ID),
    CONSTRAINT FK_ISSUE_SUPPLIER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_SURVEY_ANSWER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_SURVEY_ANSWER_ID    NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID        NUMBER(10, 0)    NOT NULL,
    QUESTION_ID               NUMBER(10, 0)    NOT NULL,
	QUESTION_VERSION		  NUMBER(10, 0)    NOT NULL,
	SURVEY_SID				  NUMBER(10, 0)    NOT NULL,
    SURVEY_VERSION 			  NUMBER(10, 0)	   NOT NULL,
    CONSTRAINT PK_ISSUE_SURVEY_ANSWER PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_SURVEY_ANSWER_ID),
    CONSTRAINT UK_ISSUE_SURVEY_ANSWER  UNIQUE (CSRIMP_SESSION_ID, SURVEY_RESPONSE_ID, QUESTION_ID),
    CONSTRAINT FK_ISSUE_SURVEY_ANS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_TYPE_ID					NUMBER(10, 0)	NOT NULL,
    LABEL							VARCHAR2(255)	NOT NULL,
    DEFAULT_REGION_SID				NUMBER(10, 0),
    DEFAULT_ISSUE_PRIORITY_ID		NUMBER(10, 0),
    ALERT_MAIL_ADDRESS				VARCHAR2(100),
    ALERT_MAIL_NAME					VARCHAR2(100),
	REQUIRE_DUE_DTM_COMMENT			NUMBER(1)		NOT NULL,
    REQUIRE_PRIORITY				NUMBER(1, 0)	NOT NULL,
    ALLOW_CHILDREN					NUMBER(1, 0)	NOT NULL,
	AUTO_CLOSE_AFTER_RESOLVE_DAYS	NUMBER(10, 0),
	CREATE_RAW						NUMBER(1, 0)	NOT NULL,
	REGION_LINK_TYPE				NUMBER(1)		NOT NULL,
	DEFAULT_ASSIGN_TO_USER_SID		NUMBER(10),
	DEFAULT_ASSIGN_TO_ROLE_SID		NUMBER(10),
	ALERT_PENDING_DUE_DAYS			NUMBER(10),
	ALERT_OVERDUE_DAYS				NUMBER(10),
	POSITION						NUMBER(10),
	DELETED							NUMBER(1),
    CAN_SET_PUBLIC              	NUMBER(1)		NOT NULL,
    EMAIL_INVOLVED_ROLES        	NUMBER(1, 0)	NOT NULL,
	EMAIL_INVOLVED_USERS			NUMBER(1)       NOT NULL,
	ALLOW_PENDING_ASSIGNMENT		NUMBER(1)		NOT NULL,
	RESTRICT_USERS_TO_REGION		NUMBER(1)		NOT NULL,
	DELETABLE_BY_OWNER				NUMBER(1)		NOT NULL,
	DELETABLE_BY_ADMINISTRATOR		NUMBER(1)		NOT NULL,
	INVOLVE_MIN_USERS_IN_ISSUE		NUMBER(1)		NOT NULL,
	SHOW_FORECAST_DTM 				NUMBER(1,0)		NOT NULL,
	REQUIRE_VAR_EXPL				NUMBER(1,0)		NOT NULL,
	ENABLE_REJECT_ACTION			NUMBER(1,0)		NOT NULL,
	HELPER_PKG						VARCHAR2(255),
	PUBLIC_BY_DEFAULT				NUMBER(1)		NOT NULL,
	OWNER_CAN_BE_CHANGED			NUMBER(1)		NOT NULL,
	DELETABLE_BY_RAISER				NUMBER(1)		NOT NULL,
	SEND_ALERT_ON_ISSUE_RAISED		NUMBER (1, 0)	NOT NULL,
	INTERNAL_ISSUE_REF_HELPER_FUNC	VARCHAR2(255),
	INTERNAL_ISSUE_REF_PREFIX		VARCHAR2(255),
	LOOKUP_KEY						VARCHAR2(255),
	SHOW_ONE_ISSUE_POPUP			NUMBER(1)		NOT NULL,
    ALLOW_OWNER_RESOLVE_AND_CLOSE	NUMBER(1,0)		NOT NULL,
	APPLIES_TO_AUDIT				NUMBER(10,0)	NOT NULL,
	GET_ASSIGNABLES_SP				VARCHAR2(255),
	IS_REGION_EDITABLE				NUMBER(1, 0)	NOT NULL,
	ENABLE_MANUAL_COMP_DATE			NUMBER(1) 		NOT NULL,
	COMMENT_IS_OPTIONAL 			NUMBER(1) 		NOT NULL,
	DUE_DATE_IS_MANDATORY 			NUMBER(1) 		NOT NULL,
	ALLOW_CRITICAL                  NUMBER(1)       NOT NULL,
    ALLOW_URGENT_ALERT              NUMBER(1)       NOT NULL,
	REGION_IS_MANDATORY				NUMBER(1)		NOT NULL,
    CONSTRAINT PK_ISSUE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_TYPE_ID),
	CONSTRAINT CHK_EMAIL_INVOLVED_ROLES_1_0 CHECK (EMAIL_INVOLVED_ROLES IN (1, 0)),
	CONSTRAINT CHK_ISS_TYPE_REQ_DDTM_CMT CHECK (REQUIRE_DUE_DTM_COMMENT IN (0,1)),
	CONSTRAINT CHK_CAN_SET_PUBLIC CHECK (CAN_SET_PUBLIC IN (0,1)),
	CONSTRAINT CHK_OWNER_CAN_BE_CHANGED CHECK (OWNER_CAN_BE_CHANGED IN (0,1)),
	CONSTRAINT CHK_DELETABLE_BY_RAISER CHECK (DELETABLE_BY_RAISER IN (0,1)),
	CONSTRAINT CHK_ISSUE_TYPE_DELETED CHECK (DELETED IN (0, 1)),
	CONSTRAINT CHK_IT_ACARD_VALID CHECK (AUTO_CLOSE_AFTER_RESOLVE_DAYS >= 0),
	CONSTRAINT CHK_IT_ALERT_OVERDUE_DAYS CHECK (ALERT_OVERDUE_DAYS >= 0),
	CONSTRAINT CHK_IT_ALERT_PENDING_DAYS CHECK (ALERT_PENDING_DUE_DAYS >= 1),
	CONSTRAINT CHK_IT_CREATE_RAW CHECK (CREATE_RAW IN (0, 1)),
	CONSTRAINT CHK_IT_RLT_NONE_OPT_MAND CHECK (REGION_LINK_TYPE IN (0, 1, 2)),
	CONSTRAINT CHK_IT_UNIQUE_ASSIGN CHECK (NOT (DEFAULT_ASSIGN_TO_USER_SID IS NOT NULL AND DEFAULT_ASSIGN_TO_ROLE_SID IS NOT NULL)),
	CONSTRAINT CHK_SHOW_ONE_ISSUE_POPUP CHECK (SHOW_ONE_ISSUE_POPUP IN (1, 0)),
	CONSTRAINT CHK_REGION_EDITABLE CHECK(IS_REGION_EDITABLE IN (0,1)),
	CONSTRAINT CHK_ALLOW_CRITICAL CHECK(ALLOW_CRITICAL IN (0,1)),
    CONSTRAINT CK_ISSUE_TYPE_ALLOW_URGENT CHECK (ALLOW_URGENT_ALERT IN (0,1)),
    CONSTRAINT CK_ISSUE_TYPE_EMAIL_INV_USERS CHECK (EMAIL_INVOLVED_USERS IN (0,1)),    
    CONSTRAINT FK_ISSUE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_INVOLVEMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ID       NUMBER(10, 0)    NOT NULL,
    IS_AN_OWNER    NUMBER(1, 0)     NOT NULL,
    USER_SID       NUMBER(10, 0),
	ROLE_SID       NUMBER(10, 0),
	COMPANY_SID    NUMBER(10, 0),
    CONSTRAINT UK_ISSUE_INVOLVEMENT UNIQUE (CSRIMP_SESSION_ID, ISSUE_ID, USER_SID, ROLE_SID, COMPANY_SID),
    CONSTRAINT FK_ISSUE_INVOLVEMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_AGGREGATE_TYPE(
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	METER_AGGREGATE_TYPE_ID			NUMBER(10, 0)	NOT NULL,
	METER_INPUT_ID					NUMBER(10, 0)	NULL,
	AGGREGATOR						VARCHAR2(32)	NOT NULL,
	ANALYTIC_FUNCTION				NUMBER(10, 0)	NOT NULL,
	DESCRIPTION						VARCHAR2(255)	NOT NULL,
	ACCUMULATIVE					NUMBER(1)		NOT NULL,
	CONSTRAINT PK_METER_AGGREGATE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, METER_AGGREGATE_TYPE_ID),
	CONSTRAINT CHK_MTR_AGG_TYP_CUMULATIVE_1_0 CHECK (ACCUMULATIVE IN (1, 0)),
	CONSTRAINT FK_METER_AGGREGATE_TYPE FOREIGN KEY
	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_ALARM_ID          NUMBER(10, 0)     NOT NULL,
    INHERITABLE             NUMBER(1, 0)      NOT NULL,
    ENABLED                 NUMBER(1, 0)      NOT NULL,
    NAME                    VARCHAR2(1024)    NOT NULL,
    TEST_TIME_ID            NUMBER(10, 0)     NOT NULL,
    LOOK_AT_STATISTIC_ID    NUMBER(10, 0)     NOT NULL,
    COMPARE_STATISTIC_ID    NUMBER(10, 0)     NOT NULL,
    COMPARISON_ID           NUMBER(10, 0)     NOT NULL,
    COMPARISON_VAL          NUMBER(10, 5)     NOT NULL,
    ISSUE_PERIOD_ID         NUMBER(10, 0)     NOT NULL,
    ISSUE_TRIGGER_COUNT     NUMBER(10, 0)     NOT NULL,
    CHECK (INHERITABLE IN(0,1)),
    CHECK (ENABLED IN(0,1)),
    CONSTRAINT PK_METER_ALARM PRIMARY KEY (CSRIMP_SESSION_ID, METER_ALARM_ID),
    CONSTRAINT FK_METER_ALARM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.METER_ALARM_COMPARISON (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COMPARISON_ID    NUMBER(10, 0)    NOT NULL,
    NAME             VARCHAR2(256)    NOT NULL,
    SHOW_PCT         NUMBER(1, 0)     NOT NULL,
    OP_CODE          VARCHAR2(64)     NOT NULL,
    CHECK (SHOW_PCT IN(0,1)),
    CONSTRAINT PK_METER_ALARM_COMPARISON PRIMARY KEY (CSRIMP_SESSION_ID, COMPARISON_ID),
    CONSTRAINT FK_METER_ALRM_COMP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_EVENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    METER_ALARM_ID          NUMBER(10, 0)    NOT NULL,
    METER_ALARM_EVENT_ID    NUMBER(10, 0)    NOT NULL,
    EVENT_DTM               DATE             NOT NULL,
    CONSTRAINT PK_METER_ALARM_EVENT PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, METER_ALARM_ID, METER_ALARM_EVENT_ID),
    CONSTRAINT FK_METER_ALARM_EV_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_ISSUE_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_PERIOD_ID    NUMBER(10, 0)    NOT NULL,
    NAME               VARCHAR2(256)    NOT NULL,
    TEST_FUNCTION      VARCHAR2(256)    NOT NULL,
    CONSTRAINT PK_METER_ALARM_ISSUE_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_PERIOD_ID),
    CONSTRAINT FK_METER_ALARM_IS_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_STAT_RUN (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_ALARM_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID        NUMBER(10, 0)    NOT NULL,
    STATISTIC_ID      NUMBER(10, 0)    NOT NULL,
    STATISTIC_DTM     DATE             NOT NULL,
    CONSTRAINT PK_METER_ALARM_STAT_RUN PRIMARY KEY (CSRIMP_SESSION_ID, METER_ALARM_ID, REGION_SID, STATISTIC_ID),
    CONSTRAINT FK_METER_ALARM_STAT_RUN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.METER_ALARM_STATISTIC (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    STATISTIC_ID        NUMBER(10, 0)    NOT NULL,
    METER_INPUT_ID      NUMBER(10, 0)    NOT NULL,
    AGGREGATOR          VARCHAR2(32)     NOT NULL,
    METER_BUCKET_ID     NUMBER(10, 0)    NOT NULL,
    NAME                VARCHAR2(256)    NOT NULL,
    IS_AVERAGE          NUMBER(1, 0)     NOT NULL,
    IS_SUM              NUMBER(1, 0)     NOT NULL,
    COMP_PROC           VARCHAR2(256),
    ALL_METERS          NUMBER(1, 0)     NOT NULL,
    NOT_BEFORE_DTM      DATE,
    CORE_WORKING_HOURS  NUMBER(1)        NOT NULL,
    POS                 NUMBER(10, 0)    NOT NULL,
    CHECK (IS_AVERAGE IN(0,1)),
    CHECK (IS_SUM  IN(0,1)),
    CHECK (ALL_METERS IN(0,1)),
    CONSTRAINT CK_CORE_WORKING_HOURS_MAS CHECK (CORE_WORKING_HOURS IN (0,1)),
    CONSTRAINT PK_METER_ALARM_STATISTIC PRIMARY KEY (CSRIMP_SESSION_ID, STATISTIC_ID),
    CONSTRAINT FK_METER_ALRM_STAT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_STATISTIC_JOB (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID         NUMBER(10, 0)    NOT NULL,
    STATISTIC_ID       NUMBER(10, 0)    NOT NULL,
    START_DTM          DATE             NOT NULL,
    END_DTM            DATE             NOT NULL,
    JOB_CREATED_DTM    DATE             NOT NULL,
    CONSTRAINT PK_METER_ALARM_STATISTIC_JOB PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, STATISTIC_ID),
    CONSTRAINT FK_METER_ALRM_STAT_JOB_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_STATISTIC_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID       NUMBER(10, 0)     NOT NULL,
    STATISTIC_ID     NUMBER(10, 0)     NOT NULL,
    STATISTIC_DTM    DATE              NOT NULL,
    VAL              NUMBER(24, 10),
    AVERAGE_COUNT    NUMBER(10, 0),
    CONSTRAINT PK_METER_ALARM_STAT_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, STATISTIC_ID, STATISTIC_DTM),
    CONSTRAINT FK_METER_ALRM_STATE_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_TEST_TIME (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TEST_TIME_ID     NUMBER(10, 0)    NOT NULL,
    NAME             VARCHAR2(256)    NOT NULL,
    TEST_FUNCTION    VARCHAR2(256)    NOT NULL,
    CONSTRAINT PK_METER_ALARM_TEST_TIME PRIMARY KEY (CSRIMP_SESSION_ID, TEST_TIME_ID),
    CONSTRAINT FK_METER_ALRM_TEST_TIME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CORE_WORKING_HOURS (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CORE_WORKING_HOURS_ID		NUMBER(10)		NOT NULL,
	START_TIME					VARCHAR2(16)	NOT NULL,
	END_TIME					VARCHAR2(16)	NOT NULL,
	CONSTRAINT PK_CORE_WORKING_HOURS PRIMARY KEY (CSRIMP_SESSION_ID, CORE_WORKING_HOURS_ID),
	CONSTRAINT FK_CUSTOMER_COREWKHRS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CORE_WORKING_HOURS_DAY (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CORE_WORKING_HOURS_ID		NUMBER(10)		NOT NULL,
	DAY							NUMBER(1)		NOT NULL,
	CONSTRAINT PK_CORE_WORKING_HOURS_DAY PRIMARY KEY (CSRIMP_SESSION_ID, CORE_WORKING_HOURS_ID, DAY),
	CONSTRAINT FK_COREWKHRS_COREWKHRSDAY FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE,
	CONSTRAINT CK_CORE_WORKING_HOURS_DAY CHECK (DAY IN (1,2,3,4,5,6,7))
);

CREATE TABLE CSRIMP.CORE_WORKING_HOURS_REGION (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REGION_SID					NUMBER(10)		NOT NULL,
	CORE_WORKING_HOURS_ID		NUMBER(10)		NOT NULL,
	CONSTRAINT PK_CORE_WORKING_HOURS_REGION PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, CORE_WORKING_HOURS_ID),
	CONSTRAINT FK_REGION_COREWKHRS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_DOCUMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_DOCUMENT_ID    NUMBER(10, 0)     NOT NULL,
    MIME_TYPE            VARCHAR2(256)     NOT NULL,
    FILE_NAME            VARCHAR2(1024)    NOT NULL,
    DATA                 BLOB              NOT NULL,
    CONSTRAINT PK_METER_DOCUMENT PRIMARY KEY (CSRIMP_SESSION_ID, METER_DOCUMENT_ID),
    CONSTRAINT FK_METER_DOCUMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_EXCEL_MAPPING (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RAW_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    FIELD_NAME            VARCHAR2(256)    NOT NULL,
    COLUMN_NAME           VARCHAR2(256)    NOT NULL,
    COLUMN_INDEX          NUMBER(10, 0)    NOT NULL,
    CREATE_METERS_MAP_COLUMN VARCHAR2(255),
    CONSTRAINT PK_METER_EXCEL_MAPPING PRIMARY KEY (CSRIMP_SESSION_ID, RAW_DATA_SOURCE_ID, FIELD_NAME),
    CONSTRAINT FK_METER_EXCEL_MAPPING_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_EXCEL_OPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RAW_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    WORKSHEET_INDEX       NUMBER(10, 0)    NOT NULL,
    ROW_INDEX             NUMBER(10, 0)    NOT NULL,
    CSV_DELIMITER         VARCHAR2(1),
	METER_DATE_FORMAT     VARCHAR2(255),
    CONSTRAINT PK_METER_EXCEL_OPTION PRIMARY KEY (CSRIMP_SESSION_ID, RAW_DATA_SOURCE_ID),
    CONSTRAINT FK_METER_EXCEL_OPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_LIST_CACHE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID              NUMBER(10, 0)     NOT NULL,
    LAST_READING_DTM        DATE,
    ENTERED_DTM             DATE,
    VAL_NUMBER              NUMBER(24, 10),
    AVG_CONSUMPTION         NUMBER(24, 10),
    COST_NUMBER             NUMBER(24, 10),
    DEMAND_NUMBER           NUMBER(24, 10),
    READ_BY_SID             NUMBER(10, 0),
    REALTIME_LAST_PERIOD    DATE,
    REALTIME_CONSUMPTION    NUMBER(24, 10),
    FIRST_READING_DTM       DATE,
    READING_COUNT           NUMBER(24, 10),
    CONSTRAINT PK_METER_LIST_CACHE PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID),
    CONSTRAINT FK_METER_LIST_CACHE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_LIVE_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID               NUMBER(10, 0)     NOT NULL,
    METER_BUCKET_ID          NUMBER(10, 0)     NOT NULL,
    METER_INPUT_ID           NUMBER(10, 0)     NOT NULL,
    AGGREGATOR               VARCHAR2(32)      NOT NULL,
    PRIORITY                 NUMBER(10)        NOT NULL,
    START_DTM                DATE              NOT NULL,
    METER_RAW_DATA_ID        NUMBER(10, 0),
    END_DTM                  DATE              NOT NULL,
    MODIFIED_DTM             DATE              NOT NULL,
    CONSUMPTION              NUMBER(24, 10),
	METER_DATA_ID			NUMBER(10),
    CONSTRAINT PK_METER_LIVE_DATA PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, METER_BUCKET_ID, METER_INPUT_ID, AGGREGATOR, PRIORITY, START_DTM),
    CONSTRAINT FK_METER_LIVE_DATA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.meter_header_element (
    csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	meter_header_element_id			NUMBER(10) NOT NULL,
	pos								NUMBER(10) NOT NULL,
	col								NUMBER(10) NOT NULL,
	ind_sid							NUMBER(10),
	tag_group_id					NUMBER(10),
	meter_header_core_element_id	NUMBER(10),
	CONSTRAINT pk_meter_header_element PRIMARY KEY (csrimp_session_id, meter_header_element_id),
	CONSTRAINT chk_meter_header_element
		CHECK ((ind_sid IS NOT NULL AND tag_group_id IS NULL AND meter_header_core_element_id IS NULL) OR
				(ind_sid IS NULL AND tag_group_id IS NOT NULL AND meter_header_core_element_id IS NULL) OR
				(ind_sid IS NULL AND tag_group_id IS NULL AND meter_header_core_element_id IS NOT NULL)),
	CONSTRAINT fk_meter_header_element_is FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METERING_OPTIONS(
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ANALYTICS_MONTHS				NUMBER(10, 0),
	ANALYTICS_CURRENT_MONTH			NUMBER(1, 0)	NOT NULL,
	METER_PAGE_URL					VARCHAR2(255)	NOT NULL,
	METERING_HELPER_PKG				VARCHAR(255),
	SHOW_INHERITED_ROLES			NUMBER(1, 0)	NOT NULL,
	PERIOD_SET_ID					NUMBER(10) NOT NULL,
	PERIOD_INTERVAL_ID				NUMBER(10) NOT NULL,
	SHOW_INVOICE_REMINDER			NUMBER(1) NOT NULL,
	INVOICE_REMINDER				VARCHAR2(1024),
	SUPPLIER_DATA_MANDATORY			NUMBER(1) NOT NULL,
	REGION_DATE_CLIPPING			NUMBER(1) NOT NULL,
	FWD_ESTIMATE_METERS				NUMBER(1) NOT NULL,
	REFERENCE_MANDATORY				NUMBER(1) NOT NULL,
	REALTIME_METERING_ENABLED		NUMBER(1) NOT NULL,
	PREVENT_MANUAL_FUTURE_READINGS	NUMBER(1) NOT NULL,
	PROC_USE_SERVICE				NUMBER(1) NOT NULL,
	PROC_API_BASE_URI				VARCHAR2(1024),
	PROC_LOCAL_PATH					VARCHAR2(1024),
	PROC_KICK_TIMEOUT				NUMBER(10),
	RAW_FEED_DATA_JOBS_ENABLED		NUMBER(1) NOT NULL,
	CONSTRAINT CHK_SHOW_INVOICE_REMINDER_1_0 CHECK (SHOW_INVOICE_REMINDER IN (1,0)),
	CONSTRAINT CHK_SUPPLIER_DATA_MAND_1_0 CHECK (SUPPLIER_DATA_MANDATORY IN (1,0)),
	CONSTRAINT CHK_REGION_DATE_CLIPPING_1_0 CHECK (REGION_DATE_CLIPPING IN (1,0)),
	CONSTRAINT CHK_FWD_ESTIMATE_METERS_1_0 CHECK (FWD_ESTIMATE_METERS IN (1,0)),
	CONSTRAINT CHK_REFERENCE_MANDATORY_1_0 CHECK (REFERENCE_MANDATORY IN (1,0)),
	CONSTRAINT CHK_REALTIME_METER_ENBLD_1_0 CHECK (REALTIME_METERING_ENABLED IN (1,0)),
	CONSTRAINT CK_MET_OPT_CURR_MON_0_1 CHECK (ANALYTICS_CURRENT_MONTH IN(0,1)),
	CONSTRAINT CK_MET_OPT_PMFR_0_1 CHECK (PREVENT_MANUAL_FUTURE_READINGS IN(0,1)),
	CONSTRAINT PK_METERING_OPTIONS PRIMARY KEY (CSRIMP_SESSION_ID),
	CONSTRAINT CK_PROC_USE_SERVICE CHECK (PROC_USE_SERVICE IN (0, 1)),
	CONSTRAINT CK_PROC_OPRIONS_IN_USE CHECK (PROC_USE_SERVICE = 0 OR (PROC_API_BASE_URI IS NOT NULL AND PROC_LOCAL_PATH IS NOT NULL AND PROC_KICK_TIMEOUT IS NOT NULL)),
	CONSTRAINT CK_RAW_FEED_DATA_JOBS_ENABLED CHECK (RAW_FEED_DATA_JOBS_ENABLED IN (0, 1)),
	CONSTRAINT FK_METERING_OPTIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.meter_photo (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	meter_photo_id					NUMBER(10, 0) NOT NULL,
	region_sid						NUMBER(10, 0) NOT NULL,
	filename						VARCHAR2(256) NOT NULL,
	mime_type						VARCHAR2(255) NOT NULL,
	data							BLOB NOT NULL,
	CONSTRAINT pk_meter_photo PRIMARY KEY (csrimp_session_id, meter_photo_id),
	CONSTRAINT fk_meter_photo_is FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_METER_ALARM_STATISTIC (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID        NUMBER(10, 0)    NOT NULL,
    STATISTIC_ID      NUMBER(10, 0)    NOT NULL,
    NOT_BEFORE_DTM    DATE,
    LAST_COMP_DTM     DATE,
    CONSTRAINT PK_METER_METER_ALARM_STAT PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, STATISTIC_ID),
    CONSTRAINT FK_MTR_MTR_ALRM_STAT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ORPHAN_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SERIAL_ID						VARCHAR2(256)     NOT NULL,
    METER_INPUT_ID					NUMBER(10, 0)     NOT NULL,
    PRIORITY						NUMBER(10, 0)     NOT NULL,
    START_DTM						DATE              NOT NULL,
    END_DTM							DATE,
    METER_RAW_DATA_ID				NUMBER(10, 0)     NOT NULL,
    CONSUMPTION						NUMBER(24, 10)    NOT NULL,
    UOM								VARCHAR2(256),
    NOTE							VARCHAR2(4000),
    RELATED_LOCATION_1				VARCHAR2(256),
    RELATED_LOCATION_2				VARCHAR2(256),
    REGION_SID						NUMBER(10),
	HAS_OVERLAP						NUMBER(1)         NOT NULL,
	ERROR_TYPE_ID					NUMBER(10),
	STATEMENT_ID					VARCHAR2(256),
	CHECK (HAS_OVERLAP IN (0,1)),
    CONSTRAINT FK_METER_ORPHAN_DATA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_RAW_DATA (
	CSRIMP_SESSION_ID               NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_RAW_DATA_ID               NUMBER(10, 0)    NOT NULL,
    RAW_DATA_SOURCE_ID              NUMBER(10, 0)    NOT NULL,
    RECEIVED_DTM                    DATE             NOT NULL,
    START_DTM                       DATE,
    END_DTM                         DATE,
    MIME_TYPE                       VARCHAR2(256)    NOT NULL,
    ENCODING_NAME                   VARCHAR2(256)    NOT NULL,
    MESSAGE_UID                     NUMBER(10, 0),
    FILE_NAME                       VARCHAR2(1024),
    DATA                            BLOB             NOT NULL,
    ORIGINAL_MIME_TYPE              VARCHAR2(256),
    ORIGINAL_FILE_NAME              VARCHAR2(1024),
    ORIGINAL_DATA                   BLOB,
    AUTOMATED_IMPORT_INSTANCE_ID    NUMBER(10, 0),
    STATUS_ID                       NUMBER(10, 0)    NOT NULL,
    ORPHAN_COUNT                    NUMBER(10, 0),
    MATCHED_COUNT                   NUMBER(10, 0),
    CONSTRAINT PK_METER_RAW_DATA PRIMARY KEY (CSRIMP_SESSION_ID, METER_RAW_DATA_ID),
    CONSTRAINT FK_METER_RAW_DATA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_RAW_DATA_ERROR (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_RAW_DATA_ID    NUMBER(10, 0)     NOT NULL,
    ERROR_ID             NUMBER(10, 0)     NOT NULL,
    MESSAGE              VARCHAR2(4000)    NOT NULL,
    RAISED_DTM           DATE              NOT NULL,
    DATA_DTM             DATE,
    CONSTRAINT PK_METER_RAW_DATA_ERROR PRIMARY KEY (CSRIMP_SESSION_ID, METER_RAW_DATA_ID, ERROR_ID),
    CONSTRAINT FK_METER_RAW_DATA_ERROR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_RAW_DATA_SOURCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LABEL                         VARCHAR2(1024),
    RAW_DATA_SOURCE_ID            NUMBER(10, 0)     NOT NULL,
    PARSER_TYPE                   VARCHAR2(256)     NOT NULL,
    HELPER_PKG                    VARCHAR2(256)     NOT NULL,
    EXPORT_SYSTEM_VALUES          NUMBER(1, 0)      NOT NULL,
    EXPORT_AFTER_DTM              DATE,
    DEFAULT_ISSUE_USER_SID        NUMBER(10, 0),
    ORPHAN_COUNT                  NUMBER(10, 0),
    MATCHED_COUNT                 NUMBER(10, 0),
    CREATE_METERS                 NUMBER(1, 0)      NOT NULL,
    AUTOMATED_IMPORT_CLASS_SID    NUMBER(10, 0),
    HOLDING_REGION_SID            NUMBER(10, 0),
    METER_DATE_FORMAT             VARCHAR2(255),
    PROCESS_BODY                  NUMBER(1, 0)      NOT NULL,
    PROC_USE_REMOTE_SERVICE       NUMBER(1)         NOT NULL,
    CHECK (EXPORT_SYSTEM_VALUES IN(0,1)),
    CONSTRAINT CK_PROC_USE_REMOTE_SERVICE CHECK (PROC_USE_REMOTE_SERVICE IN (0,1)),
    CONSTRAINT PK_METER_RAW_DATA_SOURCE PRIMARY KEY (CSRIMP_SESSION_ID, RAW_DATA_SOURCE_ID),
    CONSTRAINT FK_METER_RAW_DATA_SRC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.METER_RAW_DATA_STATUS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    STATUS_ID           NUMBER(10, 0)    NOT NULL,
    DESCRIPTION         VARCHAR2(256)    NOT NULL,
    NEEDS_PROCESSING    NUMBER(1, 0)     NOT NULL,
    CHECK (NEEDS_PROCESSING IN(0,1)),
    CONSTRAINT PK_METER_RAW_DATA_STATUS PRIMARY KEY (CSRIMP_SESSION_ID, STATUS_ID),
    CONSTRAINT FK_METER_RAW_DATA_STATUS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.METER_READING (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID             NUMBER(10, 0)     NOT NULL,
    METER_READING_ID       NUMBER(10, 0)     NOT NULL,
    START_DTM              DATE              NOT NULL,
    END_DTM                DATE,
    VAL_NUMBER             NUMBER(24, 10),
    ENTERED_BY_USER_SID    NUMBER(10, 0)     NOT NULL,
    ENTERED_DTM            DATE              NOT NULL,
    NOTE                   VARCHAR2(4000),
    REFERENCE              VARCHAR2(1024),
    COST                   NUMBER(24, 10),
    DEMAND                 NUMBER(24, 10),
    METER_DOCUMENT_ID      NUMBER(10, 0),
    CREATED_INVOICE_ID     NUMBER(10, 0),
    METER_SOURCE_TYPE_ID   NUMBER(10, 0)	NOT NULL,
    REQ_APPROVAL			NUMBER(1)		NOT NULL,
	ACTIVE					NUMBER(1)		NOT NULL,
	IS_DELETE				NUMBER(1)		NOT NULL,
	REPLACES_READING_ID		NUMBER(10),
	APPROVED_DTM			DATE,
	APPROVED_BY_SID			NUMBER(10),
	FLOW_ITEM_ID			NUMBER(10),
	BASELINE_VAL			NUMBER(24, 10),
    PM_READING_ID           NUMBER(10, 0),
    IS_ESTIMATE             NUMBER(1, 0)    NOT NULL,
	CHECK (REQ_APPROVAL IN(0,1)),
	CHECK (ACTIVE IN(0,1)),
	CHECK (IS_DELETE IN(0,1)),
    CONSTRAINT PK_METER_READING PRIMARY KEY (CSRIMP_SESSION_ID, METER_READING_ID),
    CONSTRAINT FK_METER_READING_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_SOURCE_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID           NUMBER(10, 0)     			NOT NULL,
    METER_INPUT_ID       NUMBER(10, 0)              NOT NULL,
    PRIORITY             NUMBER(10, 0)              NOT NULL,
    START_DTM            TIMESTAMP WITH TIME ZONE   NOT NULL,
    END_DTM              TIMESTAMP WITH TIME ZONE,
    METER_RAW_DATA_ID    NUMBER(10, 0),
    RAW_UOM              VARCHAR2(256),
    RAW_CONSUMPTION      NUMBER(24, 10)				NOT NULL,
    CONSUMPTION          NUMBER(24, 10)    			NOT NULL,
    NOTE                 VARCHAR2(4000),
    STATEMENT_ID         VARCHAR2(256)
);

CREATE TABLE CSRIMP.METER_READING_DATA(
    CSRIMP_SESSION_ID    NUMBER(10, 0)     			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID           NUMBER(10, 0)     			NOT NULL,
    METER_INPUT_ID       NUMBER(10, 0)              NOT NULL,
    PRIORITY             NUMBER(10, 0)              NOT NULL,
    READING_DTM          TIMESTAMP WITH TIME ZONE	NOT NULL,
    METER_RAW_DATA_ID    NUMBER(10, 0),
    RAW_UOM              VARCHAR2(256),
    RAW_VAL              NUMBER(24, 10)				NOT NULL,
    VAL                  NUMBER(24, 10),
    NOTE                 VARCHAR2(4000)
);

CREATE TABLE CSRIMP.METER_SOURCE_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_SOURCE_TYPE_ID       NUMBER(10, 0)    NOT NULL,
    NAME                       VARCHAR2(256)    NOT NULL,
    DESCRIPTION                VARCHAR2(512)    NOT NULL,
    ARBITRARY_PERIOD           NUMBER(1, 0)     NOT NULL,
    ADD_INVOICE_DATA           NUMBER(1, 0)     NOT NULL,
    SHOW_IN_METER_LIST         NUMBER(1, 0)     NOT NULL,
	IS_CALCULATED_SUB_METER	   NUMBER(1)	    NOT NULL,
	DESCENDING				   NUMBER(1)	    NOT NULL,
	ALLOW_RESET				   NUMBER(1)	    NOT NULL,
    ALLOW_NULL_START_DTM       NUMBER(1)        NOT NULL,
    CHECK (ARBITRARY_PERIOD IN (0,1)),
    CHECK (ADD_INVOICE_DATA IN (0,1)),
    CHECK (SHOW_IN_METER_LIST IN(0,1)),
	CHECK (IS_CALCULATED_SUB_METER IN(0,1)),
	CHECK (DESCENDING IN(0,1)),
	CHECK (ALLOW_RESET IN(0,1)),
    CONSTRAINT PK_METER_SOURCE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, METER_SOURCE_TYPE_ID),
    CONSTRAINT FK_METER_SOURCE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.meter_tab (
    csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	plugin_id						NUMBER(10) NOT NULL,
	plugin_type_id					NUMBER(10) NOT NULL,
	pos								NUMBER(10) NOT NULL,
	tab_label						VARCHAR2(50),
	CONSTRAINT pk_meter_tab PRIMARY KEY (csrimp_session_id, plugin_id),
	CONSTRAINT chk_meter_tab_plugin_type CHECK (plugin_type_id = 16),
    CONSTRAINT fk_meter_tab_is FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.meter_tab_group (
    csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	plugin_id						NUMBER (10) NOT NULL,
	group_sid						NUMBER (10),
	role_sid						NUMBER (10),
	CONSTRAINT pk_meter_tab_group PRIMARY KEY (csrimp_session_id, plugin_id, group_sid),
	CONSTRAINT chk_meter_tab_group_grp_role CHECK ((group_sid IS NULL AND role_sid IS NOT NULL) OR (group_sid IS NOT NULL AND role_sid IS NULL)),
    CONSTRAINT fk_meter_tab_group_is FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_UTILITY_CONTRACT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID             NUMBER(10, 0)    NOT NULL,
    UTILITY_CONTRACT_ID    NUMBER(10, 0)    NOT NULL,
    ACTIVE                 NUMBER(1, 0)     NOT NULL,
    CHECK (ACTIVE IN (0,1)),
    CONSTRAINT PK_METER_UTILITY_CONTRACT PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, UTILITY_CONTRACT_ID),
    CONSTRAINT FK_METER_UTILITY_CONTRACT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.UTILITY_CONTRACT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UTILITY_CONTRACT_ID    NUMBER(10, 0)    NOT NULL,
    UTILITY_SUPPLIER_ID    NUMBER(10, 0)    NOT NULL,
    ACCOUNT_REF            VARCHAR2(256)    NOT NULL,
    FROM_DTM               DATE,
    TO_DTM                 DATE,
    ALERT_WHEN_DUE         NUMBER(1, 0)     NOT NULL,
    FILE_DATA              BLOB,
    FILE_MIME_TYPE         VARCHAR2(256),
    FILE_NAME              VARCHAR2(256),
    CREATED_BY_SID         NUMBER(10, 0),
    CONSTRAINT PK_UTILITY_CONTRACT PRIMARY KEY (CSRIMP_SESSION_ID, UTILITY_CONTRACT_ID),
    CONSTRAINT FK_UTILITY_CONTRACT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.UTILITY_INVOICE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UTILITY_INVOICE_ID         NUMBER(10, 0)     NOT NULL,
    UTILITY_CONTRACT_ID        NUMBER(10, 0)     NOT NULL,
    REFERENCE                  VARCHAR2(256)     NOT NULL,
    INVOICE_DTM                DATE              NOT NULL,
    COST_VALUE                 NUMBER(24, 16)    NOT NULL,
    COST_MEASURE_SID           NUMBER(10, 0),
    COST_CONV_ID               NUMBER(10, 0),
    CONSUMPTION                NUMBER(10, 0),
    CONSUMPTION_CONV_ID        NUMBER(10, 0),
    FILE_DATA                  BLOB,
    FILE_MIME_TYPE             VARCHAR2(256),
    FILE_NAME                  VARCHAR2(256),
    VERIFIED_BY_SID            NUMBER(10, 0),
    VERIFIED_DTM               DATE,
    CONSUMPTION_MEASURE_SID    NUMBER(10, 0),
    CONSTRAINT PK_UTILITY_INVOICE PRIMARY KEY (CSRIMP_SESSION_ID, UTILITY_INVOICE_ID),
    CONSTRAINT FK_UTILITY_INVOICE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.UTILITY_SUPPLIER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UTILITY_SUPPLIER_ID    NUMBER(10, 0)     NOT NULL,
    SUPPLIER_NAME          VARCHAR2(1024)    NOT NULL,
    CONTACT_DETAILS        VARCHAR2(4000),
    CONSTRAINT PK_UTILITY_SUPPLIER PRIMARY KEY (CSRIMP_SESSION_ID, UTILITY_SUPPLIER_ID),
    CONSTRAINT FK_UTILITY_SUPPLIER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_XML_OPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RAW_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    DATA_TYPE             VARCHAR2(256)    NOT NULL,
    XSLT                  SYS.XMLType      NOT NULL,
    CONSTRAINT PK_METER_XML_OPTION PRIMARY KEY (CSRIMP_SESSION_ID, RAW_DATA_SOURCE_ID),
    CONSTRAINT FK_METER_XML_OPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_METER_ALARM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID            NUMBER(10, 0)    NOT NULL,
    INHERITED_FROM_SID    NUMBER(10, 0)    NOT NULL,
    METER_ALARM_ID        NUMBER(10, 0)    NOT NULL,
    IGNORE                NUMBER(1, 0)     NOT NULL,
    IGNORE_CHILDREN       NUMBER(1, 0)     NOT NULL,
    CHECK (IGNORE IN(0,1)),
    CHECK (IGNORE_CHILDREN IN(0,1)),
    CONSTRAINT PK_REGION_METER_ALARM PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, METER_ALARM_ID),
    CONSTRAINT FK_REGION_METER_ALARM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_PROC_DOC (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    DOC_ID        NUMBER(10, 0)    NOT NULL,
    INHERITED     NUMBER(1, 0)     NOT NULL,
    CHECK (INHERITED IN (0,1)),
    CONSTRAINT PK_REGION_PROC_DOC PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, DOC_ID),
    CONSTRAINT FK_REGION_PROC_DOC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_PROC_FILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID           NUMBER(10, 0)    NOT NULL,
    METER_DOCUMENT_ID    NUMBER(10, 0)    NOT NULL,
    INHERITED            NUMBER(1, 0)     NOT NULL,
    CHECK (INHERITED IN (0,1)),
    CONSTRAINT PK_REGION_PROC_FILE PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, METER_DOCUMENT_ID),
    CONSTRAINT FK_REGION_PROC_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_EVENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    EVENT_ID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_REGION_EVENT PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, EVENT_ID),
    CONSTRAINT FK_REGION_EVENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_DASHBOARD(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_DASHBOARD_SID   		NUMBER(10, 0)    NOT NULL,
    LABEL                    		VARCHAR2(255)    NOT NULL,
    FLOW_SID                 		NUMBER(10, 0),
    TPL_REPORT_SID            		NUMBER(10, 0),
    IS_MULTI_REGION           		NUMBER(1, 0)     NOT NULL,
	START_DTM                    	DATE NOT NULL,
    END_DTM                     	DATE NOT NULL,
	ACTIVE_PERIOD_SCENARIO_RUN_SID	NUMBER(10, 0),
	SIGNED_OFF_SCENARIO_RUN_SID 	NUMBER(10, 0),
	INSTANCE_CREATION_SCHEDULE 		XMLTYPE,
	PERIOD_SET_ID 					NUMBER(10) 		NOT NULL,
	PERIOD_INTERVAL_ID				NUMBER(10) 		NOT NULL,
	PUBLISH_DOC_FOLDER_SID 			NUMBER(10, 0),
	SOURCE_SCENARIO_RUN_SID			NUMBER(10, 0),
    CONSTRAINT CHK_APPR_DASH_MULTI_REG CHECK (IS_MULTI_REGION IN (0,1)),
    CONSTRAINT PK_APPROVAL_DASHBOARD PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_SID),
    CONSTRAINT UK_FL_APPROVAL_DASHBOARD  UNIQUE (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_SID, FLOW_SID),
    CONSTRAINT UK_TPL_APPROVAL_DASHBOARD  UNIQUE (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_SID, TPL_REPORT_SID),
    CONSTRAINT FK_APPROVAL_DASHBOARD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_DASHBOARD_ALERT_TYPE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_DASHBOARD_SID    NUMBER(10, 0)    NOT NULL,
    CUSTOMER_ALERT_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_SID                  NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPR_DASH_ALERT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_SID, CUSTOMER_ALERT_TYPE_ID, FLOW_SID),
    CONSTRAINT FK_APPR_DASH_AlRT_TYP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_DASHBOARD_INSTANCE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DASHBOARD_INSTANCE_ID     NUMBER(10, 0)    NOT NULL,
    APPROVAL_DASHBOARD_SID    NUMBER(10, 0)    NOT NULL,
    REGION_SID                NUMBER(10, 0)    NOT NULL,
    START_DTM                 DATE             NOT NULL,
    END_DTM                   DATE             NOT NULL,
    TPL_REPORT_SID            NUMBER(10, 0),
	LAST_REFRESHED_DTM        DATE,
    IS_LOCKED                 NUMBER(1, 0)     NOT NULL,
	IS_SIGNED_OFF 			  NUMBER(1) 	   NOT NULL,
    CONSTRAINT PK_APPROVAL_DASHBOARD_INSTANCE PRIMARY KEY (CSRIMP_SESSION_ID, DASHBOARD_INSTANCE_ID),
    CONSTRAINT UK_APPR_DASHBOARD_INSTANCE  UNIQUE (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_SID, REGION_SID, START_DTM, END_DTM),
    CONSTRAINT UK_TPL_APPR_DASHBD_INSTANCE  UNIQUE (CSRIMP_SESSION_ID, DASHBOARD_INSTANCE_ID, TPL_REPORT_SID),
    CONSTRAINT FK_APPR_DASH_INSTANCE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_DASHBOARD_REGION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_DASHBOARD_SID    NUMBER(10, 0)    NOT NULL,
    REGION_SID                NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_DASHBOARD_REGION PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_SID, REGION_SID),
    CONSTRAINT FK_APPR_DASH_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_DASHBOARD_TAB(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_DASHBOARD_SID    NUMBER(10, 0)    NOT NULL,
    TAB_ID                    NUMBER(10, 0)    NOT NULL,
    POS                       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_DASHBOARD_TAB PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_SID, TAB_ID),
    CONSTRAINT FK_APPR_DASH_TAB_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_DASHBOARD_TPL_TAG(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DASHBOARD_INSTANCE_ID    NUMBER(10, 0)    NOT NULL,
    TPL_REPORT_SID           NUMBER(10, 0)    NOT NULL,
    TAG                      VARCHAR2(255)    NOT NULL,
    NOTE                     CLOB,
    CONSTRAINT PK_APPR_DASHBD_TPL_TAG PRIMARY KEY (CSRIMP_SESSION_ID, DASHBOARD_INSTANCE_ID, TPL_REPORT_SID, TAG),
    CONSTRAINT FK_APPR_DASH_TPL_tAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_DASHBOARD_VAL(
	CSRIMP_SESSION_ID			 NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_DASHBOARD_VAL_ID    NUMBER(10, 0)     NOT NULL,
    APPROVAL_DASHBOARD_SID       NUMBER(10, 0)     NOT NULL,
    DASHBOARD_INSTANCE_ID        NUMBER(10, 0)     NOT NULL,
    IND_SID                      NUMBER(10, 0)     NOT NULL,
    START_DTM                    DATE              NOT NULL,
    END_DTM                      DATE              NOT NULL,
    VAL_NUMBER                   NUMBER(24, 10)    NOT NULL,
	YTD_VAL_NUMBER               NUMBER(24, 10)    NOT NULL,
	NOTE						 VARCHAR2(2048),
	NOTE_ADDED_BY_SID			 NUMBER(10),
	NOTE_ADDED_DTM				 DATE,
	IS_ESTIMATED_DATA 			 NUMBER(1)		   NOT NULL,
    CONSTRAINT PK_APPROVAL_DASHBOARD_VAL PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_VAL_ID),
	CONSTRAINT FK_APPROVAL_DASHBOARD_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.APPROVAL_DASHBOARD_IND(
    CSRIMP_SESSION_ID		  NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_DASHBOARD_SID    NUMBER(10, 0)    NOT NULL,
    IND_SID                   NUMBER(10, 0)    NOT NULL,
	DEACTIVATED_DTM			  DATE,
	ALLOW_ESTIMATED_DATA 	  NUMBER(1) 	   NOT NULL,
	IS_HIDDEN				  NUMBER(1)		   NOT NULL,
	POS 					  NUMBER(10) 	   NOT NULL,
    CONSTRAINT PK_APPROVAL_DASHBOARD_IND PRIMARY KEY (CSRIMP_SESSION_ID, APPROVAL_DASHBOARD_SID, IND_SID),
	CONSTRAINT FK_APPROVAL_DASHBOARD_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.BATCH_JOB_APPROVAL_DASH_VALS (
    CSRIMP_SESSION_ID			 NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DASHBOARD_INSTANCE_ID        NUMBER(10, 0)     NOT NULL,
    BATCH_JOB_ID                 NUMBER(10, 0)     NOT NULL,
	CONSTRAINT PK_BATCH_JOB_APPR_DASH_VALS PRIMARY KEY (CSRIMP_SESSION_ID, DASHBOARD_INSTANCE_ID, BATCH_JOB_ID),
	CONSTRAINT FK_BATCH_JOB_APPR_DASH_VALS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_PORTLET(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOMER_PORTLET_SID    NUMBER(10, 0)    NOT NULL,
    PORTLET_ID              NUMBER(10, 0),
    DEFAULT_STATE           CLOB,
    PORTAL_GROUP            VARCHAR2(50),
    CONSTRAINT PK_CUSTOMER_PORTLET PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_PORTLET_SID),
    CONSTRAINT FK_CUSTOMER_PORTLET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.APPROVAL_NOTE_PORTLET_NOTE (
  CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
  VERSION                   NUMBER(10, 0)     NOT NULL,
  TAB_PORTLET_ID            NUMBER(10, 0)     NOT NULL,
  APPROVAL_DASHBOARD_SID    NUMBER(10, 0)     NOT NULL,
  DASHBOARD_INSTANCE_ID     NUMBER(10, 0)     NOT NULL,
  REGION_SID                NUMBER(10, 0)     NOT NULL,
  NOTE                      VARCHAR2(1024),
  ADDED_DTM                 DATE,
  ADDED_BY_SID              NUMBER(10, 0)     NOT NULL,
  CONSTRAINT PK_APPR_NOTE_PORTLET_NOTE PRIMARY KEY (CSRIMP_SESSION_ID, VERSION, TAB_PORTLET_ID, APPROVAL_DASHBOARD_SID, DASHBOARD_INSTANCE_ID, REGION_SID),
  CONSTRAINT FK_APPR_NOTE_PORTLET_NOTE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.TPL_REPORT_TAG_APPROVAL_NOTE (
  CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
  TPL_REPORT_TAG_APP_NOTE_ID  NUMBER(10)        NOT NULL,
  TAB_PORTLET_ID              NUMBER(10, 0)     NOT NULL,
  APPROVAL_DASHBOARD_SID      NUMBER(10, 0)     NOT NULL,
  CONSTRAINT PK_TPL_REPORT_TAG_APP_NOTE PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_APP_NOTE_ID),
  CONSTRAINT FK_TPL_REPORT_TAG_APP_NOTE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.TPL_REPORT_TAG_APPROVAL_MATRIX (
  CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
  TPL_REPORT_TAG_APP_MATRIX_ID  NUMBER(10)        NOT NULL,
  APPROVAL_DASHBOARD_SID      	NUMBER(10, 0)     NOT NULL,
  CONSTRAINT PK_TPL_REP_TAG_APP_MATRIX PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_APP_MATRIX_ID),
  CONSTRAINT FK_TPL_REP_TAG_APP_MATRIX_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIDE_PORTLET (
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PORTLET_ID          NUMBER(10)          NOT NULL,
    CONSTRAINT PK_HIDE_PORTLET PRIMARY KEY (CSRIMP_SESSION_ID, PORTLET_ID),
	CONSTRAINT FK_HIDE_PORTLET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAB(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_ID          NUMBER(10, 0)    NOT NULL,
    LAYOUT          NUMBER(10, 0)    NOT NULL,
    NAME            VARCHAR2(255)    NOT NULL,
    IS_SHARED       NUMBER(1, 0)     NOT NULL,
    PORTAL_GROUP    VARCHAR2(50),
    OVERRIDE_POS    NUMBER(10, 0),
    IS_HIDEABLE     NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_TAB PRIMARY KEY (CSRIMP_SESSION_ID, TAB_ID),
    CONSTRAINT FK_TAB_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAB_GROUP(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_ID       NUMBER(10, 0)    NOT NULL,
    GROUP_SID    NUMBER(10, 0)    NOT NULL,
    POS          NUMBER(10, 0),
    CONSTRAINT PK_TAB_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, TAB_ID, GROUP_SID),
    CONSTRAINT FK_TAB_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAB_PORTLET(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_PORTLET_ID          NUMBER(10, 0)    NOT NULL,
    TAB_ID                  NUMBER(10, 0)    NOT NULL,
    COLUMN_NUM              NUMBER(10, 0)    NOT NULL,
    POS                     NUMBER(10, 0)    NOT NULL,
    STATE                   CLOB,
    CUSTOMER_PORTLET_SID    NUMBER(10, 0)    NOT NULL,
    ADDED_BY_USER_SID       NUMBER(10, 0),
    ADDED_DTM               DATE             NOT NULL,
    CONSTRAINT PK_TAB_PORTLET PRIMARY KEY (CSRIMP_SESSION_ID, TAB_PORTLET_ID),
    CONSTRAINT FK_TAB_PORTLET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PORTAL_DASHBOARD(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PORTAL_SID              NUMBER(10, 0)    NOT NULL,
    PORTAL_GROUP            VARCHAR2(50)     NOT NULL,
    MENU_SID                NUMBER(10, 0),
    MESSAGE                 VARCHAR2(2048),
    CONSTRAINT PK_PORTAL_DASHBOARD PRIMARY KEY (CSRIMP_SESSION_ID, PORTAL_SID),
    CONSTRAINT FK_PORTAL_DASHBOARD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.RSS_CACHE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RSS_URL         VARCHAR2(1024)    NOT NULL,
    LAST_UPDATED    DATE,
    XML             SYS.XMLType,
    LAST_ERROR      VARCHAR2(2040),
    ERROR_COUNT     NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_RSS_CACHE PRIMARY KEY (CSRIMP_SESSION_ID, RSS_URL),
    CONSTRAINT FK_RSS_CACHE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAB_PORTLET_RSS_FEED(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_PORTLET_ID    NUMBER(10, 0)     NOT NULL,
    RSS_URL           VARCHAR2(1024)    NOT NULL,
    CONSTRAINT PK_TAB_PORTLET_RSS_FEED PRIMARY KEY (CSRIMP_SESSION_ID, TAB_PORTLET_ID, RSS_URL),
    CONSTRAINT FK_TAB_PORTLET_RSS_FEED_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAB_PORTLET_USER_REGION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_PORTLET_ID    NUMBER(10, 0)    NOT NULL,
    CSR_USER_SID      NUMBER(10, 0)    NOT NULL,
    REGION_SID        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_TAB_PORTLET_USER_REGION PRIMARY KEY (CSRIMP_SESSION_ID, TAB_PORTLET_ID, CSR_USER_SID, REGION_SID),
    CONSTRAINT FK_TAB_PRTLT_USR_REG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAB_USER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_ID       NUMBER(10, 0)    NOT NULL,
    USER_SID     NUMBER(10, 0)    NOT NULL,
    POS          NUMBER(10, 0)    NOT NULL,
    IS_OWNER     NUMBER(1, 0)     NOT NULL,
    IS_HIDDEN    NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_TAB_USER PRIMARY KEY (CSRIMP_SESSION_ID, TAB_ID, USER_SID),
    CONSTRAINT FK_TAB_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_IMG(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    KEY          VARCHAR2(255)    NOT NULL,
    PATH         VARCHAR2(255),
    IMAGE        BLOB,
    FILENAME     VARCHAR2(255),
    MIME_TYPE    VARCHAR2(255),
    CONSTRAINT PK_TPL_IMG PRIMARY KEY (CSRIMP_SESSION_ID, KEY),
    CONSTRAINT FK_TPL_IMG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REP_CUST_TAG_TYPE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REP_CUST_TAG_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    CS_CLASS                    VARCHAR2(255)    NOT NULL,
    JS_INCLUDE                  VARCHAR2(255),
    JS_CLASS                    VARCHAR2(255)    NOT NULL,
    HELPER_PKG                  VARCHAR2(255),
    DESCRIPTION                 VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_TPL_REP_CUST_TAG_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REP_CUST_TAG_TYPE_ID),
    CONSTRAINT FK_TPL_REP_CUST_TAG_TYP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_SID    				NUMBER(10, 0)     NOT NULL,
	PARENT_SID        				NUMBER(10, 0)     NOT NULL,
    NAME              				VARCHAR2(256)     NOT NULL,
    DESCRIPTION       				VARCHAR2(1024),
    WORD_DOC          				BLOB              NOT NULL,
    FILENAME          				VARCHAR2(256)     NOT NULL,
    THUMB_IMG         				BLOB,
    PERIOD_SET_ID					NUMBER(10),
    PERIOD_INTERVAL_ID				NUMBER(10),
    CONSTRAINT PK_TPL_REPORT PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_SID),
    CONSTRAINT FK_TPL_REPORT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_TAG(
    CSRIMP_SESSION_ID               NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_SID                    NUMBER(10, 0)    NOT NULL,
    TAG                               VARCHAR2(255)    NOT NULL,
    TAG_TYPE                          NUMBER(10, 0)    NOT NULL,
    TPL_REPORT_TAG_IND_ID             NUMBER(10, 0),
    TPL_REPORT_TAG_EVAL_ID            NUMBER(10, 0),
    TPL_REPORT_TAG_DATAVIEW_ID        NUMBER(10, 0),
    TPL_REPORT_TAG_LOGGING_FORM_ID    NUMBER(10, 0),
    TPL_REP_CUST_TAG_TYPE_ID          NUMBER(10, 0),
    TPL_REPORT_TAG_TEXT_ID            NUMBER(10, 0),
    TPL_REPORT_NON_COMPL_ID           NUMBER(10, 0),
    TPL_REPORT_TAG_APP_NOTE_ID        NUMBER(10, 0),
    TPL_REPORT_TAG_APP_MATRIX_ID      NUMBER(10, 0),
    TPL_REPORT_TAG_REG_DATA_ID        NUMBER(10, 0),
    TPL_REPORT_TAG_QC_ID              NUMBER(10, 0),
    CONSTRAINT CT_TPL_REPORT_TAG CHECK (
        (TAG_TYPE IN (1,4,5,14) AND TPL_REPORT_TAG_IND_ID IS NOT NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = 6 AND TPL_REPORT_TAG_EVAL_ID IS NOT NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE IN (2,3,101) AND TPL_REPORT_TAG_DATAVIEW_ID IS NOT NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = 7 AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NOT NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = 8 AND TPL_REP_CUST_TAG_TYPE_ID IS NOT NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = 9 AND TPL_REPORT_TAG_TEXT_ID IS NOT NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = -1 AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = 10 AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NOT NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = 11 AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NOT NULL)
        OR (TAG_TYPE = 102 AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NOT NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = 103 AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NOT NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
        OR (TAG_TYPE = 12 AND TPL_REPORT_TAG_QC_ID IS NOT NULL AND TPL_REPORT_TAG_DATAVIEW_ID IS NULL AND TPL_REPORT_TAG_IND_ID IS NULL AND TPL_REPORT_TAG_EVAL_ID IS NULL AND TPL_REPORT_TAG_LOGGING_FORM_ID IS NULL AND TPL_REP_CUST_TAG_TYPE_ID IS NULL AND TPL_REPORT_TAG_TEXT_ID IS NULL AND TPL_REPORT_NON_COMPL_ID IS NULL AND TPL_REPORT_TAG_APP_NOTE_ID IS NULL AND TPL_REPORT_TAG_APP_MATRIX_ID IS NULL AND TPL_REPORT_TAG_REG_DATA_ID IS NULL)
    ),
    CONSTRAINT PK_TPL_REPORT_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_SID, TAG),
    CONSTRAINT FK_TPL_REPORT_TAG_IS FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_TAG_DATAVIEW(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_TAG_DATAVIEW_ID    NUMBER(10, 0)    NOT NULL,
    DATAVIEW_SID                  NUMBER(10, 0),
    MONTH_OFFSET                  NUMBER(10, 0)    NOT NULL,
    MONTH_DURATION                NUMBER(10, 0)    NOT NULL,
    HIDE_IF_EMPTY                 NUMBER(1)        NOT NULL,
    SPLIT_TABLE_BY_COLUMNS        NUMBER(10)       NOT NULL,
	PERIOD_SET_ID				  NUMBER(10),
	PERIOD_INTERVAL_ID			  NUMBER(10),
    SAVED_FILTER_SID              NUMBER(10),
    FILTER_RESULT_MODE            NUMBER(10),
    AGGREGATE_TYPE_ID             NUMBER(10),
    APPROVAL_DASHBOARD_SID	 	  NUMBER(10),
	IND_TAG 					  NUMBER(10),
	CONSTRAINT PK_TPL_REPORT_TAG_DATAVIEW PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_DATAVIEW_ID),
    CONSTRAINT AK_TPL_RPT_TAG_DV  UNIQUE (CSRIMP_SESSION_ID, TPL_REPORT_TAG_DATAVIEW_ID, DATAVIEW_SID),
    CONSTRAINT CHK_REPORT_FIELDS_SET CHECK ((DATAVIEW_SID IS NOT NULL AND SAVED_FILTER_SID IS NULL) OR (DATAVIEW_SID IS NULL AND SAVED_FILTER_SID IS NOT NULL)),
    CONSTRAINT CHK_FILTER_REPORT_FIELDS_SET CHECK (SAVED_FILTER_SID IS NULL OR FILTER_RESULT_MODE IS NOT NULL),
    CONSTRAINT CHK_FILTER_RESULT_MODE CHECK (FILTER_RESULT_MODE IN (2, 3, 4, 5, 6)),
    CONSTRAINT FK_TPL_REPORT_TAV_DV_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_TAG_DV_REGION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_TAG_DATAVIEW_ID    NUMBER(10, 0)    NOT NULL,
    DATAVIEW_SID                  NUMBER(10, 0)    NOT NULL,
    REGION_SID                    NUMBER(10, 0)    NOT NULL,
    TPL_REGION_TYPE_ID            NUMBER(10, 0)    NOT NULL,
    FILTER_BY_TAG                 NUMBER(10, 0),
    CONSTRAINT PK_TPL_RPT_RAG_RV_REGION PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_DATAVIEW_ID, DATAVIEW_SID, REGION_SID),
    CONSTRAINT FK_TPL_REPORT_TAG_DV_REG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_TAG_EVAL(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_TAG_EVAL_ID    NUMBER(10, 0)     NOT NULL,
    IF_TRUE                   VARCHAR2(2000)    NOT NULL,
    IF_FALSE                  VARCHAR2(2000)    NOT NULL,
    ALL_MUST_BE_TRUE          NUMBER(1, 0)      NOT NULL,
    MONTH_OFFSET              NUMBER(10, 0)     NOT NULL,
	PERIOD_SET_ID					NUMBER(10),
	PERIOD_INTERVAL_ID				NUMBER(10),
    CONSTRAINT PK_TPL_REPORT_TAG_EVAL PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_EVAL_ID),
    CONSTRAINT FK_TPL_REPORT_TAG_EVAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_TAG_EVAL_COND(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_TAG_EVAL_ID    NUMBER(10, 0)     NOT NULL,
    LEFT_IND_SID              NUMBER(10, 0)     NOT NULL,
    OPERATOR                  VARCHAR2(2)       NOT NULL,
    RIGHT_VALUE               NUMBER(24, 10),
    RIGHT_IND_SID             NUMBER(10, 0),
    CONSTRAINT CK_RPT_TG_EVL_COND_COMP_NN CHECK ((RIGHT_VALUE IS NOT NULL AND RIGHT_IND_SID IS NULL) OR (RIGHT_VALUE IS NULL AND RIGHT_IND_SID IS NOT NULL) OR (RIGHT_VALUE IS NULL AND RIGHT_IND_SID IS NULL AND operator IN ('N','NN'))),
    CONSTRAINT CK_RPT_TG_EVL_OP CHECK (OPERATOR IN ('>','<','<=','>=','=','!=','N','NN')),
    CONSTRAINT FK_TPL_RPT_TAG_EVAL_COND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_TAG_IND(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_TAG_IND_ID    NUMBER(10, 0)    NOT NULL,
    IND_SID                  NUMBER(10, 0)    NOT NULL,
    MONTH_OFFSET             NUMBER(10, 0)    NOT NULL,
	PERIOD_SET_ID					NUMBER(10),
	PERIOD_INTERVAL_ID				NUMBER(10),
	MEASURE_CONVERSION_ID    NUMBER(10, 0)    NULL,
	FORMAT_MASK              VARCHAR2(255)    NULL,
	SHOW_FULL_PATH					NUMBER(1)	NOT NULL,
    CONSTRAINT PK_TPL_RPT_TAG_IND PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_IND_ID),
    CONSTRAINT CHK_TPL_RPT_TAG_IND_SFP CHECK (SHOW_FULL_PATH IN (1,0)),
    CONSTRAINT FK_TPL_RPT_TAG_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_TAG_LOGGING_FORM(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_TAG_LOGGING_FORM_ID    NUMBER(10, 0)    NOT NULL,
    TAB_SID                           NUMBER(10, 0)    NOT NULL,
    MONTH_OFFSET                      NUMBER(10, 0)    NOT NULL,
    MONTH_DURATION                    NUMBER(10, 0)    NOT NULL,
    REGION_COLUMN_NAME                VARCHAR2(30),
    TPL_REGION_TYPE_ID                NUMBER(10, 0),
    DATE_COLUMN_NAME                  VARCHAR2(30),
    FORM_SID                          NUMBER(10, 0),
    FILTER_SID                        NUMBER(10, 0),
    SAVED_FILTER_SID                  NUMBER(10, 0),
	PERIOD_SET_ID					NUMBER(10),
	PERIOD_INTERVAL_ID				NUMBER(10),
    CONSTRAINT CHK_TPL_REP_LGN_FORM_FILTER CHECK ((form_sid IS NULL AND filter_sid IS NULL) OR (form_sid IS NULL AND saved_filter_sid IS NULL) OR (saved_filter_sid IS NULL AND filter_sid IS NULL)),
    CONSTRAINT PK_TPL_REP_TAG_LOGGING_FORM PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_LOGGING_FORM_ID),
    CONSTRAINT FK_TPL_RPT_TAG_LOG_FRM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_NON_COMPL(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_NON_COMPL_ID    NUMBER(10, 0)    NOT NULL,
    TPL_REGION_TYPE_ID         NUMBER(10, 0)    NOT NULL,
    MONTH_OFFSET               NUMBER(10, 0)    NOT NULL,
    MONTH_DURATION             NUMBER(10, 0)    NOT NULL,
    TAG_ID                     NUMBER(10, 0),
	PERIOD_SET_ID					NUMBER(10),
	PERIOD_INTERVAL_ID				NUMBER(10),
    CONSTRAINT PK_TPL_REPORT_NON_COMPL PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_NON_COMPL_ID),
    CONSTRAINT FK_TPL_RPT_NON_COMPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.TPL_REPORT_TAG_TEXT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TPL_REPORT_TAG_TEXT_ID    NUMBER(10, 0)     NOT NULL,
    LABEL                     VARCHAR2(2048)    NOT NULL,
    CONSTRAINT PK_TPL_REPORT_TAG_TEXT PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_TEXT_ID),
    CONSTRAINT FK_TPL_RPT_TAG_TEXT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.tpl_report_tag_reg_data (
    csrimp_session_id               NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    tpl_report_tag_reg_data_id      NUMBER(10) NOT NULL,
    tpl_report_reg_data_type_id     NUMBER(10) NOT NULL,
    CONSTRAINT pk_tpl_report_tag_reg_data PRIMARY KEY (csrimp_session_id, tpl_report_tag_reg_data_id),
    CONSTRAINT fk_tpl_report_tag_reg_data_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.tpl_report_tag_qchart
(
    CSRIMP_SESSION_ID               NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TPL_REPORT_TAG_QCHART_ID NUMBER(10,0) NOT NULL, 
	MONTH_OFFSET NUMBER(10,0) NOT NULL, 
	MONTH_DURATION NUMBER(10,0) NOT NULL, 
	PERIOD_SET_ID NUMBER(10,0) NOT NULL, 
	PERIOD_INTERVAL_ID NUMBER(10,0) NOT NULL, 
	HIDE_IF_EMPTY NUMBER(1,0) NOT NULL, 
	SPLIT_TABLE_BY_COLUMNS NUMBER(10,0) NOT NULL, 
	SAVED_FILTER_SID NUMBER(10,0), 
    CONSTRAINT TPL_REPORT_TAG_QCHART PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_TAG_QCHART_ID),
	CONSTRAINT fk_tpl_rep_tag_qc_is FOREIGN KEY
    	(csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TPL_REPORT_VARIANT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MASTER_TEMPLATE_SID				NUMBER(10, 0)	NOT NULL,
	LANGUAGE_CODE					VARCHAR2(10)	NOT NULL,
	FILENAME						VARCHAR2(256)	NOT NULL,
	WORD_DOC						BLOB			NOT NULL,
	MIME_TYPE						VARCHAR2(255),
	CONSTRAINT PK_TPL_REPORT_VARIANT PRIMARY KEY (CSRIMP_SESSION_ID, MASTER_TEMPLATE_SID, LANGUAGE_CODE),
	CONSTRAINT FK_TPL_REPORT_VARIANT_IS FOREIGN KEY (CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION(CSRIMP_SESSION_ID) ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.TPL_REPORT_VARIANT_TAG(
	CSRIMP_SESSION_ID		NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TPL_REPORT_SID			NUMBER(10, 0)	NOT NULL,
	LANGUAGE_CODE			VARCHAR2(10)	NOT NULL,
	TAG						VARCHAR2(256)	NOT NULL,
	CONSTRAINT PK_TPL_REPORT_VARIANT_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TPL_REPORT_SID, LANGUAGE_CODE, TAG),
	CONSTRAINT FK_TPL_REPORT_VARIANT_TAG_IS FOREIGN KEY (CSRIMP_SESSION_ID) 
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.TRASH(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TRASH_SID              NUMBER(10, 0)    NOT NULL,
    TRASH_CAN_SID          NUMBER(10, 0)    NOT NULL,
    TRASHED_BY_SID         NUMBER(10, 0),
    TRASHED_DTM            DATE             NOT NULL,
    PREVIOUS_PARENT_SID    NUMBER(10, 0)    NOT NULL,
    DESCRIPTION            VARCHAR2(4000)   NOT NULL,
    SO_NAME                VARCHAR2(255),
    CONSTRAINT PK_TRASH PRIMARY KEY (CSRIMP_SESSION_ID, TRASH_SID),
    CONSTRAINT FK_TRASH_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_SETTING(
	CSRIMP_SESSION_ID				 NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CATEGORY       VARCHAR2(100)     NOT NULL,
    SETTING        VARCHAR2(100)     NOT NULL,
    DESCRIPTION    VARCHAR2(1000)    NOT NULL,
    DATA_TYPE      VARCHAR2(10)      NOT NULL,
    CONSTRAINT CHK_US_CATEGORY_IS_VALID CHECK (CATEGORY = UPPER(TRIM(CATEGORY))),
    CONSTRAINT CHK_US_SETTING_IS_VALID CHECK (SETTING = TRIM(SETTING)),
    CONSTRAINT CHK_US_DATA_TYPE_IS_VALID CHECK (DATA_TYPE in ('STRING', 'NUMBER', 'BOOLEAN')),
    CONSTRAINT PK_USER_SETTING PRIMARY KEY (CSRIMP_SESSION_ID, CATEGORY, SETTING),
    CONSTRAINT FK_USER_SETTING_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_SETTING_ENTRY(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CSR_USER_SID      NUMBER(10, 0)     NOT NULL,
    CATEGORY          VARCHAR2(100)     NOT NULL,
    SETTING           VARCHAR2(100)     NOT NULL,
    TAB_PORTLET_ID    NUMBER(10, 0),
    VALUE             VARCHAR2(4000)    NOT NULL,
    CONSTRAINT UK_USER_SETTING_ENTRY  UNIQUE (CSRIMP_SESSION_ID, CSR_USER_SID, CATEGORY, SETTING, TAB_PORTLET_ID),
    CONSTRAINT FK_USER_SETTING_ENTRY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AGGREGATE_IND_GROUP(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    AGGREGATE_IND_GROUP_ID    NUMBER(10, 0)    NOT NULL,
    HELPER_PROC               VARCHAR2(255)    NOT NULL,
	HELPER_PROC_ARGS          VARCHAR2(4000)   NOT NULL,
    NAME                      VARCHAR2(64),
	JS_INCLUDE				  VARCHAR2(255),
    RUN_DAILY			 	  NUMBER(1) 	   NOT NULL,
	SOURCE_URL				  VARCHAR2(1027),
    LABEL 					  VARCHAR2(1024)   NOT NULL,
	RUN_FOR_CURRENT_MONTH	  NUMBER(1)		   NOT NULL,
    LOOKUP_KEY                VARCHAR2(255),
	DATA_BUCKET_SID           NUMBER(10, 0),
	DATA_BUCKET_FETCH_SP      VARCHAR2(255),
    CONSTRAINT PK_AGGREGATE_IND_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, AGGREGATE_IND_GROUP_ID),
    CONSTRAINT FK_AGGREGATE_IND_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE,
    CONSTRAINT CHK_AGGR_IND_GRP_RUN_DAILY CHECK (RUN_DAILY IN (0,1)),
	CONSTRAINT CK_AGG_IND_GROUP_MONTHLY CHECK (RUN_FOR_CURRENT_MONTH IN (0, 1))
);

CREATE TABLE CSRIMP.AGGREGATE_IND_GROUP_MEMBER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    AGGREGATE_IND_GROUP_ID    NUMBER(10, 0)    NOT NULL,
    IND_SID                   NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_AGGREGATE_IND_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, AGGREGATE_IND_GROUP_ID, IND_SID),
    CONSTRAINT UC_AGG_IND_GRP_MBR_IND  UNIQUE (CSRIMP_SESSION_ID, IND_SID),
    CONSTRAINT FK_AGGR_IND_GROUP_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AGGREGATE_IND_GROUP_AUDIT_LOG (
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    AGGREGATE_IND_GROUP_ID			NUMBER(10, 0)     NOT NULL,
    CHANGE_DTM						DATE              NOT NULL,
    CHANGE_DESCRIPTION				VARCHAR2(4000)    NOT NULL,
    CHANGED_BY_USER_SID				NUMBER(10, 0)     NOT NULL,
    CONSTRAINT FK_AGGR_IND_GROUP_AUDIT_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CALC_TAG_DEPENDENCY(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CALC_IND_SID    NUMBER(10, 0)    NOT NULL,
    TAG_ID          NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_CALC_TAG_DEP PRIMARY KEY (CSRIMP_SESSION_ID, CALC_IND_SID, TAG_ID),
    CONSTRAINT FK_TAG_DEPENDENCY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CALC_BASELINE_CONFIG_DEPENDENCY(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CALC_IND_SID                    NUMBER(10, 0)    NOT NULL,
    BASELINE_CONFIG_ID              NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_CALC_BASELINE_CONFIG_DEP PRIMARY KEY (CSRIMP_SESSION_ID, CALC_IND_SID, BASELINE_CONFIG_ID),
    CONSTRAINT FK_BASELINE_CONFIG_DEPENDENCY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DASHBOARD(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DASHBOARD_SID    NUMBER(10, 0)    NOT NULL,
    NAME             VARCHAR2(255)    NOT NULL,
    NOTE             CLOB,
    CONSTRAINT PK_DASHBOARD PRIMARY KEY (CSRIMP_SESSION_ID, DASHBOARD_SID),
    CONSTRAINT FK_DASHBOARD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DASHBOARD_ITEM(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DASHBOARD_ITEM_ID    NUMBER(10, 0)    NOT NULL,
    DASHBOARD_SID        NUMBER(10, 0)    NOT NULL,
    PARENT_SID           NUMBER(10, 0)    NOT NULL,
    PERIOD               CHAR(1)          NOT NULL,
    COMPARISON_TYPE      NUMBER(10, 0)    NOT NULL,
    IND_SID              NUMBER(10, 0)    NOT NULL,
    REGION_SID           NUMBER(10, 0)    NOT NULL,
    NAME                 VARCHAR2(255)    NOT NULL,
    POS                  NUMBER(10, 0)    NOT NULL,
    DATAVIEW_SID         NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DASHBOARD_ITEM PRIMARY KEY (CSRIMP_SESSION_ID, DASHBOARD_ITEM_ID),
    CONSTRAINT FK_DASHBOARD_ITEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_SCENARIO_RUN(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID         NUMBER(10, 0)    NOT NULL,
    SCENARIO_RUN_TYPE    NUMBER(10, 0)    NOT NULL,
    SCENARIO_RUN_SID     NUMBER(10, 0),
    CONSTRAINT CK_SCENARIO_RUN_SID CHECK (( scenario_run_type = 2 and scenario_run_sid is not null ) or
( scenario_run_type in (0,1) and scenario_run_sid is null )),
    CONSTRAINT UK_DATAVIEW_SCENARIO_RUN  UNIQUE (CSRIMP_SESSION_ID, DATAVIEW_SID, SCENARIO_RUN_TYPE, SCENARIO_RUN_SID),
    CONSTRAINT FK_DATAVIEW_SCENARIO_RUN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_ZONE(
    CSRIMP_SESSION_ID       NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    POS                     NUMBER(10, 0)    NOT NULL,
    NAME                    VARCHAR2(255)    NOT NULL,
    DATAVIEW_SID            NUMBER(10, 0),
    START_VAL_IND_SID       NUMBER(10, 0)    NOT NULL,
    START_VAL_REGION_SID    NUMBER(10, 0)    NOT NULL,
    START_VAL_START_DTM     DATE             NOT NULL,
    START_VAL_END_DTM       DATE             NOT NULL,
    END_VAL_IND_SID         NUMBER(10, 0),
    END_VAL_REGION_SID      NUMBER(10, 0),
    END_VAL_START_DTM       DATE,
    END_VAL_END_DTM         DATE,
    STYLE_XML               CLOB             NOT NULL,
    TYPE                    NUMBER(10)       NOT NULL,
    DESCRIPTION             VARCHAR2(255),
    IS_TARGET               NUMBER(10)       NOT NULL,
    TARGET_DIRECTION        NUMBER(10)       NOT NULL,
    CONSTRAINT PK_DATAVIEW_ZONE PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, POS),
    CONSTRAINT FK_DATAVIEW_ZONE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_TREND(
	CSRIMP_SESSION_ID		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    POS                     NUMBER(10, 0)    NOT NULL,
    NAME                    VARCHAR2(255)    NOT NULL,
    TITLE                   VARCHAR2(4000)   NOT NULL,
    DATAVIEW_SID            NUMBER(10, 0)    NOT NULL,
    IND_SID                 NUMBER(10, 0)    NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    MONTHS                  NUMBER(10, 0)    NOT NULL,
    ROUNDING_METHOD         NUMBER(5, 0)     NOT NULL,
    ROUNDING_DIGITS         NUMBER(5, 0)     NOT NULL,
    CONSTRAINT CHK_DATAVIEW_TREND_ROUNDING_ME CHECK ( ROUNDING_METHOD BETWEEN 0 AND 9 ),
    CONSTRAINT CHK_DATAVIEW_TREND_ROUNDING_DI CHECK ( ROUNDING_DIGITS BETWEEN 0 AND 99 ),
    CONSTRAINT PK_DATAVIEW_TREND PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, POS),
    CONSTRAINT FK_DATAVIEW_TREND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.DELEG_META_ROLE_IND_SELECTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)     NOT NULL,
    IND_SID           NUMBER(10, 0)     NOT NULL,
    LANG              VARCHAR2(10)      NOT NULL,
    DESCRIPTION       VARCHAR2(500)     NOT NULL,
    CONSTRAINT PK_DELEG_META_ROLE_IND_SEL PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, IND_SID),
    CONSTRAINT FK_DLG_META_ROLE_IND_SEL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_COMMENT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    START_DTM         DATE             NOT NULL,
    END_DTM           DATE             NOT NULL,
    POSTIT_ID         NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEGATION_COMMENT PRIMARY KEY (CSRIMP_SESSION_ID, POSTIT_ID),
    CONSTRAINT FK_DELEG_COMMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_PLUGIN(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID          NUMBER(10, 0)     NOT NULL,
    NAME             VARCHAR2(255)     NOT NULL,
    JS_CLASS_TYPE    VARCHAR2(1000)    NOT NULL,
    JS_INCLUDE       VARCHAR2(1000),
    HELPER_PKG        VARCHAR2(255),
    CONSTRAINT DELEGATION_PLUGIN_PK PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID),
    CONSTRAINT FK_DELEGATION_PLUGIN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_TAG(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    TAG_ID            NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEGATION_TAG PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_SID, TAG_ID),
    CONSTRAINT FK_DELEGATION_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_USER_COVER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    USER_COVER_ID             NUMBER(10, 0)    NOT NULL,
    USER_GIVING_COVER_SID     NUMBER(10, 0)    NOT NULL,
    USER_BEING_COVERED_SID    NUMBER(10, 0)    NOT NULL,
    DELEGATION_SID            NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEGATION_USER_COVER PRIMARY KEY (CSRIMP_SESSION_ID, USER_COVER_ID, USER_GIVING_COVER_SID, USER_BEING_COVERED_SID, DELEGATION_SID),
    CONSTRAINT FK_DELEGATION_USER_COVER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_ID     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DOC PRIMARY KEY (CSRIMP_SESSION_ID, DOC_ID),
    CONSTRAINT FK_DOC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_CURRENT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_ID             NUMBER(10, 0)    NOT NULL,
    VERSION            NUMBER(10, 0),
    PARENT_SID         NUMBER(10, 0)    NOT NULL,
    LOCKED_BY_SID      NUMBER(10, 0),
    PENDING_VERSION    NUMBER(10, 0),
    CONSTRAINT PK_DOC_CURRENT PRIMARY KEY (CSRIMP_SESSION_ID, DOC_ID),
    CONSTRAINT FK_DOC_CURRENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_DATA(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_DATA_ID    NUMBER(10, 0)    NOT NULL,
    DATA           BLOB             NOT NULL,
    SHA1           RAW(20)          NOT NULL,
    MIME_TYPE      VARCHAR2(100)    NOT NULL,
    CONSTRAINT PK_DOC_DATA PRIMARY KEY (CSRIMP_SESSION_ID, DOC_DATA_ID),
    CONSTRAINT FK_DOC_DATA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_DOWNLOAD(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_ID               NUMBER(10, 0)    NOT NULL,
    VERSION              NUMBER(10, 0)    NOT NULL,
    DOWNLOADED_DTM       DATE             NOT NULL,
    DOWNLOADED_BY_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT FK_DOC_DOWNLOAD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_FOLDER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_FOLDER_SID          NUMBER(10, 0)    NOT NULL,
    DESCRIPTION             CLOB,
    LIFESPAN_IS_OVERRIDE    NUMBER(1, 0)     NOT NULL,
    LIFESPAN                NUMBER(10, 0),
    APPROVER_IS_OVERRIDE    NUMBER(1, 0)     NOT NULL,
    APPROVER_SID            NUMBER(10, 0),
	COMPANY_SID				NUMBER(10),
	PROPERTY_SID			NUMBER(10),
	IS_SYSTEM_MANAGED		NUMBER(1) NOT NULL,
	PERMIT_ITEM_ID			NUMBER(10,0),
    CONSTRAINT PK_DOC_FOLDER PRIMARY KEY (CSRIMP_SESSION_ID, DOC_FOLDER_SID),
	CONSTRAINT CHK_DOC_FOLDER_IS_SYS_MNGD_1_0 CHECK (is_system_managed IN (1, 0)),
    CONSTRAINT FK_DOC_FOLDER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_FOLDER_SUBSCRIPTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_FOLDER_SID    NUMBER(10, 0)    NOT NULL,
    NOTIFY_SID        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DOC_FOLDER_SUB PRIMARY KEY (CSRIMP_SESSION_ID, DOC_FOLDER_SID, NOTIFY_SID),
    CONSTRAINT FK_DOC_FOLDER_SUB_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_LIBRARY(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_LIBRARY_SID     NUMBER(10, 0)    NOT NULL,
    DOCUMENTS_SID       NUMBER(10, 0)    NOT NULL,
    TRASH_FOLDER_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DOC_LIBRARY PRIMARY KEY (CSRIMP_SESSION_ID, DOC_LIBRARY_SID),
    CONSTRAINT FK_DOC_LIBRARY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_NOTIFICATION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_NOTIFICATION_ID    NUMBER(10, 0)    NOT NULL,
    DOC_ID                 NUMBER(10, 0)    NOT NULL,
    VERSION                NUMBER(10, 0)    NOT NULL,
    NOTIFY_SID             NUMBER(10, 0)    NOT NULL,
    SENT_DTM               DATE,
    REASON                 VARCHAR2(32)     NOT NULL,
    CHECK (REASON IN ('NEW_VERSION','DELETED','RESTORED','FOR_APPROVAL')),
    CONSTRAINT PK_DOC_NOTIFICATION PRIMARY KEY (CSRIMP_SESSION_ID, DOC_NOTIFICATION_ID),
    CONSTRAINT FK_DOC_NOTIFICATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_SUBSCRIPTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_ID        NUMBER(10, 0)    NOT NULL,
    NOTIFY_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DOC_SUBSCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, DOC_ID, NOTIFY_SID),
    CONSTRAINT FK_DOC_SUBSCRIPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_VERSION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DOC_ID                NUMBER(10, 0)    NOT NULL,
    VERSION               NUMBER(10, 0)    NOT NULL,
    FILENAME              VARCHAR2(200)    NOT NULL,
    DESCRIPTION           CLOB             NOT NULL,
    CHANGE_DESCRIPTION    CLOB             NOT NULL,
    CHANGED_BY_SID        NUMBER(10, 0)    NOT NULL,
    CHANGED_DTM           TIMESTAMP(6)     NOT NULL,
    DOC_DATA_ID           NUMBER(10, 0)    NOT NULL,
	DOC_TYPE_ID			  NUMBER(10,0)	   NULL,
    CONSTRAINT PK_DOC_VERSION PRIMARY KEY (CSRIMP_SESSION_ID, DOC_ID, VERSION),
    CONSTRAINT FK_DOC_VERSION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DOC_FOLDER_NAME_TRANSLATION(
	CSRIMP_SESSION_ID	NUMBER(10, 0)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DOC_FOLDER_SID		NUMBER(10, 0)		NOT NULL,
	LANG				VARCHAR2(10)		NOT NULL,
	TRANSLATED			VARCHAR2(1023)		NOT NULL,
	PARENT_SID			NUMBER(10, 0)		NOT NULL,
	CONSTRAINT PK_DOC_FOLDER_NAME_TRANSLATION PRIMARY KEY (CSRIMP_SESSION_ID, DOC_FOLDER_SID, LANG),
	CONSTRAINT FK_DOC_FOLDER_NAME_TR_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.EXCEL_EXPORT_OPTIONS(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID                   NUMBER(10, 0)    NOT NULL,
    IND_SHOW_SID                   NUMBER(1, 0)     NOT NULL,
    IND_SHOW_INFO                  NUMBER(1, 0)     NOT NULL,
    IND_SHOW_TAGS                  NUMBER(1, 0)     NOT NULL,
    IND_SHOW_GAS_FACTOR            NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_SID                NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_INACTIVE           NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_INFO               NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_TAGS               NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_TYPE               NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_REF                NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_ACQUISITION_DTM    NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_DISPOSAL_DTM       NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_ROLES              NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_EGRID              NUMBER(1, 0)     NOT NULL,
    REGION_SHOW_GEO_COUNTRY        NUMBER(1, 0)     NOT NULL,
    METER_SHOW_REF                 NUMBER(1, 0)     NOT NULL,
    METER_SHOW_LOCATION            NUMBER(1, 0)     NOT NULL,
    METER_SHOW_SOURCE_TYPE         NUMBER(1, 0)     NOT NULL,
    METER_SHOW_NOTE                NUMBER(1, 0)     NOT NULL,
    METER_SHOW_CRC                 NUMBER(1, 0)     NOT NULL,
    METER_SHOW_IND                 NUMBER(1, 0)     NOT NULL,
    METER_SHOW_MEASURE             NUMBER(1, 0)     NOT NULL,
    METER_SHOW_COST_IND            NUMBER(1, 0)     NOT NULL,
    METER_SHOW_COST_MEASURE        NUMBER(1, 0)     NOT NULL,
    METER_SHOW_DAYS_IND            NUMBER(1, 0)     NOT NULL,
    METER_SHOW_SUPPLIER            NUMBER(1, 0)     NOT NULL,
    METER_SHOW_CONTRACT            NUMBER(1, 0)     NOT NULL,
    SCENARIO_POS                   VARCHAR2(10)     NOT NULL,
    CHECK (IND_SHOW_SID IN (0,1)),
    CHECK (IND_SHOW_INFO IN (0,1)),
    CHECK (IND_SHOW_TAGS IN (0,1)),
    CHECK (REGION_SHOW_SID IN (0,1)),
    CHECK (REGION_SHOW_INACTIVE IN (0,1)),
    CHECK (REGION_SHOW_INFO IN (0,1)),
    CHECK (REGION_SHOW_TAGS IN (0,1)),
    CHECK (REGION_SHOW_TYPE IN (0,1)),
    CHECK (REGION_SHOW_REF IN (0,1)),
    CHECK (REGION_SHOW_ACQUISITION_DTM IN (0,1)),
    CHECK (REGION_SHOW_DISPOSAL_DTM IN (0,1)),
    CHECK (REGION_SHOW_ROLES IN (0,1)),
    CHECK (METER_SHOW_REF IN (0,1)),
    CHECK (METER_SHOW_LOCATION IN (0,1)),
    CHECK (METER_SHOW_SOURCE_TYPE IN (0,1)),
    CHECK (METER_SHOW_NOTE IN (0,1)),
    CHECK (METER_SHOW_CRC IN (0,1)),
    CHECK (METER_SHOW_IND IN (0,1)),
    CHECK (METER_SHOW_MEASURE IN (0,1)),
    CHECK (METER_SHOW_SUPPLIER IN (0,1)),
    CHECK (METER_SHOW_CONTRACT IN (0,1)),
    CONSTRAINT CHK_EE_M_SHOW_COST_IND CHECK (METER_SHOW_COST_IND IN (0,1)),
    CONSTRAINT CHK_EE_M_SHOW_COST_MEASURE CHECK (METER_SHOW_COST_MEASURE IN (0,1)),
    CONSTRAINT CHK_EE_M_SHOW_DAYS_IND CHECK (METER_SHOW_DAYS_IND IN (0,1)),
    CONSTRAINT CK_EXCEL_EXPORT_OPTS_SCN_POS CHECK (scenario_pos in ('Column','Sheet')),
    CONSTRAINT PK_EXCEL_EXPORT_OPTIONS PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID),
    CONSTRAINT FK_EXCEL_EXPORT_OPTIONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.EXCEL_EXPORT_OPTIONS_TAG_GROUP(
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DATAVIEW_SID				NUMBER(10, 0)	NOT NULL,
	APPLIES_TO					NUMBER			NOT NULL,
	TAG_GROUP_ID				NUMBER			NOT NULL,
	CONSTRAINT PK_EXCEL_EXPORT_OPTIONS_TG PRIMARY KEY (CSRIMP_SESSION_ID, DATAVIEW_SID, APPLIES_TO, TAG_GROUP_ID),
	CONSTRAINT CHK_EXCEL_EXPORT_OPTIONS_AT CHECK (APPLIES_TO IN (1,2)),
	CONSTRAINT FK_EXCEL_EXPORT_OPTIONS_TAG_GROUP_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FACTOR_HISTORY(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FACTOR_ID      NUMBER(10, 0)     NOT NULL,
    CHANGED_DTM    DATE			     NOT NULL,
    USER_SID       NUMBER(10, 0)     NOT NULL,
    OLD_VALUE      NUMBER(24, 10)    NOT NULL,
    NOTE           CLOB              NOT NULL,
    CONSTRAINT FK_FACTOR_HISTORY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_VOCAB(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CSR_USER_SID       NUMBER(10, 0)     NOT NULL,
    IMP_TAG_TYPE_ID    NUMBER(10, 0)     NOT NULL,
    PHRASE             VARCHAR2(4000)    NOT NULL,
    FREQUENCY          NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_IMP_VOCAB PRIMARY KEY (CSRIMP_SESSION_ID, CSR_USER_SID, IMP_TAG_TYPE_ID, PHRASE),
    CONSTRAINT FK_IMP_VOCAB_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_SEL_GROUP_MEMBER_DESC(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID        NUMBER(10, 0)    NOT NULL,
    LANG           VARCHAR2(10)     NOT NULL,
    DESCRIPTION    VARCHAR2(500)    NOT NULL,
    CONSTRAINT PK_IND_SEL_GROUP_MEMBER_DESC PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, LANG),
    CONSTRAINT FK_IND_SEL_GRP_MEM_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_SELECTION_GROUP(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MASTER_IND_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IND_SELECTION_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, MASTER_IND_SID),
    CONSTRAINT FK_IND_SEL_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_SELECTION_GROUP_MEMBER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MASTER_IND_SID    NUMBER(10, 0)    NOT NULL,
    IND_SID           NUMBER(10, 0)    NOT NULL,
    POS               NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IND_SELECTION_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, MASTER_IND_SID, IND_SID),
    CONSTRAINT UK_IND_SELECTION_GROUP_IND  UNIQUE (CSRIMP_SESSION_ID, IND_SID),
    CONSTRAINT FK_IND_SEL_GROUP_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT(
	CSRIMP_SESSION_ID			NUMBER(10) 		 DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    INTERNAL_AUDIT_SID        	NUMBER(10, 0)    NOT NULL,
    INTERNAL_AUDIT_TYPE_ID    	NUMBER(10, 0)    NOT NULL,
    SURVEY_SID                	NUMBER(10, 0),
    REGION_SID                	NUMBER(10, 0),
    LABEL                     	VARCHAR2(255)    NOT NULL,
    AUDIT_DTM                 	DATE             NOT NULL,
    CREATED_BY_USER_SID       	NUMBER(10, 0)    NOT NULL,
    CREATED_DTM               	DATE             NOT NULL,
    AUDITOR_USER_SID          	NUMBER(10, 0)    NOT NULL,
    NOTES                     	CLOB,
    AUDIT_CONTACT_USER_SID    	NUMBER(10, 0),
    SURVEY_RESPONSE_ID        	NUMBER(10, 0),
    AUDITOR_NAME              	VARCHAR2(256),
    AUDITOR_ORGANISATION      	VARCHAR2(50),
    AUDIT_CLOSURE_TYPE_ID     	NUMBER(10, 0),
    FLOW_ITEM_ID              	NUMBER(10),
    SUMMARY_RESPONSE_ID       	NUMBER(10),
    DELETED					  	NUMBER(10) 		 NOT NULL,
    EXPIRED					  	NUMBER(1) 		 NOT NULL,
	INTERNAL_AUDIT_REF		  	NUMBER(10, 0),
	NC_SCORE				  	NUMBER(15, 5),
	COMPARISON_RESPONSE_ID	  	NUMBER(10) 		 NULL,
	AUDITOR_COMPANY_SID 	  	NUMBER(10),
	OVW_VALIDITY_DTM 		  	DATE 			 NULL,
	NC_SCORE_THRSH_ID 		  	NUMBER(10),
	OVW_NC_SCORE_THRSH_ID 		NUMBER(10),
	OVW_NC_SCORE_THRSH_DTM 		DATE,
	OVW_NC_SCORE_THRSH_USR_SID  NUMBER(10),
	AUDITEE_USER_SID			NUMBER(10, 0),
	PERMIT_ID					NUMBER(10, 0),
	EXTERNAL_AUDIT_REF			VARCHAR2(255),
	EXTERNAL_PARENT_REF			VARCHAR2(255),
	EXTERNAL_URL				VARCHAR(255),
    CONSTRAINT PK_INTERNAL_AUDIT PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID),
	CONSTRAINT CHK_IA_EXPIRED_1_0 CHECK (EXPIRED IN (1, 0)),
    CONSTRAINT FK_INTERNAL_AUDIT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AUDIT_CLOSURE_TYPE(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    AUDIT_CLOSURE_TYPE_ID      NUMBER(10, 0)    NOT NULL,
    LABEL                      VARCHAR2(255)    NOT NULL,
    ICON_IMAGE                 BLOB,
    ICON_IMAGE_FILENAME        VARCHAR2(255),
    ICON_IMAGE_MIME_TYPE       VARCHAR2(255),
    ICON_IMAGE_SHA1            RAW(20),
    IS_FAILURE                 NUMBER(1)        NOT NULL,
	LOOKUP_KEY					VARCHAR2(255),
    CONSTRAINT CHK_ADT_CLSRE_TYP_IS_FAIL_1_0 CHECK (IS_FAILURE IN (1,0)),
    CONSTRAINT PK_AUDIT_CLOSURE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, AUDIT_CLOSURE_TYPE_ID),
    CONSTRAINT FK_AUDIT_CLOSURE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.AUDIT_TYPE_CLOSURE_TYPE(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    INTERNAL_AUDIT_TYPE_ID     NUMBER(10, 0)    NOT NULL,
    AUDIT_CLOSURE_TYPE_ID      NUMBER(10, 0)    NOT NULL,
    RE_AUDIT_DUE_AFTER         NUMBER(10, 0),
    MANUAL_EXPIRY_DATE         NUMBER(1)        DEFAULT 0 NOT NULL,
    RE_AUDIT_DUE_AFTER_TYPE    CHAR(1),
    REMINDER_OFFSET_DAYS       NUMBER(10, 0),
    REPORTABLE_FOR_MONTHS      NUMBER(10, 0),
	IND_SID					   NUMBER(10, 0),
    CONSTRAINT CHK_CHK_DUE_AFTER_VALID CHECK ((RE_AUDIT_DUE_AFTER IS NULL AND RE_AUDIT_DUE_AFTER_TYPE IS NULL) OR (RE_AUDIT_DUE_AFTER IS NOT NULL AND RE_AUDIT_DUE_AFTER_TYPE IS NOT NULL)),
    CONSTRAINT CHK_DUE_AFTER_TYPE_VLD CHECK (RE_AUDIT_DUE_AFTER_TYPE IN ('d','w','m','y')),
    CONSTRAINT CHK_RPRTBLE_MNTHS_POS CHECK (REPORTABLE_FOR_MONTHS > 0),
    CONSTRAINT PK_AUDIT_TYPE_CLOSURE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_ID, AUDIT_CLOSURE_TYPE_ID),
    CONSTRAINT FK_AUDIT_TYPE_CLOSURE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;


CREATE TABLE CSRIMP.AUDIT_ALERT(
   CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    INTERNAL_AUDIT_SID    NUMBER(10, 0)    NOT NULL,
    CSR_USER_SID          NUMBER(10, 0)    NOT NULL,
    REMINDER_SENT_DTM     DATE,
    OVERDUE_SENT_DTM      DATE,
    CONSTRAINT PK_AUDIT_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID, CSR_USER_SID),
    CONSTRAINT FK_AUDIT_ALERT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE csrimp.internal_audit_file_data (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	internal_audit_file_data_id			NUMBER(10) NOT NULL,
	filename						VARCHAR2(255) NOT NULL,
	mime_type						VARCHAR2(255) NOT NULL,
	data							BLOB NOT NULL,
	sha1							RAW(20) NOT NULL,
	uploaded_dtm					DATE NOT NULL,
	CONSTRAINT pk_internal_audit_file PRIMARY KEY (csrimp_session_id, internal_audit_file_data_id),
	CONSTRAINT fk_internal_audit_file_is FOREIGN KEY
    	(csrimp_session_id) REFERENCES CSRIMP.CSRIMP_SESSION (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_FILE(
    CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    INTERNAL_AUDIT_SID    		NUMBER(10, 0)    NOT NULL,
    INTERNAL_AUDIT_FILE_DATA_ID  	NUMBER(10, 0)    NOT NULL,
	CONSTRAINT PK_IA_FILE_CONNECTION PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID, INTERNAL_AUDIT_FILE_DATA_ID),
    CONSTRAINT FK_IA_FILE_CONNECTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_POSTIT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    INTERNAL_AUDIT_SID    NUMBER(10, 0)    NOT NULL,
    POSTIT_ID             NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_INTERNAL_AUDIT_POSTIT PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID, POSTIT_ID),
    CONSTRAINT FK_INTERNAL_AUDIT_POSTIT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_TYPE(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    INTERNAL_AUDIT_TYPE_ID   		NUMBER(10, 0)    NOT NULL,
    LABEL                    		VARCHAR2(255)    NOT NULL,
    EVERY_N_MONTHS           		NUMBER(10, 0),
    AUDITOR_ROLE_SID         		NUMBER(10, 0),
    AUDIT_CONTACT_ROLE_SID   		NUMBER(10, 0),
    DEFAULT_SURVEY_SID       		NUMBER(10, 0),
    LOOKUP_KEY              		VARCHAR2(30),
    DEFAULT_AUDITOR_ORG       		VARCHAR2(50),
    OVERRIDE_ISSUE_DTM        		NUMBER(1, 0)    NOT NULL,
    ASSIGN_ISSUES_TO_ROLE     		NUMBER(1, 0)    NOT NULL,
    AUDITOR_CAN_TAKE_OWNERSHIP 		NUMBER(1, 0)	NOT NULL,
    FLOW_SID                  		NUMBER(10),
    SUMMARY_SURVEY_SID        		NUMBER(10, 0),
	SEND_AUDITOR_EXPIRY_ALERTS 		NUMBER(1)  		NOT NULL,
	VALIDITY_MONTHS           		NUMBER(10),
	TAB_SID							NUMBER(10),
	FORM_PATH						VARCHAR2(255),
	FORM_SID						NUMBER(10),
	INTERNAL_AUDIT_REF_HELPER_FUNC	VARCHAR2(255),
	INTERNAL_AUDIT_TYPE_GROUP_ID 	NUMBER(10, 0)	NULL,
	NC_AUDIT_CHILD_REGION 			NUMBER(1,0) 	NOT NULL,
	NC_SCORE_TYPE_ID				NUMBER(10, 0),
	ISSUE_TYPE_ID					NUMBER(10,0),
	SHOW_PRIMARY_SURVEY_IN_HEADER	NUMBER(1, 0)	NOT NULL,
	PRIMARY_SURVEY_ACTIVE			NUMBER(1, 0)	NOT NULL,
	PRIMARY_SURVEY_LABEL			VARCHAR2(1024),
	PRIMARY_SURVEY_MANDATORY		NUMBER(1, 0)	NOT NULL,
	PRIMARY_SURVEY_FIXED			NUMBER(1, 0)	NOT NULL,
	PRIMARY_SURVEY_GROUP_KEY		VARCHAR2(256),
	ACTIVE                          NUMBER(1),
	ADD_NC_PER_QUESTION 			NUMBER(1, 0),
 	AUDIT_COORD_ROLE_OR_GROUP_SID	NUMBER(10)		NULL,
    INTERNAL_AUDIT_TYPE_SOURCE_ID   NUMBER(10, 0)   NOT NULL,
    USE_LEGACY_CLOSED_DEFINITION    NUMBER(1, 0)    NOT NULL,
	INVOLVE_AUDITOR_IN_ISSUES       NUMBER(1, 0),
    CONSTRAINT CHK_IAT_ISS_ASS_ROLE_0_1 CHECK (ASSIGN_ISSUES_TO_ROLE IN (0,1)),
    CONSTRAINT CHK_IAT_TAKE_OWNERSHIP_0_1 CHECK (AUDITOR_CAN_TAKE_OWNERSHIP IN (0,1)),
	CONSTRAINT CHK_SND_ADTR_EXP_ALERT_1_0 CHECK (SEND_AUDITOR_EXPIRY_ALERTS IN (1,0)),
	CONSTRAINT CHK_IA_TYPE_CMS_TAB_FORM CHECK ((TAB_SID IS NULL AND FORM_PATH IS NULL AND FORM_SID IS NULL) OR (TAB_SID IS NOT NULL AND (FORM_PATH IS NOT NULL OR FORM_SID IS NOT NULL))),
    CONSTRAINT PK_INTERNAL_AUDIT_TYPE_ID PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_ID),
    CONSTRAINT FK_INTERNAL_AUDIT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE,
	CONSTRAINT CHK_IAT_USE_LEGACY_CLSD_DEF CHECK (USE_LEGACY_CLOSED_DEFINITION IN (0,1)),
	CONSTRAINT CHK_INVOLVE_AUDITOR_IN_ISSUES CHECK (INVOLVE_AUDITOR_IN_ISSUES IN (0, 1))
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_TYPE_REPORT (
    CSRIMP_SESSION_ID               NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    INTERNAL_AUDIT_TYPE_ID          NUMBER(10) NOT NULL,
    INTERNAL_AUDIT_TYPE_REPORT_ID   NUMBER(10) NOT NULL,
    WORD_DOC                        BLOB NOT NULL,
    REPORT_FILENAME                 VARCHAR(255) NOT NULL,
    LABEL                           VARCHAR(255) NOT NULL,
    IA_TYPE_REPORT_GROUP_ID         NUMBER(10) NULL,
	USE_MERGE_FIELD_GUID			NUMBER(1) NULL,
	GUID_EXPIRATION_DAYS			NUMBER(10) NULL,
    CONSTRAINT PK_AUDIT_TYPE_REPORT PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_REPORT_ID),
    CONSTRAINT UK_AUDIT_TYPE_REPORT_LABEL UNIQUE (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_ID, LABEL),
    CONSTRAINT FK_INTERNAL_AUDIT_TYPE_REP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IA_TYPE_REPORT_GROUP (
    CSRIMP_SESSION_ID               NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IA_TYPE_REPORT_GROUP_ID         NUMBER(10) NOT NULL,
    LABEL                           VARCHAR(255) NOT NULL,
    CONSTRAINT PK_IA_TYPE_REPORT_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, IA_TYPE_REPORT_GROUP_ID),
    CONSTRAINT FK_IA_TYPE_REPORT_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_AUDIT_IND (
	CSRIMP_SESSION_ID 				NUMBER(10) 			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IND_SID							NUMBER(10) 			NOT NULL,
	FLOW_STATE_ID					NUMBER(10) 			NOT NULL,
	FLOW_STATE_AUDIT_IND_TYPE_ID	NUMBER(10)			NOT NULL,
	INTERNAL_AUDIT_TYPE_ID			NUMBER(10) 			NOT NULL,
	CONSTRAINT PK_FLOW_STATE_AUDIT_IND PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID),
	CONSTRAINT FK_FLOW_STATE_AUDIT_IND_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.internal_audit_type_group (
	CSRIMP_SESSION_ID				NUMBER(10) 			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INTERNAL_AUDIT_TYPE_GROUP_ID	NUMBER(10,0) 		NOT NULL,
	LABEL							VARCHAR2(255 BYTE) 	NOT NULL,
	LOOKUP_KEY						VARCHAR2(255 BYTE),
	INTERNAL_AUDIT_REF_PREFIX		VARCHAR2(255 BYTE),
	ISSUE_TYPE_ID 					NUMBER(10,0),
	AUDITOR_NAME_LABEL	 			VARCHAR2(100) 		NULL,
	APPLIES_TO_REGIONS				NUMBER(1, 0),
	APPLIES_TO_USERS				NUMBER(1, 0),
	USE_USER_PRIMARY_REGION			NUMBER(1, 0),
	AUDIT_SINGULAR_LABEL			VARCHAR2(100),
	AUDIT_PLURAL_LABEL				VARCHAR2(100),
	AUDITEE_USER_LABEL				VARCHAR2(100),
	AUDITOR_USER_LABEL				VARCHAR2(100),
	AUDITS_MENU_SID					NUMBER(10, 0),
	NEW_AUDIT_MENU_SID				NUMBER(10, 0),
	NON_COMPLIANCES_MENU_SID		NUMBER(10, 0),
	BLOCK_CSS_CLASS					VARCHAR2(255),
	APPLIES_TO_PERMITS				NUMBER(1) 			NOT NULL,
	CONSTRAINT PK_AUDIT_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_GROUP_ID),
	CONSTRAINT FK_INTRNL_AUDIT_TYPE_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_MEASURE_CONVERSION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CSR_USER_SID             NUMBER(10, 0)    NOT NULL,
    MEASURE_SID              NUMBER(10, 0)    NOT NULL,
    MEASURE_CONVERSION_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_USER_MEASURE_CONVERSION PRIMARY KEY (CSRIMP_SESSION_ID, CSR_USER_SID, MEASURE_SID),
    CONSTRAINT FK_USER_MEASURE_CONV_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REVISION               NUMBER(10, 0)     NOT NULL,
    MODEL_SID              NUMBER(10, 0)     NOT NULL,
    NAME                   VARCHAR2(255)     NOT NULL,
    DESCRIPTION            VARCHAR2(4000),
    EXCEL_DOC              BLOB,
    FILE_NAME              VARCHAR2(255),
    THUMB_IMG              BLOB,
    CREATED_DTM            DATE              NOT NULL,
    TEMP_ONLY_BOO          NUMBER(1, 0),
    LOAD_STATE             VARCHAR2(1)       NOT NULL,
	SCENARIO_RUN_TYPE 	   NUMBER(10) 		 NOT NULL,
	SCENARIO_RUN_SID 	   NUMBER(10),
    LOOKUP_KEY 	   		   VARCHAR2(255),
	CONSTRAINT CK_LOAD_STATE CHECK (LOAD_STATE IN ('N','L','U')),
    CONSTRAINT CK_MODEL_SCN_RUN_SID CHECK (
		(SCENARIO_RUN_TYPE = 2 AND SCENARIO_RUN_SID IS NOT NULL) OR
		(SCENARIO_RUN_TYPE IN (0, 1) AND SCENARIO_RUN_SID IS NULL)
	),
    CONSTRAINT PK_MODEL PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_SID),
    CONSTRAINT FK_MODEL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_INSTANCE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_INSTANCE_SID    NUMBER(10, 0)     NOT NULL,
    BASE_MODEL_SID        NUMBER(10, 0)     NOT NULL,
    START_DTM             DATE              NOT NULL,
    END_DTM               DATE              NOT NULL,
    OWNER_SID             NUMBER(10, 0)     NOT NULL,
    CREATED_DTM           DATE              NOT NULL,
    EXCEL_DOC             BLOB,
    DESCRIPTION           VARCHAR2(1000),
    RUN_STATE             VARCHAR2(1)       NOT NULL,
    CONSTRAINT CHK_MI_RUN_STATE CHECK (RUN_STATE IN ('N','W','R')),
    CONSTRAINT PK_MODEL_INSTANCE PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_INSTANCE_SID, BASE_MODEL_SID),
    CONSTRAINT FK_MODEL_INSTANCE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_INSTANCE_CHART(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_INSTANCE_SID    NUMBER(10, 0)     NOT NULL,
    BASE_MODEL_SID        NUMBER(10, 0)     NOT NULL,
    SHEET_ID              NUMBER(10, 0)     NOT NULL,
    CHART_INDEX           NUMBER(10, 0)     NOT NULL,
    TOP                   NUMBER(10, 0)     NOT NULL,
    LEFT                  NUMBER(10, 0)     NOT NULL,
    WIDTH                 NUMBER(10, 0)     NOT NULL,
    HEIGHT                NUMBER(10, 0)     NOT NULL,
    SOURCE_DATA           VARCHAR2(4000),
    CONSTRAINT PK_MODEL_INSTANCE_CHART PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_INSTANCE_SID, BASE_MODEL_SID, SHEET_ID, CHART_INDEX),
    CONSTRAINT FK_MODEL_INSTANCE_CHART_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_INSTANCE_MAP(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_INSTANCE_SID      NUMBER(10, 0)     NOT NULL,
    BASE_MODEL_SID          NUMBER(10, 0)     NOT NULL,
    SHEET_ID                NUMBER(10, 0)     NOT NULL,
    CELL_NAME               VARCHAR2(20)      NOT NULL,
    SOURCE_CELL_NAME        VARCHAR2(20)      NOT NULL,
    CELL_VALUE              VARCHAR2(4000),
    MAP_TO_INDICATOR_SID    NUMBER(10, 0),
    MAP_TO_REGION_SID       NUMBER(10, 0),
    PERIOD_YEAR_OFFSET      NUMBER(10, 0)     NOT NULL,
    PERIOD_OFFSET           NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_MODEL_INSTANCE_MAP PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_INSTANCE_SID, BASE_MODEL_SID, SHEET_ID, CELL_NAME),
    CONSTRAINT FK_MODEL_INSTANCE_MAP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_INSTANCE_REGION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_INSTANCE_SID    NUMBER(10, 0)    NOT NULL,
    REGION_SID            NUMBER(10, 0)    NOT NULL,
    POS                   NUMBER(10, 0)    NOT NULL,
    BASE_MODEL_SID        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_MODEL_INSTANCE_REGION PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_INSTANCE_SID, REGION_SID, BASE_MODEL_SID),
    CONSTRAINT FK_MODEL_INSTANCE_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_INSTANCE_SHEET(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_INSTANCE_SID    NUMBER(10, 0)    NOT NULL,
    BASE_MODEL_SID        NUMBER(10, 0)    NOT NULL,
    SHEET_ID              NUMBER(10, 0)    NOT NULL,
    STRUCTURE             SYS.XMLType,
    CONSTRAINT PK_MODEL_INSTANCE_SHEET PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_INSTANCE_SID, BASE_MODEL_SID, SHEET_ID),
    CONSTRAINT FK_MODEL_INSTANCE_SHEET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_MAP(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_SID               NUMBER(10, 0)    NOT NULL,
    SHEET_ID                NUMBER(10, 0)    NOT NULL,
    CELL_NAME               VARCHAR2(20)     NOT NULL,
    MODEL_MAP_TYPE_ID       NUMBER(10, 0)    NOT NULL,
    MAP_TO_INDICATOR_SID    NUMBER(10, 0),
    CELL_COMMENT            CLOB,
    IS_TEMP                 NUMBER(1, 0)     NOT NULL,
    REGION_TYPE_OFFSET      NUMBER(10, 0),
    REGION_OFFSET_TAG_ID    NUMBER(10, 0),
    PERIOD_YEAR_OFFSET      NUMBER(10, 0)    NOT NULL,
    PERIOD_OFFSET           NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_MODEL_MAP PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_SID, SHEET_ID, CELL_NAME),
    CONSTRAINT FK_MODEL_MAP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_RANGE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_SID    NUMBER(10, 0)    NOT NULL,
    RANGE_ID     NUMBER(10, 0)    NOT NULL,
    SHEET_ID     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_MODEL_RANGE PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_SID, RANGE_ID),
    CONSTRAINT UK_MODEL_RANGE  UNIQUE (CSRIMP_SESSION_ID, RANGE_ID),
    CONSTRAINT FK_MODEL_RANGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_RANGE_CELL(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_SID    NUMBER(10, 0)    NOT NULL,
    RANGE_ID     NUMBER(10, 0)    NOT NULL,
    CELL_NAME    VARCHAR2(20)     NOT NULL,
    CONSTRAINT PK_MODEL_RANGE_CELL PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_SID, RANGE_ID, CELL_NAME),
    CONSTRAINT FK_MODEL_RANGE_CELL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_REGION_RANGE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_SID           NUMBER(10, 0)    NOT NULL,
    RANGE_ID            NUMBER(10, 0)    NOT NULL,
    REGION_REPEAT_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT CK_MRR_RRI CHECK (REGION_REPEAT_ID >= 1 AND REGION_REPEAT_ID <= 4),
    CONSTRAINT PK_MODEL_REGION_RANGE PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_SID, RANGE_ID),
    CONSTRAINT FK_MODEL_REGION_RANGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_SHEET(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_SID             NUMBER(10, 0)    NOT NULL,
    SHEET_NAME            VARCHAR2(255)    NOT NULL,
    USER_EDITABLE_BOO     NUMBER(1, 0),
    SHEET_INDEX           NUMBER(10, 0)    NOT NULL,
    DISPLAY_CHARTS_BOO    NUMBER(1, 0)     NOT NULL,
    CHART_COUNT           NUMBER(10, 0)    NOT NULL,
    SHEET_ID              NUMBER(10, 0)    NOT NULL,
    STRUCTURE             SYS.XMLType,
    CONSTRAINT PK_MODEL_SHEET PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_SID, SHEET_ID),
    CONSTRAINT FK_MODEL_SHEET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODEL_VALIDATION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODEL_SID          NUMBER(10, 0)    NOT NULL,
    CELL_NAME          VARCHAR2(20)     NOT NULL,
    DISPLAY_SEQ        NUMBER(10, 0)    NOT NULL,
    VALIDATION_TEXT    VARCHAR2(50),
    SHEET_ID           NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_MODEL_VALIDATION PRIMARY KEY (CSRIMP_SESSION_ID, MODEL_SID, CELL_NAME, DISPLAY_SEQ, SHEET_ID),
    CONSTRAINT FK_MODEL_VALIDATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMP_DEFAULT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NON_COMP_DEFAULT_ID				NUMBER(10, 0) NOT NULL,
	LABEL							VARCHAR2(2048) NOT NULL,
	DETAIL							CLOB,
	NON_COMPLIANCE_TYPE_ID			NUMBER(10),
	ROOT_CAUSE						CLOB,
	SUGGESTED_ACTION				CLOB,
	NON_COMP_DEFAULT_FOLDER_ID		NUMBER(10),
	UNIQUE_REFERENCE				VARCHAR2(255),
	CONSTRAINT PK_NON_COMP_DEFAULT PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMP_DEFAULT_ID),
	CONSTRAINT FK_NON_COMP_DEFAULT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMP_DEFAULT_ISSUE (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NON_COMP_DEFAULT_ISSUE_ID	NUMBER(10, 0) NOT NULL,
	NON_COMP_DEFAULT_ID			NUMBER(10, 0) NOT NULL,
	LABEL						VARCHAR(2048) NOT NULL,
	DESCRIPTION					CLOB,
	DUE_DTM_RELATIVE			NUMBER(10),
	DUE_DTM_RELATIVE_UNIT		VARCHAR2(1),
	CONSTRAINT CHK_NON_COMP_DEF_ISS_DUE_UNIT CHECK (DUE_DTM_RELATIVE_UNIT IN ('d','m')),
	CONSTRAINT CHK_NON_COMP_DEF_ISS_DUE_REL CHECK ((DUE_DTM_RELATIVE IS NULL AND DUE_DTM_RELATIVE_UNIT IS NULL) OR (DUE_DTM_RELATIVE IS NOT NULL AND DUE_DTM_RELATIVE_UNIT IS NOT NULL)),
	CONSTRAINT PK_NON_COMP_DEFAULT_ISSUE PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMP_DEFAULT_ISSUE_ID),
	CONSTRAINT FK_NON_COMP_DEFAULT_ISSUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMP_DEFAULT_FOLDER (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NON_COMP_DEFAULT_FOLDER_ID	NUMBER(10)		NOT NULL,
	PARENT_FOLDER_ID			NUMBER(10),
	LABEL						VARCHAR(4000)	NOT NULL,
	CONSTRAINT PK_NON_COMP_DEFAULT_FOLDER PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMP_DEFAULT_FOLDER_ID),
	CONSTRAINT PK_NON_COMP_DEFAULT_FOLDER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMP_DEFAULT_TAG (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NON_COMP_DEFAULT_ID			NUMBER(10)		NOT NULL,
	TAG_ID						NUMBER(10)		NOT NULL,
	CONSTRAINT PK_NON_COMP_DEFAULT_TAG PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMP_DEFAULT_ID, TAG_ID),
	CONSTRAINT PK_NON_COMP_DEFAULT_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMPLIANCE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NON_COMPLIANCE_ID				NUMBER(10, 0)    NOT NULL,
	CREATED_IN_AUDIT_SID			NUMBER(10, 0)    NOT NULL,
	FROM_NON_COMP_DEFAULT_ID		NUMBER(10, 0),
	LABEL							VARCHAR2(2048)   NOT NULL,
	DETAIL							CLOB,
	CREATED_DTM						DATE             NOT NULL,
	CREATED_BY_USER_SID				NUMBER(10, 0)    NOT NULL,
	NON_COMPLIANCE_TYPE_ID			NUMBER(10),
	IS_CLOSED						NUMBER(1),
	NON_COMPLIANCE_REF				VARCHAR2(255),
	QUESTION_ID						NUMBER(10),
	QUESTION_VERSION				NUMBER(10, 0),
	QUESTION_DRAFT					NUMBER(1),
	QUESTION_OPTION_ID				NUMBER(10),
	OVERRIDE_SCORE					NUMBER(15, 5),
	ROOT_CAUSE						CLOB,
	SUGGESTED_ACTION                CLOB,
	REGION_SID 						NUMBER(10,0) 	 NULL,
	CONSTRAINT CHK_NC_QUESTION_DRAFT CHECK (QUESTION_DRAFT IN (0,1)),
	CONSTRAINT CHK_NON_COMP_IS_CLOSED_1_0 CHECK (IS_CLOSED IS NULL OR IS_CLOSED IN (1,0)),
	CONSTRAINT PK_NON_COMPLIANCE PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMPLIANCE_ID),
	CONSTRAINT FK_NON_COMPLIANCE_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AUDIT_NON_COMPLIANCE(
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    NON_COMPLIANCE_ID			NUMBER(10, 0)    NOT NULL,
    INTERNAL_AUDIT_SID			NUMBER(10, 0)    NOT NULL,
	AUDIT_NON_COMPLIANCE_ID		NUMBER(10, 0)    NOT NULL,
	REPEAT_OF_AUDIT_NC_ID		NUMBER(10, 0),
	ATTACHED_TO_PRIMARY_SURVEY			NUMBER(1, 0) NOT NULL,
	INTERNAL_AUDIT_TYPE_SURVEY_ID		NUMBER(10, 0),
    CONSTRAINT PK_AUDIT_NON_COMPLIANCE PRIMARY KEY (CSRIMP_SESSION_ID, AUDIT_NON_COMPLIANCE_ID),
    CONSTRAINT FK_AUD_NON_COMPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AUDIT_TYPE_NON_COMP_DEFAULT (
	CSRIMP_SESSION_ID			NUMBER(10, 0) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INTERNAL_AUDIT_TYPE_ID		NUMBER(10, 0) NOT NULL,
	NON_COMP_DEFAULT_ID			NUMBER(10, 0) NOT NULL,
	CONSTRAINT PK_AUDIT_TYPE_NON_COMP_DEFAULT PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_ID, NON_COMP_DEFAULT_ID),
	CONSTRAINT FK_AUDIT_TYPE_NON_COMP_DEF_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMPLIANCE_EXPR_ACTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    NON_COMPLIANCE_ID              NUMBER(10, 0)    NOT NULL,
    QS_EXPR_NON_COMPL_ACTION_ID    NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID             NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_NON_COMPL_EXPR_ACTION PRIMARY KEY (CSRIMP_SESSION_ID, QS_EXPR_NON_COMPL_ACTION_ID, SURVEY_RESPONSE_ID),
    CONSTRAINT FK_NON_COMPL_EXPR_ACT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMPLIANCE_FILE_UPLOAD(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    NON_COMPLIANCE_ID    NUMBER(10, 0)    NOT NULL,
    FILE_UPLOAD_SID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_NON_COMPLIANCE_FILE_UPLOAD PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMPLIANCE_ID, FILE_UPLOAD_SID),
    CONSTRAINT FK_NON_COMPL_FILE_UPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMPLIANCE_TAG(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID               NUMBER(10, 0)    NOT NULL,
    NON_COMPLIANCE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_NON_COMPLIANCE_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TAG_ID, NON_COMPLIANCE_ID),
    CONSTRAINT FK_NON_COMPLIANCE_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_FLOW_CAPABILITY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_CAPABILITY_ID NUMBER(10,0) NOT NULL,
	DEFAULT_PERMISSION_SET NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(256) NOT NULL,
	FLOW_ALERT_CLASS VARCHAR2(256) NOT NULL,
	LOOKUP_KEY VARCHAR2(256),
	PERM_TYPE NUMBER(1) NOT NULL,
	IS_SYSTEM_MANAGED NUMBER(1, 0) NOT NULL,
	CONSTRAINT PK_CUSTOMER_FLOW_CAPABILITY PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_CAPABILITY_ID),
	CONSTRAINT FK_CUSTOMER_FLOW_CAPABILITY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE,
	CONSTRAINT CK_CUST_FLOW_CAP_IS_SYS_MNGD CHECK (IS_SYSTEM_MANAGED IN (0, 1))
);

CREATE TABLE CSRIMP.NON_COMPLIANCE_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) 		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NON_COMPLIANCE_TYPE_ID			NUMBER(10) 		NOT NULL,
	LABEL							VARCHAR2(255) 	NOT NULL,
	LOOKUP_KEY						VARCHAR2(255) 	NOT NULL,
	POSITION						NUMBER(10) 		NOT NULL,
	COLOUR_WHEN_OPEN				NUMBER(10) 		NOT NULL,
	COLOUR_WHEN_CLOSED				NUMBER(10) 		NOT NULL,
	CAN_HAVE_ACTIONS				NUMBER(1)  		NOT NULL,
	CLOSURE_BEHAVIOUR_ID			NUMBER(10) 		NOT NULL,
	INTER_NON_COMP_REF_HELPER_FUNC	VARCHAR2(255),
	INTER_NON_COMP_REF_PREFIX		VARCHAR2(255),
	SCORE							NUMBER(15, 5),
	REPEAT_SCORE					NUMBER(15, 5),
	ROOT_CAUSE_ENABLED				NUMBER(1) 		NOT NULL,
	SUGGESTED_ACTION_ENABLED		NUMBER(1) 		NOT NULL,
	MATCH_REPEATS_BY_CARRY_FWD		NUMBER(1),
	MATCH_REPEATS_BY_DEFAULT_NCS	NUMBER(1),
	MATCH_REPEATS_BY_SURVEYS		NUMBER(1),
	FIND_REPEATS_IN_UNIT			VARCHAR2(10),
	FIND_REPEATS_IN_QTY				NUMBER(10, 0),
	CARRY_FWD_REPEAT_TYPE			VARCHAR2(10),
	IS_DEFAULT_SURVEY_FINDING		NUMBER(1, 0)	NOT NULL,
	CONSTRAINT PK_NON_COMPLIANCE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMPLIANCE_TYPE_ID),
	CONSTRAINT UK_NC_TYPE_LOOKUP_KEY UNIQUE (CSRIMP_SESSION_ID, LOOKUP_KEY),
	CONSTRAINT CHK_NC_TYP_CAN_HAVE_ACTNS_1_0 CHECK (CAN_HAVE_ACTIONS IN (1, 0)),
	CONSTRAINT CHK_NON_COMP_TYP_RT_CAUSE_1_0 CHECK (ROOT_CAUSE_ENABLED IN (1, 0)),
	CONSTRAINT CHK_NON_COMP_TYP_SUGG_ACT_1_0 CHECK (SUGGESTED_ACTION_ENABLED IN (1, 0)),
	CONSTRAINT CHK_NC_TYP_CLOSURE_BEHAVIOUR CHECK (CLOSURE_BEHAVIOUR_ID IN (1, 2, 3)),
	CONSTRAINT CHK_IS_DEFAULT_SURVEY_FINDING CHECK (IS_DEFAULT_SURVEY_FINDING IN (1, 0)),
	CONSTRAINT FK_NON_COMPLIANCE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMP_TYPE_AUDIT_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NON_COMPLIANCE_TYPE_ID			NUMBER(10) NOT NULL,
	INTERNAL_AUDIT_TYPE_ID			NUMBER(10) NOT NULL,
	CONSTRAINT PK_NON_COMP_TYPE_AUDIT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMPLIANCE_TYPE_ID, INTERNAL_AUDIT_TYPE_ID),
	CONSTRAINT FK_NC_TYPE_AUDIT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMPLIANCE_TYPE_FLOW_CAP(
    CSRIMP_SESSION_ID         NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    NON_COMPLIANCE_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_CAPABILITY_ID        NUMBER(10, 0)    NOT NULL,
    BASE_FLOW_CAPABILITY_ID   NUMBER(10 ,0)    NOT NULL,
    CONSTRAINT PK_NON_COMPLIANCE_TYP_FLOW_CAP PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMPLIANCE_TYPE_ID, FLOW_CAPABILITY_ID),
    CONSTRAINT UK_NC_TYPE_BASE_FLOW_CAP UNIQUE (CSRIMP_SESSION_ID, NON_COMPLIANCE_TYPE_ID, BASE_FLOW_CAPABILITY_ID),
    CONSTRAINT FK_NON_COM_TYP_FLOW_CAP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.NON_COMP_TYPE_RPT_AUDIT_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NON_COMPLIANCE_TYPE_ID NUMBER(10,0) NOT NULL,
	INTERNAL_AUDIT_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_NON_COM_TYP_RPT_AUDI_TYP PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMPLIANCE_TYPE_ID, INTERNAL_AUDIT_TYPE_ID),
	CONSTRAINT FK_NON_COM_TYP_RPT_AUDI_TYP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.POSTIT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LABEL              VARCHAR2(1024),
    POSTIT_ID          NUMBER(10, 0)     NOT NULL,
    MESSAGE            CLOB,
    CREATED_DTM        DATE              NOT NULL,
    CREATED_BY_SID     NUMBER(10, 0)     NOT NULL,
    SECURED_VIA_SID    NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_POSTIT PRIMARY KEY (CSRIMP_SESSION_ID, POSTIT_ID),
    CONSTRAINT FK_POSTIT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.POSTIT_FILE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    POSTIT_FILE_ID    NUMBER(10, 0)    NOT NULL,
    POSTIT_ID         NUMBER(10, 0)    NOT NULL,
    FILENAME          VARCHAR2(255)    NOT NULL,
    MIME_TYPE         VARCHAR2(256)    NOT NULL,
    DATA              BLOB             NOT NULL,
    SHA1              RAW(20)          NOT NULL,
    UPLOADED_DTM      DATE             NOT NULL,
    CONSTRAINT PK_POSTIT_FILE PRIMARY KEY (CSRIMP_SESSION_ID, POSTIT_FILE_ID),
    CONSTRAINT FK_POSTIT_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_ANSWER_FILE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QS_ANSWER_FILE_ID     NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID    NUMBER(10, 0)    NOT NULL,
    QUESTION_ID           NUMBER(10, 0)    NOT NULL,
	QUESTION_VERSION	NUMBER(10, 0)	NOT NULL,
    FILENAME              VARCHAR2(255)    NOT NULL,
    MIME_TYPE             VARCHAR2(256)    NOT NULL,
    SHA1                  RAW(20)          NOT NULL,
    CAPTION               VARCHAR2(1023),
	SURVEY_SID			NUMBER(10, 0)	NOT NULL,
    SURVEY_VERSION		NUMBER(10, 0)	NOT NULL,
    CONSTRAINT PK_QS_ANSWER_FILE PRIMARY KEY (CSRIMP_SESSION_ID, QS_ANSWER_FILE_ID),
    CONSTRAINT FK_QS_ANSER_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_ANSWER_LOG(
	CSRIMP_SESSION_ID	  NUMBER(10)        DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QS_ANSWER_LOG_ID      NUMBER(10, 0)     NOT NULL,
    SURVEY_RESPONSE_ID    NUMBER(10, 0)     NOT NULL,
    QUESTION_ID           NUMBER(10, 0)     NOT NULL,
	QUESTION_VERSION	  NUMBER(10, 0)		NOT NULL,
    VERSION_STAMP         NUMBER(10,0)      NOT NULL,
    SET_DTM               DATE              NOT NULL,
    SET_BY_USER_SID       NUMBER(10, 0)     NOT NULL,
    LOG_ITEM              CLOB,
    SUBMISSION_ID         NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_PENDING_VAL_LOG_1 PRIMARY KEY (CSRIMP_SESSION_ID, QS_ANSWER_LOG_ID),
    CONSTRAINT FK_QS_ANSWER_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_CUSTOM_QUESTION_TYPE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOM_QUESTION_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    DESCRIPTION                VARCHAR2(255)    NOT NULL,
    JS_INCLUDE                 VARCHAR2(255)    NOT NULL,
    JS_CLASS                   VARCHAR2(255)    NOT NULL,
    CS_CLASS                   VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_QS_CUST_QUESTION_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOM_QUESTION_TYPE_ID),
    CONSTRAINT UK_CUST_QUEST_TYPE_JS_CLASS  UNIQUE (CSRIMP_SESSION_ID, JS_CLASS),
    CONSTRAINT FK_QS_CUSTOM_QUEST_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_EXPR_MSG_ACTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QS_EXPR_MSG_ACTION_ID    NUMBER(10, 0)     NOT NULL,
    MSG                      VARCHAR2(4000)    NOT NULL,
    CSS_CLASS                VARCHAR2(255)     NOT NULL,
    CONSTRAINT PK_QS_EXPR_MSG_ACTION PRIMARY KEY (CSRIMP_SESSION_ID, QS_EXPR_MSG_ACTION_ID),
    CONSTRAINT FK_QS_EXPR_MSG_ACTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_EXPR_NC_ACTION_INVOLVE_ROLE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QS_EXPR_NON_COMPL_ACTION_ID    NUMBER(10, 0)    NOT NULL,
    INVOLVE_ROLE_SID               NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_QS_EXPR_NC_ACTION_INV PRIMARY KEY (CSRIMP_SESSION_ID, QS_EXPR_NON_COMPL_ACTION_ID, INVOLVE_ROLE_SID),
    CONSTRAINT FK_QS_EXPR_NC_ACT_INV_RLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_EXPR_NON_COMPL_ACTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QS_EXPR_NON_COMPL_ACTION_ID    NUMBER(10, 0)     NOT NULL,
    ASSIGN_TO_ROLE_SID             NUMBER(10, 0),
    DUE_DTM_ABS                    DATE,
    DUE_DTM_RELATIVE               NUMBER(10, 0),
    DUE_DTM_RELATIVE_UNIT          VARCHAR2(1),
    TITLE                          VARCHAR2(2048)    NOT NULL,
    DETAIL                         VARCHAR2(2048),
    SEND_EMAIL_ON_CREATION         NUMBER(1, 0)      NOT NULL,
    NON_COMP_DEFAULT_ID            NUMBER(10, 0),
    NON_COMPLIANCE_TYPE_ID         NUMBER(10),
    CONSTRAINT CHK_QS_EXPR_NC_ACT_DUE_DTM CHECK ((DUE_DTM_RELATIVE IS NULL AND DUE_DTM_RELATIVE_UNIT IS NULL) OR (DUE_DTM_RELATIVE IS NOT NULL AND DUE_DTM_RELATIVE_UNIT IS NOT NULL)),
    CONSTRAINT CHK_NC_DUE_DTM_REL_UNIT CHECK (DUE_DTM_RELATIVE_UNIT IN ('d','m')),
    CONSTRAINT PK_QS_EXPR_NC_ACTION PRIMARY KEY (CSRIMP_SESSION_ID, QS_EXPR_NON_COMPL_ACTION_ID),
    CONSTRAINT FK_QS_EXPR_NON_COMPL_ACT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_FILTER_CONDITION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FILTER_ID                 NUMBER(10, 0)     NOT NULL,
    QS_FILTER_CONDITION_ID    NUMBER(10, 0)     NOT NULL,
    QUESTION_ID               NUMBER(10, 0)     NOT NULL,
	QUESTION_VERSION		  NUMBER(10, 0)		NOT NULL,
    POS                       NUMBER(10, 0)     NOT NULL,
    SURVEY_SID                NUMBER(10, 0)     NOT NULL,
    COMPARATOR                VARCHAR2(20),
    COMPARE_TO_STR_VAL        VARCHAR2(2047),
    COMPARE_TO_NUM_VAL        NUMBER(10, 0),
    COMPARE_TO_OPTION_ID      NUMBER(10, 0),
    SURVEY_VERSION            NUMBER(10) NOT NULL,
    QS_CAMPAIGN_SID           NUMBER(10),
    CONSTRAINT PK_QS_FILTER_CONDITION PRIMARY KEY (CSRIMP_SESSION_ID, QS_FILTER_CONDITION_ID),
    CONSTRAINT FK_QS_FILTER_CONDITION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE UNIQUE INDEX csrimp.uk_qs_filter_condition
		ON csrimp.qs_filter_condition (csrimp_session_id, filter_id, pos, NVL(qs_campaign_sid, survey_sid));

CREATE TABLE CSRIMP.QS_QUESTION_OPTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QUESTION_OPTION_ID    NUMBER(10, 0)     NOT NULL,
    QUESTION_ID           NUMBER(10, 0)     NOT NULL,
    QUESTION_VERSION			NUMBER(10, 0)     NOT NULL,
	QUESTION_DRAFT				NUMBER(1) NOT NULL,
    PARENT_OPTION_ID      NUMBER(10, 0),
    POS                   NUMBER(10, 0)     NOT NULL,
    LABEL                 VARCHAR2(4000)    NOT NULL,
    IS_VISIBLE            NUMBER(1, 0)      NOT NULL,
    SCORE                 NUMBER(13, 3),
    COLOR                 NUMBER(10, 0),
    LOOKUP_KEY            VARCHAR2(1000),
    MAPS_TO_IND_SID       NUMBER(10, 0),
    OPTION_ACTION         VARCHAR2(50),
    SURVEY_SID					NUMBER(10, 0) NOT NULL,
    SURVEY_VERSION				NUMBER(10, 0) NOT NULL,
	NON_COMPLIANCE_POPUP		NUMBER(1),
	NON_COMP_DEFAULT_ID			NUMBER(10),
	NON_COMPLIANCE_TYPE_ID		NUMBER(10),
	NON_COMPLIANCE_LABEL		VARCHAR2(255),
	NON_COMPLIANCE_DETAIL		VARCHAR2(4000),
	NON_COMP_ROOT_CAUSE		VARCHAR2(4000),
	NON_COMP_SUGGESTED_ACTION VARCHAR2(4000),
    CONSTRAINT CHK_QS_QUES_OPT_VIS CHECK (IS_VISIBLE IN (0,1)),
	CONSTRAINT CHK_QSQO_QUESTION_DRAFT CHECK (QUESTION_DRAFT IN (0,1)),
    CONSTRAINT PK_QS_QUESTION_OPTION PRIMARY KEY (CSRIMP_SESSION_ID, QUESTION_ID, QUESTION_VERSION, QUESTION_OPTION_ID, SURVEY_SID, SURVEY_VERSION),
    CONSTRAINT FK_QS_QUESTION_OPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_QUESTION_OPTION_NC_TAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTION_ID					NUMBER(10) NOT NULL,
	QUESTION_OPTION_ID			NUMBER(10) NOT NULL,
	QUESTION_VERSION			NUMBER(10, 0) NOT NULL,
	SURVEY_SID					NUMBER(10, 0) NOT NULL,
	SURVEY_VERSION				NUMBER(10) NOT NULL,
	TAG_ID						NUMBER(10) NOT NULL,
	CONSTRAINT PK_QS_QUESTION_OPTION_NC_TAG
		PRIMARY KEY (CSRIMP_SESSION_ID, QUESTION_ID, QUESTION_VERSION, QUESTION_OPTION_ID, SURVEY_SID, SURVEY_VERSION, TAG_ID),
	CONSTRAINT FK_QS_QSTN_OPTION_NC_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_RESPONSE_POSTIT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_RESPONSE_ID    NUMBER(10, 0)    NOT NULL,
    POSTIT_ID             NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_QS_RESPONSE_POSTIT PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_RESPONSE_ID, POSTIT_ID),
    CONSTRAINT FK_QS_RESPONSE_POSTIT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_SUBMISSION_FILE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QS_ANSWER_FILE_ID     NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID    NUMBER(10, 0)    NOT NULL,
    SUBMISSION_ID         NUMBER(10, 0)    NOT NULL,
    SURVEY_VERSION NUMBER(10) NOT NULL,
    CONSTRAINT PK_QS_SUBMISSION_FILE PRIMARY KEY (CSRIMP_SESSION_ID, QS_ANSWER_FILE_ID, SURVEY_RESPONSE_ID, SUBMISSION_ID),
    CONSTRAINT FK_QS_SUBMISSION_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUESTION(
	CSRIMP_SESSION_ID		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTION_ID				NUMBER(10, 0)	 NOT NULL,
	OWNED_BY_SURVEY_SID		NUMBER(10, 0)	 NULL,
	QUESTION_TYPE			VARCHAR2(20)	 NOT NULL,
	CUSTOM_QUESTION_TYPE_ID	NUMBER(10, 0),
	LOOKUP_KEY				VARCHAR2(255),
	MAPS_TO_IND_SID			NUMBER(10, 0),
	MEASURE_SID				NUMBER(10, 0),
	LATEST_QUESTION_VERSION	NUMBER(10) NOT NULL,
	LATEST_QUESTION_DRAFT	NUMBER(1) NOT NULL,
	CONSTRAINT PK_QUESTION PRIMARY KEY (CSRIMP_SESSION_ID, QUESTION_ID),
	CONSTRAINT CONS_QUESTION_MEASURE UNIQUE (CSRIMP_SESSION_ID, QUESTION_ID, MEASURE_SID),
	CONSTRAINT CHK_Q_CUSTOM_QUESTION_ID CHECK ((QUESTION_TYPE!='custom' AND CUSTOM_QUESTION_TYPE_ID IS NULL) OR (QUESTION_TYPE='custom' AND CUSTOM_QUESTION_TYPE_ID IS NOT NULL)),
    CONSTRAINT FK_QUESTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.QUESTION_VERSION(
	CSRIMP_SESSION_ID		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTION_ID				NUMBER(10, 0)	 NOT NULL,
	QUESTION_VERSION		NUMBER(10, 0)	 NOT NULL,
	QUESTION_DRAFT			NUMBER(1)		NOT NULL,
	PARENT_ID				NUMBER(10, 0),
	PARENT_VERSION			NUMBER(10, 0),
	PARENT_DRAFT			NUMBER(10, 0),
	POS						NUMBER(10, 0),
	LABEL					VARCHAR2(4000),
	SCORE					NUMBER(13, 3),
	MAX_SCORE				NUMBER(10, 0),
	UPLOAD_SCORE			NUMBER(10, 0),
	WEIGHT					NUMBER(15, 5)	 NOT NULL,
	DONT_NORMALISE_SCORE	NUMBER(1, 0)	 NOT NULL,
	HAS_SCORE_EXPRESSION	NUMBER(1, 0)	 NOT NULL,
	HAS_MAX_SCORE_EXPR		NUMBER(1, 0)	 NOT NULL,
	REMEMBER_ANSWER			NUMBER(1, 0)	 NOT NULL,
	COUNT_QUESTION			NUMBER(1, 0)	 NOT NULL,
	ACTION					VARCHAR2(50),
	QUESTION_XML			CLOB NOT NULL,
	CONSTRAINT CHK_QV_DNT_NORM_SC_0_1 CHECK (DONT_NORMALISE_SCORE IN (0,1)),
	CONSTRAINT CHK_QV_HAS_SC_EXPR_0_1 CHECK (HAS_SCORE_EXPRESSION IN (0,1)),
	CONSTRAINT CHK_QV_MAX_SC_EXPR_0_1 CHECK (HAS_MAX_SCORE_EXPR IN (0,1)),
	CONSTRAINT CHK_QV_QUESTION_DRAFT CHECK (QUESTION_DRAFT IN (0,1)),
	CONSTRAINT PK_QUESTION_VERSION PRIMARY KEY (CSRIMP_SESSION_ID, QUESTION_ID, QUESTION_VERSION, QUESTION_DRAFT),
    CONSTRAINT FK_QUESTION_VER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.QUESTION_OPTION(
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTION_OPTION_ID			NUMBER(10, 0)	 NOT NULL,
	QUESTION_ID					NUMBER(10, 0)	 NOT NULL,
	QUESTION_VERSION			NUMBER(10, 0)	 NOT NULL,
	QUESTION_DRAFT				NUMBER(1)		 NOT NULL,
	POS							NUMBER(10, 0)	 NOT NULL,
	LABEL						VARCHAR2(4000)	 NOT NULL,
    SCORE						NUMBER(13, 3),
	COLOR						NUMBER(10, 0),
	LOOKUP_KEY					VARCHAR2(1000),
	MAPS_TO_IND_SID				NUMBER(10, 0),
	OPTION_ACTION				VARCHAR2(50),
	NON_COMPLIANCE_POPUP		NUMBER(1, 0),
	NON_COMP_DEFAULT_ID			NUMBER(10, 0),
	NON_COMPLIANCE_TYPE_ID		NUMBER(10, 0),
	NON_COMPLIANCE_LABEL		VARCHAR2(255),
	NON_COMPLIANCE_DETAIL		VARCHAR2(4000),
	NON_COMP_ROOT_CAUSE			VARCHAR2(4000),
	NON_COMP_SUGGESTED_ACTION	VARCHAR2(4000),
	QUESTION_OPTION_XML			CLOB NOT NULL,
	CONSTRAINT CHK_QO_NON_COMP_POPUP_0_1 CHECK (NON_COMPLIANCE_POPUP IN (0,1)),
	CONSTRAINT PK_QUESTION_OPTION PRIMARY KEY (CSRIMP_SESSION_ID, QUESTION_OPTION_ID, QUESTION_ID, QUESTION_VERSION, QUESTION_DRAFT),
    CONSTRAINT FK_QUESTION_OPT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.QUESTION_OPTION_NC_TAG(
	CSRIMP_SESSION_ID	  NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QUESTION_ID           NUMBER(10, 0)    NOT NULL,
    QUESTION_OPTION_ID    NUMBER(10, 0)    NOT NULL,
    QUESTION_VERSION      NUMBER(10, 0)    NOT NULL,
    QUESTION_DRAFT        NUMBER(1)        NOT NULL,
    TAG_ID                NUMBER(10, 0)    NOT NULL,
	CONSTRAINT CHK_QONT_QUESTION_DRAFT CHECK (QUESTION_DRAFT IN (0,1)),
	CONSTRAINT PK_QUESTION_OPTION_NC_TAG PRIMARY KEY (CSRIMP_SESSION_ID, QUESTION_ID, QUESTION_OPTION_ID, QUESTION_VERSION, QUESTION_DRAFT, TAG_ID),
    CONSTRAINT FK_QUESTION_OPT_NC_T_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.QUESTION_TAG(
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QUESTION_ID			NUMBER(10, 0)	NOT NULL,
    QUESTION_VERSION	NUMBER(10, 0)	NOT NULL,
    TAG_ID				NUMBER(10, 0)	NOT NULL,
	QUESTION_DRAFT		NUMBER(1)		NOT NULL,
	SHOW_IN_SURVEY		NUMBER(1)		NOT NULL,
	CONSTRAINT CHK_QT_QUESTION_DRAFT CHECK (QUESTION_DRAFT IN (0,1)),
    CONSTRAINT PK_QUESTION_TAG PRIMARY KEY (CSRIMP_SESSION_ID, QUESTION_ID, QUESTION_VERSION, TAG_ID),
    CONSTRAINT FK_QUESTION_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE,
	CONSTRAINT CHK_QT_SHOW_IN_SURVEY CHECK (SHOW_IN_SURVEY IN (0,1))
)
;

CREATE TABLE CSRIMP.QUICK_SURVEY(
	CSRIMP_SESSION_ID		  NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_SID                NUMBER(10, 0)    NOT NULL,
    CREATED_DTM               DATE             NOT NULL,
    AUDIENCE                  VARCHAR2(32)     NOT NULL,
    AGGREGATE_IND_GROUP_ID    NUMBER(10, 0),
    QUICK_SURVEY_TYPE_ID      NUMBER(10, 0),
    ROOT_IND_SID              NUMBER(10, 0),
    SCORE_TYPE_ID             NUMBER(10, 0),
    SUBMISSION_VALIDITY_MONTHS NUMBER(10, 0)   NOT NULL,
    LAST_MODIFIED_DTM DATE NOT NULL,
    CURRENT_VERSION NUMBER(10),
	AUDITING_AUDIT_TYPE_ID	  NUMBER(10),
	GROUP_KEY				  VARCHAR2(256),
	FROM_QUESTION_LIBRARY     NUMBER(1) NOT NULL,
    LOOKUP_KEY                VARCHAR2(256),
    CONSTRAINT CHK_QUICK_SURVEY_CURR_VERSION CHECK (CURRENT_VERSION > 0),
    CONSTRAINT CHK_QUICK_SURVEY_AUDIENCE CHECK (AUDIENCE IN ('everyone','existing','chain','audit','chain.product')),
    CONSTRAINT CHK_FROM_QUESTION_LIBRARY_0_1 CHECK (FROM_QUESTION_LIBRARY IN (0,1)),
    CONSTRAINT PK_QUICK_SURVEY PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_SID),
    CONSTRAINT FK_QUICK_SURVEY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_VERSION (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SURVEY_SID			NUMBER(10) NOT NULL,
	SURVEY_VERSION		NUMBER(10) NOT NULL,
	QUESTION_XML		CLOB NOT NULL,
	LABEL				VARCHAR2(256) NOT NULL,
	START_DTM			DATE,
	END_DTM				DATE,
	PUBLISHED_DTM		DATE,
	PUBLISHED_BY_SID	NUMBER(10),
	CONSTRAINT PK_QUICK_SURVEY_VERSION PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_SID, SURVEY_VERSION),
	 CONSTRAINT FK_QUICK_SURVEY_VER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_ANSWER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_RESPONSE_ID       NUMBER(10, 0)     NOT NULL,
    QUESTION_ID              NUMBER(10, 0)     NOT NULL,
	QUESTION_VERSION		 NUMBER(10, 0)	   NOT NULL,
    ANSWER                   CLOB,
    NOTE                     CLOB,
    SCORE                    NUMBER(15, 5),
    QUESTION_OPTION_ID       NUMBER(10, 0),
    VAL_NUMBER               NUMBER(24, 10),
    MEASURE_CONVERSION_ID    NUMBER(10, 0),
    MEASURE_SID              NUMBER(10, 0),
    REGION_SID               NUMBER(10, 0),
    HTML_DISPLAY             CLOB,
    MAX_SCORE                NUMBER(15, 5),
    VERSION_STAMP            NUMBER(10, 0)     NOT NULL,
    SUBMISSION_ID            NUMBER(10, 0)     NOT NULL,
    WEIGHT_OVERRIDE			 NUMBER(15,5),
	SURVEY_SID				 NUMBER(10, 0)	   NOT NULL,
    SURVEY_VERSION 			 NUMBER(10) 	   NOT NULL,
	LOG_ITEM 				 CLOB,
    CONSTRAINT PK_QUICK_SURVEY_RESP_ANSWR PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_RESPONSE_ID, QUESTION_ID, SUBMISSION_ID),
    CONSTRAINT FK_QUICK_SURVEY_QNSER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_EXPR(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SURVEY_SID						NUMBER(10, 0)     NOT NULL,
	EXPR_ID							NUMBER(10, 0)     NOT NULL,
	EXPR							VARCHAR2(4000),
	SURVEY_VERSION 					NUMBER(10) NOT NULL,
	QUESTION_ID						NUMBER(10),
	QUESTION_VERSION				NUMBER(10),
	QUESTION_OPTION_ID				NUMBER(10),
	CONSTRAINT CHK_QS_EXPR_OR_QUESTION CHECK (
		(EXPR IS NOT NULL AND QUESTION_ID IS NULL AND QUESTION_OPTION_ID IS NULL) OR
		(EXPR IS NULL AND QUESTION_ID IS NOT NULL AND QUESTION_OPTION_ID IS NOT NULL)),
	CONSTRAINT PK_QS_EXPR PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_SID, EXPR_ID, SURVEY_VERSION),
	CONSTRAINT FK_QUICK_SURVEY_EXPR_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE UNIQUE INDEX csrimp.uk_quick_survey_expr_question ON csrimp.quick_survey_expr (csrimp_session_id, survey_sid, survey_version, NVL2(expr, expr_id, NULL), question_id, question_option_id);

CREATE TABLE CSRIMP.QUICK_SURVEY_EXPR_ACTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QUICK_SURVEY_EXPR_ACTION_ID    NUMBER(10, 0)    NOT NULL,
    ACTION_TYPE                    VARCHAR2(20)     NOT NULL,
    SURVEY_SID                     NUMBER(10, 0)    NOT NULL,
    EXPR_ID                        NUMBER(10, 0)    NOT NULL,
    QS_EXPR_NON_COMPL_ACTION_ID    NUMBER(10, 0),
    QS_EXPR_MSG_ACTION_ID          NUMBER(10, 0),
    SHOW_QUESTION_ID               NUMBER(10, 0),
	SHOW_QUESTION_VERSION			NUMBER(10, 0),
    MANDATORY_QUESTION_ID          NUMBER(10, 0),
	MANDATORY_QUESTION_VERSION		NUMBER(10, 0),
    SHOW_PAGE_ID                   NUMBER(10, 0),
	SHOW_PAGE_VERSION				NUMBER(10, 0),
	ISSUE_TEMPLATE_ID				NUMBER(10, 0),
    SURVEY_VERSION NUMBER(10) NOT NULL,
    CONSTRAINT CHK_QS_EXPR_ACTION_TYPE_FK CHECK (
		(ACTION_TYPE = 'nc' AND QS_EXPR_NON_COMPL_ACTION_ID IS NOT NULL
		  AND QS_EXPR_MSG_ACTION_ID IS NULL AND SHOW_QUESTION_ID IS NULL
		  AND MANDATORY_QUESTION_ID IS NULL AND SHOW_PAGE_ID IS NULL
		  AND ISSUE_TEMPLATE_ID IS NULL)
		OR
		(ACTION_TYPE = 'msg' AND QS_EXPR_NON_COMPL_ACTION_ID IS NULL
		  AND QS_EXPR_MSG_ACTION_ID IS NOT NULL AND SHOW_QUESTION_ID IS NULL
		  AND MANDATORY_QUESTION_ID IS NULL AND SHOW_PAGE_ID IS NULL
		  AND ISSUE_TEMPLATE_ID IS NULL)
		OR
		(ACTION_TYPE = 'show_q' AND QS_EXPR_NON_COMPL_ACTION_ID IS NULL
		  AND QS_EXPR_MSG_ACTION_ID IS NULL AND SHOW_QUESTION_ID IS NOT NULL
		  AND MANDATORY_QUESTION_ID IS NULL AND SHOW_PAGE_ID IS NULL
		  AND ISSUE_TEMPLATE_ID IS NULL)
		OR
		(ACTION_TYPE = 'mand_q' AND QS_EXPR_NON_COMPL_ACTION_ID IS NULL
		  AND QS_EXPR_MSG_ACTION_ID IS NULL AND SHOW_QUESTION_ID IS NULL
		  AND MANDATORY_QUESTION_ID IS NOT NULL AND SHOW_PAGE_ID IS NULL
		  AND ISSUE_TEMPLATE_ID IS NULL)
		OR
		(ACTION_TYPE = 'show_p' AND QS_EXPR_NON_COMPL_ACTION_ID IS NULL
		  AND QS_EXPR_MSG_ACTION_ID IS NULL AND SHOW_QUESTION_ID IS NULL
		  AND MANDATORY_QUESTION_ID IS NULL AND SHOW_PAGE_ID IS NOT NULL
		  AND ISSUE_TEMPLATE_ID IS NULL)
		OR
		(ACTION_TYPE = 'issue' AND QS_EXPR_NON_COMPL_ACTION_ID IS NULL
		  AND QS_EXPR_MSG_ACTION_ID IS NULL AND SHOW_QUESTION_ID IS NULL
		  AND MANDATORY_QUESTION_ID IS NULL AND SHOW_PAGE_ID IS NULL
		  AND ISSUE_TEMPLATE_ID IS NOT NULL)
    ),
    CONSTRAINT PK_QS_EXPR_ACTION PRIMARY KEY (CSRIMP_SESSION_ID, QUICK_SURVEY_EXPR_ACTION_ID),
    CONSTRAINT UK_QS_EXPR_ACTION  UNIQUE (CSRIMP_SESSION_ID, QUICK_SURVEY_EXPR_ACTION_ID, SURVEY_SID, EXPR_ID),
    CONSTRAINT FK_QUICK_SURVEY_EXPR_ACT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_LANG(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_SID    NUMBER(10, 0)    NOT NULL,
    LANG          VARCHAR2(10)     NOT NULL,
    CONSTRAINT PK_QS_LANG PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_SID, LANG),
    CONSTRAINT FK_QUICK_SURVEY_LANG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_QUESTION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QUESTION_ID                NUMBER(10, 0)     NOT NULL,
	QUESTION_VERSION			NUMBER(10, 0) 	NOT NULL,
	QUESTION_DRAFT				NUMBER(1) 		NOT NULL,
    PARENT_ID                  NUMBER(10, 0),
	PARENT_VERSION				NUMBER(10, 0) 	NULL,
    SURVEY_SID                 NUMBER(10, 0)     NOT NULL,
    POS                        NUMBER(10, 0)     NOT NULL,
    LABEL                      VARCHAR2(4000),
    IS_VISIBLE                 NUMBER(1, 0)      NOT NULL,
    QUESTION_TYPE              VARCHAR2(20)      NOT NULL,
    SCORE                      NUMBER(13, 3),
    LOOKUP_KEY                 VARCHAR2(255),
    MAPS_TO_IND_SID            NUMBER(10, 0),
    MEASURE_SID                NUMBER(10, 0),
    MAX_SCORE                  NUMBER(10, 0),
    UPLOAD_SCORE               NUMBER(10, 0),
    CUSTOM_QUESTION_TYPE_ID    NUMBER(10, 0),
    WEIGHT                     NUMBER(15, 5)     NOT NULL,
    DONT_NORMALISE_SCORE	   NUMBER(1)	NOT NULL,
	HAS_SCORE_EXPRESSION	   NUMBER(1)	NOT NULL,
	HAS_MAX_SCORE_EXPR		   NUMBER(1)	NOT NULL,
	SURVEY_VERSION 				NUMBER(10) NOT NULL,
	REMEMBER_ANSWER 			NUMBER(10) NOT NULL,
	COUNT_QUESTION 				NUMBER(10) NOT NULL,
	ACTION						VARCHAR2(50),
    CONSTRAINT CK_QSQ_IS_VISIBLE CHECK (IS_VISIBLE IN (0,1)),
	CONSTRAINT CHK_QSQ_QUESTION_DRAFT CHECK (QUESTION_DRAFT IN (0,1)),
	CONSTRAINT CHK_QSQ_PARENT CHECK ((PARENT_ID IS NULL AND PARENT_VERSION IS NULL) OR (PARENT_ID IS NOT NULL AND PARENT_VERSION IS NOT NULL)),
    CONSTRAINT CHK_CUSTOM_QUESTION_ID CHECK ((QUESTION_TYPE!='custom' AND CUSTOM_QUESTION_TYPE_ID IS NULL) OR (QUESTION_TYPE='custom' AND CUSTOM_QUESTION_TYPE_ID IS NOT NULL)),
    CONSTRAINT PK_QUICK_SURVEY_QUESTION PRIMARY KEY (CSRIMP_SESSION_ID, QUESTION_ID, QUESTION_VERSION, SURVEY_SID, SURVEY_VERSION),
    CONSTRAINT CONS_QS_QUES_MEASURE  UNIQUE (CSRIMP_SESSION_ID, QUESTION_ID, MEASURE_SID, SURVEY_VERSION),
    CONSTRAINT CHK_QSQ_DNT_NORM_SC_0_1 CHECK (DONT_NORMALISE_SCORE IN (0,1)),
	CONSTRAINT CHK_QSQ_HAS_SC_EXPR_0_1 CHECK (HAS_SCORE_EXPRESSION IN (0,1)),
	CONSTRAINT CHK_QSQ_MAX_SC_EXPR_0_1 CHECK (HAS_MAX_SCORE_EXPR IN (0,1)),
    CONSTRAINT FK_QUICK_SURVEY_QUESTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_RESPONSE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_RESPONSE_ID       		NUMBER(10, 0)    NOT NULL,
    SURVEY_SID               		NUMBER(10, 0)    NOT NULL,
    USER_SID                 		NUMBER(10, 0),
    USER_NAME                		VARCHAR2(255),
    CREATED_DTM              		DATE             NOT NULL,
    GUID                     		VARCHAR2(36)     NOT NULL,
    QS_CAMPAIGN_SID          		NUMBER(10, 0),
    LAST_SUBMISSION_ID       		NUMBER(10, 0),
    SURVEY_VERSION 					NUMBER(10) NOT NULL,
	QUESTION_XML_OVERRIDE			CLOB,
	HIDDEN							NUMBER(1) NOT NULL,
    CONSTRAINT PK_QUICK_SURVEY_RESPONSE PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_RESPONSE_ID),
    CONSTRAINT UK_QUICK_SURVEY_RESPONSE  UNIQUE (CSRIMP_SESSION_ID, SURVEY_SID, SURVEY_RESPONSE_ID),
    CONSTRAINT chk_qs_response_hidden_0_1 CHECK (hidden IN (0,1)),
    CONSTRAINT FK_QUICK_SURVEY_RESPONSE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_SUBMISSION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_RESPONSE_ID       NUMBER(10, 0)    NOT NULL,
    SUBMISSION_ID            NUMBER(10, 0)    NOT NULL,
    SUBMITTED_DTM            DATE,
    SUBMITTED_BY_USER_SID    NUMBER(10, 0),
    OVERALL_SCORE            NUMBER(15, 5),
    OVERALL_MAX_SCORE        NUMBER(15, 5),
    SCORE_THRESHOLD_ID       NUMBER(10, 0),
    SURVEY_VERSION 			 NUMBER(10) 	 NOT NULL,
	GEO_LATITUDE			 NUMBER(24,10),
	GEO_LONGITUDE			 NUMBER(24,10),
	GEO_ALTITUDE			 NUMBER(24,10),
	GEO_H_ACCURACY			 NUMBER(24,10),
	GEO_V_ACCURACY			 NUMBER(24,10),
    CONSTRAINT PK_QUICK_SURVEY_SUBMISSION PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_RESPONSE_ID, SUBMISSION_ID, SURVEY_VERSION),
    CONSTRAINT FK_QUICK_SURVEY_SUBMSSN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_TYPE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QUICK_SURVEY_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    DESCRIPTION             VARCHAR2(255)    NOT NULL,
    CS_CLASS                VARCHAR2(255)    NULL,
    HELPER_PKG              VARCHAR2(255),
	ENABLE_QUESTION_COUNT   NUMBER(1) 		NOT NULL ,
	SHOW_ANSWER_SET_DTM		NUMBER(1) 		NOT NULL ,
	OTHER_TEXT_REQ_FOR_SCORE NUMBER(1),
	TEAROFF_TOOLBAR          NUMBER(1, 0)   NOT NULL,
	CAPTURE_GEO_LOCATION	NUMBER(1, 0) DEFAULT 0 NOT NULL,
	ENABLE_RESPONSE_IMPORT	NUMBER(1, 0) DEFAULT 1 NOT NULL,
    CONSTRAINT PK_QS_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, QUICK_SURVEY_TYPE_ID),
	CONSTRAINT CHK_TEAROFF_TOOLBAR CHECK (tearoff_toolbar IN (0,1)),
    CONSTRAINT CHK_CAPTURE_GEO_LOCATION CHECK (capture_geo_location IN (0,1)),
    CONSTRAINT FK_QUICK_SURVEY_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_FILTER_COND_GEN_TYPE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    QS_FILTER_COND_GEN_TYPE_ID		NUMBER(10, 0)		NOT NULL,
    CONDITION_CLASS					VARCHAR2(50)		NOT NULL,
	QUESTION_LABEL					VARCHAR2(100)		NOT NULL,
	CONSTRAINT PK_QS_FILTER_COND_GEN_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, QS_FILTER_COND_GEN_TYPE_ID),
	CONSTRAINT FK_QS_FILTER_COND_GEN_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_FILTER_CONDITION_GENERAL(
	CSRIMP_SESSION_ID					NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FILTER_ID							NUMBER(10, 0)     NOT NULL,
	QS_FILTER_CONDITION_GENERAL_ID		NUMBER(10, 0)     NOT NULL,
	POS									NUMBER(10, 0)     NOT NULL,
	SURVEY_SID							NUMBER(10, 0)     NOT NULL,
	QS_FILTER_COND_GEN_TYPE_ID			NUMBER(10, 0)     NOT NULL,
	COMPARATOR							VARCHAR2(20),
	COMPARE_TO_STR_VAL					VARCHAR2(2047),
	COMPARE_TO_NUM_VAL					NUMBER(10, 0),
	QS_CAMPAIGN_SID						NUMBER(10, 0),
	CONSTRAINT PK_QS_FILTER_CONDITION_GENERAL PRIMARY KEY (CSRIMP_SESSION_ID, QS_FILTER_CONDITION_GENERAL_ID),
	CONSTRAINT FK_QS_FILTER_COND_GEN_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE UNIQUE INDEX csrimp.uk_qs_filter_condition_general
			ON csrimp.qs_filter_condition_general (csrimp_session_id, filter_id, pos, NVL(qs_campaign_sid, survey_sid));

CREATE TABLE CSRIMP.QUICK_SURVEY_CSS (
    CSRIMP_SESSION_ID		NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
    CLASS_NAME		 		VARCHAR2(1024)	NOT NULL,
    DESCRIPTION		 		VARCHAR2(1024)	NOT NULL,
    TYPE					NUMBER(1)		NOT NULL,
	POSITION				NUMBER(10)    	NOT NULL,
    CONSTRAINT PK_QUICK_SURVEY_CSS PRIMARY KEY (CSRIMP_SESSION_ID, CLASS_NAME),
	CONSTRAINT FK_QS_CSS_IS FOREIGN KEY (CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION(CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SUPPLIER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	LOGO_FILE_SID NUMBER(10,0),
	RECIPIENT_SID NUMBER(10,0),
	REGION_SID NUMBER(10,0),
	DEFAULT_REGION_MOUNT_SID NUMBER(10,0),
	CONSTRAINT PK_SUPPLIER PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID),
	CONSTRAINT FK_SUPPLIER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SUPPLIER_SURVEY_RESPONSE(
    CSRIMP_SESSION_ID     NUMBER(10, 0)    DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SUPPLIER_SID          NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID    NUMBER(10, 0)    NOT NULL,
    SURVEY_SID            NUMBER(10, 0)    NOT NULL,
    COMPONENT_ID          NUMBER(10, 0)    NULL,
    CONSTRAINT PK_SUPPLIER_SURVEY_RESPONSE PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_RESPONSE_ID),
   CONSTRAINT FK_SUPP_SURV_RESP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.REGION_INTERNAL_AUDIT(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    INTERNAL_AUDIT_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID                NUMBER(10, 0)    NOT NULL,
    NEXT_AUDIT_DTM            DATE,
    CONSTRAINT PK_REGION_INTERNAL_AUDIT PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_ID, REGION_SID),
    CONSTRAINT FK_REGION_INTERNAL_AUDIT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_OWNER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    USER_SID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_REGION_OWNER PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, USER_SID),
    CONSTRAINT FK_REGION_OWNER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_SET(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SET_ID    NUMBER(10, 0)    NOT NULL,
    OWNER_SID        NUMBER(10, 0),
    NAME             VARCHAR2(255)    NOT NULL,
    DISPOSAL_DTM     DATE,
    CONSTRAINT PK_REGION_SET PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SET_ID),
    CONSTRAINT FK_REGION_SET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_SET_REGION(
    CSRIMP_SESSION_ID    NUMBER(10)       DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SET_ID        NUMBER(10, 0)    NOT NULL,
    REGION_SID           NUMBER(10, 0)    NOT NULL,
    POS                  NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_REGION_SET_REGION PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SET_ID, REGION_SID),
    CONSTRAINT FK_REGION_SET_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.region_score_log (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	region_score_log_id	 			NUMBER(10, 0)	NOT NULL,
	region_sid		 				NUMBER(10, 0)	NOT NULL,
	score_type_id					NUMBER(10, 0)	NOT NULL,
	score_threshold_id				NUMBER(10, 0),
	score							NUMBER(15, 5),
	set_dtm							DATE			NOT NULL,
	changed_by_user_sid				NUMBER(10, 0),
	comment_text					CLOB,
	CONSTRAINT pk_region_score_log PRIMARY KEY (csrimp_session_id, region_score_log_id),
	CONSTRAINT fk_region_score_log_is FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.region_score (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	score_type_id					NUMBER(10, 0)	NOT NULL,
	region_sid						NUMBER(10, 0)	NOT NULL,
	last_region_score_log_id 		NUMBER(10, 0)	NOT NULL,
	CONSTRAINT pk_region_score PRIMARY KEY (csrimp_session_id, score_type_id, region_sid),
	CONSTRAINT fk_region_score_is FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_SURVEY_RESPONSE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_SID            NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID            NUMBER(10, 0)    NOT NULL,
    PERIOD_START_DTM      DATE             NOT NULL,
    PERIOD_END_DTM        DATE             NOT NULL,
    CONSTRAINT PK_REGION_SURVEY_RESPONSE PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_RESPONSE_ID),
    CONSTRAINT FK_REGION_SURVEY_RESP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCENARIO_SID                    NUMBER(10, 0)     NOT NULL,
    DESCRIPTION                     VARCHAR2(1000)    NOT NULL,
    START_DTM                       DATE              NOT NULL,
    END_DTM                         DATE,
    PERIOD_SET_ID					NUMBER(10),
    PERIOD_INTERVAL_ID				NUMBER(10),
	EQUALITY_EPSILON				NUMBER,
	AUTO_UPDATE_RUN_SID				NUMBER(10),
	RECALC_TRIGGER_TYPE				NUMBER(10),
	DATA_SOURCE						NUMBER(10),
	FILE_BASED						NUMBER(1),
	DATA_SOURCE_SP 					VARCHAR2(100),
	DATA_SOURCE_SP_ARGS 			VARCHAR2(4000),
	DATA_SOURCE_RUN_SID				NUMBER(10),
	CREATED_BY_USER_SID				NUMBER(10) NOT NULL,
	CREATED_DTM						DATE NOT NULL,
	INCLUDE_ALL_INDS				NUMBER(1) NOT NULL,
	DONT_RUN_AGGREGATE_INDICATORS	NUMBER(1) NOT NULL,
    CONSTRAINT CK_SCENARIO_DATES CHECK (START_DTM = TRUNC(START_DTM, 'MON') AND (END_DTM IS NULL OR (END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM))),
    CONSTRAINT PK_SCENARIO PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_SID),
    CONSTRAINT FK_SCENARIO_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_IND(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCENARIO_SID    NUMBER(10, 0)    NOT NULL,
    IND_SID         NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SCENARIO_IND PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_SID, IND_SID),
    CONSTRAINT FK_SCENARIO_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_OPTIONS(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHOW_CHART         NUMBER(1, 0)     NOT NULL,
    SHOW_BAU_OPTION    NUMBER(1, 0)     NOT NULL,
    BAU_DEFAULT        NUMBER(1, 0)     NOT NULL,
    CHECK (SHOW_CHART IN(0,1)),
    CHECK (SHOW_BAU_OPTION IN(0,1)),
    CHECK (BAU_DEFAULT IN(0,1)),
    CONSTRAINT FK_SCENARIO_OPTIONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_REGION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCENARIO_SID    NUMBER(10, 0)    NOT NULL,
    REGION_SID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SCENARIO_REGION PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_SID, REGION_SID),
    CONSTRAINT FK_SCENARIO_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_RULE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCENARIO_SID             NUMBER(10, 0)     NOT NULL,
    RULE_ID                  NUMBER(10, 0)     NOT NULL,
    DESCRIPTION              VARCHAR2(1000)    NOT NULL,
    RULE_TYPE                NUMBER(1, 0)      NOT NULL,
    AMOUNT                   NUMBER(24, 10)    NOT NULL,
    MEASURE_CONVERSION_ID    NUMBER(10, 0),
    START_DTM                DATE              NOT NULL,
    END_DTM                  DATE,
    CONSTRAINT CK_SCENARIO_RULE_DATES CHECK (START_DTM = TRUNC(START_DTM, 'MON') AND (END_DTM IS NULL OR (END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM))),
    CONSTRAINT PK_SCENARIO_RULE PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_SID, RULE_ID),
    CONSTRAINT FK_SCENARIO_RULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_RULE_IND(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCENARIO_SID    NUMBER(10, 0)    NOT NULL,
    RULE_ID         NUMBER(10, 0)    NOT NULL,
    IND_SID         NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SCENARIO_RULE_IND PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_SID, RULE_ID, IND_SID),
    CONSTRAINT FK_SCENARIO_RULE_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_RULE_LIKE_CONTIG_IND(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCENARIO_SID    NUMBER(10, 0)    NOT NULL,
    RULE_ID         NUMBER(10, 0)    NOT NULL,
    IND_SID         NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SCENARIO_RULE_LIKE_CTG_IND PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_SID, RULE_ID, IND_SID),
    CONSTRAINT FK_SCN_RLE_LIKE_CONTIG_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_RULE_REGION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCENARIO_SID    NUMBER(10, 0)    NOT NULL,
    RULE_ID         NUMBER(10, 0)    NOT NULL,
    REGION_SID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SCENARIO_RULE_REGION PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_SID, RULE_ID, REGION_SID),
    CONSTRAINT FK_SCENARIO_RULE_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_RUN_VERSION (
	CSRIMP_SESSION_ID		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCENARIO_RUN_SID		NUMBER(10) NOT NULL,
	VERSION					NUMBER(10) NOT NULL,
	CONSTRAINT FK_SCN_RUN_VER_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_RUN_VERSION_FILE (
	CSRIMP_SESSION_ID		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCENARIO_RUN_SID		NUMBER(10) NOT NULL,
	VERSION					NUMBER(10) NOT NULL,
	FILE_PATH				VARCHAR2(4000) NOT NULL,
	SHA1					RAW(20) NOT NULL,
	CONSTRAINT FK_SCN_RUN_FILE_SCN_RUN_VER_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_RUN(
	CSRIMP_SESSION_ID      NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCENARIO_RUN_SID       NUMBER(10, 0)     NOT NULL,
    SCENARIO_SID           NUMBER(10, 0)     NOT NULL,
    RUN_DTM                DATE              NOT NULL,
    DESCRIPTION            VARCHAR2(4000),
	LAST_SUCCESS_DTM	   DATE,
	ON_COMPLETION_SP	   VARCHAR(255),
    VERSION                NUMBER(10, 0),
	LAST_RUN_BY_USER_SID   NUMBER(10)        NOT NULL,
    CONSTRAINT PK_SCENARIO_RUN PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_RUN_SID),
    CONSTRAINT FK_SCENARIO_RUN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_RUN_VAL(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID             NUMBER(10, 0)     NOT NULL,
    REGION_SID          NUMBER(10, 0)     NOT NULL,
    PERIOD_START_DTM    DATE              NOT NULL,
    PERIOD_END_DTM      DATE              NOT NULL,
    VAL_NUMBER          NUMBER(24, 10),
    ERROR_CODE          NUMBER(10, 0),
    SOURCE_TYPE_ID      NUMBER(10, 0)     NOT NULL,
    SOURCE_ID           NUMBER(10, 0),
    SCENARIO_RUN_SID    NUMBER(10, 0),
    CONSTRAINT CK_VAL_NULL CHECK ((val_number is not null and error_code is null) or (val_number is null and error_code is not null)),
    CONSTRAINT CK_SCENARIO_RUN_VAL_DATES CHECK (period_start_dtm = trunc(period_start_dtm, 'MON') and period_end_dtm = trunc(period_end_dtm, 'MON') and period_end_dtm > period_start_dtm),
    CONSTRAINT PK_SCENARIO_RUN_VAL PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_RUN_SID, IND_SID, REGION_SID, PERIOD_START_DTM, PERIOD_END_DTM),
    CONSTRAINT FK_SCENARIO_RUN_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCORE_THRESHOLD(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SCORE_THRESHOLD_ID      NUMBER(10, 0)    NOT NULL,
    MAX_VALUE               NUMBER(15, 5)    NOT NULL,
    DESCRIPTION             VARCHAR2(255)    NOT NULL,
    TEXT_COLOUR             NUMBER(10, 0)    NOT NULL,
    BACKGROUND_COLOUR       NUMBER(10, 0),
    BAR_COLOUR              NUMBER(10, 0),
    ICON_IMAGE              BLOB,
    ICON_IMAGE_FILENAME     VARCHAR2(255),
    ICON_IMAGE_MIME_TYPE    VARCHAR2(255),
    ICON_IMAGE_SHA1         RAW(20),
    DASHBOARD_IMAGE         BLOB,
    DASHBOARD_FILENAME      VARCHAR2(255),
    DASHBOARD_MIME_TYPE     VARCHAR2(255),
    DASHBOARD_SHA1          RAW(20),
    MEASURE_LIST_INDEX      NUMBER(10, 0),
    SCORE_TYPE_ID           NUMBER(10, 0)    NOT NULL,
	SUPPLIER_SCORE_IND_SID  NUMBER(10, 0),
	LOOKUP_KEY				VARCHAR2(255),
    CONSTRAINT PK_SCORE_THRESHOLD PRIMARY KEY (CSRIMP_SESSION_ID, SCORE_THRESHOLD_ID),
    CONSTRAINT FK_SCORE_THRESHOLD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QUICK_SURVEY_SCORE_THRESHOLD(
    CSRIMP_SESSION_ID     NUMBER(10, 0)    DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_SID            NUMBER(10, 0)    NOT NULL,
    SCORE_THRESHOLD_ID    NUMBER(10, 0)    NOT NULL,
    MAPS_TO_IND_SID       NUMBER(10, 0),
    CONSTRAINT PK_QUICK_SURVEY_SCORE_THRESHOL PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_SID, SCORE_THRESHOLD_ID),
    CONSTRAINT FK_QSST_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCORE_TYPE (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCORE_TYPE_ID				NUMBER(10, 0)	NOT NULL,
	LABEL						VARCHAR(255)	NOT NULL,
	POS							NUMBER(10, 0)	NOT NULL,
	HIDDEN						NUMBER(1)		NOT NULL,
	ALLOW_MANUAL_SET			NUMBER(1)		NOT NULL,
	LOOKUP_KEY					VARCHAR(255),
	APPLIES_TO_SUPPLIER			NUMBER(1)		NOT NULL,
	APPLIES_TO_SURVEYS			NUMBER(1, 0)	NOT NULL,
	APPLIES_TO_NON_COMPLIANCES	NUMBER(1, 0)	NOT NULL,
	APPLIES_TO_REGIONS			NUMBER(1)		NOT NULL,
	REPORTABLE_MONTHS			NUMBER(10)		NOT NULL,
	MEASURE_SID					NUMBER(10, 0),
	SUPPLIER_SCORE_IND_SID 		NUMBER(10),
	FORMAT_MASK					VARCHAR(20) 	NOT NULL,
	ASK_FOR_COMMENT				VARCHAR2(16)	NOT NULL,
	MIN_SCORE					NUMBER(15, 5),
	MAX_SCORE					NUMBER(15, 5),
	START_SCORE					NUMBER(15, 5)	NOT NULL,
	NORMALISE_TO_MAX_SCORE		NUMBER(1, 0),
	APPLIES_TO_AUDITS			NUMBER(1, 0)	NOT NULL,
	APPLIES_TO_SUPP_RELS		NUMBER(1, 0)	NOT NULL,
	APPLIES_TO_PERMITS			NUMBER(1, 0)	NOT NULL,
	SHOW_EXPIRED_SCORES			NUMBER(1, 0)	NOT NULL,
	CONSTRAINT PK_SCORE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, SCORE_TYPE_ID),
	CONSTRAINT CHK_SCORE_TYPE_APPL2SUP CHECK (APPLIES_TO_SUPPLIER IN (0,1)),
	CONSTRAINT CHK_SCORE_TYPE_HIDDEN CHECK (HIDDEN IN (0,1)),
	CONSTRAINT CHK_SCORE_TYPE_AL_MAN_SET CHECK (ALLOW_MANUAL_SET IN (0,1)),
	CONSTRAINT CK_SCORE_TYPE_APP_TO_REG_1_0 CHECK (APPLIES_TO_REGIONS IN (0,1)),
    CONSTRAINT CK_SCORE_TYPE_APP_TO_AUD_1_0 CHECK (APPLIES_TO_AUDITS IN (0, 1)),
	CONSTRAINT CK_SCORE_TYPE_NOT_AUD_AND_NC	CHECK (APPLIES_TO_AUDITS = 0 OR APPLIES_TO_NON_COMPLIANCES = 0),
	CONSTRAINT CHK_SCORE_TYPE_APPL_SUPREL CHECK (APPLIES_TO_SUPP_RELS IN (0,1)),
	CONSTRAINT CHK_SCORE_TYPE_NOT_SUP_AND_SR CHECK (APPLIES_TO_SUPPLIER = 0 OR APPLIES_TO_SUPP_RELS = 0),
	CONSTRAINT CK_SCORE_TYPE_APP_TO_PERM CHECK (applies_to_permits IN (0, 1)),
	CONSTRAINT CHK_SCORE_TYPE_SHOW_EXP CHECK (show_expired_scores IN (0, 1)),
	CONSTRAINT FK_SCORE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCORE_TYPE_AGG_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCORE_TYPE_AGG_TYPE_ID			NUMBER(10)	NOT NULL,
	ANALYTIC_FUNCTION				NUMBER(10)	NOT NULL,
	SCORE_TYPE_ID					NUMBER(10)	NOT NULL,
	APPLIES_TO_NC_SCORE				NUMBER(1)	NOT NULL,
	APPLIES_TO_PRIMARY_AUDIT_SURVY	NUMBER(1)	NOT NULL,
	APPLIES_TO_AUDITS				NUMBER(1) 	NOT NULL,
	IA_TYPE_SURVEY_GROUP_ID			NUMBER(10),
	CONSTRAINT PK_SCORE_TYPE_AGG_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, SCORE_TYPE_AGG_TYPE_ID),
	CONSTRAINT CHK_SCORE_TYPE_AGG_TYPE CHECK(
		(APPLIES_TO_NC_SCORE = 1 AND APPLIES_TO_PRIMARY_AUDIT_SURVY = 0 AND IA_TYPE_SURVEY_GROUP_ID IS NULL AND APPLIES_TO_AUDITS = 0) OR
		(APPLIES_TO_NC_SCORE = 0 AND APPLIES_TO_PRIMARY_AUDIT_SURVY = 1 AND IA_TYPE_SURVEY_GROUP_ID IS NULL AND APPLIES_TO_AUDITS = 0) OR
		(APPLIES_TO_NC_SCORE = 0 AND APPLIES_TO_PRIMARY_AUDIT_SURVY = 0 AND IA_TYPE_SURVEY_GROUP_ID IS NOT NULL AND APPLIES_TO_AUDITS = 0) OR
		(APPLIES_TO_NC_SCORE = 0 AND APPLIES_TO_PRIMARY_AUDIT_SURVY = 0 AND IA_TYPE_SURVEY_GROUP_ID IS NULL AND APPLIES_TO_AUDITS = 1)
	),
	CONSTRAINT FK_SCORE_TYPE_AGG_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TARGET_DASHBOARD(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TARGET_DASHBOARD_SID    		NUMBER(10, 0)    NOT NULL,
    START_DTM               		DATE             NOT NULL,
    END_DTM                 		DATE,
    PERIOD_SET_ID					NUMBER(10),
    PERIOD_INTERVAL_ID				NUMBER(10),
    NAME                    		VARCHAR2(255)    NOT NULL,
    PARENT_SID              		NUMBER(10, 0)    NOT NULL,
    USE_ROOT_REGION_SID     		NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CHK_TGT_DASH_USE_ROOT_REG CHECK (USE_ROOT_REGION_SID IN (0,1)),
    CONSTRAINT PK_TARGET_DASHBOARD PRIMARY KEY (CSRIMP_SESSION_ID, TARGET_DASHBOARD_SID),
    CONSTRAINT FK_TARGET_DASHBOARD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TARGET_DASHBOARD_IND_MEMBER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TARGET_DASHBOARD_SID    NUMBER(10, 0)    NOT NULL,
    TARGET_IND_SID          NUMBER(10, 0),
    IND_SID                 NUMBER(10, 0)    NOT NULL,
	POS						 NUMBER(10) NOT NULL,
    CONSTRAINT PK_TARGET_DASHBOARD_IND_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, TARGET_DASHBOARD_SID, IND_SID),
    CONSTRAINT FK_TARGET_DASH_IND_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TARGET_DASHBOARD_REG_MEMBER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TARGET_DASHBOARD_SID      		NUMBER(10, 0)    NOT NULL,
    REGION_SID     					NUMBER(10, 0)    NOT NULL,
    POS            					NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_TARGET_DASH_REG_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, TARGET_DASHBOARD_SID, REGION_SID),
    CONSTRAINT FK_TARGET_DASH_REG_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TARGET_DASHBOARD_VALUE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TARGET_DASHBOARD_SID    NUMBER(10, 0)    NOT NULL,
    IND_SID                 NUMBER(10, 0)    NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    VAL_NUMBER              NUMBER(18, 4)    NOT NULL,
    CONSTRAINT PK_TARGET_DASHBOARD_VALUE PRIMARY KEY (CSRIMP_SESSION_ID, TARGET_DASHBOARD_SID, IND_SID, REGION_SID),
    CONSTRAINT FK_TARGET_DASH_VALUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TEMPLATE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TEMPLATE_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    DATA                BLOB             NOT NULL,
    MIME_TYPE           VARCHAR2(255)    NOT NULL,
    UPLOADED_DTM        DATE             NOT NULL,
    UPLOADED_BY_SID     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_TEMPLATE PRIMARY KEY (CSRIMP_SESSION_ID, TEMPLATE_TYPE_ID),
    CONSTRAINT FK_TEMPLATE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_COVER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    USER_COVER_ID             NUMBER(10, 0)    NOT NULL,
    USER_GIVING_COVER_SID     NUMBER(10, 0)    NOT NULL,
    USER_BEING_COVERED_SID    NUMBER(10, 0)    NOT NULL,
    START_DTM                 DATE             NOT NULL,
    END_DTM                   DATE,
    COVER_TERMINATED          NUMBER(1, 0)     NOT NULL,
    ALERT_SENT_DTM			  DATE,
    CONSTRAINT PK_USER_COVER PRIMARY KEY (CSRIMP_SESSION_ID, USER_COVER_ID, USER_GIVING_COVER_SID, USER_BEING_COVERED_SID),
    CONSTRAINT FK_USER_COVER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AUDIT_USER_COVER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    USER_COVER_ID             NUMBER(10, 0)    NOT NULL,
    USER_GIVING_COVER_SID     NUMBER(10, 0)    NOT NULL,
    USER_BEING_COVERED_SID    NUMBER(10, 0)    NOT NULL,
    INTERNAL_AUDIT_SID        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_AUD_USR_COVER PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID, USER_COVER_ID),
    CONSTRAINT FK_AUDIT_USER_COVER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_USER_COVER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_COVER_ID			NUMBER(10) NOT NULL,
	USER_GIVING_COVER_SID	NUMBER(10) NOT NULL,
	USER_BEING_COVERED_SID	NUMBER(10) NOT NULL,
	ISSUE_ID				NUMBER(10) NOT NULL,
	CONSTRAINT PK_ISSUE_USER_COVER PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_ID, USER_COVER_ID),
	CONSTRAINT FK_ISSUE_USER_COVER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.GROUP_USER_COVER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_COVER_ID			NUMBER(10) NOT NULL,
	USER_GIVING_COVER_SID	NUMBER(10, 0)    NOT NULL,
    USER_BEING_COVERED_SID	NUMBER(10, 0)    NOT NULL,
	GROUP_SID				NUMBER(10) NOT NULL,
	CONSTRAINT PK_GROUP_USER_COVER PRIMARY KEY (CSRIMP_SESSION_ID, USER_COVER_ID, USER_GIVING_COVER_SID, USER_BEING_COVERED_SID, GROUP_SID),
	CONSTRAINT FK_GROUP_USER_COVER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ROLE_USER_COVER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_COVER_ID			NUMBER(10) NOT NULL,
	USER_GIVING_COVER_SID	NUMBER(10, 0)    NOT NULL,
    USER_BEING_COVERED_SID	NUMBER(10, 0)    NOT NULL,
	ROLE_SID				NUMBER(10) NOT NULL,
	REGION_SID				NUMBER(10) NOT NULL,
	CONSTRAINT PK_ROLE_USER_COVER PRIMARY KEY (CSRIMP_SESSION_ID, USER_COVER_ID, USER_GIVING_COVER_SID, USER_BEING_COVERED_SID, ROLE_SID, REGION_SID),
	CONSTRAINT FK_ROLE_USER_COVER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AUTOCREATE_USER(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    GUID                    CHAR(36)         NOT NULL,
    REQUESTED_DTM           DATE             NOT NULL,
    USER_NAME               VARCHAR2(255)    NOT NULL,
    APPROVED_DTM            DATE,
    APPROVED_BY_USER_SID    NUMBER(10, 0),
    CREATED_USER_SID        NUMBER(10, 0),
    ACTIVATED_DTM           DATE,
    REJECTED_DTM            DATE,
    REQUIRE_NEW_PASSWORD    NUMBER(1, 0)     NOT NULL,
    REDIRECT_TO_URL         VARCHAR2(255),
    CONSTRAINT PK_AUTOCREATE_USER PRIMARY KEY (CSRIMP_SESSION_ID, USER_NAME),
    CONSTRAINT FK_AUTOCREATE_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AUDIT_LOG(
    AUDIT_DATE       DATE              NOT NULL,
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    AUDIT_TYPE_ID    NUMBER(10, 0)     NOT NULL,
    OBJECT_SID       NUMBER(10, 0),
    USER_SID         NUMBER(10, 0)     NOT NULL,
    DESCRIPTION      VARCHAR2(1023),
    PARAM_1          VARCHAR2(2048),
    PARAM_2          VARCHAR2(2048),
    PARAM_3          VARCHAR2(2048),
    SUB_OBJECT_ID    NUMBER(10, 0),
    REMOTE_ADDR      VARCHAR2(40),
    CONSTRAINT FK_AUDIT_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.audit_type_expiry_alert_role (
	csrimp_session_id		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	internal_audit_type_id	NUMBER(10, 0)    NOT NULL,
	role_sid				NUMBER(10, 0)    NOT NULL,
	CONSTRAINT pk_adt_typ_exp_alert_role PRIMARY KEY (csrimp_session_id, internal_audit_type_id, role_sid),
	CONSTRAINT fk_adt_typ_exp_alert_role_is FOREIGN KEY
    	(csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_ALERT_TYPE_PARAM(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOMER_ALERT_TYPE_ID    NUMBER(10, 0)     NOT NULL,
    FIELD_NAME                VARCHAR2(100)     NOT NULL,
    DESCRIPTION               VARCHAR2(200)     NOT NULL,
    HELP_TEXT                 VARCHAR2(2000)    NOT NULL,
    REPEATS                   NUMBER(1, 0)      NOT NULL,
    DISPLAY_POS               NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_CUS_ALERT_TYPE_PARAM PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_ALERT_TYPE_ID, FIELD_NAME),
    CONSTRAINT FK_CUST_ALRT_TYPE_PARAM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_ALERT_TYPE(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_SID                   NUMBER(10, 0)    NOT NULL,
    HAS_REPEATS               NUMBER(1, 0)     NOT NULL,
    CUSTOMER_ALERT_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    FILTER_XML                SYS.XMLType,
    CONSTRAINT CHK_CMS_ALERT_HAS_REPEATS CHECK (HAS_REPEATS IN (0,1)),
    CONSTRAINT PK_CMS_TAB_ALERT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_ALERT_TYPE_ID),
    CONSTRAINT FK_TAB_ALERT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_ALERT_HELPER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HELPER_SP						VARCHAR2(100) NOT NULL,
	TAB_SID							NUMBER(10) NOT NULL,
	DESCRIPTION						VARCHAR2(500) NOT NULL,
	CONSTRAINT PK_CMS_ALERT_HELPER PRIMARY KEY (CSRIMP_SESSION_ID, HELPER_SP),
    CONSTRAINT FK_CMS_ALERT_HELPER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_ALERT_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAB_SID							NUMBER(10) NOT NULL,
	CUSTOMER_ALERT_TYPE_ID			NUMBER(10) NOT NULL,
	DESCRIPTION						VARCHAR2(500) NOT NULL,
	LOOKUP_KEY						VARCHAR2(255),
	INCLUDE_IN_ALERT_SETUP			NUMBER(1),
	DELETED							NUMBER(1,0) NOT NULL,
	IS_BATCHED 						NUMBER(1, 0) NOT NULL,
	CONSTRAINT PK_CMS_ALERT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, TAB_SID, CUSTOMER_ALERT_TYPE_ID),
	CONSTRAINT CHK_INCLUDE_IN_ALERT_SETUP CHECK (INCLUDE_IN_ALERT_SETUP IN (1, 0)),
    CONSTRAINT FK_CMS_ALERT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_ID						RAW(16) NOT NULL,
	TO_USER_SID						NUMBER(10),
	TO_EMAIL_ADDRESS				VARCHAR2(255) NOT NULL,
	SENT_DTM						DATE NOT NULL,
	SUBJECT							VARCHAR2(4000),
	MESSAGE							BLOB NOT NULL,
	CONSTRAINT PK_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_ID),
    CONSTRAINT FK_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_BOUNCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_BOUNCE_ID					NUMBER(10) NOT NULL,
	ALERT_ID						RAW(16) NOT NULL,
	RECEIVED_DTM					DATE NOT NULL,
	MESSAGE							BLOB NOT NULL,
	CONSTRAINT PK_ALERT_BOUNCE PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_BOUNCE_ID),
    CONSTRAINT FK_ALERT_BOUNCE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.EXPORT_FEED (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EXPORT_FEED_SID 			NUMBER(10)		NOT NULL,
	NAME			 			VARCHAR2(100)	NOT NULL,
	PROTOCOL					NUMBER(1)		NOT NULL,
	URL							VARCHAR2(1024) 	NOT NULL,
    PERIOD_SET_ID				NUMBER(10),
    PERIOD_INTERVAL_ID			NUMBER(10),
    INTERVAL				 	VARCHAR2(1),
	START_DTM					DATE			NOT NULL,
	END_DTM						DATE,
	LAST_SUCCESS_ATTEMPT_DTM	DATE,
	LAST_ATTEMPT_DTM			DATE,
	SECURE_CREDS				CLOB NULL,
	ALERT_RECIPIENTS			VARCHAR(1024),
	CONSTRAINT PK_EXPORT_FEED PRIMARY KEY (CSRIMP_SESSION_ID, EXPORT_FEED_SID),
	CONSTRAINT FK_EXPORT_FEED_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.EXPORT_FEED_CMS_FORM (
	CSRIMP_SESSION_ID	NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EXPORT_FEED_SID		NUMBER(10)			NOT NULL,
	FORM_SID			NUMBER(10)			NOT NULL,
	FILENAME_MASK		VARCHAR2(255)		NOT NULL,
	FORMAT				NUMBER(1)			NOT NULL,
	INCREMENTAL			NUMBER(1)			NOT NULL,
	CONSTRAINT PK_EXPORT_FEED_CMS_FORM PRIMARY KEY (CSRIMP_SESSION_ID, EXPORT_FEED_SID, FORM_SID),
	CONSTRAINT FK_EF_CMS_FORM_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.EXPORT_FEED_DATAVIEW (
	CSRIMP_SESSION_ID	NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EXPORT_FEED_SID		NUMBER(10)			NOT NULL,
	DATAVIEW_SID		NUMBER(10)			NOT NULL,
	FILENAME_MASK		VARCHAR2(255)		NOT NULL,
	FORMAT				NUMBER(1)			NOT NULL,
	ASSEMBLY_NAME		VARCHAR2(150)		NOT NULL,
	CONSTRAINT PK_EXPORT_FEED_DATAVIEW PRIMARY KEY (CSRIMP_SESSION_ID, EXPORT_FEED_SID, DATAVIEW_SID),
	CONSTRAINT FK_EF_DATAVIEW_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.EXPORT_FEED_STORED_PROC (
	CSRIMP_SESSION_ID	NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EXPORT_FEED_SID		NUMBER(10)			NOT NULL,
	SP_NAME		    	VARCHAR2(100)		NOT NULL,
	SP_PARAMS			VARCHAR2(255)		NOT NULL,
	FILENAME_MASK		VARCHAR2(255)		NOT NULL,
	FORMAT				NUMBER(1)			NOT NULL,
	CONSTRAINT FK_EF_STORED_PROC_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.NON_COMPLIANCE_FILE(
    CSRIMP_SESSION_ID	    NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    NON_COMPLIANCE_FILE_ID  NUMBER(10, 0)    NOT NULL,
    NON_COMPLIANCE_ID       NUMBER(10, 0)    NOT NULL,
    FILENAME                VARCHAR2(255)    NOT NULL,
    MIME_TYPE               VARCHAR2(256)    NOT NULL,
    DATA                    BLOB             NOT NULL,
    SHA1                    RAW(20)          NOT NULL,
    UPLOADED_DTM            DATE             NOT NULL,
    CONSTRAINT PK_NON_COMPLIANCE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, NON_COMPLIANCE_FILE_ID),
    CONSTRAINT FK_NON_COMPLIANCE_FILE_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.DELEGATION_DATE_SCHEDULE (
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DELEGATION_DATE_SCHEDULE_ID 	NUMBER(10,0) 	NOT NULL,
	START_DTM 						DATE 			NOT NULL,
	END_DTM 						DATE 			NOT NULL,
	CONSTRAINT PK_DELEGATION_DATE_SCHEDULE PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_DATE_SCHEDULE_ID),
	CONSTRAINT CK_DATES CHECK (END_DTM > START_DTM),
	CONSTRAINT FK_DELEGATION_DATE_SCHEDULE_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_DATE_SCHEDULE(
    CSRIMP_SESSION_ID					NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_DATE_SCHEDULE_ID 		NUMBER(10, 0)   NOT NULL,
	START_DTM 							DATE 			NOT NULL,
	CREATION_DTM						DATE 			NOT NULL,
	SUBMISSION_DTM						DATE 			NOT NULL,
	REMINDER_DTM						DATE 			NOT NULL,
    CONSTRAINT PK_SHEET_DATE_SCHEDULE	PRIMARY KEY (CSRIMP_SESSION_ID, DELEGATION_DATE_SCHEDULE_ID, START_DTM),
	CONSTRAINT CK_SUBMISSION_DTM CHECK (SUBMISSION_DTM > START_DTM),
	CONSTRAINT CK_REMINDER_DTM CHECK (REMINDER_DTM <= SUBMISSION_DTM),
	CONSTRAINT FK_SHEET_DATE_SCHEDULE_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_DATE_SCHEDULE(
    CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_SID    				NUMBER(10, 0)	NOT NULL,
    ROLE_SID						NUMBER(10, 0),
	DELEG_PLAN_COL_ID               NUMBER(10, 0),
    SCHEDULE_XML					CLOB,
	REMINDER_OFFSET					NUMBER(10,0),
	DELEGATION_DATE_SCHEDULE_ID 	NUMBER(10, 0),
	CONSTRAINT UK_DELEG_PLAN_DATE_SCHEDULE  UNIQUE (DELEG_PLAN_SID, ROLE_SID, DELEG_PLAN_COL_ID),
	CONSTRAINT CK_SCHEDULE CHECK ((DELEGATION_DATE_SCHEDULE_ID IS NULL AND REMINDER_OFFSET IS NOT NULL AND SCHEDULE_XML IS NOT NULL) OR (DELEGATION_DATE_SCHEDULE_ID IS NOT NULL AND REMINDER_OFFSET IS NULL AND SCHEDULE_XML IS NULL)),
	CONSTRAINT FK_DELEG_PLAN_DATE_SCHEDULE_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.ISSUE_TYPE_AGGREGATE_IND_GRP (
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_TYPE_ID				NUMBER(10) NOT NULL,
	AGGREGATE_IND_GROUP_ID		NUMBER(10) NOT NULL,
	CONSTRAINT PK_ISS_TPY_AGG_IND_GRP PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_TYPE_ID, AGGREGATE_IND_GROUP_ID),
	CONSTRAINT FK_ISS_TPY_AGG_IND_GRP_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.RAG_STATUS(
    CSRIMP_SESSION_ID   NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RAG_STATUS_ID       NUMBER(10, 0)    NOT NULL,
    COLOUR              NUMBER(10, 0)    NOT NULL,
    LABEL               VARCHAR2(255)    NOT NULL,
    LOOKUP_KEY          VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_RAG_STATUS PRIMARY KEY (CSRIMP_SESSION_ID, RAG_STATUS_ID),
    CONSTRAINT FK_RAG_STATUS_IS FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_TYPE_RAG_STATUS(
    CSRIMP_SESSION_ID   NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_TYPE_ID       NUMBER(10, 0)    NOT NULL,
    RAG_STATUS_ID       NUMBER(10, 0)    NOT NULL,
    POS                 NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_TYPE_RAG_STATUS PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_TYPE_ID, RAG_STATUS_ID),
    CONSTRAINT FK_ISSUE_TYPE_RAG_STATUS_IS FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_ISSUE_AGGREGATE_IND (
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_SID 						NUMBER(10) NOT NULL,
    RAISED_IND_SID 					NUMBER(10),
    REJECTED_IND_SID 				NUMBER(10),
    CLOSED_ON_TIME_IND_SID 			NUMBER(10),
    CLOSED_LATE_IND_SID 			NUMBER(10),
    CLOSED_LATE_U30_IND_SID 		NUMBER(10),
    CLOSED_LATE_U60_IND_SID 		NUMBER(10),
    CLOSED_LATE_U90_IND_SID 		NUMBER(10),
    CLOSED_LATE_O90_IND_SID 		NUMBER(10),
    CLOSED_IND_SID					NUMBER(10),
    OPEN_IND_SID 					NUMBER(10),
    CLOSED_TD_IND_SID 				NUMBER(10),
    REJECTED_TD_IND_SID 			NUMBER(10),
    OPEN_OD_IND_SID 				NUMBER(10),
    OPEN_NOD_IND_SID 				NUMBER(10),
    OPEN_OD_U30_IND_SID 			NUMBER(10),
    OPEN_OD_U60_IND_SID 			NUMBER(10),
    OPEN_OD_U90_IND_SID 			NUMBER(10),
    OPEN_OD_O90_IND_SID 			NUMBER(10),
    CONSTRAINT PK_CMS_TAB_ISSUE_AGG_IND PRIMARY KEY (CSRIMP_SESSION_ID, TAB_SID),
	CONSTRAINT FK_CMS_TAB_ISSUE_AGG_IND_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_AGGREGATE_IND (
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_AGGREGATE_IND_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10),
    IND_SID NUMBER(10) NOT NULL,
    CONSTRAINT PK_CMS_TAB_AGG_IND PRIMARY KEY (CSRIMP_SESSION_ID, TAB_AGGREGATE_IND_ID),
    CONSTRAINT TUC_TAB_AGG_IND_1 UNIQUE (CSRIMP_SESSION_ID, TAB_SID, COLUMN_SID),
	CONSTRAINT FK_CMS_TAB_AGG_IND_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TERM_COND_DOC(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COMPANY_TYPE_ID					NUMBER(10, 0)     NOT NULL,
    DOC_ID							NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_TERM_COND_DOC PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TYPE_ID, DOC_ID),
	CONSTRAINT FK_TERM_COND_DOC_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TERM_COND_DOC_LOG(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_SID						NUMBER(10, 0)     NOT NULL,
    COMPANY_TYPE_ID					NUMBER(10, 0)     NOT NULL,
    DOC_ID							NUMBER(10, 0)     NOT NULL,
	DOC_VERSION						NUMBER(10, 0)     NOT NULL,
	ACCEPTED_DTM					DATE		      NOT NULL,
    CONSTRAINT PK_TERM_COND_DOC_LOG PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TYPE_ID, USER_SID, DOC_ID, DOC_VERSION),
	CONSTRAINT FK_TERM_COND_DOC_LOG_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);


CREATE TABLE CSRIMP.TENANT (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TENANT_ID NUMBER(10,0) NOT NULL,
    NAME VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_TENANT PRIMARY KEY (CSRIMP_SESSION_ID, TENANT_ID),
    CONSTRAINT FK_TENANT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SPACE_TYPE_REGION_METRIC (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SPACE_TYPE_ID NUMBER(10,0) NOT NULL,
    IND_SID NUMBER(10,0) NOT NULL,
    REGION_TYPE NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_SPACE_TYPE_REGION_METRIC PRIMARY KEY (CSRIMP_SESSION_ID, SPACE_TYPE_ID, IND_SID),
    CONSTRAINT FK_SPACE_TYPE_REGION_METRIC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SPACE_TYPE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SPACE_TYPE_ID NUMBER(10,0) NOT NULL,
    LABEL VARCHAR2(255) NOT NULL,
    IS_TENANTABLE NUMBER(1,0) NOT NULL,
    CONSTRAINT PK_SPACE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, SPACE_TYPE_ID),
    CONSTRAINT FK_SPACE_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE,
    CONSTRAINT CHK_SPACE_TYPE_IS_TENANT CHECK (IS_TENANTABLE IN (0,1))
);

CREATE TABLE CSRIMP.SPACE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID NUMBER(10,0) NOT NULL,
    SPACE_TYPE_ID NUMBER(10,0) NOT NULL,
    PROPERTY_REGION_SID NUMBER(10,0) NOT NULL,
    PROPERTY_TYPE_ID NUMBER(10,0) NOT NULL,
    CURRENT_LEASE_ID NUMBER(10,0),
    CONSTRAINT PK_SPACE PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID),
    CONSTRAINT FK_SPACE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_TYPE_TAG_GROUP (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_TYPE NUMBER(10,0) NOT NULL,
    TAG_GROUP_ID NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_REGION_TYPE_TAG_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, REGION_TYPE, TAG_GROUP_ID),
    CONSTRAINT FK_REGION_TYPE_TAG_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_TYPE_METRIC (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_TYPE NUMBER(2,0) NOT NULL,
    IND_SID NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_REGION_TYPE_METRIC PRIMARY KEY (CSRIMP_SESSION_ID, REGION_TYPE, IND_SID),
    CONSTRAINT FK_REGION_TYPE_METRIC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_METRIC (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MEASURE_SID NUMBER(10,0) NOT NULL,
    IND_SID NUMBER(10,0) NOT NULL,
    IS_MANDATORY NUMBER(1,0) NOT NULL,
	SHOW_MEASURE NUMBER(1) NOT NULL,
    CONSTRAINT PK_REGION_METRIC PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID),
    CONSTRAINT FK_REGION_METRIC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE,
    CONSTRAINT CHK_REG_METRIC_MAND CHECK (IS_MANDATORY IN (0,1))
);

CREATE TABLE CSRIMP.REGION_METRIC_VAL (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID NUMBER(10,0) NOT NULL,
    REGION_SID NUMBER(10,0) NOT NULL,
    EFFECTIVE_DTM DATE NOT NULL,
    ENTERED_BY_SID NUMBER(10,0) NOT NULL,
    ENTERED_DTM DATE NOT NULL,
    VAL NUMBER(24,10),
    NOTE VARCHAR2(4000),
    REGION_METRIC_VAL_ID NUMBER(10,0) NOT NULL,
    MEASURE_SID NUMBER(10,0) NOT NULL,
    SOURCE_TYPE_ID NUMBER(10,0) NOT NULL,
    ENTRY_MEASURE_CONVERSION_ID NUMBER(10,0),
    ENTRY_VAL NUMBER(24,10),
    CONSTRAINT PK_REGION_METRIC_VAL PRIMARY KEY (CSRIMP_SESSION_ID, REGION_METRIC_VAL_ID),
    CONSTRAINT FK_REGION_METRIC_VAL_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE,
	CONSTRAINT CK_REGION_METRIC_VAL_EFF_DTM CHECK (effective_dtm = TRUNC(effective_dtm, 'DD'))
);

CREATE TABLE CSRIMP.PROPERTY_TYPE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PROPERTY_TYPE_ID NUMBER(10,0) NOT NULL,
    LABEL VARCHAR2(255) NOT NULL,
	LOOKUP_KEY VARCHAR(255),
	GRESB_PROPERTY_TYPE_ID NUMBER(10),
    CONSTRAINT PK_PROPERTY_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PROPERTY_TYPE_ID),
    CONSTRAINT FK_PROPERTY_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROPERTY_TAB (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PLUGIN_ID NUMBER(10,0) NOT NULL,
    PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
    POS NUMBER(10,0) NOT NULL,
    TAB_LABEL VARCHAR2(50),
    CONSTRAINT PK_PROPERTY_TAB PRIMARY KEY (CSRIMP_SESSION_ID, PLUGIN_ID),
    CONSTRAINT FK_PROPERTY_TAB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROPERTY_TAB_GROUP (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PLUGIN_ID NUMBER(10,0) NOT NULL,
    GROUP_SID NUMBER(10,0),
    ROLE_SID  NUMBER(10,0),
    CONSTRAINT PK_PROPERTY_TAB_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, PLUGIN_ID, GROUP_SID),
	CONSTRAINT FK_PROPERTY_TAB_GRP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROP_TYPE_PROP_TAB (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROPERTY_TYPE_ID	NUMBER(10) NOT NULL,
	PLUGIN_ID			NUMBER(10) NOT NULL,
	CONSTRAINT PK_PROP_TYPE_PROP_TAB PRIMARY KEY (CSRIMP_SESSION_ID, PROPERTY_TYPE_ID, PLUGIN_ID),
	CONSTRAINT FK_PROP_TYPE_PROP_TAB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROPERTY_SUB_TYPE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PROPERTY_SUB_TYPE_ID NUMBER(10,0) NOT NULL,
    PROPERTY_TYPE_ID NUMBER(10,0) NOT NULL,
    LABEL VARCHAR2(255) NOT NULL,
	GRESB_PROPERTY_TYPE_ID NUMBER(10),
	GRESB_PROPERTY_SUB_TYPE_ID NUMBER(10),
    CONSTRAINT PK_PROPERTY_SUB_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PROPERTY_SUB_TYPE_ID),
    CONSTRAINT FK_PROPERTY_SUB_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROPERTY_OPTIONS (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PROPERTY_HELPER_PKG VARCHAR2(255),
	PROPERTIES_GEO_MAP_SID NUMBER(10),
	ENABLE_MULTI_FUND_OWNERSHIP NUMBER(1),
	GRESB_SERVICE_CONFIG VARCHAR2(255),
    AUTO_ASSIGN_MANAGER NUMBER(1, 0) NOT NULL,
	SHOW_INHERITED_ROLES NUMBER(1, 0) NOT NULL,
    CONSTRAINT PK_PROPERTY_OPTIONS PRIMARY KEY (CSRIMP_SESSION_ID),
    CONSTRAINT FK_PROPERTY_OPTIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROPERTY_CHARACTER_LAYOUT (
    CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ELEMENT_NAME 					VARCHAR2(255) NOT NULL,
    POS 							NUMBER(10,0) NOT NULL,
    COL 							NUMBER(10,0) NOT NULL,
	IND_SID							NUMBER(10),
	TAG_GROUP_ID					NUMBER(10),
    CONSTRAINT PK_PROPERTY_CHARACTER_LAYOUT PRIMARY KEY (CSRIMP_SESSION_ID, ELEMENT_NAME),
	CONSTRAINT FK_PROPERTY_CHAR_LAYOUT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE,
	CONSTRAINT CHK_PROP_CHAR_LAYT_IND_TG_GRP
		CHECK ((ind_sid IS NULL AND tag_group_id IS NULL) OR (ind_sid IS NOT NULL AND tag_group_id IS NULL) OR (ind_sid IS NULL AND tag_group_id IS NOT NULL))
);

CREATE TABLE CSRIMP.PROPERTY_ELEMENT_LAYOUT (
    CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ELEMENT_NAME 					VARCHAR2(255) NOT NULL,
    POS 							NUMBER(10,0) NOT NULL,
	IND_SID							NUMBER(10),
	TAG_GROUP_ID					NUMBER(10),
    CONSTRAINT PK_PROPERTY_ELEMENT_LAYOUT PRIMARY KEY (CSRIMP_SESSION_ID, ELEMENT_NAME),
	CONSTRAINT FK_PROPERTY_EL_LAYOUT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE,
	CONSTRAINT CHK_PROP_EL_LAYOUT_IND_TG_GRP
		CHECK ((ind_sid IS NULL AND tag_group_id IS NULL) OR (ind_sid IS NOT NULL AND tag_group_id IS NULL) OR (ind_sid IS NULL AND tag_group_id IS NOT NULL))
);

CREATE TABLE CSRIMP.PROPERTY_ADDRESS_OPTIONS (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ELEMENT_NAME VARCHAR2(255) NOT NULL,
    MANDATORY NUMBER(1,0) NOT NULL,
    CONSTRAINT PK_PROPERTY_ADDRESS_OPTIONS PRIMARY KEY (CSRIMP_SESSION_ID, ELEMENT_NAME),
	CONSTRAINT FK_PROPERTY_ADDR_OPTIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROPERTY (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID NUMBER(10,0) NOT NULL,
    STREET_ADDR_1 VARCHAR2(200),
    CITY VARCHAR2(200),
    STATE VARCHAR2(200),
    POSTCODE VARCHAR2(200),
    FLOW_ITEM_ID NUMBER(10,0),
    STREET_ADDR_2 VARCHAR2(200),
    PROPERTY_TYPE_ID NUMBER(10,0),
    COMPANY_SID NUMBER(10,0),
    PROPERTY_SUB_TYPE_ID NUMBER(10,0),
    MGMT_COMPANY_ID NUMBER(10,0),
    MGMT_COMPANY_OTHER VARCHAR2(255),
    PM_BUILDING_ID VARCHAR2(256),
    CURRENT_LEASE_ID NUMBER(10,0),
    MGMT_COMPANY_CONTACT_ID NUMBER(10,0),
    CONSTRAINT PK_PROPERTY PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID),
    CONSTRAINT FK_PROPERTY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROPERTY_PHOTO (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROPERTY_PHOTO_ID NUMBER(10,0) NOT NULL,
    PROPERTY_REGION_SID NUMBER(10,0) NOT NULL,
    SPACE_REGION_SID NUMBER(10,0),
    FILENAME VARCHAR2(256 BYTE) NOT NULL,
    MIME_TYPE VARCHAR2(255 BYTE) NOT NULL,
    DATA BLOB NOT NULL,
    CONSTRAINT PK_PROPERTY_PHOTO PRIMARY KEY (CSRIMP_SESSION_ID, PROPERTY_PHOTO_ID),
	CONSTRAINT FK_PROPERTY_PHOTO_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MGMT_COMPANY_FUND_CONTACT (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FUND_ID NUMBER(10,0) NOT NULL,
    MGMT_COMPANY_CONTACT_ID NUMBER(10,0) NOT NULL,
    MGMT_COMPANY_ID NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_MGMT_COMP_FUND_CONT PRIMARY KEY (CSRIMP_SESSION_ID, FUND_ID, MGMT_COMPANY_CONTACT_ID, MGMT_COMPANY_ID),
    CONSTRAINT FK_MGMT_COMP_FUND_CONT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MGMT_COMPANY_CONTACT (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MGMT_COMPANY_CONTACT_ID NUMBER(10,0) NOT NULL,
    NAME VARCHAR2(255) NOT NULL,
    EMAIL VARCHAR2(255),
    PHONE VARCHAR2(255),
    MGMT_COMPANY_ID NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_MGMT_COMPANY_CONTACT PRIMARY KEY (CSRIMP_SESSION_ID, MGMT_COMPANY_CONTACT_ID),
    CONSTRAINT FK_MGMT_COMPANY_CONTACT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MGMT_COMPANY (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MGMT_COMPANY_ID NUMBER(10,0) NOT NULL,
    NAME VARCHAR2(255) NOT NULL,
    COMPANY_SID NUMBER(10,0),
    CONSTRAINT PK_MGMT_COMPANY PRIMARY KEY (CSRIMP_SESSION_ID, MGMT_COMPANY_ID),
    CONSTRAINT FK_MGMT_COMPANY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_TYPE (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	METER_TYPE_ID				NUMBER(10,0) NOT NULL,
	LABEL						VARCHAR2(255) NOT NULL,
	GROUP_KEY					VARCHAR2(255),
	DAYS_IND_SID				NUMBER(10,0),
	COSTDAYS_IND_SID			NUMBER(10,0),
	REQ_APPROVAL				NUMBER(1) NOT NULL,
	FLOW_SID					NUMBER(10),
	CONSTRAINT CHK_REQ_APPROVAL_1_0 CHECK (REQ_APPROVAL IN (1,0)),
	CONSTRAINT PK_METER_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, METER_TYPE_ID),
	CONSTRAINT FK_METER_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_TYPE_INPUT (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_TYPE_ID      NUMBER(10, 0)    NOT NULL,
    METER_INPUT_ID    NUMBER(10, 0)    NOT NULL,
    AGGREGATOR        VARCHAR2(32)     NOT NULL,
    IND_SID           NUMBER(10, 0),
    MEASURE_SID       NUMBER(10, 0),
    CONSTRAINT PK_METER_TYPE_INPUT PRIMARY KEY (CSRIMP_SESSION_ID, METER_TYPE_ID, METER_INPUT_ID, AGGREGATOR),
    CONSTRAINT CONS_METER_TYPE_INPUT_MEASURE UNIQUE (CSRIMP_SESSION_ID, METER_TYPE_ID, METER_INPUT_ID, AGGREGATOR, MEASURE_SID)
);

CREATE TABLE CSRIMP.LEASE_TYPE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LEASE_TYPE_ID NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_LEASE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, LEASE_TYPE_ID),
    CONSTRAINT FK_LEASE_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.LEASE_SPACE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LEASE_ID NUMBER(10,0) NOT NULL,
    SPACE_REGION_SID NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_LEASE_SPACE PRIMARY KEY (CSRIMP_SESSION_ID, LEASE_ID, SPACE_REGION_SID),
    CONSTRAINT FK_LEASE_SPACE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.LEASE_PROPERTY (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LEASE_ID NUMBER(10,0) NOT NULL,
    PROPERTY_REGION_SID NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_LEASE_PROPERTY PRIMARY KEY (CSRIMP_SESSION_ID, LEASE_ID, PROPERTY_REGION_SID),
    CONSTRAINT FK_LEASE_PROPERTY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.LEASE_POSTIT (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LEASE_ID NUMBER(10,0) NOT NULL,
    POSTIT_ID NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_LEASE_POSTIT PRIMARY KEY (CSRIMP_SESSION_ID, LEASE_ID, POSTIT_ID),
    CONSTRAINT FK_LEASE_POSTIT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.LEASE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LEASE_ID NUMBER(10,0) NOT NULL,
    START_DTM DATE NOT NULL,
    END_DTM DATE,
    NEXT_BREAK_DTM DATE,
    CURRENT_RENT NUMBER(16,2),
    NORMALISED_RENT NUMBER(16,2),
    NEXT_RENT_REVIEW DATE,
    TENANT_ID NUMBER(10,0) NOT NULL,
    CURRENCY_CODE VARCHAR2(10) NOT NULL,
    CONSTRAINT PK_LEASE PRIMARY KEY (CSRIMP_SESSION_ID, LEASE_ID),
    CONSTRAINT FK_LEASE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FUND_TYPE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FUND_TYPE_ID NUMBER(10,0) NOT NULL,
    LABEL VARCHAR2(255),
    CONSTRAINT PK_FUND_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, FUND_TYPE_ID),
    CONSTRAINT FK_FUND_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FUND_FORM_PLUGIN (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PLUGIN_ID NUMBER(10,0) NOT NULL,
    POS NUMBER(10,0) NOT NULL,
    XML_PATH VARCHAR2(255) NOT NULL,
    KEY_NAME VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_FUND_FORM_PLUGIN PRIMARY KEY (CSRIMP_SESSION_ID, PLUGIN_ID, POS),
    CONSTRAINT FK_FUND_FORM_PLUGIN_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FUND (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FUND_ID NUMBER(10,0) NOT NULL,
    COMPANY_SID NUMBER(10,0) NOT NULL,
    NAME VARCHAR2(255) NOT NULL,
    YEAR_OF_INCEPTION NUMBER(10,0),
    FUND_TYPE_ID NUMBER(10,0),
    DEFAULT_MGMT_COMPANY_ID NUMBER(10,0),
    MGR_CONTACT_NAME VARCHAR2(255),
    MGR_CONTACT_EMAIL VARCHAR2(255),
    MGR_CONTACT_PHONE VARCHAR2(255),
	REGION_SID NUMBER(10, 0) NULL,
    CONSTRAINT PK_FUND PRIMARY KEY (CSRIMP_SESSION_ID, FUND_ID),
    CONSTRAINT FK_FUND_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PLUGIN_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_PLUGIN_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PLUGIN_TYPE_ID),
	CONSTRAINT FK_PLUGIN_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PLUGIN (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	CS_CLASS VARCHAR2(255) NOT NULL,
	DESCRIPTION VARCHAR2(50) NOT NULL,
	JS_CLASS VARCHAR2(255) NOT NULL,
	JS_INCLUDE VARCHAR2(255) NOT NULL,
	PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
	APP_SID						NUMBER(10), --NULLABLE
	DETAILS						VARCHAR2(4000),
	PREVIEW_IMAGE_PATH 			VARCHAR2(255),
	TAB_SID						NUMBER(10),
	FORM_PATH					VARCHAR2(255),
	FORM_SID					NUMBER(10),
	GROUP_KEY					VARCHAR2(255),
	CONTROL_LOOKUP_KEYS			VARCHAR2(255),
	SAVED_FILTER_SID			NUMBER(10),
	RESULT_MODE					NUMBER(10),
	PORTAL_SID					NUMBER(10),
	USE_REPORTING_PERIOD		NUMBER(10),
	R_SCRIPT_PATH				VARCHAR2(1024),
	PRE_FILTER_SID				NUMBER(10),
	ALLOW_MULTIPLE				NUMBER(10, 0),
	CONSTRAINT PK_PLUGIN PRIMARY KEY (CSRIMP_SESSION_ID, PLUGIN_ID),
	CONSTRAINT CK_ALLOW_MULTIPLE CHECK (ALLOW_MULTIPLE IN (1,0)),
	CONSTRAINT FK_PLUGIN_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PLUGIN_INDICATOR (
	CSRIMP_SESSION_ID 		NUMBER(10) 		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PLUGIN_INDICATOR_ID		NUMBER(10, 0)	NOT NULL,
	PLUGIN_ID 				NUMBER(10, 0)  	NOT NULL,
	LOOKUP_KEY				VARCHAR2(64)	NOT NULL,
	LABEL					VARCHAR2(128)	NOT NULL,
	POS						NUMBER(10, 0)	NULL,
	CONSTRAINT PK_PLUGIN_INDICATOR PRIMARY KEY (CSRIMP_SESSION_ID, PLUGIN_INDICATOR_ID),
	CONSTRAINT FK_PLUGIN_IND_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.PROPERTY_TYPE_SPACE_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROPERTY_TYPE_ID NUMBER(10,0) NOT NULL,
	SPACE_TYPE_ID NUMBER(10,0) NOT NULL,
	IS_HIDDEN NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_PROPERTY_TYPE_SPACE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PROPERTY_TYPE_ID, SPACE_TYPE_ID),
	CONSTRAINT FK_PROPERTY_TYPE_SPACE_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CURRENCY (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CURRENCY_CODE VARCHAR2(10) NOT NULL,
    CONSTRAINT PK_CURRENCY PRIMARY KEY (CSRIMP_SESSION_ID, CURRENCY_CODE),
    CONSTRAINT FK_CURRENCY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WORKSHEET (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	WORKSHEET_ID NUMBER(10,0) NOT NULL,
	HEADER_ROW_INDEX NUMBER(10,0) NOT NULL,
	LOWER_SHEET_NAME VARCHAR2(1000),
	SHEET_NAME VARCHAR2(1000) NOT NULL,
	WORKSHEET_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_WORKSHEET PRIMARY KEY (CSRIMP_SESSION_ID, WORKSHEET_ID),
	CONSTRAINT FK_WORKSHEET_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WORKSHEET_COLUMN (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	WORKSHEET_ID NUMBER(10,0) NOT NULL,
	COLUMN_TYPE_ID NUMBER(10,0) NOT NULL,
	COLUMN_INDEX NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_WORKSHEET_COLUMN PRIMARY KEY (CSRIMP_SESSION_ID, WORKSHEET_ID, COLUMN_TYPE_ID),
	CONSTRAINT FK_WORKSHEET_COLUMN_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WORKSHEET_COLUMN_VALUE_MAP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	WORKSHEET_ID NUMBER(10,0) NOT NULL,
	COLUMN_TYPE_ID NUMBER(10,0) NOT NULL,
	VALUE_MAPPER_ID NUMBER(10,0) NOT NULL,
	VALUE_MAP_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_WORKSHE_COLUMN_VALUE_MAP PRIMARY KEY (CSRIMP_SESSION_ID, WORKSHEET_ID, COLUMN_TYPE_ID, VALUE_MAPPER_ID, VALUE_MAP_ID),
	CONSTRAINT FK_WORKSHE_COLUMN_VALUE_MAP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WORKSHEET_ROW (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	WORKSHEET_ID NUMBER(10,0) NOT NULL,
	ROW_NUMBER NUMBER(10,0) NOT NULL,
	IGNORE NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_WORKSHEET_ROW PRIMARY KEY (CSRIMP_SESSION_ID, WORKSHEET_ID, ROW_NUMBER),
	CONSTRAINT FK_WORKSHEET_ROW_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WORKSHEET_VALUE_MAP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	VALUE_MAPPER_ID NUMBER(10,0) NOT NULL,
	VALUE_MAP_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_WORKSHEET_VALUE_MAP PRIMARY KEY (CSRIMP_SESSION_ID, VALUE_MAPPER_ID, VALUE_MAP_ID),
	CONSTRAINT FK_WORKSHEET_VALUE_MAP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WORKSHEET_VALUE_MAP_VALUE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	VALUE_MAP_ID NUMBER(10,0) NOT NULL,
	COLUMN_TYPE_ID NUMBER(10,0) NOT NULL,
	VALUE_MAPPER_ID NUMBER(10,0) NOT NULL,
	VALUE VARCHAR2(1000),
	CONSTRAINT PK_WORKSHEE_VALUE_MAP_VALUE PRIMARY KEY (CSRIMP_SESSION_ID, VALUE_MAP_ID, COLUMN_TYPE_ID, VALUE_MAPPER_ID),
	CONSTRAINT FK_WORKSHEE_VALUE_MAP_VALUE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CAPABILITY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAPABILITY_ID NUMBER(10,0) NOT NULL,
	CAPABILITY_NAME VARCHAR2(100) NOT NULL,
	CAPABILITY_TYPE_ID NUMBER(10,0) NOT NULL,
	IS_SUPPLIER NUMBER(1,0) NOT NULL,
	PERM_TYPE NUMBER(10,0) NOT NULL,
    SUPPLIER_ON_PURCHASER NUMBER(1, 0) NOT NULL,
	CONSTRAINT PK_CHAIN_CAPABILITY PRIMARY KEY (CSRIMP_SESSION_ID, CAPABILITY_ID),
	CONSTRAINT FK_CHAIN_CAPABILITY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CUSTOMER_OPTIONS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ADD_CSR_USER_TO_TOP_COMP NUMBER(1,0) NOT NULL,
	ADMIN_HAS_DEV_ACCESS NUMBER(1,0) NOT NULL,
	ALLOW_ADD_EXISTING_CONTACTS NUMBER(1,0) NOT NULL,
	ALLOW_CC_ON_INVITE NUMBER(1,0) NOT NULL,
	ALLOW_COMPANY_SELF_REG NUMBER(1,0) NOT NULL,
	ALLOW_NEW_USER_REQUEST NUMBER(1,0) NOT NULL,
	CHAIN_IS_VISIBLE_TO_TOP NUMBER(1,0) NOT NULL,
	COMPANY_USER_CREATE_ALERT NUMBER(1,0) NOT NULL,
	COUNTRIES_HELPER_SP VARCHAR2(100),
	DEFAULT_QNR_INVITATION_WIZ NUMBER(1,0) NOT NULL,
	DEFAULT_RECEIVE_SCHED_ALERTS NUMBER(1,0) NOT NULL,
	DEFAULT_SHARE_QNR_WITH_ON_BHLF NUMBER(1,0) NOT NULL,
	DEFAULT_URL VARCHAR2(4000),
	ENABLE_QNNAIRE_REMINDER_ALERTS NUMBER(1,0) NOT NULL,
	INVITATION_EXPIRATION_DAYS NUMBER(10,0) NOT NULL,
	INVITE_FROM_NAME_ADDENDUM VARCHAR2(4000),
	INV_MGR_NORM_USER_FULL_ACCESS NUMBER(1,0) NOT NULL,
	LANDING_URL VARCHAR2(1000),
	LAST_GENERATE_ALERT_DTM TIMESTAMP(6) NOT NULL,
	LINK_HOST VARCHAR2(100),
	LOGIN_PAGE_MESSAGE VARCHAR2(4000),
	NEWSFLASH_SUMMARY_SP VARCHAR2(100),
	OVERRIDE_SEND_QI_PATH VARCHAR2(2000),
	PRODUCT_URL VARCHAR2(4000),
	PRODUCT_URL_READ_ONLY VARCHAR2(4000),
	PURCHASED_COMP_AUTO_MAP NUMBER(1,0) NOT NULL,
	QUESTIONNAIRE_FILTER_CLASS VARCHAR2(100),
	REGISTRATION_TERMS_URL VARCHAR2(4000),
	REGISTRATION_TERMS_VERSION NUMBER(10,5),
	REQ_QNNAIRE_INVITATION_LANDING VARCHAR2(1000),
	RESTRICT_CHANGE_EMAIL_DOMAINS NUMBER(1,0) NOT NULL,
	SCHEDULED_ALERT_INTVL_MINUTES NUMBER(10,0) NOT NULL,
	SCHED_ALERTS_ENABLED NUMBER(1,0) NOT NULL,
	SEND_CHANGE_EMAIL_ALERT NUMBER(1,0) NOT NULL,
	SITE_NAME VARCHAR2(200),
	SUPPORT_EMAIL VARCHAR2(255),
	TASK_MANAGER_HELPER_TYPE VARCHAR2(1000),
	TOP_COMPANY_SID NUMBER(10,0),
	USE_COMPANY_TYPE_CSS_CLASS NUMBER(1,0) NOT NULL,
	USE_COMPANY_TYPE_USER_GROUPS NUMBER(1,0) NOT NULL,
	USE_TYPE_CAPABILITIES NUMBER(1,0) NOT NULL,
	ACTIVITY_MAIL_ACCOUNT_SID NUMBER(10),
	FLOW_HELPER_CLASS_PATH	VARCHAR2(1000),
	SUPPLIER_FILTER_EXPORT_URL	VARCHAR2(2000),
	ENABLE_USER_VISIBILITY_OPTIONS	NUMBER(1),
	REINVITE_SUPPLIER	NUMBER(1),
	OVERRIDE_MANAGE_CO_PATH	VARCHAR2(2000),
	SHOW_INVITATION_PREVIEW	NUMBER(1),
	SHOW_ALL_COMPONENTS	NUMBER(1),
	INVITATION_EXPIRATION_REM_DAYS NUMBER(10, 0) NOT NULL,
	INVITATION_EXPIRATION_REM NUMBER(1) NOT NULL,
    DASHBOARD_TASK_SCHEME_ID NUMBER(10, 0),
	COUNTRY_RISK_ENABLED NUMBER(1) NOT NULL,
	FILTER_CACHE_TIMEOUT NUMBER(10) NOT NULL,
	SHOW_MAP_ON_SUPPLIER_LIST NUMBER(1) NOT NULL,
	FORCE_LOGIN_AS_COMPANY NUMBER(1) NULL,
	ENABLE_DEDUPE_PREPROCESS NUMBER(1),
	SHOW_EXTRA_DETAILS_IN_GRAPH NUMBER(1) NOT NULL,
	ENABLE_DEDUPE_ONBOARDING NUMBER(1) NOT NULL,
	CREATE_ONE_FLOW_ITEM_FOR_COMP NUMBER(1) NOT NULL,
    SHOW_AUDIT_COORDINATOR NUMBER(1) NOT NULL,
	PREVENT_RELATIONSHIP_LOOPS NUMBER(1) NOT NULL,
	ALLOW_DUPLICATE_EMAILS NUMBER(1) NOT NULL,
	COMPANY_GEOTAG_ENABLED NUMBER(1) NOT NULL,
	CONSTRAINT CHK_CREATE_ONE_FLOW_ITEM CHECK(CREATE_ONE_FLOW_ITEM_FOR_COMP IN (0, 1)),
	CONSTRAINT PK_CHAIN_CUSTOMER_OPTIONS PRIMARY KEY (CSRIMP_SESSION_ID),
	CONSTRAINT CHK_SHOW_MAP_ON_SUP_LIST CHECK (SHOW_MAP_ON_SUPPLIER_LIST IN (0, 1)),
	CONSTRAINT CHK_ENABLE_DEDUPE_ONBOARDING CHECK (ENABLE_DEDUPE_ONBOARDING IN (0,1)),
    CONSTRAINT CHK_SHOW_AUDIT_COORDINATOR CHECK (SHOW_AUDIT_COORDINATOR IN (0,1)),
	CONSTRAINT CHK_ALLOW_DUP_EMAILS CHECK (allow_duplicate_emails IN (0, 1)),
	CONSTRAINT FK_CHAIN_CUSTOMER_OPTIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CUSTOMER_AGGREGATE_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CARD_GROUP_ID					NUMBER(10) NOT NULL,
	CUSTOMER_AGGREGATE_TYPE_ID		NUMBER(10) NOT NULL,
	CMS_AGGREGATE_TYPE_ID			NUMBER(10),
	INITIATIVE_METRIC_ID			NUMBER(10),
	IND_SID							NUMBER(10),
	FILTER_PAGE_IND_INTERVAL_ID		NUMBER(10),
	METER_AGGREGATE_TYPE_ID			NUMBER(10),
	SCORE_TYPE_AGG_TYPE_ID			NUMBER(10),
	CUST_FILT_ITEM_AGG_TYPE_ID		NUMBER(10),
	CONSTRAINT PK_CUSTOMER_AGGREGATE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_AGGREGATE_TYPE_ID)
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	ALLOW_LOWER_CASE NUMBER(1,0) NOT NULL,
	CSS_CLASS VARCHAR2(255),
	IS_DEFAULT NUMBER(1,0) NOT NULL,
	IS_TOP_COMPANY NUMBER(1,0) NOT NULL,
	LOOKUP_KEY VARCHAR2(100) NOT NULL,
	PLURAL VARCHAR2(100) NOT NULL,
	POSITION NUMBER(10,0) NOT NULL,
	SINGULAR VARCHAR2(100) NOT NULL,
	USER_GROUP_SID NUMBER(10,0),
	USER_ROLE_SID NUMBER(10,0),
	USE_USER_ROLE NUMBER(1,0) NOT NULL,
	DEFAULT_REGION_TYPE			NUMBER(2),
	REGION_ROOT_SID					NUMBER(10),
	DEFAULT_REGION_LAYOUT			VARCHAR2(255),
	CREATE_SUBSIDS_UNDER_PARENT		NUMBER(1) NOT NULL,
	CREATE_DOC_LIBRARY_FOLDER		NUMBER(1) NOT NULL,
	CONSTRAINT CHK_SUBS_UNDER_PARENT_1_0 CHECK (CREATE_SUBSIDS_UNDER_PARENT IN (1,0)),
	CONSTRAINT PK_CHAIN_COMPANY_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TYPE_ID),
	CONSTRAINT CHK_CREATE_DOC_LIB_FOLDER_1_0 CHECK (CREATE_DOC_LIBRARY_FOLDER IN (1, 0)),
	CONSTRAINT FK_CHAIN_COMPANY_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	ACTIVATED_DTM DATE,
	ACTIVE NUMBER(1,0) NOT NULL,
	ADDRESS_1 VARCHAR2(255),
	ADDRESS_2 VARCHAR2(255),
	ADDRESS_3 VARCHAR2(255),
	ADDRESS_4 VARCHAR2(255),
	ALLOW_STUB_REGISTRATION NUMBER(1,0) NOT NULL,
	APPROVE_STUB_REGISTRATION NUMBER(1,0) NOT NULL,
	CAN_SEE_ALL_COMPANIES NUMBER(1,0) NOT NULL,
	COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	COUNTRY_CODE VARCHAR2(2) NOT NULL,
	CREATED_DTM DATE,
	DELETED NUMBER(1,0) NOT NULL,
	DETAILS_CONFIRMED NUMBER(1,0) NOT NULL,
	FAX VARCHAR2(255),
	MAPPING_APPROVAL_REQUIRED NUMBER(1,0) NOT NULL,
	NAME VARCHAR2(255) NOT NULL,
	PHONE VARCHAR2(255),
	POSTCODE VARCHAR2(255),
	SECTOR_ID NUMBER(10,0),
	STATE VARCHAR2(255),
	STUB_REGISTRATION_GUID VARCHAR2(38),
	SUPP_REL_CODE_LABEL VARCHAR2(100),
	SUPP_REL_CODE_LABEL_MAND NUMBER(10,0) NOT NULL,
	CITY VARCHAR2(255),
	USER_LEVEL_MESSAGING NUMBER(10,0) NOT NULL,
	WEBSITE VARCHAR2(1000),
	EMAIL VARCHAR2(255),
	PARENT_SID NUMBER(10),
	COUNTRY_IS_HIDDEN NUMBER(1),
	DEACTIVATED_DTM DATE,
	REQUESTED_BY_COMPANY_SID NUMBER(10),
	REQUESTED_BY_USER_SID NUMBER(10),
	PENDING NUMBER(1) NOT NULL,
	SIGNATURE VARCHAR2(1024) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPANY PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID),
	CONSTRAINT CHK_PENDING CHECK (PENDING IN (0,1)),
	CONSTRAINT FK_CHAIN_COMPANY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SUPPLIER_SCORE_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUPPLIER_SCORE_ID NUMBER(10,0) NOT NULL,
	SCORE NUMBER(15,5),
	SCORE_THRESHOLD_ID NUMBER(10,0),
	SET_DTM DATE NOT NULL,
	SUPPLIER_SID NUMBER(10,0) NOT NULL,
	SCORE_TYPE_ID NUMBER(10,0),
	CHANGED_BY_USER_SID NUMBER(10,0),
	COMMENT_TEXT CLOB,
	VALID_UNTIL_DTM	DATE,
	SCORE_SOURCE_TYPE NUMBER(10),
	SCORE_SOURCE_ID NUMBER(10),
	CONSTRAINT PK_SUPPLIER_SCORE PRIMARY KEY (CSRIMP_SESSION_ID, SUPPLIER_SCORE_ID),
	CONSTRAINT FK_SUPPLIER_SCORE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CURRENT_SUPPLIER_SCORE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCORE_TYPE_ID		NUMBER(10, 0)	NOT NULL,
	COMPANY_SID			NUMBER(10, 0)	NOT NULL,
	LAST_SUPPLIER_SCORE_ID NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_CURRENT_SUPPLIER_SCORE PRIMARY KEY (CSRIMP_SESSION_ID, SCORE_TYPE_ID, COMPANY_SID),
	CONSTRAINT FK_CURRENT_SUPPLIER_SCORE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_APPLI_COMPA_CAPABI (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	GROUP_CAPABILITY_ID NUMBER(10,0) NOT NULL,
	PERMISSION_SET NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_APPLI_COMPA_CAPABI PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID, GROUP_CAPABILITY_ID, PERMISSION_SET),
	CONSTRAINT FK_CHAIN_APPLI_COMPA_CAPABI_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CHAIN_USER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	DEFAULT_COMPANY_SID NUMBER(10,0),
	DEFAULT_CSS_PATH VARCHAR2(200),
	DEFAULT_HOME_PAGE VARCHAR2(200),
	DEFAULT_STYLESHEET VARCHAR2(200),
	DELETED NUMBER(1,0) NOT NULL,
	DETAILS_CONFIRMED NUMBER(1,0) NOT NULL,
	MERGED_TO_USER_SID NUMBER(10,0),
	NEXT_SCHEDULED_ALERT_DTM TIMESTAMP(6) NOT NULL,
	RECEIVE_SCHEDULED_ALERTS NUMBER(1,0) NOT NULL,
	REGISTRATION_STATUS_ID NUMBER(10,0) NOT NULL,
	SCHEDULED_ALERT_TIME TIMESTAMP(6) NOT NULL,
	TMP_IS_CHAIN_USER NUMBER(1,0) NOT NULL,
	VISIBILITY_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_CHAIN_USER PRIMARY KEY (CSRIMP_SESSION_ID, USER_SID),
	CONSTRAINT FK_CHAIN_CHAIN_USER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	COMPANY_GROUP_TYPE_ID NUMBER(10,0) NOT NULL,
	GROUP_SID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_COMPANY_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID, COMPANY_GROUP_TYPE_ID),
	CONSTRAINT FK_CHAIN_COMPANY_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPAN_TYPE_RELATI (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRIMARY_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	SECONDARY_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	USE_USER_ROLES NUMBER(1,0) NOT NULL,
    FLOW_SID					 NUMBER(10, 0),
	HIDDEN NUMBER(1,0) NOT NULL,
	FOLLOWER_ROLE_SID NUMBER(10) NULL,
    CAN_BE_PRIMARY NUMBER(1) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPAN_TYPE_RELATI PRIMARY KEY (CSRIMP_SESSION_ID, PRIMARY_COMPANY_TYPE_ID, SECONDARY_COMPANY_TYPE_ID),
	CONSTRAINT FK_CHAIN_COMPAN_TYPE_RELATI_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPAN_TYPE_CAPABI (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAPABILITY_ID NUMBER(10,0) NOT NULL,
	PERMISSION_SET NUMBER(10,0) NOT NULL,
	PRIMARY_COMPANY_GROUP_TYPE_ID NUMBER(10,0) NULL,
	PRIMARY_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	SECONDARY_COMPANY_TYPE_ID NUMBER(10,0),
	TERTIARY_COMPANY_TYPE_ID NUMBER(10,0),
	PRIMARY_COMPANY_TYPE_ROLE_SID NUMBER(10,0),
	CONSTRAINT FK_CHAIN_COMPAN_TYPE_CAPABI_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_GROUP_CAPAB_OVERRI (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	GROUP_CAPABILITY_ID NUMBER(10,0) NOT NULL,
	HIDE_GROUP_CAPABILITY NUMBER(1,0) NOT NULL,
	PERMISSION_SET_OVERRIDE NUMBER(10,0),
	CONSTRAINT PK_CHAIN_GROUP_CAPAB_OVERRI PRIMARY KEY (CSRIMP_SESSION_ID, GROUP_CAPABILITY_ID),
	CONSTRAINT FK_CHAIN_GROUP_CAPAB_OVERRI_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_IMPLEMENTATION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EXECUTE_ORDER NUMBER(10,0) NOT NULL,
	LINK_PKG VARCHAR2(100),
	NAME VARCHAR2(100) NOT NULL,
	CONSTRAINT FK_CHAIN_IMPLEMENTATION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SECTOR (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SECTOR_ID NUMBER(10,0) NOT NULL,
	ACTIVE NUMBER(1,0) NOT NULL,
	DESCRIPTION VARCHAR2(255),
	IS_OTHER NUMBER(1,0) NOT NULL,
	PARENT_SECTOR_ID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_SECTOR PRIMARY KEY (CSRIMP_SESSION_ID, SECTOR_ID),
	CONSTRAINT FK_CHAIN_SECTOR_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TERTIARY_RELATIONS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRIMARY_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	SECONDARY_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	TERTIARY_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_TERTIARY_RELATIONS PRIMARY KEY (CSRIMP_SESSION_ID, PRIMARY_COMPANY_TYPE_ID, SECONDARY_COMPANY_TYPE_ID, TERTIARY_COMPANY_TYPE_ID),
	CONSTRAINT FK_CHAIN_TERTIARY_RELATIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);


CREATE TABLE CSRIMP.CHAIN_COMPANY_TYPE_ROLE (
	CSRIMP_SESSION_ID 		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_TYPE_ROLE_ID	NUMBER(10, 0)	NOT NULL,
	COMPANY_TYPE_ID			NUMBER(10, 0)	NOT NULL,
	ROLE_SID				NUMBER(10, 0)	NOT NULL,
	POS						NUMBER(10)		NOT NULL,
	MANDATORY				NUMBER(1)		NOT NULL,
	CASCADE_TO_SUPPLIER		NUMBER(1)		NOT NULL,
	CONSTRAINT PK_CHAIN_COMPANY_TYPE_ROLE		PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TYPE_ROLE_ID),
	CONSTRAINT UK_CHAIN_COMPANY_TYPE_ROLE		UNIQUE (CSRIMP_SESSION_ID, COMPANY_TYPE_ID, ROLE_SID) USING INDEX,
	CONSTRAINT FK_CHAIN_COMPANY_TYPE_ROLE_SES	FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SUPPLIER_RELATIONSHIP (
	CSRIMP_SESSION_ID 			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PURCHASER_COMPANY_SID		NUMBER(10, 0)	NOT NULL,
	SUPPLIER_COMPANY_SID		NUMBER(10, 0)	NOT NULL,
	ACTIVE						NUMBER(1) NOT NULL,
	DELETED						NUMBER(1) NOT NULL,
	VIRTUALLY_ACTIVE_UNTIL_DTM		TIMESTAMP(6),
	VIRTUALLY_ACTIVE_KEY		NUMBER(10),
	SUPP_REL_CODE				VARCHAR2(100),
	FLOW_ITEM_ID				NUMBER(10),
    IS_PRIMARY                  NUMBER(1) NOT NULL,
	CONSTRAINT PK_CHAIN_SUPPLIER_RELATIONSHIP	PRIMARY KEY (CSRIMP_SESSION_ID, PURCHASER_COMPANY_SID, SUPPLIER_COMPANY_SID),
	CONSTRAINT FK_CHAIN_SUPP_RELATIONSHIP_SES FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SUPP_REL_SOURCE (
	CSRIMP_SESSION_ID				NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PURCHASER_COMPANY_SID			NUMBER(10),
	SUPPLIER_COMPANY_SID			NUMBER(10),
	SOURCE_TYPE						NUMBER(2),
	OBJECT_ID						NUMBER(10),
	CONSTRAINT FK_SUPP_REL_SRC_SESSION FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CARD(
	CSRIMP_SESSION_ID 	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CARD_ID          NUMBER(10, 0)     NOT NULL,
	DESCRIPTION      VARCHAR2(4000)    NOT NULL,
	CLASS_TYPE       VARCHAR2(1000)    NOT NULL,
	JS_CLASS_TYPE    VARCHAR2(1000)    NOT NULL,
	JS_INCLUDE       VARCHAR2(1000)    NOT NULL,
	CSS_INCLUDE      VARCHAR2(1000),
	CONSTRAINT PK_CHAIN_CARD PRIMARY KEY (CSRIMP_SESSION_ID, CARD_ID),
	CONSTRAINT UC_CHAIN_CARD_JS  UNIQUE (CSRIMP_SESSION_ID, JS_CLASS_TYPE),
	CONSTRAINT FK_CHAIN_CARD_SES FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CARD_GROUP_CARD(
	CSRIMP_SESSION_ID 			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CARD_GROUP_ID              NUMBER(10, 0)    NOT NULL,
	CARD_ID                    NUMBER(10, 0)    NOT NULL,
	POSITION                   NUMBER(10, 0)    NOT NULL,
	REQUIRED_PERMISSION_SET    NUMBER(10, 0),
	REQUIRED_CAPABILITY_ID     NUMBER(10, 0),
	INVERT_CAPABILITY_CHECK    NUMBER(1, 0)    NOT NULL,
	FORCE_TERMINATE            NUMBER(1, 0)    NOT NULL,
	CONSTRAINT PK_CHAIN_CARD_GROUP_CARD PRIMARY KEY (CSRIMP_SESSION_ID, CARD_GROUP_ID, CARD_ID),
	CONSTRAINT FK_CHAIN_CARD_GROUP_CARD_SES FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CARD_GROUP_PROGRESSION(
    CSRIMP_SESSION_ID 	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CARD_GROUP_ID       NUMBER(10, 0)    NOT NULL,
    FROM_CARD_ID        NUMBER(10, 0)    NOT NULL,
    FROM_CARD_ACTION    VARCHAR2(100)    NOT NULL,
    TO_CARD_ID          NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_CHAIN_CARD_GROUP_PROGR PRIMARY KEY (CSRIMP_SESSION_ID, CARD_GROUP_ID, FROM_CARD_ID, FROM_CARD_ACTION),
	CONSTRAINT FK_CHAIN_CARD_GROUP_PROGR_SES FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.CHAIN_CARD_INIT_PARAM(
	CSRIMP_SESSION_ID 	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CARD_ID          NUMBER(10, 0)    NOT NULL,
    PARAM_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    KEY              VARCHAR2(255)    NOT NULL,
    VALUE            VARCHAR2(255)    NOT NULL,
    CARD_GROUP_ID    NUMBER(10, 0),
	CONSTRAINT CHK_CHAIN_CARD_INIT_PARAM_TYPE CHECK ((PARAM_TYPE_ID = 0 /* GLOBAL */ AND CARD_GROUP_ID IS NULL) OR (PARAM_TYPE_ID = 1 /* SPECIFIC */ AND CARD_GROUP_ID IS NOT NULL)),
	CONSTRAINT FK_CHAIN_CARD_INIT_PARAM_SES FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
)
;
CREATE UNIQUE INDEX CSRIMP.IX_CHAIN_CARD_INIT_PARAM ON CSRIMP.CHAIN_CARD_INIT_PARAM (CSRIMP_SESSION_ID, CARD_ID, KEY, CASE WHEN PARAM_TYPE_ID = 0 /* GLOBAL */ THEN 1 ELSE CARD_GROUP_ID END);

CREATE TABLE CSRIMP.CHAIN_SUPPLIER_FOLLOWER (
	CSRIMP_SESSION_ID 			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PURCHASER_COMPANY_SID		NUMBER(10, 0)	NOT NULL,
	SUPPLIER_COMPANY_SID		NUMBER(10, 0)	NOT NULL,
	USER_SID					NUMBER(10, 0)	NOT NULL,
	IS_PRIMARY					NUMBER(1)		NULL,
	CONSTRAINT PK_CHAIN_SUPPLIER_FOLLOWER PRIMARY KEY (CSRIMP_SESSION_ID, PURCHASER_COMPANY_SID, SUPPLIER_COMPANY_SID, USER_SID),
	CONSTRAINT FK_CHAIN_SUPPLIER_FOLLOWER_SES FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVITY_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	CSS_CLASS VARCHAR2(255) NOT NULL,
	DUE_DTM_RELATIVE NUMBER(10,0),
	DUE_DTM_RELATIVE_UNIT VARCHAR2(1),
	HAS_LOCATION NUMBER(1,0) NOT NULL,
	HAS_TARGET_USER NUMBER(1,0) NOT NULL,
	HELPER_PKG VARCHAR2(255),
	LABEL VARCHAR2(255) NOT NULL,
	LOOKUP_KEY VARCHAR2(255),
	USER_CAN_CREATE NUMBER(1,0) NOT NULL,
	TITLE_TEMPLATE VARCHAR(255),
	CAN_SHARE NUMBER(1, 0) NOT NULL,
	CONSTRAINT PK_CHAIN_ACTIVITY_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ID),
	CONSTRAINT FK_CHAIN_ACTIVITY_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_OUTCOME_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OUTCOME_TYPE_ID NUMBER(10,0) NOT NULL,
	IS_DEFERRED NUMBER(1,0),
	IS_FAILURE NUMBER(1,0) NOT NULL,
	IS_SUCCESS NUMBER(1,0) NOT NULL,
	LABEL VARCHAR2(255) NOT NULL,
	LOOKUP_KEY VARCHAR2(255),
	REQUIRE_REASON NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_OUTCOME_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, OUTCOME_TYPE_ID),
	CONSTRAINT FK_CHAIN_OUTCOME_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVI_OUTCOM_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	OUTCOME_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_ACTIVI_OUTCOM_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ID, OUTCOME_TYPE_ID),
	CONSTRAINT FK_CHAIN_ACTIVI_OUTCOM_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVITY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION CLOB NOT NULL,
	ACTIVITY_DTM DATE NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	ASSIGNED_TO_USER_SID NUMBER(10,0) NULL,
	ASSIGNED_TO_ROLE_SID NUMBER(10,0) NULL,
	CREATED_BY_ACTIVITY_ID NUMBER(10,0),
	CREATED_BY_COMPANY_SID NUMBER(10,0) NOT NULL,
	CREATED_BY_SID NUMBER(10,0) NOT NULL,
	CREATED_DTM DATE NOT NULL,
	LOCATION VARCHAR2(1000),
	LOCATION_TYPE NUMBER(10,0),
	ORIGINAL_ACTIVITY_DTM DATE NOT NULL,
	OUTCOME_REASON CLOB,
	OUTCOME_TYPE_ID NUMBER(10,0),
	TARGET_COMPANY_SID NUMBER(10,0) NOT NULL,
	TARGET_USER_SID NUMBER(10,0),
	TARGET_ROLE_SID NUMBER(10,0),
	SHARE_WITH_TARGET NUMBER(1, 0) NOT NULL,
	PROJECT_ID NUMBER(10, 0),
	CONSTRAINT PK_CHAIN_ACTIVITY PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_ID),
	CONSTRAINT FK_CHAIN_ACTIVITY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVITY_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_LOG_ID NUMBER(10,0) NOT NULL,
	ACTIVITY_ID NUMBER(10,0) NOT NULL,
	IS_SYSTEM_GENERATED NUMBER(1,0) NOT NULL,
	IS_VISIBLE_TO_SUPPLIER NUMBER(1,0) NOT NULL,
	LOGGED_BY_USER_SID NUMBER(10,0) NOT NULL,
	LOGGED_DTM DATE NOT NULL,
	MESSAGE CLOB NOT NULL,
	REPLY_TO_ACTIVITY_LOG_ID NUMBER(10),
	PARAM_1 VARCHAR2(2048),
	PARAM_2 VARCHAR2(2048),
	PARAM_3 VARCHAR2(2048),
    CORRESPONDENT_NAME VARCHAR2(256),
    IS_FROM_EMAIL NUMBER(1, 0) NOT NULL,
	CONSTRAINT PK_CHAIN_ACTIVITY_LOG PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_LOG_ID),
	CONSTRAINT CHK_ACT_LOG_FROM_EMAIL CHECK (IS_FROM_EMAIL IN (0,1)),
	CONSTRAINT CHK_ACT_LOG_IS_VIS_TO_SUP CHECK (IS_VISIBLE_TO_SUPPLIER IN (0,1)),
	CONSTRAINT FK_CHAIN_ACTIVITY_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVITY_LOG_FILE (
	CSRIMP_SESSION_ID 		NUMBER(10) 		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_LOG_FILE_ID 	NUMBER(10,0) 	NOT NULL,
	ACTIVITY_LOG_ID 		NUMBER(10,0) 	NOT NULL,
	DATA 					BLOB 			NOT NULL,
	FILENAME 				VARCHAR2(255) 	NOT NULL,
	MIME_TYPE 				VARCHAR2(256) 	NOT NULL,
	SHA1 					VARCHAR2(40) 	NOT NULL,
	UPLOADED_DTM 			DATE 			NOT NULL,
	CONSTRAINT PK_CHAIN_ACTIVITY_LOG_FILE PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_LOG_FILE_ID),
	CONSTRAINT FK_CHAIN_ACTIVITY_LOG_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTI_TYPE_TAG_GROU (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	TAG_GROUP_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_ACTI_TYPE_TAG_GROU PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ID, TAG_GROUP_ID),
	CONSTRAINT FK_CHAIN_ACTI_TYPE_TAG_GROU_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVITY_INVOLVEMENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0),
	ROLE_SID NUMBER(10, 0),
	ADDED_BY_SID NUMBER(10,0) NOT NULL,
	ADDED_DTM DATE NOT NULL,
	CONSTRAINT FK_CHAIN_ACTIVITY_USER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVITY_TAG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_ID NUMBER(10,0) NOT NULL,
	TAG_ID NUMBER(10,0) NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	TAG_GROUP_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_ACTIVITY_TAG PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_ID, TAG_ID),
	CONSTRAINT FK_CHAIN_ACTIVITY_TAG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVI_TYPE_ACTION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ACTION_ID NUMBER(10,0) NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	ALLOW_USER_INTERACTION NUMBER(1,0) NOT NULL,
	GENERATE_ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	DEFAULT_DESCRIPTION               CLOB,
    DEFAULT_ASSIGNED_TO_ROLE_SID      NUMBER(10, 0),
    DEFAULT_TARGET_ROLE_SID           NUMBER(10, 0),
    DEFAULT_ACT_DATE_RELATIVE         NUMBER(10, 0),
    DEFAULT_ACT_DATE_RELATIVE_UNIT    VARCHAR2(1),
	DEFAULT_SHARE_WITH_TARGET         NUMBER(1),
    DEFAULT_LOCATION                  VARCHAR2(1000),
    DEFAULT_LOCATION_TYPE	          NUMBER(10, 0),
	COPY_TAGS                         NUMBER(1),
	COPY_ASSIGNED_TO                  NUMBER(1),
	COPY_TARGET                       NUMBER(1),
    CONSTRAINT CHK_ACT_TYP_ACT_DATE_REL_UNIT CHECK (DEFAULT_ACT_DATE_RELATIVE_UNIT IN ('d','m')),
    CONSTRAINT CHK_ACT_TO_GEN_USER_INTER CHECK (ALLOW_USER_INTERACTION IN (0,1)),
    CONSTRAINT CHK_ACT_TYP_ACT_COPY_TAGS CHECK (COPY_TAGS IN (0,1)),
    CONSTRAINT CHK_ACT_TYP_ACT_COPY_ASS CHECK (COPY_ASSIGNED_TO IN (0,1)),
    CONSTRAINT CHK_ACT_TYP_ACT_COPY_TARGET CHECK (COPY_TARGET IN (0,1)),
	CONSTRAINT PK_CHAIN_ACTIVI_TYPE_ACTION PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ACTION_ID),
	CONSTRAINT FK_CHAIN_ACTIVI_TYPE_ACTION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACT_OUTC_TYPE_ACT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_OUTCOME_TYP_ACTION_ID NUMBER(10,0) NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	ALLOW_USER_INTERACTION NUMBER(1,0),
	GENERATE_ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	OUTCOME_TYPE_ID NUMBER(10,0) NOT NULL,
	DEFAULT_DESCRIPTION               CLOB,
    DEFAULT_ASSIGNED_TO_ROLE_SID      NUMBER(10, 0),
    DEFAULT_TARGET_ROLE_SID           NUMBER(10, 0),
    DEFAULT_ACT_DATE_RELATIVE         NUMBER(10, 0),
    DEFAULT_ACT_DATE_RELATIVE_UNIT    VARCHAR2(1),
	DEFAULT_SHARE_WITH_TARGET         NUMBER(1),
    DEFAULT_LOCATION                  VARCHAR2(1000),
    DEFAULT_LOCATION_TYPE	          NUMBER(10, 0),
	COPY_TAGS                         NUMBER(1),
	COPY_ASSIGNED_TO                  NUMBER(1),
	COPY_TARGET                       NUMBER(1),
    CONSTRAINT CHK_ACT_OUT_ACT_DATE_REL_UNIT CHECK (DEFAULT_ACT_DATE_RELATIVE_UNIT IN ('d','m')),
    CONSTRAINT CHK_ACT_OUT_ACT_ALLOW_USR_INT CHECK (ALLOW_USER_INTERACTION IN (0,1)),
    CONSTRAINT CHK_ACT_OUT_ACT_COPY_TAGS CHECK (COPY_TAGS IN (0,1)),
    CONSTRAINT CHK_ACT_OUT_ACT_COPY_ASS CHECK (COPY_ASSIGNED_TO IN (0,1)),
    CONSTRAINT CHK_ACT_OUT_ACT_COPY_TARGET CHECK (COPY_TARGET IN (0,1)),
	CONSTRAINT PK_CHAIN_ACT_OUTC_TYPE_ACT PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_OUTCOME_TYP_ACTION_ID),
	CONSTRAINT FK_CHAIN_ACT_OUTC_TYPE_ACT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACTIVIT_TYPE_ALERT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	CUSTOMER_ALERT_TYPE_ID NUMBER(10,0) NOT NULL,
	ALLOW_MANUAL_EDITING NUMBER(1,0) NOT NULL,
	LABEL VARCHAR2(255) NOT NULL,
	USE_SUPPLIER_COMPANY NUMBER(1,0) NOT NULL,
	SEND_TO_TARGET NUMBER(1,0) NOT NULL,
	SEND_TO_ASSIGNEE NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_ACTIVIT_TYPE_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ID, CUSTOMER_ALERT_TYPE_ID),
	CONSTRAINT FK_CHAIN_ACTIVIT_TYPE_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACT_TYPE_ALER_ROLE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	CUSTOMER_ALERT_TYPE_ID NUMBER(10,0) NOT NULL,
	ROLE_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_ACT_TYPE_ALER_ROLE PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ID, CUSTOMER_ALERT_TYPE_ID, ROLE_SID),
	CONSTRAINT FK_CHAIN_ACT_TYPE_ALER_ROLE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ACT_TYPE_DEFA_USER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_ACT_TYPE_DEFA_USER PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ID, USER_SID),
	CONSTRAINT FK_CHAIN_ACT_TYPE_DEFA_USER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PROJECT (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_ID			NUMBER(10, 0)	NOT NULL,
	NAME				VARCHAR(255)	NOT NULL,
	CONSTRAINT PK_PROJECT PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_ID),
	CONSTRAINT FK_PROJECT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT_TYPE (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_TYPE_ID				NUMBER(10, 0)   NOT NULL,
	PARENT_PRODUCT_TYPE_ID      NUMBER(10, 0),
	LABEL						VARCHAR2(4000) NOT NULL,
	LOOKUP_KEY					VARCHAR2(255),
	NODE_TYPE					NUMBER(10,0) 	NOT NULL,
	ACTIVE						NUMBER(1,0) 	NOT NULL,
	CONSTRAINT PK_PRODUCT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_TYPE_ID),
	CONSTRAINT UK_PRODUCT_TYPE UNIQUE (CSRIMP_SESSION_ID, PARENT_PRODUCT_TYPE_ID, LABEL),
	CONSTRAINT FK_CHAIN_PRODUCT_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT_TYPE_TR (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PRODUCT_TYPE_ID                 NUMBER(10, 0)     NOT NULL,
    LANG                            VARCHAR2(10)      NOT NULL,
    DESCRIPTION                     VARCHAR2(1023),
    LAST_CHANGED_DTM_DESCRIPTION    DATE,
    CONSTRAINT PK_PRODUCT_TYPE_TR PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_TYPE_ID, LANG),
	CONSTRAINT FK_PRODUCT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.chain_company_product_type (
	csrimp_session_id			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	company_sid					NUMBER(10, 0)   NOT NULL,
	product_type_id				NUMBER(10, 0)   NOT NULL,
	CONSTRAINT pk_company_product_type PRIMARY KEY (csrimp_session_id, company_sid, product_type_id),
	CONSTRAINT fk_chain_company_prod_type_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.chain_product_type_tag (
	csrimp_session_id			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	product_type_id				NUMBER(10, 0)   NOT NULL,
	tag_id						NUMBER(10, 0)   NOT NULL,
	CONSTRAINT pk_product_type_tag PRIMARY KEY (csrimp_session_id, product_type_id, tag_id),
	CONSTRAINT fk_chain_product_type_tag_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.quick_survey_question_tag (
	csrimp_session_id		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	question_id				NUMBER(10)  NOT NULL,
	question_version		NUMBER(10, 0)	NOT NULL,
	survey_sid				NUMBER(10, 0)	NOT NULL,
	survey_version			NUMBER(10)  NOT NULL,
	tag_id					NUMBER(10)  NOT NULL,
	CONSTRAINT pk_qs_question_tag PRIMARY KEY (csrimp_session_id, question_id, survey_version, tag_id),
	CONSTRAINT fk_qs_question_tag_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.audit_type_tab (
	csrimp_session_id		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	internal_audit_type_id	NUMBER(10) NOT NULL,
	plugin_type_id			NUMBER(10) NOT NULL,
	plugin_id				NUMBER(10) NOT NULL,
	pos						NUMBER(10) NOT NULL,
	tab_label				VARCHAR2(255),
	flow_capability_id		NUMBER(10),
	CONSTRAINT pk_audit_type_tab PRIMARY KEY (csrimp_session_id, internal_audit_type_id, plugin_id),
	CONSTRAINT chk_audit_type_tab_plugin_typ CHECK (plugin_type_id = 13),
	CONSTRAINT fk_audit_type_tab_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.audit_type_header (
	csrimp_session_id		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	internal_audit_type_id	NUMBER(10) NOT NULL,
	plugin_type_id			NUMBER(10) NOT NULL,
	plugin_id				NUMBER(10) NOT NULL,
	pos						NUMBER(10) NOT NULL,
	CONSTRAINT pk_audit_type_header PRIMARY KEY (csrimp_session_id, internal_audit_type_id, plugin_id),
	CONSTRAINT chk_audit_type_head_plugin_typ CHECK (plugin_type_id = 14),
	CONSTRAINT fk_audit_type_header_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ALERT_PARTI_TEMPLA (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_TYPE_ID NUMBER(10,0) NOT NULL,
	PARTIAL_TEMPLATE_TYPE_ID NUMBER(10,0) NOT NULL,
	LANG VARCHAR2(10) NOT NULL,
	PARTIAL_HTML CLOB NOT NULL,
	CONSTRAINT PK_CHAIN_ALERT_PARTI_TEMPLA PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_TYPE_ID, PARTIAL_TEMPLATE_TYPE_ID, LANG),
	CONSTRAINT FK_CHAIN_ALERT_PARTI_TEMPLA_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ALE_PART_TEMP_PARA (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_TYPE_ID NUMBER(10,0) NOT NULL,
	PARTIAL_TEMPLATE_TYPE_ID NUMBER(10,0) NOT NULL,
	FIELD_NAME VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_CHAIN_ALE_PART_TEMP_PARA PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_TYPE_ID, PARTIAL_TEMPLATE_TYPE_ID, FIELD_NAME),
	CONSTRAINT FK_CHAIN_ALE_PART_TEMP_PARA_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_AMOUNT_UNIT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AMOUNT_UNIT_ID NUMBER(10,0) NOT NULL,
	CONVERSION_TO_BASE NUMBER(20,10),
	DESCRIPTION VARCHAR2(255) NOT NULL,
	UNIT_TYPE VARCHAR2(32) NOT NULL,
	CONSTRAINT PK_CHAIN_AMOUNT_UNIT PRIMARY KEY (CSRIMP_SESSION_ID, AMOUNT_UNIT_ID),
	CONSTRAINT FK_CHAIN_AMOUNT_UNIT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_AUDIT_REQUEST (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AUDIT_REQUEST_ID NUMBER(10,0) NOT NULL,
	AUDITEE_COMPANY_SID NUMBER(10,0) NOT NULL,
	AUDITOR_COMPANY_SID NUMBER(10,0) NOT NULL,
	AUDIT_SID NUMBER(10,0),
	NOTES CLOB,
	PROPOSED_DTM DATE,
	REQUESTED_AT_DTM DATE NOT NULL,
	REQUESTED_BY_COMPANY_SID NUMBER(10,0) NOT NULL,
	REQUESTED_BY_USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_AUDIT_REQUEST PRIMARY KEY (CSRIMP_SESSION_ID, AUDIT_REQUEST_ID),
	CONSTRAINT FK_CHAIN_AUDIT_REQUEST_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_AUDIT_REQUES_ALERT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AUDIT_REQUEST_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	SENT_DTM DATE,
	CONSTRAINT PK_CHAIN_AUDIT_REQUES_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, AUDIT_REQUEST_ID, USER_SID),
	CONSTRAINT FK_CHAIN_AUDIT_REQUES_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_BUSINESS_UNIT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_UNIT_ID NUMBER(10,0) NOT NULL,
	ACTIVE NUMBER(1,0) NOT NULL,
	DESCRIPTION VARCHAR2(255) NOT NULL,
	PARENT_BUSINESS_UNIT_ID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_BUSINESS_UNIT PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_UNIT_ID),
	CONSTRAINT FK_CHAIN_BUSINESS_UNIT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_BUSINE_UNIT_MEMBER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_UNIT_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	IS_PRIMARY_BU NUMBER(1,0),
	CONSTRAINT PK_CHAIN_BUSINE_UNIT_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_UNIT_ID, USER_SID),
	CONSTRAINT FK_CHAIN_BUSINE_UNIT_MEMBER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_BUSINE_UNIT_SUPPLI (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_UNIT_ID NUMBER(10,0) NOT NULL,
	SUPPLIER_COMPANY_SID NUMBER(10,0) NOT NULL,
	IS_PRIMARY_BU NUMBER(1,0),
	CONSTRAINT PK_CHAIN_BUSINE_UNIT_SUPPLI PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_UNIT_ID, SUPPLIER_COMPANY_SID),
	CONSTRAINT FK_CHAIN_BUSINE_UNIT_SUPPLI_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CH_USE_EMA_ADD_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EMAIL VARCHAR2(256) NOT NULL,
	LAST_MODIFIED_DTM DATE NOT NULL,
	MODIFIED_BY_SID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT FK_CHAIN_CH_USE_EMA_ADD_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_CC_EMAIL (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	LOWER_EMAIL VARCHAR2(255) NOT NULL,
	EMAIL VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPANY_CC_EMAIL PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID, LOWER_EMAIL),
	CONSTRAINT FK_CHAIN_COMPANY_CC_EMAIL_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_HEADER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_HEADER_ID NUMBER(10,0) NOT NULL,
	PAGE_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	USER_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	VIEWING_OWN_COMPANY				NUMBER(1) NOT NULL,
	PAGE_COMPANY_COL_SID NUMBER(10,0),
	USER_COMPANY_COL_SID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_COMPANY_HEADER PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_HEADER_ID),
	CONSTRAINT FK_CHAIN_COMPANY_HEADER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPAN_METRIC_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_METRIC_TYPE_ID NUMBER(10,0) NOT NULL,
	CLASS VARCHAR2(64) NOT NULL,
	DESCRIPTION VARCHAR2(200) NOT NULL,
	MAX_VALUE NUMBER(10,3) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPAN_METRIC_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_METRIC_TYPE_ID),
	CONSTRAINT FK_CHAIN_COMPAN_METRIC_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_METRIC (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_METRIC_TYPE_ID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	METRIC_VALUE NUMBER(10,3),
	NORMALISED_VALUE NUMBER(10,3),
	CONSTRAINT PK_CHAIN_COMPANY_METRIC PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_METRIC_TYPE_ID, COMPANY_SID),
	CONSTRAINT FK_CHAIN_COMPANY_METRIC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_REFERENCE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_REFERENCE_ID NUMBER(10,0) NOT NULL,
	REFERENCE_ID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	VALUE VARCHAR2(200),
	CONSTRAINT PK_CHAIN_COMPANY_REFERENCE PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_REFERENCE_ID),
	CONSTRAINT FK_CHAIN_COMPANY_REFERENCE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_TAB (
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_TAB_ID					NUMBER(10,0)	NOT NULL,
	LABEL							VARCHAR2(254)	NOT NULL,
	PAGE_COMPANY_TYPE_ID			NUMBER(10,0)	NOT NULL,
	PLUGIN_ID						NUMBER(10,0)	NOT NULL,
	PLUGIN_TYPE_ID					NUMBER(10,0)	NOT NULL,
	POS								NUMBER(10,0)	NOT NULL,
	USER_COMPANY_TYPE_ID			NUMBER(10,0)	NOT NULL,
	VIEWING_OWN_COMPANY				NUMBER(1)		NOT NULL,
	OPTIONS							VARCHAR2(255),
	PAGE_COMPANY_COL_SID			NUMBER(10)		NULL,
	USER_COMPANY_COL_SID			NUMBER(10)		NULL,
	FLOW_CAPABILITY_ID				NUMBER(10, 0),
	BUSINESS_RELATIONSHIP_TYPE_ID	NUMBER(10, 0),
	DEFAULT_SAVED_FILTER_SID		NUMBER(10)		NULL,
    SUPPLIER_RESTRICTION            NUMBER(1)       NOT NULL,
	CONSTRAINT PK_CHAIN_COMPANY_TAB PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TAB_ID),
	CONSTRAINT FK_CHAIN_COMPANY_TAB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CO_TAB_RELATED_CO_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_TAB_ID					NUMBER(10, 0)	NOT NULL,
	COMPANY_TYPE_ID					NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_CO_TAB_REL_CO_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TAB_ID, COMPANY_TYPE_ID),
	CONSTRAINT FK_CO_TAB_REL_CO_TYPE FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMP_TAB_COMP_TYPE_ROLE(
	CSRIMP_SESSION_ID				NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMP_TAB_COMP_TYPE_ROLE_ID		NUMBER(10, 0)	NOT NULL,
	COMPANY_TAB_ID					NUMBER(10, 0)	NOT NULL,
	COMPANY_GROUP_TYPE_ID			NUMBER(10, 0),
	COMPANY_TYPE_ROLE_ID			NUMBER(10, 0),
	CONSTRAINT PK_CHAIN_CMP_TAB_CMP_TYPE_ROLE PRIMARY KEY (CSRIMP_SESSION_ID, COMP_TAB_COMP_TYPE_ROLE_ID),
	CONSTRAINT FK_CHAIN_CMP_TAB_TYPE_ROLE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT_HEADER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_HEADER_ID NUMBER(10,0) NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	PRODUCT_COL_SID NUMBER(10,0),
	PRODUCT_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	USER_COMPANY_COL_SID NUMBER(10,0),
	USER_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	VIEWING_AS_SUPPLIER NUMBER(1,0) NOT NULL,
	VIEWING_OWN_PRODUCT NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PRODUCT_HEADER PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_HEADER_ID),
	CONSTRAINT FK_CHAIN_PRODUCT_HEADER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRO_HEAD_PRO_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_HEADER_ID NUMBER(10,0) NOT NULL,
	PRODUCT_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PRO_HEAD_PRO_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_HEADER_ID, PRODUCT_TYPE_ID),
	CONSTRAINT FK_CHAIN_PRO_HEAD_PRO_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT_TAB (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_TAB_ID NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(254) NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	PRODUCT_COL_SID NUMBER(10,0),
	PRODUCT_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	USER_COMPANY_COL_SID NUMBER(10,0),
	USER_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	VIEWING_AS_SUPPLIER NUMBER(1,0) NOT NULL,
	VIEWING_OWN_PRODUCT NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PRODUCT_TAB PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_TAB_ID),
	CONSTRAINT FK_CHAIN_PRODUCT_TAB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PROD_TAB_PROD_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_TAB_ID NUMBER(10,0) NOT NULL,
	PRODUCT_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PROD_TAB_PROD_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_TAB_ID, PRODUCT_TYPE_ID),
	CONSTRAINT FK_CHAIN_PROD_TAB_PROD_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUC_SUPPLIE_TAB (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_SUPPLIER_TAB_ID NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(254) NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	PRODUCT_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	USER_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	VIEWING_AS_SUPPLIER NUMBER(1,0) NOT NULL,
	VIEWING_OWN_PRODUCT NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PRODUC_SUPPLIE_TAB PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_SUPPLIER_TAB_ID),
	CONSTRAINT FK_CHAIN_PRODUC_SUPPLIE_TAB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PR_SUP_TAB_PR_TYP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_SUPPLIER_TAB_ID NUMBER(10,0) NOT NULL,
	PRODUCT_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PR_SUP_TAB_PR_TYP PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_SUPPLIER_TAB_ID, PRODUCT_TYPE_ID),
	CONSTRAINT FK_CHAIN_PR_SUP_TAB_PR_TYP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_TAG_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	TAG_GROUP_ID NUMBER(10,0) NOT NULL,
	APPLIES_TO_COMPONENT NUMBER(1,0) NOT NULL,
	APPLIES_TO_PURCHASE NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPANY_TAG_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID, TAG_GROUP_ID),
	CONSTRAINT FK_CHAIN_COMPANY_TAG_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPONENT_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPONENT_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPONENT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, COMPONENT_TYPE_ID),
	CONSTRAINT FK_CHAIN_COMPONENT_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPON_TYPE_CONTAI (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CONTAINER_COMPONENT_TYPE_ID NUMBER(10,0) NOT NULL,
	CHILD_COMPONENT_TYPE_ID NUMBER(10,0) NOT NULL,
	ALLOW_ADD_EXISTING NUMBER(1,0) NOT NULL,
	ALLOW_ADD_NEW NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPON_TYPE_CONTAI PRIMARY KEY (CSRIMP_SESSION_ID, CONTAINER_COMPONENT_TYPE_ID, CHILD_COMPONENT_TYPE_ID),
	CONSTRAINT FK_CHAIN_COMPON_TYPE_CONTAI_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPONENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPONENT_ID NUMBER(10,0) NOT NULL,
	AMOUNT_CHILD_PER_PARENT NUMBER(10,3),
	AMOUNT_UNIT_ID NUMBER(10,0),
	COMPANY_SID NUMBER(10,0) NOT NULL,
	COMPONENT_CODE VARCHAR2(4000),
	COMPONENT_NOTES VARCHAR2(4000),
	COMPONENT_TYPE_ID NUMBER(10,0) NOT NULL,
	CREATED_BY_SID NUMBER(10,0) NOT NULL,
	CREATED_DTM DATE NOT NULL,
	DELETED NUMBER(1,0) NOT NULL,
	DESCRIPTION VARCHAR2(4000),
	PARENT_COMPONENT_ID NUMBER(10,0),
	PARENT_COMPONENT_TYPE_ID NUMBER(10,0),
	POSITION NUMBER(10,0),
	CONSTRAINT PK_CHAIN_COMPONENT PRIMARY KEY (CSRIMP_SESSION_ID, COMPONENT_ID),
	CONSTRAINT FK_CHAIN_COMPONENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FILE_UPLOAD (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FILE_UPLOAD_SID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	DATA BLOB NOT NULL,
	DOWNLOAD_PERMISSION_ID NUMBER(10,0) NOT NULL,
	FILENAME VARCHAR2(255) NOT NULL,
	LANG VARCHAR2(10),
	LAST_MODIFIED_BY_SID NUMBER(10,0),
	LAST_MODIFIED_DTM TIMESTAMP(6) NOT NULL,
	MIME_TYPE VARCHAR2(255) NOT NULL,
	SHA1 RAW(20) NOT NULL,
	CONSTRAINT PK_CHAIN_FILE_UPLOAD PRIMARY KEY (CSRIMP_SESSION_ID, FILE_UPLOAD_SID),
	CONSTRAINT FK_CHAIN_FILE_UPLOAD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPONENT_DOCUMENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPONENT_ID NUMBER(10,0) NOT NULL,
	FILE_UPLOAD_SID NUMBER(10,0) NOT NULL,
	KEY VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPONENT_DOCUMENT PRIMARY KEY (CSRIMP_SESSION_ID, COMPONENT_ID, FILE_UPLOAD_SID),
	CONSTRAINT FK_CHAIN_COMPONENT_DOCUMENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPONENT_SOURCE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CARD_GROUP_ID NUMBER(10,0),
	CARD_TEXT VARCHAR2(2000) NOT NULL,
	COMPONENT_TYPE_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION_XML VARCHAR2(4000),
	POSITION NUMBER(10,0) NOT NULL,
	PROGRESSION_ACTION VARCHAR2(100) NOT NULL,
	CONSTRAINT FK_CHAIN_COMPONENT_SOURCE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPONENT_TAG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAG_ID NUMBER(10,0) NOT NULL,
	COMPONENT_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPONENT_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TAG_ID, COMPONENT_ID),
	CONSTRAINT FK_CHAIN_COMPONENT_TAG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPOUND_FILTER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPOUND_FILTER_ID NUMBER(10,0) NOT NULL,
	ACT_ID CHAR(36),
	CARD_GROUP_ID NUMBER(10,0) NOT NULL,
	CREATED_BY_USER_SID NUMBER(10,0) NOT NULL,
	CREATED_DTM DATE NOT NULL,
	OPERATOR_TYPE VARCHAR2(8) NOT NULL,
	CONSTRAINT PK_CHAIN_COMPOUND_FILTER PRIMARY KEY (CSRIMP_SESSION_ID, COMPOUND_FILTER_ID),
	CONSTRAINT FK_CHAIN_COMPOUND_FILTER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CUS_ALER_ENTR_TEMP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_ENTRY_TYPE_ID NUMBER(10,0) NOT NULL,
	TEMPLATE_NAME VARCHAR2(100) NOT NULL,
	TEMPLATE VARCHAR2(1000) NOT NULL,
	CONSTRAINT PK_CHAIN_CUS_ALER_ENTR_TEMP PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_ENTRY_TYPE_ID, TEMPLATE_NAME),
	CONSTRAINT FK_CHAIN_CUS_ALER_ENTR_TEMP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CUS_ALER_ENTR_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_ENTRY_TYPE_ID NUMBER(10,0) NOT NULL,
	COMPANY_SECTION_TEMPLATE VARCHAR2(1000),
	ENABLED NUMBER(1,0),
	FORCE_DISABLE NUMBER(1,0),
	GENERATOR_SP VARCHAR2(255),
	IMPORTANT_SECTION_TEMPLATE VARCHAR2(1000),
	SCHEDULE_XML CLOB,
	USER_SECTION_TEMPLATE VARCHAR2(1000),
	CONSTRAINT PK_CHAIN_CUS_ALER_ENTR_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_ENTRY_TYPE_ID),
	CONSTRAINT FK_CHAIN_CUS_ALER_ENTR_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEF_PROD_CODE_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CODE_LABEL1 VARCHAR2(100) NOT NULL,
	CODE_LABEL2 VARCHAR2(100),
	CODE_LABEL3 VARCHAR2(100),
	CONSTRAINT FK_CHAIN_DEF_PROD_CODE_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DE_SUP_REL_COD_LAB (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LABEL VARCHAR2(100) NOT NULL,
	MANDATORY NUMBER(1,0) NOT NULL,
	CONSTRAINT FK_CHAIN_DE_SUP_REL_COD_LAB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_EMAIL_STUB (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	LOWER_STUB VARCHAR2(100) NOT NULL,
	STUB VARCHAR2(100) NOT NULL,
	CONSTRAINT PK_CHAIN_EMAIL_STUB PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID, LOWER_STUB),
	CONSTRAINT FK_CHAIN_EMAIL_STUB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FILE_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FILE_GROUP_ID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0),
	DEFAULT_FILE_GROUP_FILE_ID NUMBER(10,0),
	DESCRIPTION VARCHAR2(4000),
	DOWNLOAD_PERMISSION_ID NUMBER(10,0) NOT NULL,
	FILE_GROUP_MODEL_ID NUMBER(10,0) NOT NULL,
	GUID VARCHAR2(38) NOT NULL,
	TITLE VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHAIN_FILE_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, FILE_GROUP_ID),
	CONSTRAINT FK_CHAIN_FILE_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FILE_GROUP_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FILE_GROUP_FILE_ID NUMBER(10,0) NOT NULL,
	FILE_GROUP_ID NUMBER(10,0) NOT NULL,
	FILE_UPLOAD_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_FILE_GROUP_FILE PRIMARY KEY (CSRIMP_SESSION_ID, FILE_GROUP_FILE_ID),
	CONSTRAINT FK_CHAIN_FILE_GROUP_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FILTER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FILTER_ID NUMBER(10,0) NOT NULL,
	COMPOUND_FILTER_ID NUMBER(10,0) NOT NULL,
	FILTER_TYPE_ID NUMBER(10,0) NOT NULL,
	OPERATOR_TYPE VARCHAR2(8) NOT NULL,
	CONSTRAINT PK_CHAIN_FILTER PRIMARY KEY (CSRIMP_SESSION_ID, FILTER_ID),
	CONSTRAINT FK_CHAIN_FILTER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FILTER_FIELD (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FILTER_FIELD_ID NUMBER(10,0) NOT NULL,
	COMPARATOR VARCHAR2(64),
	FILTER_ID NUMBER(10,0) NOT NULL,
	NAME VARCHAR2(255),
	GROUP_BY_INDEX     NUMBER(1),
	SHOW_ALL           NUMBER(1),
	TOP_N			   NUMBER(10),
	BOTTOM_N		   NUMBER(10),
	SHOW_OTHER		   NUMBER(1),
	COLUMN_SID		   NUMBER(10),
	PERIOD_SET_ID		NUMBER(10),
	PERIOD_INTERVAL_ID	NUMBER(10),
	CONSTRAINT CHK_FLTR_FLD_SHO_ALL_0_1 CHECK (SHOW_ALL IN (0,1)),
	CONSTRAINT CHK_FLTR_FLD_SHO_OTH_0_1 CHECK ((TOP_N IS NULL AND BOTTOM_N IS NULL) OR SHOW_OTHER IN (0,1)),
	CONSTRAINT PK_CHAIN_FILTER_FIELD PRIMARY KEY (CSRIMP_SESSION_ID, FILTER_FIELD_ID),
	CONSTRAINT FK_CHAIN_FILTER_FIELD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FILTER_VALUE (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FILTER_VALUE_ID				NUMBER(10,0) NOT NULL,
	DESCRIPTION					VARCHAR2(255),
	END_DTM_VALUE				DATE,
	FILTER_FIELD_ID				NUMBER(10,0) NOT NULL,
	MAX_NUM_VAL					NUMBER(24,10),
	MIN_NUM_VAL					NUMBER(24,10),
	NUM_VALUE					NUMBER(10,0),
	REGION_SID					NUMBER(10,0),
	START_DTM_VALUE				DATE,
	STR_VALUE					VARCHAR2(255),
	USER_SID					NUMBER(10,0),
	COMPOUND_FILTER_ID_VALUE 	NUMBER(10,0),
	SAVED_FILTER_SID_VALUE 		NUMBER(10,0),
	POS							NUMBER(10),
	PERIOD_SET_ID				NUMBER(10),
	PERIOD_INTERVAL_ID			NUMBER(10),
	START_PERIOD_ID				NUMBER(10),
	FILTER_TYPE					NUMBER(10) NULL,
	NULL_FILTER					NUMBER(10) NOT NULL,
	COLOUR						NUMBER(10),
	CONSTRAINT PK_CHAIN_FILTER_VALUE PRIMARY KEY (CSRIMP_SESSION_ID, FILTER_VALUE_ID),
	CONSTRAINT FK_CHAIN_FILTER_VALUE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.chain_filter_page_column (
	csrimp_session_id		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	card_group_id			NUMBER(10) NOT NULL,
	column_name				VARCHAR2(255) NOT NULL,
	session_prefix 			VARCHAR2(255),
	label					VARCHAR2(1024) NOT NULL,
	pos						NUMBER(10) NOT NULL,
	width					NUMBER(10) NOT NULL,
	fixed_width				NUMBER(1) NOT NULL,
	hidden					NUMBER(1) NOT NULL,
	include_in_export		NUMBER(1) NOT NULL,
	group_sid				NUMBER(10),
	group_key				VARCHAR2(255),
	CONSTRAINT chk_fltr_pg_col_fix_width_1_0 CHECK (fixed_width IN (1, 0)),
	CONSTRAINT chk_fltr_pg_col_hidden_1_0 CHECK (hidden IN (1, 0)),
	CONSTRAINT chk_fltr_pg_col_export_1_0 CHECK (include_in_export IN (1, 0)),
	CONSTRAINT fk_chain_fltr_page_column_is FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE UNIQUE INDEX csrimp.uk_filter_table_column ON csrimp.chain_filter_page_column(csrimp_session_id, card_group_id, column_name, session_prefix, LOWER(group_key));

CREATE TABLE csrimp.chain_filter_item_config (
	csrimp_session_id		NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	card_group_id			NUMBER(10) NOT NULL,
	card_id					NUMBER(10) NOT NULL,
	item_name				VARCHAR2(255) NOT NULL,
	session_prefix 			VARCHAR2(255),
	label					VARCHAR2(1024) NOT NULL,
	pos						NUMBER(10) NOT NULL,
	include_in_filter		NUMBER(1) NOT NULL,
	include_in_breakdown	NUMBER(1) NOT NULL,
	include_in_advanced		NUMBER(1) NOT NULL,
	group_sid				NUMBER(10),
	path					VARCHAR2(1024),
	CONSTRAINT chk_fltr_itm_cfg_inc_fil_1_0 CHECK (include_in_filter IN (1, 0)),
	CONSTRAINT chk_fltr_itm_cfg_inc_brkd_1_0 CHECK (include_in_breakdown IN (1, 0)),
	CONSTRAINT chk_fltr_itm_cfg_inc_adv_1_0 CHECK (include_in_advanced IN (1, 0))
);

CREATE UNIQUE INDEX csrimp.uk_filter_item_config ON csrimp.chain_filter_item_config(csrimp_session_id, card_group_id, card_id, item_name, session_prefix, path);


CREATE TABLE csrimp.chain_filter_page_cms_table (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	filter_page_cms_table_id		NUMBER(10) NOT NULL,
	card_group_id					NUMBER(10) NOT NULL,
	column_sid						NUMBER(10) NOT NULL,
	CONSTRAINT pk_filter_page_cms_table PRIMARY KEY (csrimp_session_id, filter_page_cms_table_id),
	CONSTRAINT fk_chain_filtr_page_cms_tab_is FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.chain_filter_page_ind (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	filter_page_ind_id				NUMBER(10) NOT NULL,
	card_group_id					NUMBER(10) NOT NULL,
	ind_sid							NUMBER(10) NOT NULL,
	period_set_id					NUMBER(10) NOT NULL,
	period_interval_id				NUMBER(10) NOT NULL,
	start_dtm						DATE,
	end_dtm							DATE,
	previous_n_intervals			NUMBER(10),
	include_in_list					NUMBER(1) NOT NULL,
	include_in_filter				NUMBER(1) NOT NULL,
	include_in_aggregates			NUMBER(1) NOT NULL,
	include_in_breakdown			NUMBER(1) NOT NULL,
	show_measure_in_description		NUMBER(1) NOT NULL,
	show_interval_in_description	NUMBER(1) NOT NULL,
	description_override			VARCHAR2(1023),
	CONSTRAINT pk_filter_page_ind PRIMARY KEY (csrimp_session_id, filter_page_ind_id),
	CONSTRAINT chk_fltr_pg_ind_dtm_or_intrvl CHECK (
		(start_dtm IS NOT NULL AND end_dtm IS NOT NULL AND previous_n_intervals IS NULL) OR
		(start_dtm IS NULL AND end_dtm IS NULL AND previous_n_intervals IS NOT NULL)),
	CONSTRAINT chk_fltr_pg_ind_intrvl_gt_0 CHECK (previous_n_intervals IS NULL OR previous_n_intervals > 0),
	CONSTRAINT chk_fltr_pg_ind_inc_list_1_0 CHECK (include_in_list IN (1,0)),
	CONSTRAINT chk_fltr_pg_ind_inc_fltr_1_0 CHECK (include_in_filter IN (1,0)),
	CONSTRAINT chk_fltr_pg_ind_inc_agg_1_0 CHECK (include_in_aggregates IN (1,0)),
	CONSTRAINT chk_fltr_pg_ind_inc_brkdwn_1_0 CHECK (include_in_breakdown IN (1,0)),
	CONSTRAINT chk_fltr_pg_ind_shw_msre_1_0 CHECK (show_measure_in_description IN (1,0)),
	CONSTRAINT chk_fltr_pg_ind_shw_intrvl_1_0 CHECK (show_interval_in_description IN (1,0)),
	CONSTRAINT fk_chain_filter_page_ind_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE UNIQUE INDEX csrimp.uk_chain_filter_page_ind ON csrimp.chain_filter_page_ind (
		csrimp_session_id, card_group_id, ind_sid, period_set_id, period_interval_id,
		start_dtm, end_dtm, previous_n_intervals);

CREATE TABLE csrimp.chain_filter_page_ind_interval (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	filter_page_ind_interval_id		NUMBER(10) NOT NULL,
	filter_page_ind_id				NUMBER(10) NOT NULL,
	start_dtm						DATE,
	current_interval_offset			NUMBER(10),
	CONSTRAINT pk_filter_page_ind_interval PRIMARY KEY (csrimp_session_id, filter_page_ind_interval_id),
	CONSTRAINT chk_fltr_pg_i_itvl_dtm_or_itvl CHECK (
		(start_dtm IS NOT NULL AND current_interval_offset IS NULL) OR
		(start_dtm IS NULL AND current_interval_offset IS NOT NULL)),
	CONSTRAINT fk_chain_fltr_page_ind_itvl_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE UNIQUE INDEX csrimp.uk_chain_filter_page_ind_itvl ON csrimp.chain_filter_page_ind_interval (
		csrimp_session_id, filter_page_ind_id, start_dtm, current_interval_offset);

CREATE TABLE CSRIMP.CHAIN_FILTERSUPPLIERREPO (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LABEL NVARCHAR2(500) NOT NULL,
	REPORT_URL NVARCHAR2(2000) NOT NULL,
	POSITION		NUMBER(10)			NULL,
	CONSTRAINT FK_CHAIN_FILTERSUPPLIERREPO_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FLOW_FILTER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_SID NUMBER(10,0) NOT NULL,
	SAVED_FILTER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_FLOW_FILTER PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_SID, SAVED_FILTER_SID),
	CONSTRAINT FK_CHAIN_FLOW_FILTER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_INVITATION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INVITATION_ID NUMBER(10,0) NOT NULL,
	ACCEPTED_DTM TIMESTAMP(6),
	ACCEPTED_REG_TERMS_VERS NUMBER(10,5),
	BATCH_JOB_ID NUMBER(10,0),
	CANCELLED_BY_USER_SID NUMBER(10,0),
	CANCELLED_DTM TIMESTAMP(6),
	EXPIRATION_DTM TIMESTAMP(6) NOT NULL,
	EXPIRATION_GRACE NUMBER(1,0) NOT NULL,
	FROM_COMPANY_SID NUMBER(10,0),
	FROM_USER_SID NUMBER(10,0),
	GUID VARCHAR2(38) NOT NULL,
	INVITATION_STATUS_ID NUMBER(10,0) NOT NULL,
	INVITATION_TYPE_ID NUMBER(10,0) NOT NULL,
	LANG VARCHAR2(10),
	ON_BEHALF_OF_COMPANY_SID NUMBER(10,0),
	REINVITATION_OF_INVITATION_ID NUMBER(10,0),
	SENT_DTM TIMESTAMP(6),
	TO_COMPANY_SID NUMBER(10,0) NOT NULL,
	TO_USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_INVITATION PRIMARY KEY (CSRIMP_SESSION_ID, INVITATION_ID),
	CONSTRAINT FK_CHAIN_INVITATION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_INVITATIO_USER_TPL (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	LANG VARCHAR2(10) NOT NULL,
	FOOTER VARCHAR2(4000),
	HEADER VARCHAR2(4000),
	CONSTRAINT PK_CHAIN_INVITATIO_USER_TPL PRIMARY KEY (CSRIMP_SESSION_ID, USER_SID, LANG),
	CONSTRAINT FK_CHAIN_INVITATIO_USER_TPL_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_MESSAGE_DEFINITION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MESSAGE_DEFINITION_ID NUMBER(10,0) NOT NULL,
	COMPLETED_TEMPLATE VARCHAR2(255),
	COMPLETION_TYPE_ID NUMBER(10,0),
	CSS_CLASS VARCHAR2(255),
	HELPER_PKG VARCHAR2(100),
	MESSAGE_PRIORITY_ID NUMBER(10,0),
	MESSAGE_TEMPLATE VARCHAR2(4000),
	CONSTRAINT PK_CHAIN_MESSAGE_DEFINITION PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_DEFINITION_ID),
	CONSTRAINT FK_CHAIN_MESSAGE_DEFINITION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_MESSAGE_PARAM (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MESSAGE_DEFINITION_ID NUMBER(10,0) NOT NULL,
	PARAM_NAME VARCHAR2(255) NOT NULL,
	CSS_CLASS VARCHAR2(255),
	HREF VARCHAR2(1000),
	VALUE VARCHAR2(1000),
	CONSTRAINT PK_CHAIN_MESSAGE_PARAM PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_DEFINITION_ID, PARAM_NAME),
	CONSTRAINT FK_CHAIN_MESSAGE_PARAM_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTIONNAIR_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	GROUP_NAME VARCHAR2(30) NOT NULL,
	DESCRIPTION VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHAIN_QUESTIONNAIR_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, GROUP_NAME),
	CONSTRAINT FK_CHAIN_QUESTIONNAIR_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTIONNAIRE_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_TYPE_ID NUMBER(10,0) NOT NULL,
	ACTIVE NUMBER(1,0) NOT NULL,
	AUTO_RESEND_ON_EXPIRY NUMBER(10,0) NOT NULL,
	CAN_BE_OVERDUE NUMBER(1,0) NOT NULL,
	CLASS VARCHAR2(255) NOT NULL,
	DB_CLASS VARCHAR2(200),
	DEFAULT_OVERDUE_DAYS NUMBER(10,0),
	EDIT_URL VARCHAR2(4000),
	ENABLE_OVERDUE_ALERT NUMBER(1,0) NOT NULL,
	ENABLE_REMINDER_ALERT NUMBER(1,0) NOT NULL,
	EXPIRE_AFTER_MONTHS NUMBER(10,0),
	GROUP_NAME VARCHAR2(30),
	IS_RESENDABLE NUMBER(1,0) NOT NULL,
	NAME VARCHAR2(255) NOT NULL,
	OWNER_CAN_REVIEW NUMBER(1,0) NOT NULL,
	POSITION NUMBER(10,0),
	PROCURER_CAN_REVIEW NUMBER(1,0),
	REMINDER_OFFSET_DAYS NUMBER(10,0),
	REQUIRES_REVIEW NUMBER(1,0) NOT NULL,
	SECURITY_SCHEME_ID NUMBER(10,0),
	VIEW_URL VARCHAR2(4000),
	ENABLE_STATUS_LOG NUMBER(1),
	ENABLE_TRANSITION_ALERT NUMBER(1),
	CONSTRAINT PK_CHAIN_QUESTIONNAIRE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_TYPE_ID),
	CONSTRAINT FK_CHAIN_QUESTIONNAIRE_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FLOW_QUESTION_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_SID NUMBER(10,0) NOT NULL,
	QUESTIONNAIRE_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_FLOW_QUESTION_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_SID),
	CONSTRAINT FK_CHAIN_FLOW_QUESTION_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_INVI_QNR_TYPE_COMP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INVITATION_ID NUMBER(10,0) NOT NULL,
	QUESTIONNAIRE_TYPE_ID NUMBER(10,0) NOT NULL,
	COMPONENT_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_INVI_QNR_TYPE_COMP PRIMARY KEY (CSRIMP_SESSION_ID, INVITATION_ID, QUESTIONNAIRE_TYPE_ID, COMPONENT_ID),
	CONSTRAINT FK_CHAIN_INVI_QNR_TYPE_COMP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_MESSAGE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MESSAGE_ID NUMBER(10,0) NOT NULL,
	ACTION_ID NUMBER(10,0),
	COMPLETED_BY_USER_SID NUMBER(10,0),
	COMPLETED_DTM TIMESTAMP(6),
	DUE_DTM TIMESTAMP(6),
	EVENT_ID NUMBER(10,0),
	MESSAGE_DEFINITION_ID NUMBER(10,0) NOT NULL,
	RE_AUDIT_REQUEST_ID NUMBER(10,0),
	RE_COMPANY_SID NUMBER(10,0),
	RE_COMPONENT_ID NUMBER(10,0),
	RE_INVITATION_ID NUMBER(10,0),
	RE_QUESTIONNAIRE_TYPE_ID NUMBER(10,0),
	RE_SECONDARY_COMPANY_SID NUMBER(10,0),
	RE_USER_SID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_MESSAGE PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_ID),
	CONSTRAINT FK_CHAIN_MESSAGE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ALERT_ENTRY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_ENTRY_ID NUMBER(10,0) NOT NULL,
	ALERT_ENTRY_TYPE_ID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0),
	MESSAGE_ID NUMBER(10,0),
	OCCURRED_DTM TIMESTAMP(6) NOT NULL,
	OWNER_SCHEDULED_ALERT_ID NUMBER(10,0),
	PRIORITY NUMBER(10,0),
	TEMPLATE_NAME VARCHAR2(100) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_ALERT_ENTRY PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_ENTRY_ID),
	CONSTRAINT FK_CHAIN_ALERT_ENTRY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ALERT_ENTRY_PARAM (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_ENTRY_ID NUMBER(10,0) NOT NULL,
	NAME VARCHAR2(100) NOT NULL,
	VALUE VARCHAR2(1000) NOT NULL,
	CONSTRAINT PK_CHAIN_ALERT_ENTRY_PARAM PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_ENTRY_ID, NAME),
	CONSTRAINT FK_CHAIN_ALERT_ENTRY_PARAM_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_INVITATIO_QNR_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INVITATION_ID NUMBER(10,0) NOT NULL,
	QUESTIONNAIRE_TYPE_ID NUMBER(10,0) NOT NULL,
	ADDED_BY_USER_SID NUMBER(10,0) NOT NULL,
	REQUESTED_DUE_DTM DATE,
	CONSTRAINT PK_CHAIN_INVITATIO_QNR_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, INVITATION_ID, QUESTIONNAIRE_TYPE_ID),
	CONSTRAINT FK_CHAIN_INVITATIO_QNR_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_MESSAGE_RECIPIENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MESSAGE_ID NUMBER(10,0) NOT NULL,
	RECIPIENT_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_MESSAGE_RECIPIENT PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_ID, RECIPIENT_ID),
	CONSTRAINT FK_CHAIN_MESSAGE_RECIPIENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_MESSAG_REFRESH_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MESSAGE_ID NUMBER(10,0) NOT NULL,
	REFRESH_INDEX NUMBER(10,0) NOT NULL,
	REFRESH_DTM TIMESTAMP(6) NOT NULL,
	REFRESH_USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_MESSAG_REFRESH_LOG PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_ID, REFRESH_INDEX),
	CONSTRAINT FK_CHAIN_MESSAG_REFRESH_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_NEWSFLASH (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NEWSFLASH_ID NUMBER(10,0) NOT NULL,
	CONTENT CLOB,
	CREATED_DTM DATE NOT NULL,
	EXPIRED_DTM DATE,
	RELEASED_DTM DATE,
	CONSTRAINT PK_CHAIN_NEWSFLASH PRIMARY KEY (CSRIMP_SESSION_ID, NEWSFLASH_ID),
	CONSTRAINT FK_CHAIN_NEWSFLASH_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_NEWSFLASH_COMPANY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NEWSFLASH_ID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	FOR_SUPPLIERS NUMBER(1,0) NOT NULL,
	FOR_USERS NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_NEWSFLASH_COMPANY PRIMARY KEY (CSRIMP_SESSION_ID, NEWSFLASH_ID),
	CONSTRAINT FK_CHAIN_NEWSFLASH_COMPANY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_NEWSFL_USER_SETTIN (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	NEWSFLASH_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	HIDDEN NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_NEWSFL_USER_SETTIN PRIMARY KEY (CSRIMP_SESSION_ID, NEWSFLASH_ID, USER_SID),
	CONSTRAINT FK_CHAIN_NEWSFL_USER_SETTIN_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PRODUCT PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_ID),
	CONSTRAINT FK_CHAIN_PRODUCT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT_CODE_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	CODE2_MANDATORY NUMBER(1,0) NOT NULL,
	CODE3_MANDATORY NUMBER(1,0) NOT NULL,
	CODE_LABEL1 VARCHAR2(100) NOT NULL,
	CODE_LABEL2 VARCHAR2(100),
	CODE_LABEL3 VARCHAR2(100),
	MAPPING_APPROVAL_REQUIRED NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PRODUCT_CODE_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID),
	CONSTRAINT FK_CHAIN_PRODUCT_CODE_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT_COMPANY_ALERT (
	CSRIMP_SESSION_ID 		NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_ID 				NUMBER(10,0)	NOT NULL,
	COMPANY_PRODUCT_ID 		NUMBER(10,0)	NOT NULL,
	PURCHASER_COMPANY_SID 	NUMBER(10,0)	NOT NULL,
	SUPPLIER_COMPANY_SID 	NUMBER(10,0)	NOT NULL,
	USER_SID 				NUMBER(10,0)	NOT NULL,
	SENT_DTM 				TIMESTAMP(6),
	CONSTRAINT PK_CHAIN_PRODUCT_COMPANY_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_ID),
	CONSTRAINT FK_CHAIN_PRDCT_CMPNY_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT_METRIC (
	CSRIMP_SESSION_ID 			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IND_SID						NUMBER(10, 0)	NOT NULL,
	APPLIES_TO_PRODUCT			NUMBER(1, 0)	NOT NULL,
	APPLIES_TO_PROD_SUPPLIER	NUMBER(1, 0)	NOT NULL,
	PRODUCT_METRIC_ICON_ID		NUMBER(10, 0)	NULL,
	IS_MANDATORY				NUMBER(1, 0)	NOT NULL,
	SHOW_MEASURE				NUMBER(1, 0)	NOT NULL,
	CONSTRAINT PK_CHAIN_PRODUCT_METRIC PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID),
	CONSTRAINT FK_CHAIN_PRODUCT_METRIC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRD_MTRC_PRD_TYPE (
	CSRIMP_SESSION_ID 			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IND_SID						NUMBER(10, 0)	NOT NULL,
	PRODUCT_TYPE_ID				NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_CHAIN_PRD_MTRC_PRD_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, PRODUCT_TYPE_ID),
	CONSTRAINT FK_CHAIN_PRD_MTRC_PRD_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUC_METRIC_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_METRIC_TYPE_ID NUMBER(10,0) NOT NULL,
	CLASS VARCHAR2(64),
	DESCRIPTION VARCHAR2(200) NOT NULL,
	MAX_SCORE NUMBER(10,3),
	CONSTRAINT PK_CHAIN_PRODUC_METRIC_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_METRIC_TYPE_ID),
	CONSTRAINT FK_CHAIN_PRODUC_METRIC_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PRODUCT_REVISION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PRODUCT_ID NUMBER(10,0) NOT NULL,
	REVISION_NUM NUMBER(10,0) NOT NULL,
	ACTIVE NUMBER(1,0) NOT NULL,
	CODE2 VARCHAR2(100),
	CODE3 VARCHAR2(100),
	LAST_PUBLISHED_BY_USER_SID NUMBER(10,0),
	LAST_PUBLISHED_DTM TIMESTAMP(0),
	NEED_REVIEW NUMBER(1,0) NOT NULL,
	NOTES VARCHAR2(255),
	PREVIOUS_END_DTM DATE,
	PREVIOUS_REV_NUMBER NUMBER(10,0),
	supplier_root_component_id NUMBER(10,0) NOT NULL,
	PUBLISHED NUMBER(1,0) NOT NULL,
	REVISION_CREATED_BY_SID NUMBER(10,0) NOT NULL,
	REVISION_END_DTM DATE,
	REVISION_START_DTM DATE NOT NULL,
	VALIDATED_ROOT_COMPONENT_ID NUMBER(10,0),
	VALIDATION_STATUS_ID NUMBER(10, 0),
	CONSTRAINT PK_CHAIN_PRODUCT_REVISION PRIMARY KEY (CSRIMP_SESSION_ID, PRODUCT_ID, REVISION_NUM),
	CONSTRAINT FK_CHAIN_PRODUCT_REVISION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);
CREATE TABLE CSRIMP.CHAIN_PURCHASE_CHANNEL (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	PURCHASE_CHANNEL_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(255) NOT NULL,
	REGION_SID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_PURCHASE_CHANNEL PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID, PURCHASE_CHANNEL_ID),
	CONSTRAINT FK_CHAIN_PURCHASE_CHANNEL_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PURCHASE_COMPONENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPONENT_ID NUMBER(10,0) NOT NULL,
	ACCEPTANCE_STATUS_ID NUMBER(10,0),
	COMPANY_SID NUMBER(10,0) NOT NULL,
	COMPONENT_SUPPLIER_TYPE_ID NUMBER(10,0),
	COMPONENT_TYPE_ID NUMBER(10,0) NOT NULL,
	MAPPED_BY_USER_SID NUMBER(10,0),
	MAPPED_DTM DATE,
	PREVIOUS_PURCH_COMPONENT_ID NUMBER(10,0),
	PURCHASES_LOCKED NUMBER(1,0) NOT NULL,
	SUPPLIER_COMPANY_SID NUMBER(10,0),
	SUPPLIER_PRODUCT_ID NUMBER(10,0),
	UNINVITED_SUPPLIER_SID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_PURCHASE_COMPONENT PRIMARY KEY (CSRIMP_SESSION_ID, COMPONENT_ID),
	CONSTRAINT FK_CHAIN_PURCHASE_COMPONENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PURCHASE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PURCHASE_ID NUMBER(10,0) NOT NULL,
	AMOUNT NUMBER(10,3) NOT NULL,
	AMOUNT_UNIT_ID NUMBER(10,0) NOT NULL,
	END_DATE DATE,
	INVOICE_NUMBER VARCHAR2(50),
	NOTE VARCHAR2(255),
	COMPONENT_ID NUMBER(10,0) NOT NULL,
	PURCHASER_COMPANY_SID NUMBER(10,0) NOT NULL,
	PURCHASE_CHANNEL_ID NUMBER(10,0),
	PURCHASE_ORDER VARCHAR2(50),
	START_DATE DATE NOT NULL,
	CONSTRAINT PK_CHAIN_PURCHASE PRIMARY KEY (CSRIMP_SESSION_ID, PURCHASE_ID),
	CONSTRAINT FK_CHAIN_PURCHASE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PURCHASE_TAG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAG_ID NUMBER(10,0) NOT NULL,
	PURCHASE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PURCHASE_TAG PRIMARY KEY (CSRIMP_SESSION_ID, TAG_ID, PURCHASE_ID),
	CONSTRAINT FK_CHAIN_PURCHASE_TAG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PURCHASER_FOLLOWER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PURCHASER_COMPANY_SID NUMBER(10,0) NOT NULL,
	SUPPLIER_COMPANY_SID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_PURCHASER_FOLLOWER PRIMARY KEY (CSRIMP_SESSION_ID, PURCHASER_COMPANY_SID, SUPPLIER_COMPANY_SID, USER_SID),
	CONSTRAINT FK_CHAIN_PURCHASER_FOLLOWER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QNNA_SHAR_ALER_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_SHARE_ID NUMBER(10,0) NOT NULL,
	ALERT_SENT_DTM DATE NOT NULL,
	STD_ALERT_TYPE_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QNNA_SHAR_ALER_LOG PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_SHARE_ID, ALERT_SENT_DTM, STD_ALERT_TYPE_ID, USER_SID),
	CONSTRAINT FK_CHAIN_QNNA_SHAR_ALER_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QNR_ACTI_SECU_MASK (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_TYPE_ID NUMBER(10,0) NOT NULL,
	COMPANY_FUNCTION_ID NUMBER(10,0) NOT NULL,
	QUESTIONNAIRE_ACTION_ID NUMBER(10,0) NOT NULL,
	ACTION_SECURITY_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QNR_ACTI_SECU_MASK PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_TYPE_ID, COMPANY_FUNCTION_ID, QUESTIONNAIRE_ACTION_ID),
	CONSTRAINT FK_CHAIN_QNR_ACTI_SECU_MASK_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTIONNAIRE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_ID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	COMPONENT_ID NUMBER(10,0),
	CREATED_DTM DATE,
	DESCRIPTION VARCHAR2(255),
	QUESTIONNAIRE_TYPE_ID NUMBER(10,0) NOT NULL,
	REJECTED NUMBER(1),
	CONSTRAINT PK_CHAIN_QUESTIONNAIRE PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_ID),
	CONSTRAINT FK_CHAIN_QUESTIONNAIRE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QNR_SHAR_LOG_ENTRY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_SHARE_ID NUMBER(10,0) NOT NULL,
	SHARE_LOG_ENTRY_INDEX NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	ENTRY_DTM TIMESTAMP(6) NOT NULL,
	SHARE_STATUS_ID NUMBER(10,0) NOT NULL,
	USER_NOTES VARCHAR2(4000),
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QNR_SHAR_LOG_ENTRY PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_SHARE_ID, SHARE_LOG_ENTRY_INDEX),
	CONSTRAINT FK_CHAIN_QNR_SHAR_LOG_ENTRY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QNR_STAT_LOG_ENTRY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_ID NUMBER(10,0) NOT NULL,
	STATUS_LOG_ENTRY_INDEX NUMBER(10,0) NOT NULL,
	ENTRY_DTM TIMESTAMP(6) NOT NULL,
	QUESTIONNAIRE_STATUS_ID NUMBER(10,0) NOT NULL,
	USER_NOTES VARCHAR2(4000),
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QNR_STAT_LOG_ENTRY PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_ID, STATUS_LOG_ENTRY_INDEX),
	CONSTRAINT FK_CHAIN_QNR_STAT_LOG_ENTRY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUEST_EXPIRY_ALERT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_SHARE_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QUEST_EXPIRY_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_SHARE_ID, USER_SID),
	CONSTRAINT FK_CHAIN_QUEST_EXPIRY_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTION_INVITATIO (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_ID NUMBER(10,0) NOT NULL,
	INVITATION_ID NUMBER(10,0) NOT NULL,
	ADDED_DTM TIMESTAMP(6) NOT NULL,
	CONSTRAINT PK_CHAIN_QUESTION_INVITATIO PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_ID, INVITATION_ID),
	CONSTRAINT FK_CHAIN_QUESTION_INVITATIO_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTI_METRIC_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_METRIC_TYPE_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(4000),
	MAX_VALUE NUMBER(10,0),
	QUESTIONNAIRE_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QUESTI_METRIC_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_METRIC_TYPE_ID),
	CONSTRAINT FK_CHAIN_QUESTI_METRIC_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTIONNAI_METRIC (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_ID NUMBER(10,0) NOT NULL,
	QUESTIONNAIRE_METRIC_TYPE_ID NUMBER(10,0) NOT NULL,
	METRIC_VALUE NUMBER(10,0) NOT NULL,
	NORMALISED_VALUE NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QUESTIONNAI_METRIC PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_ID, QUESTIONNAIRE_METRIC_TYPE_ID),
	CONSTRAINT FK_CHAIN_QUESTIONNAI_METRIC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTIONNAIR_SHARE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_SHARE_ID NUMBER(10,0) NOT NULL,
	DUE_BY_DTM DATE NOT NULL,
	EXPIRY_DTM DATE,
	EXPIRY_SENT_DTM DATE,
	OVERDUE_EVENTS_SENT NUMBER(1,0) NOT NULL,
	OVERDUE_SENT_DTM DATE,
	QNR_OWNER_COMPANY_SID NUMBER(10,0) NOT NULL,
	QUESTIONNAIRE_ID NUMBER(10,0) NOT NULL,
	REMINDER_SENT_DTM DATE,
	SHARE_WITH_COMPANY_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QUESTIONNAIR_SHARE PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_SHARE_ID),
	CONSTRAINT FK_CHAIN_QUESTIONNAIR_SHARE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTIONNAIRE_USER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	COMPANY_FUNCTION_ID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	ADDED_DTM TIMESTAMP(6) NOT NULL,
	CONSTRAINT PK_CHAIN_QUESTIONNAIRE_USER PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_ID, USER_SID, COMPANY_FUNCTION_ID, COMPANY_SID),
	CONSTRAINT FK_CHAIN_QUESTIONNAIRE_USER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_QUESTI_USER_ACTION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	QUESTIONNAIRE_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	COMPANY_FUNCTION_ID NUMBER(10,0) NOT NULL,
	QUESTIONNAIRE_ACTION_ID NUMBER(10,0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_QUESTI_USER_ACTION PRIMARY KEY (CSRIMP_SESSION_ID, QUESTIONNAIRE_ID, USER_SID, COMPANY_FUNCTION_ID, QUESTIONNAIRE_ACTION_ID, COMPANY_SID),
	CONSTRAINT FK_CHAIN_QUESTI_USER_ACTION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_RECIPIENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	RECIPIENT_ID NUMBER(10,0) NOT NULL,
	TO_COMPANY_SID NUMBER(10,0),
	TO_USER_SID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_RECIPIENT PRIMARY KEY (CSRIMP_SESSION_ID, RECIPIENT_ID),
	CONSTRAINT FK_CHAIN_RECIPIENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_REFERENCE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REFERENCE_ID NUMBER(10, 0) NOT NULL,
	LOOKUP_KEY VARCHAR2(255) NOT NULL,
	DEPRICATED_REFERENCE_NUMBER NUMBER(10,0),
	LABEL VARCHAR2(255) NOT NULL,
	MANDATORY NUMBER(1,0) NOT NULL,
	REFERENCE_FILTER_TYPE_ID NUMBER(10,0) NOT NULL,
	REFERENCE_LOCATION_ID NUMBER(10,0) NOT NULL,
	REFERENCE_UNIQUENESS_ID NUMBER(10,0) NOT NULL,
	SHOW_IN_FILTER NUMBER(1) NOT NULL,
	REFERENCE_VALIDATION_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_REFERENCE PRIMARY KEY (CSRIMP_SESSION_ID, REFERENCE_ID),
	CONSTRAINT FK_CHAIN_REFERENCE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_REFERENCE_COMPANY_TYPE(
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REFERENCE_ID            		 NUMBER(10, 0)    NOT NULL,
    COMPANY_TYPE_ID					 NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_REFERENCE_COMPANY_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, REFERENCE_ID, COMPANY_TYPE_ID),
    CONSTRAINT PK_REFERENCE_COMPANY_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_REFERENCE_CAPABILITY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REFERENCE_ID					NUMBER(10, 0)	NOT NULL,
	PRIMARY_COMPANY_TYPE_ID			NUMBER(10, 0)	NOT NULL,
	PRIMARY_COMPANY_GROUP_TYPE_ID	NUMBER(10, 0),
	PRIMARY_COMPANY_TYPE_ROLE_SID	NUMBER(10, 0),
	SECONDARY_COMPANY_TYPE_ID		NUMBER(10, 0),
	PERMISSION_SET					NUMBER(10, 0)	NOT NULL,
	CONSTRAINT FK_CHAIN_REF_CAP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_REVIEW_ALERT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REVIEW_ALERT_ID NUMBER(10,0) NOT NULL,
	FROM_COMPANY_SID NUMBER(10,0) NOT NULL,
	FROM_USER_SID NUMBER(10,0) NOT NULL,
	SENT_DTM TIMESTAMP(6),
	TO_COMPANY_SID NUMBER(10,0) NOT NULL,
	TO_USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_REVIEW_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, REVIEW_ALERT_ID),
	CONSTRAINT FK_CHAIN_REVIEW_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SAVED_FILTER (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SAVED_FILTER_SID				NUMBER(10,0) NOT NULL,
	CARD_GROUP_ID 					NUMBER(10,0) NOT NULL,
	COMPOUND_FILTER_ID 				NUMBER(10,0),
	NAME 							VARCHAR2(255) NOT NULL,
	PARENT_SID 						NUMBER(10,0) NOT NULL,
	GROUP_BY_COMPOUND_FILTER_ID 	NUMBER(10),
	SEARCH_TEXT 					VARCHAR2(255),
	GROUP_KEY 						VARCHAR2(255),
	REGION_COLUMN_ID 				NUMBER(10),
	DATE_COLUMN_ID 					NUMBER(10),
	CMS_REGION_COLUMN_SID			NUMBER(10),
	CMS_DATE_COLUMN_SID				NUMBER(10),
	CMS_ID_COLUMN_SID				NUMBER(10),
	LIST_PAGE_URL					VARCHAR2(255),
	COMPANY_SID						NUMBER(10),
    EXCLUDE_FROM_REPORTS            NUMBER(1) NOT NULL,
	DUAL_AXIS						NUMBER(1) NOT NULL,
	RANKING_MODE		  			NUMBER(1,0) NOT NULL,
	COLOUR_BY						VARCHAR2(255),
	COLOUR_RANGE_ID					NUMBER(10),
	ORDER_BY						VARCHAR2(255),
	ORDER_DIRECTION					VARCHAR2(4),	
	RESULTS_PER_PAGE				NUMBER(10),
	MAP_COLOUR_BY					VARCHAR2(255),
	MAP_CLUSTER_BIAS				NUMBER(2),
	HIDE_EMPTY						NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_CHAIN_SAVED_FILTER PRIMARY KEY (CSRIMP_SESSION_ID, SAVED_FILTER_SID),
	CONSTRAINT CHK_ONE_REGION_COLUMN CHECK (NOT(REGION_COLUMN_ID IS NOT NULL AND CMS_REGION_COLUMN_SID IS NOT NULL)),
	CONSTRAINT CHK_ONE_DATE_COLUMN CHECK (NOT(DATE_COLUMN_ID IS NOT NULL AND CMS_DATE_COLUMN_SID IS NOT NULL)),
	CONSTRAINT CHK_CMS_ID_COL CHECK ((CARD_GROUP_ID != 43 AND CMS_ID_COLUMN_SID IS NULL) OR (CARD_GROUP_ID = 43 AND CMS_ID_COLUMN_SID IS NOT NULL)),
	CONSTRAINT FK_CHAIN_SAVED_FILTER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SAVED_FILTER_AGG_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SAVED_FILTER_SID	NUMBER(10, 0)    NOT NULL,
	POS					NUMBER(10, 0)    NOT NULL,
	AGGREGATION_TYPE	NUMBER(10, 0),
	CUSTOMER_AGGREGATE_TYPE_ID NUMBER(10),
	CONSTRAINT PK_CHAIN_SAVED_FIL_AGG_TYP PRIMARY KEY (CSRIMP_SESSION_ID, SAVED_FILTER_SID, POS),
	CONSTRAINT UK_CHAIN_SAVED_FIL_AGG_TYP UNIQUE (CSRIMP_SESSION_ID, SAVED_FILTER_SID, AGGREGATION_TYPE, CUSTOMER_AGGREGATE_TYPE_ID),
	CONSTRAINT chk_svd_fil_agg_type
		CHECK ((AGGREGATION_TYPE IS NULL AND CUSTOMER_AGGREGATE_TYPE_ID IS NOT NULL)
		   OR (AGGREGATION_TYPE IS NOT NULL AND CUSTOMER_AGGREGATE_TYPE_ID IS NULL)),
	CONSTRAINT FK_CHAIN_SAVED_FIL_AGG_TYP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
)
;

CREATE TABLE csrimp.chain_saved_filter_column (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	saved_filter_sid				NUMBER(10) NOT NULL,
	column_name						VARCHAR2(255) NOT NULL,
	pos								NUMBER(10) NOT NULL,
	width							NUMBER(10),
	label							VARCHAR2(1024),
	CONSTRAINT pk_chain_saved_filter_column PRIMARY KEY (csrimp_session_id, saved_filter_sid, column_name),
	CONSTRAINT fk_chain_saved_fltr_col_is FOREIGN KEY
		(csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.chain_aggregate_type_config (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	card_group_id			NUMBER(10) NOT NULL,
	aggregate_type_id		NUMBER(10) NOT NULL,
	label					VARCHAR2(1024) NOT NULL,
	pos						NUMBER(10) NOT NULL,
	enabled					NUMBER(1) NOT NULL,
	group_sid				NUMBER(10),
	session_prefix 			VARCHAR2(255),
	path					VARCHAR2(1024),
	CONSTRAINT chk_agg_typ_cfg_enbld_1_0 CHECK (enabled IN (1, 0)),
	CONSTRAINT FK_CHAIN_AGG_TYP_CFG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE UNIQUE INDEX csrimp.uk_chain_agg_type_config ON csrimp.chain_aggregate_type_config(csrimp_session_id, card_group_id, aggregate_type_id, session_prefix, path);

CREATE TABLE CSRIMP.CHAIN_SAVED_FILTER_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SAVED_FILTER_SID				NUMBER(10) NOT NULL,
	REGION_SID						NUMBER(10) NOT NULL,
	CONSTRAINT PK_SAVED_FILTER_REGION PRIMARY KEY (CSRIMP_SESSION_ID, SAVED_FILTER_SID, REGION_SID),
	CONSTRAINT FK_CHAIN_SAVED_FLTR_REGION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.chain_saved_filter_alert (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	saved_filter_sid				NUMBER(10) NOT NULL,
	description						VARCHAR2(4000),
	users_can_subscribe				NUMBER(1) NOT NULL,
	customer_alert_type_id			NUMBER(10) NOT NULL,
	every_n_minutes					NUMBER(10),
	schedule_xml					SYS.XMLTYPE,
	next_fire_time					DATE NOT NULL,
	last_fire_time					DATE,
	alerts_sent_on_last_run			NUMBER(10),
	CONSTRAINT pk_saved_filter_alert PRIMARY KEY (CSRIMP_SESSION_ID, saved_filter_sid),
	CONSTRAINT chk_users_can_subscribe_1_0 CHECK (users_can_subscribe IN (1, 0)),
	CONSTRAINT chk_svd_fltr_alrt_n_min_schd CHECK ((every_n_minutes IS NOT NULL AND schedule_xml IS NULL) OR (every_n_minutes IS NULL AND schedule_xml IS NOT NULL)),
	CONSTRAINT FK_CHAIN_SAVED_FIL_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SAVED_FLTR_ALRT_SBSCRPTN (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SAVED_FILTER_SID				NUMBER(10) NOT NULL,
	USER_SID						NUMBER(10) NOT NULL,
	REGION_SID						NUMBER(10),
	ERROR_MESSAGE					VARCHAR2(4000),
	--HAS_HAD_INITIAL_SET				NUMBER(1) NOT NULL,
	CONSTRAINT UK_SAVED_FLTR_ALRT_SUBSCRIPTN UNIQUE (CSRIMP_SESSION_ID, SAVED_FILTER_SID, USER_SID, REGION_SID),
	CONSTRAINT FK_CHAIN_SVD_FIL_ALRT_SUB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SCHEDULED_ALERT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCHEDULED_ALERT_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	ALERT_ENTRY_TYPE_ID NUMBER(10,0) NOT NULL,
	SENT_DTM TIMESTAMP(6),
	CONSTRAINT PK_CHAIN_SCHEDULED_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, SCHEDULED_ALERT_ID, USER_SID, ALERT_ENTRY_TYPE_ID),
	CONSTRAINT FK_CHAIN_SCHEDULED_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SUPPLIER_AUDIT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AUDIT_SID NUMBER(10,0) NOT NULL,
	AUDITOR_COMPANY_SID NUMBER(10,0) NOT NULL,
	CREATED_BY_COMPANY_SID NUMBER(10,0) NOT NULL,
	SUPPLIER_COMPANY_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_SUPPLIER_AUDIT PRIMARY KEY (CSRIMP_SESSION_ID, AUDIT_SID),
	CONSTRAINT FK_CHAIN_SUPPLIER_AUDIT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TASK_ID NUMBER(10,0) NOT NULL,
	CHANGE_GROUP_ID NUMBER(10,0),
	DUE_DATE DATE,
	LAST_TASK_STATUS_ID NUMBER(10,0),
	LAST_UPDATED_BY_SID NUMBER(10,0),
	LAST_UPDATED_DTM DATE,
	NEXT_REVIEW_DATE DATE,
	OWNER_COMPANY_SID NUMBER(10,0) NOT NULL,
	SKIPPED NUMBER(1,0) NOT NULL,
	SUPPLIER_COMPANY_SID NUMBER(10,0) NOT NULL,
	TASK_STATUS_ID NUMBER(10,0) NOT NULL,
	TASK_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_TASK PRIMARY KEY (CSRIMP_SESSION_ID, TASK_ID),
	CONSTRAINT FK_CHAIN_TASK_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK_ACTION_TRIGGE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ON_TASK_ACTION_ID NUMBER(10,0) NOT NULL,
	POSITION NUMBER(10,0) NOT NULL,
	TASK_TYPE_ID NUMBER(10,0) NOT NULL,
	TRIGGER_TASK_ACTION_ID NUMBER(10,0) NOT NULL,
	TRIGGER_TASK_NAME VARCHAR2(30) NOT NULL,
	CONSTRAINT FK_CHAIN_TASK_ACTION_TRIGGE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK_ENTRY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TASK_ENTRY_ID NUMBER(10,0) NOT NULL,
	LAST_MODIFIED_BY_SID NUMBER(10,0) NOT NULL,
	LAST_MODIFIED_DTM TIMESTAMP(6) NOT NULL,
	NAME VARCHAR2(30),
	TASK_ENTRY_TYPE_ID NUMBER(10,0) NOT NULL,
	TASK_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_TASK_ENTRY PRIMARY KEY (CSRIMP_SESSION_ID, TASK_ENTRY_ID),
	CONSTRAINT FK_CHAIN_TASK_ENTRY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK_ENTRY_DATE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TASK_ENTRY_ID NUMBER(10,0) NOT NULL,
	DTM TIMESTAMP(6),
	CONSTRAINT PK_CHAIN_TASK_ENTRY_DATE PRIMARY KEY (CSRIMP_SESSION_ID, TASK_ENTRY_ID),
	CONSTRAINT FK_CHAIN_TASK_ENTRY_DATE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK_ENTRY_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TASK_ENTRY_ID NUMBER(10,0) NOT NULL,
	FILE_UPLOAD_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_TASK_ENTRY_FILE PRIMARY KEY (CSRIMP_SESSION_ID, TASK_ENTRY_ID, FILE_UPLOAD_SID),
	CONSTRAINT FK_CHAIN_TASK_ENTRY_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK_ENTRY_NOTE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TASK_ENTRY_ID NUMBER(10,0) NOT NULL,
	TEXT VARCHAR2(4000),
	CONSTRAINT PK_CHAIN_TASK_ENTRY_NOTE PRIMARY KEY (CSRIMP_SESSION_ID, TASK_ENTRY_ID),
	CONSTRAINT FK_CHAIN_TASK_ENTRY_NOTE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK_SCHEME (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TASK_SCHEME_ID NUMBER(10,0) NOT NULL,
	DB_CLASS VARCHAR2(64),
	DESCRIPTION VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHAIN_TASK_SCHEME PRIMARY KEY (CSRIMP_SESSION_ID, TASK_SCHEME_ID),
	CONSTRAINT FK_CHAIN_TASK_SCHEME_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TASK_TYPE_ID NUMBER(10,0) NOT NULL,
	CARD_ID NUMBER(10,0),
	DB_CLASS VARCHAR2(64),
	DEFAULT_TASK_STATUS_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(255) NOT NULL,
	DUE_DATE_EDITABLE NUMBER(1,0) NOT NULL,
	DUE_IN_DAYS NUMBER(10,0),
	MANDATORY NUMBER(1,0) NOT NULL,
	NAME VARCHAR2(30) NOT NULL,
	PARENT_TASK_TYPE_ID NUMBER(10,0),
	POSITION NUMBER(10,0) NOT NULL,
	REVIEW_EVERY_N_DAYS NUMBER(10,0),
	TASK_SCHEME_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_TASK_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, TASK_TYPE_ID),
	CONSTRAINT FK_CHAIN_TASK_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TASK_INVI_QNR_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TASK_ID NUMBER(10,0) NOT NULL,
	INVITATION_ID NUMBER(10,0) NOT NULL,
	QUESTIONNAIRE_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_TASK_INVI_QNR_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, TASK_ID),
	CONSTRAINT FK_CHAIN_TASK_INVI_QNR_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_UCD_LOGON (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	UCD_ACT_ID CHAR(36) NOT NULL,
	PREVIOUS_ACT_ID CHAR(36) NOT NULL,
	PREVIOUS_COMPANY_SID NUMBER(10,0),
	PREVIOUS_USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_UCD_LOGON PRIMARY KEY (CSRIMP_SESSION_ID, UCD_ACT_ID),
	CONSTRAINT FK_CHAIN_UCD_LOGON_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_UNINVITED_SUPPLIER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	UNINVITED_SUPPLIER_SID NUMBER(10,0) NOT NULL,
	COUNTRY_CODE VARCHAR2(2) NOT NULL,
	CREATED_AS_COMPANY_SID NUMBER(10,0),
	NAME VARCHAR2(1000) NOT NULL,
	SUPP_REL_CODE VARCHAR2(100),
	CONSTRAINT PK_CHAIN_UNINVITED_SUPPLIER PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID, UNINVITED_SUPPLIER_SID),
	CONSTRAINT FK_CHAIN_UNINVITED_SUPPLIER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_URL_OVERRIDES (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HOST VARCHAR2(1000) NOT NULL,
	KEY VARCHAR2(100) NOT NULL,
	SITE_NAME VARCHAR2(200),
	SUPPORT_EMAIL VARCHAR2(255),
	CONSTRAINT FK_CHAIN_URL_OVERRIDES_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_USE_ALER_ENTR_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALERT_ENTRY_TYPE_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	ENABLED NUMBER(1,0),
	SCHEDULE_XML CLOB,
	CONSTRAINT PK_CHAIN_USE_ALER_ENTR_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, ALERT_ENTRY_TYPE_ID, USER_SID),
	CONSTRAINT FK_CHAIN_USE_ALER_ENTR_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_USER_MESSAGE_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	MESSAGE_ID NUMBER(10,0) NOT NULL,
	VIEWED_DTM TIMESTAMP(6),
	CONSTRAINT PK_CHAIN_USER_MESSAGE_LOG PRIMARY KEY (CSRIMP_SESSION_ID, USER_SID, MESSAGE_ID),
	CONSTRAINT FK_CHAIN_USER_MESSAGE_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_VALID_PURCH_COMPON (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPONENT_ID NUMBER(10,0) NOT NULL,
	MAPPED_PURCHASED_COMPONENT_ID NUMBER(10,0),
	CONSTRAINT PK_CHAIN_VALID_PURCH_COMPON PRIMARY KEY (CSRIMP_SESSION_ID, COMPONENT_ID),
	CONSTRAINT FK_CHAIN_VALID_PURCH_COMPON_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_WORKSH_FILE_UPLOAD (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	WORKSHEET_ID NUMBER(10,0) NOT NULL,
	FILE_UPLOAD_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_WORKSH_FILE_UPLOAD PRIMARY KEY (CSRIMP_SESSION_ID, WORKSHEET_ID, FILE_UPLOAD_SID),
	CONSTRAINT FK_CHAIN_WORKSH_FILE_UPLOAD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEFAU_MESSA_DEFINI (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MESSAGE_DEFINITION_ID NUMBER(10,0) NOT NULL,
	ADDRESSING_TYPE_ID NUMBER(10,0) NOT NULL,
	COMPLETED_TEMPLATE VARCHAR2(255),
	COMPLETION_TYPE_ID NUMBER(10,0) NOT NULL,
	CSS_CLASS VARCHAR2(255),
	HELPER_PKG VARCHAR2(100),
	MESSAGE_PRIORITY_ID NUMBER(10,0) NOT NULL,
	MESSAGE_TEMPLATE VARCHAR2(4000) NOT NULL,
	REPEAT_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_DEFAU_MESSA_DEFINI PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_DEFINITION_ID),
	CONSTRAINT FK_CHAIN_DEFAU_MESSA_DEFINI_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_MESSA_DEFIN_LOOKUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MESSAGE_DEFINITION_ID NUMBER(10,0) NOT NULL,
	PRIMARY_LOOKUP_ID NUMBER(10,0) NOT NULL,
	SECONDARY_LOOKUP_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_MESSA_DEFIN_LOOKUP PRIMARY KEY (CSRIMP_SESSION_ID, MESSAGE_DEFINITION_ID),
	CONSTRAINT FK_CHAIN_MESSA_DEFIN_LOOKUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_FILTER_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FILTER_TYPE_ID NUMBER(10,0) NOT NULL,
	CARD_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(255),
	HELPER_PKG VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHAIN_FILTER_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, FILTER_TYPE_ID),
	CONSTRAINT FK_CHAIN_FILTER_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_GROUP_CAPABILITY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	GROUP_CAPABILITY_ID NUMBER(10,0) NOT NULL,
	CAPABILITY_ID NUMBER(10,0) NOT NULL,
	COMPANY_GROUP_TYPE_ID NUMBER(10,0) NOT NULL,
	PERMISSION_SET NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_GROUP_CAPABILITY PRIMARY KEY (CSRIMP_SESSION_ID, GROUP_CAPABILITY_ID),
	CONSTRAINT FK_CHAIN_GROUP_CAPABILITY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CARD_PROGRE_ACTION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CARD_ID NUMBER(10,0) NOT NULL,
	ACTION VARCHAR2(100) NOT NULL,
	CONSTRAINT PK_CHAIN_CARD_PROGRE_ACTION PRIMARY KEY (CSRIMP_SESSION_ID, CARD_ID, ACTION),
	CONSTRAINT FK_CHAIN_CARD_PROGRE_ACTION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);
CREATE TABLE CSRIMP.CHAIN_BUSINE_RELATI_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_RELATIONSHIP_TYPE_ID NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(255) NOT NULL,
	FORM_PATH		VARCHAR2(255),
	TAB_SID			NUMBER(10, 0),
	COLUMN_SID		NUMBER(10, 0),
	LOOKUP_KEY 						VARCHAR2(255),
	CONSTRAINT PK_CHAIN_BUSINE_RELATI_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_RELATIONSHIP_TYPE_ID),
	CONSTRAINT FK_CHAIN_BUSINE_RELATI_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_BUSINE_RELATI_TIER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_RELATIONSHIP_TYPE_ID NUMBER(10,0) NOT NULL,
	BUSINESS_RELATIONSHIP_TIER_ID NUMBER(10,0) NOT NULL,
	TIER NUMBER(10,0) NOT NULL,
	DIRECT_FROM_PREVIOUS_TIER NUMBER(1,0),
	LABEL VARCHAR2(255) NOT NULL,
	CREATE_SUPPLIER_RELATIONSHIP	NUMBER(1),
	CREATE_NEW_COMPANY				NUMBER(1),
	LOOKUP_KEY 						VARCHAR2(255),
	ALLOW_MULTIPLE_COMPANIES		NUMBER(1, 0) NOT NULL,
	CREATE_SUP_RELS_W_LOWER_TIERS	NUMBER(1, 0) NOT NULL,
	CONSTRAINT PK_CHAIN_BUSINE_RELATI_TIER PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_RELATIONSHIP_TIER_ID),
	CONSTRAINT FK_CHAIN_BUSINE_RELATI_TIER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_BU_REL_TIE_COM_TYP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_RELATIONSHIP_TIER_ID NUMBER(10,0) NOT NULL,
	COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_BU_REL_TIE_COM_TYP PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_RELATIONSHIP_TIER_ID, COMPANY_TYPE_ID),
	CONSTRAINT FK_CHAIN_BU_REL_TIE_COM_TYP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_BUSINESS_RELATIONS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_RELATIONSHIP_ID NUMBER(10,0) NOT NULL,
	BUSINESS_RELATIONSHIP_TYPE_ID NUMBER(10,0) NOT NULL,
	START_DTM DATE,
	CONSTRAINT PK_CHAIN_BUSINESS_RELATIONS PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_RELATIONSHIP_ID),
	CONSTRAINT FK_CHAIN_BUSINESS_RELATIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_BUSIN_RELAT_PERIOD (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_REL_PERIOD_ID			NUMBER(10,0) NOT NULL,
	BUSINESS_RELATIONSHIP_ID		NUMBER(10,0) NOT NULL,
	START_DTM						DATE NOT NULL,
	END_DTM							DATE,
	CONSTRAINT PK_CHAIN_BUSIN_RELAT_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_REL_PERIOD_ID),
	CONSTRAINT FK_CHAIN_BUSIN_RELAT_PERIOD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_BUSIN_RELAT_COMPAN (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BUSINESS_RELATIONSHIP_ID NUMBER(10,0) NOT NULL,
	BUSINESS_RELATIONSHIP_TIER_ID NUMBER(10,0) NOT NULL,
	POS NUMBER(10, 0) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_BUSIN_RELAT_COMPAN PRIMARY KEY (CSRIMP_SESSION_ID, BUSINESS_RELATIONSHIP_ID, BUSINESS_RELATIONSHIP_TIER_ID, POS),
	CONSTRAINT FK_CHAIN_BUSIN_RELAT_COMPAN_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

--chem
CREATE TABLE CSRIMP.CHEM_CHEM_OPTIONS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CHEM_HELPER_PKG VARCHAR(255),
	CONSTRAINT PK_CHEM_OPTIONS PRIMARY KEY (CSRIMP_SESSION_ID),
	CONSTRAINT FK_CHEM_CHEM_OPTIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_CAS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	NAME VARCHAR2(4000) NOT NULL,
	UNCONFIRMED NUMBER(1) NOT NULL,
	IS_VOC NUMBER(1) NOT NULL,
	CATEGORY VARCHAR2(20),
	CONSTRAINT PK_CAS PRIMARY KEY (CSRIMP_SESSION_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_CAS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_CAS_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAS_GROUP_ID NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(255),
	LOOKUP_KEY VARCHAR2(64),
	PARENT_GROUP_ID NUMBER(10,0),
	CONSTRAINT PK_CHEM_CAS_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, CAS_GROUP_ID),
	CONSTRAINT FK_CHEM_CAS_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_CAS_GROUP_MEMBER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAS_GROUP_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_CHEM_CAS_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, CAS_GROUP_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_CAS_GROUP_MEMBER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_CAS_RESTRICTED (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	ROOT_REGION_SID NUMBER(10,0) NOT NULL,
	CLP_TABLE_3_1 VARCHAR2(1024),
	CLP_TABLE_3_2 VARCHAR2(1024),
	END_DTM DATE,
	REMARKS VARCHAR2(2048),
	SOURCE VARCHAR2(200),
	START_DTM DATE,
	CONSTRAINT PK_CHEM_CAS_RESTRICTED PRIMARY KEY (CSRIMP_SESSION_ID, CAS_CODE, ROOT_REGION_SID),
	CONSTRAINT FK_CHEM_CAS_RESTRICTED_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_CLASSIFICATION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CLASSIFICATION_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(100),
	CONSTRAINT PK_CHEM_CLASSIFICATION PRIMARY KEY (CSRIMP_SESSION_ID, CLASSIFICATION_ID),
	CONSTRAINT FK_CHEM_CLASSIFICATION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_MANUFACTURER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MANUFACTURER_ID NUMBER(10,0) NOT NULL,
	CODE VARCHAR2(50) NOT NULL,
	NAME VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHEM_MANUFACTURER PRIMARY KEY (CSRIMP_SESSION_ID, MANUFACTURER_ID),
	CONSTRAINT FK_CHEM_MANUFACTURER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CLASSIFICATION_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(500),
	IS_CENTRAL NUMBER(1,0),
	MANUFACTURER_ID NUMBER(10,0) NOT NULL,
	REF VARCHAR2(20),
	REGION_SID NUMBER(10,0),
	CONSTRAINT PK_CHEM_SUBSTANCE PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID),
	CONSTRAINT FK_CHEM_SUBSTANCE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE_CAS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	PCT_COMPOSITION NUMBER(5,4),
	CONSTRAINT PK_CHEM_SUBSTANCE_CAS PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_SUBSTANCE_CAS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_USAGE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USAGE_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(100),
	CONSTRAINT PK_CHEM_USAGE PRIMARY KEY (CSRIMP_SESSION_ID, USAGE_ID),
	CONSTRAINT FK_CHEM_USAGE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE_REGION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	FIRST_USED_DTM DATE,
	FLOW_ITEM_ID NUMBER(10,0),
	LOCAL_REF VARCHAR2(40),
	WAIVER_STATUS_ID NUMBER(1,0),
	CONSTRAINT PK_CHEM_SUBSTANCE_REGION PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID, REGION_SID),
	CONSTRAINT FK_CHEM_SUBSTANCE_REGION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBST_REGION_PROCES (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	PROCESS_ID NUMBER(10,0) NOT NULL,
	ACTIVE NUMBER(1,0) NOT NULL,
	FIRST_USED_DTM DATE NOT NULL,
	LABEL VARCHAR2(255) NOT NULL,
	USAGE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHEM_SUBST_REGION_PROCES PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID, REGION_SID, PROCESS_ID),
	CONSTRAINT FK_CHEM_SUBST_REGION_PROCES_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_PROCESS_CAS_DEFAULT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	PROCESS_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	REMAINING_DEST VARCHAR2(100),
	REMAINING_PCT NUMBER(5,4) NOT NULL,
	TO_AIR_PCT NUMBER(5,4) NOT NULL,
	TO_PRODUCT_PCT NUMBER(5,4) NOT NULL,
	TO_WASTE_PCT NUMBER(5,4) NOT NULL,
	TO_WATER_PCT NUMBER(5,4) NOT NULL,
	CONSTRAINT PK_CHEM_PROCESS_CAS_DEFAULT PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID, REGION_SID, PROCESS_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_PROCESS_CAS_DEFAULT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBS_PROC_USE_CHANG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBST_PROC_USE_CHANGE_ID NUMBER(10,0) NOT NULL,
	CHANGED_BY NUMBER(10,0) NOT NULL,
	CHANGED_DTM TIMESTAMP(6) NOT NULL,
	END_DTM DATE,
	ENTRY_MASS_VALUE NUMBER(24,10),
	ENTRY_STD_MEASURE_CONV_ID NUMBER(10,0),
	MASS_VALUE NUMBER(24,10),
	NOTE CLOB,
	PROCESS_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	RETIRED_DTM TIMESTAMP(6),
	ROOT_DELEGATION_SID NUMBER(10,0),
	START_DTM DATE,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHEM_SUBS_PROC_USE_CHANG PRIMARY KEY (CSRIMP_SESSION_ID, SUBST_PROC_USE_CHANGE_ID),
	CONSTRAINT FK_CHEM_SUBS_PROC_USE_CHANG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUB_PRO_CAS_DES_CHA (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBST_PROC_CAS_DEST_CHANGE_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	CHANGED_BY NUMBER(10,0) NOT NULL,
	CHANGED_DTM TIMESTAMP(6) NOT NULL,
	REMAINING_DEST VARCHAR2(100),
	REMAINING_PCT NUMBER(5,4),
	RETIRED_DTM DATE,
	SUBST_PROC_USE_CHANGE_ID NUMBER(10,0),
	TO_AIR_PCT NUMBER(5,4) NOT NULL,
	TO_PRODUCT_PCT NUMBER(5,4) NOT NULL,
	TO_WASTE_PCT NUMBER(5,4) NOT NULL,
	TO_WATER_PCT NUMBER(5,4) NOT NULL,
	CONSTRAINT PK_CHEM_SUB_PRO_CAS_DES_CHA PRIMARY KEY (CSRIMP_SESSION_ID, SUBST_PROC_CAS_DEST_CHANGE_ID),
	CONSTRAINT FK_CHEM_SUB_PRO_CAS_DES_CHA_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE_AUDIT_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_AUDIT_LOG_ID NUMBER(10,0) NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CHANGED_BY NUMBER(10,0) NOT NULL,
	CHANGED_DTM DATE NOT NULL,
	DESCRIPTION VARCHAR2(1024) NOT NULL,
	PARAM_1 VARCHAR2(1024),
	PARAM_2 VARCHAR2(1024),
	CONSTRAINT PK_CHEM_SUBSTANCE_AUDIT_LOG PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_AUDIT_LOG_ID, SUBSTANCE_ID),
	CONSTRAINT FK_CHEM_SUBSTANCE_AUDIT_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_FILE_ID NUMBER(10,0) NOT NULL,
	DATA BLOB,
	FILENAME VARCHAR2(2048),
	MIME_TYPE VARCHAR2(256) NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	UPLOADED_DTM DATE,
	UPLOADED_USER_SID NUMBER(10,0),
	URL VARCHAR2(2048),
	CONSTRAINT PK_CHEM_SUBSTANCE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_FILE_ID),
	CONSTRAINT FK_CHEM_SUBSTANCE_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTAN_PROCESS_USE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_PROCESS_USE_ID NUMBER(10,0) NOT NULL,
	CHANGED_SINCE_PREV_PERIOD NUMBER(1,0) NOT NULL,
	END_DTM DATE,
	ENTRY_MASS_VALUE NUMBER(24,10),
	ENTRY_STD_MEASURE_CONV_ID NUMBER(10,0),
	MASS_VALUE NUMBER(24,10),
	NOTE CLOB,
	PROCESS_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	ROOT_DELEGATION_SID NUMBER(10,0) NOT NULL,
	START_DTM DATE,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHEM_SUBSTAN_PROCESS_USE PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_PROCESS_USE_ID),
	CONSTRAINT FK_CHEM_SUBSTAN_PROCESS_USE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBS_PROCE_CAS_DEST (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_PROCESS_USE_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	REMAINING_DEST VARCHAR2(100),
	REMAINING_PCT NUMBER(5,4) NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	TO_AIR_PCT NUMBER(5,4) NOT NULL,
	TO_PRODUCT_PCT NUMBER(5,4) NOT NULL,
	TO_WASTE_PCT NUMBER(5,4) NOT NULL,
	TO_WATER_PCT NUMBER(5,4) NOT NULL,
	CONSTRAINT PK_CHEM_SUBS_PROCE_CAS_DEST PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_PROCESS_USE_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_SUBS_PROCE_CAS_DEST_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBS_PROCE_USE_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_PROCESS_USE_FILE_ID NUMBER(10,0) NOT NULL,
	DATA BLOB,
	FILENAME VARCHAR2(2048),
	MIME_TYPE VARCHAR2(255),
	SUBSTANCE_PROCESS_USE_ID NUMBER(10,0) NOT NULL,
	UPLOADED_DTM DATE,
	UPLOADED_USER_SID NUMBER(10,0),
	CONSTRAINT PK_CHEM_SUBS_PROCE_USE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_PROCESS_USE_FILE_ID),
	CONSTRAINT FK_CHEM_SUBS_PROCE_USE_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_USAGE_AUDIT_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USAGE_AUDIT_LOG_ID NUMBER(10,0) NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CHANGED_BY NUMBER(10,0) NOT NULL,
	CHANGED_DTM DATE NOT NULL,
	DESCRIPTION VARCHAR2(1024) NOT NULL,
	END_DTM DATE,
	PARAM_1 VARCHAR2(1024),
	PARAM_2 VARCHAR2(1024),
	REGION_SID NUMBER(10,0),
	ROOT_DELEGATION_SID NUMBER(10,0),
	START_DTM DATE,
	CONSTRAINT PK_CHEM_USAGE_AUDIT_LOG PRIMARY KEY (CSRIMP_SESSION_ID, USAGE_AUDIT_LOG_ID, SUBSTANCE_ID),
	CONSTRAINT FK_CHEM_USAGE_AUDIT_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERIOD_SET
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PERIOD_SET_ID					NUMBER(10) NOT NULL,
	ANNUAL_PERIODS					NUMBER(1) NOT NULL,
	LABEL							VARCHAR2(200) NOT NULL,
	CONSTRAINT PK_PERIOD_SET PRIMARY KEY (CSRIMP_SESSION_ID, PERIOD_SET_ID),
	CONSTRAINT FK_PERIOD_SET_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERIOD
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PERIOD_SET_ID					NUMBER(10) NOT NULL,
	PERIOD_ID						NUMBER(10) NOT NULL,
	LABEL							VARCHAR2(200) NOT NULL,
	START_DTM						DATE,
	END_DTM							DATE,
	CONSTRAINT PK_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, PERIOD_SET_ID, PERIOD_ID),
	CONSTRAINT FK_PERIOD_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERIOD_DATES
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PERIOD_SET_ID					NUMBER(10) NOT NULL,
	PERIOD_ID						NUMBER(10) NOT NULL,
	YEAR							NUMBER(10) NOT NULL,
	START_DTM						DATE NOT NULL,
	END_DTM							DATE NOT NULL,
	CONSTRAINT PK_PERIOD_DATES PRIMARY KEY (CSRIMP_SESSION_ID, PERIOD_SET_ID, PERIOD_ID, YEAR),
	CONSTRAINT CK_PERIOD_DATES_SPAN CHECK (start_dtm < end_dtm),
	CONSTRAINT FK_PERIOD_DATES_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERIOD_INTERVAL
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PERIOD_SET_ID					NUMBER(10) NOT NULL,
	PERIOD_INTERVAL_ID				NUMBER(10) NOT NULL,
	SINGLE_INTERVAL_LABEL			VARCHAR2(200) NOT NULL,
	MULTIPLE_INTERVAL_LABEL			VARCHAR2(200) NOT NULL,
	LABEL                         	VARCHAR2(200) NOT NULL,
	SINGLE_INTERVAL_NO_YEAR_LABEL   VARCHAR2(200) NOT NULL,
	CONSTRAINT PK_PERIOD_INTERVAL PRIMARY KEY (CSRIMP_SESSION_ID, PERIOD_SET_ID, PERIOD_INTERVAL_ID),
	CONSTRAINT FK_PERIOD_INTERVAL_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERIOD_INTERVAL_MEMBER
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PERIOD_SET_ID					NUMBER(10) NOT NULL,
	PERIOD_INTERVAL_ID				NUMBER(10) NOT NULL,
	START_PERIOD_ID					NUMBER(10) NOT NULL,
	END_PERIOD_ID					NUMBER(10) NOT NULL,
	CONSTRAINT PK_PERIOD_INTERVAL_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, PERIOD_SET_ID, PERIOD_INTERVAL_ID, START_PERIOD_ID),
	CONSTRAINT FK_PERIOD_INTERVAL_MEMBER_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.QS_RESPONSE_FILE
(
    CSRIMP_SESSION_ID 		NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SURVEY_RESPONSE_ID		NUMBER(10, 0)	NOT NULL,
    FILENAME				VARCHAR2(255)	NOT NULL,
    MIME_TYPE				VARCHAR2(256)	NOT NULL,
    DATA					BLOB			NOT NULL,
    SHA1					RAW(20)			NOT NULL,
    UPLOADED_DTM			DATE			NOT NULL,
	CONSTRAINT PK_QS_RESPONSE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, SURVEY_RESPONSE_ID, SHA1, FILENAME, MIME_TYPE),
    CONSTRAINT FK_QS_RESPONSE_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCHEDULED_STORED_PROC
(
	CSRIMP_SESSION_ID	NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SSP_ID				NUMBER(10, 0)		NOT NULL,
	SP					VARCHAR2(255)		NOT NULL,
	ARGS				VARCHAR2(1024),
	DESCRIPTION			VARCHAR2(1024),
	INTRVAL				CHAR 				NOT NULL,
	FREQUENCY			NUMBER(10, 0)		NOT NULL,
	SCHEDULE_RUN_DTM    TIMESTAMP,
    NEXT_RUN_DTM        TIMESTAMP,
	ENABLED             NUMBER(1, 0)		NOT NULL,
	LAST_SSP_LOG_ID     NUMBER(10, 0),
	ONE_OFF				NUMBER(1, 0)		NOT NULL,
	ONE_OFF_USER		NUMBER(10, 0),
	ONE_OFF_DATE		TIMESTAMP,
    CONSTRAINT PK_SSP PRIMARY KEY (CSRIMP_SESSION_ID, SSP_ID),
	CONSTRAINT FK_SSP_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION(CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCHEDULED_STORED_PROC_LOG (
	CSRIMP_SESSION_ID		NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SSP_LOG_ID				NUMBER(10)	NOT NULL,
	SSP_ID					NUMBER(10)	NOT NULL,
	RUN_DTM					TIMESTAMP,
	RESULT_CODE				NUMBER(10),
	RESULT_MSG				VARCHAR2(1024),
	RESULT_EX				CLOB,
	ONE_OFF					NUMBER(1),
	ONE_OFF_USER			NUMBER(10),
	ONE_OFF_DATE			TIMESTAMP,
	CONSTRAINT PK_SSPL PRIMARY KEY (CSRIMP_SESSION_ID, SSP_LOG_ID),
	CONSTRAINT FK_SSPL_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION(CSRIMP_SESSION_ID),
	CONSTRAINT FK_SSPL_SSP FOREIGN KEY (CSRIMP_SESSION_ID, SSP_ID)
	REFERENCES CSRIMP.SCHEDULED_STORED_PROC (CSRIMP_SESSION_ID, SSP_ID)
);

CREATE TABLE CSRIMP.ASPEN2_TRANSLATED
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LANG            				VARCHAR2(10) NOT NULL,
	ORIGINAL_HASH   				RAW(20) NOT NULL,
	TRANSLATED      				VARCHAR2(4000) NOT NULL,
	TRANSLATED_ID           		NUMBER(10) NOT NULL,
    CONSTRAINT PK_ASPEN2_TRANSLATED PRIMARY KEY (CSRIMP_SESSION_ID, LANG, ORIGINAL_HASH),
    CONSTRAINT FK_ASPEN2_TRANSLATED_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ASPEN2_TRANSLATION
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ORIGINAL_HASH					RAW(20) NOT NULL,
	ORIGINAL						VARCHAR2(4000) NOT NULL,
    CONSTRAINT PK_ASPEN2_TRANSLATION PRIMARY KEY (CSRIMP_SESSION_ID, ORIGINAL_HASH),
    CONSTRAINT FK_ASPEN2_TRANSLATION_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ASPEN2_TRANSLATION_APP
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BASE_LANG               		VARCHAR2(10) NOT NULL,
	STATIC_TRANSLATION_PATH			VARCHAR2(1000),
    CONSTRAINT PK_ASPEN2_TRANSLATION_APP PRIMARY KEY (CSRIMP_SESSION_ID),
    CONSTRAINT FK_ASPEN2_TRANSLATION_APP_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ASPEN2_TRANSLATION_SET
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LANG							VARCHAR2(10) NOT NULL,
	REVISION						NUMBER(10) NOT NULL,
	HIDDEN							NUMBER(1) NOT NULL,
    CONSTRAINT PK_ASPEN2_TRANSLATION_SET PRIMARY KEY (CSRIMP_SESSION_ID, LANG),
    CONSTRAINT FK_ASPEN2_TRANSLATION_SET_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ASPEN2_TRANSLATION_SET_INCL
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LANG							VARCHAR2(10) NOT NULL,
	POS								NUMBER(10) NOT NULL,
	TO_APPLICATION					VARCHAR2(4000) NULL,
	TO_LANG							VARCHAR2(10) NOT NULL,
    CONSTRAINT PK_ASPEN2_TRANS_SET_INCL PRIMARY KEY (CSRIMP_SESSION_ID, LANG, POS),
    CONSTRAINT FK_ASPEN2_TRANS_SET_INCL_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_INVOLVEMENT_TYPE
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_INVOLVEMENT_TYPE_ID		NUMBER(10) NOT NULL,
	PRODUCT_AREA					VARCHAR2(256) NOT NULL,
	LABEL							VARCHAR2(256) NOT NULL,
	LOOKUP_KEY 						VARCHAR2(255) NULL,
	CSS_CLASS						VARCHAR2(256) NOT NULL,
	CONSTRAINT PK_FLOW_INV_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_INVOLVEMENT_TYPE_ID),
	CONSTRAINT FK_FLOW_INV_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_ITEM_INVOLVEMENT
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_INVOLVEMENT_TYPE_ID		NUMBER(10) NOT NULL,
	FLOW_ITEM_ID					NUMBER(10) NOT NULL,
	USER_SID						NUMBER(10) NOT NULL,
	CONSTRAINT PK_FLOW_ITEM_INV PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_INVOLVEMENT_TYPE_ID, FLOW_ITEM_ID, USER_SID),
	CONSTRAINT FK_FLOW_ITEM_INV_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AUDIT_TYPE_FLOW_INV_TYPE
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AUDIT_TYPE_FLOW_INV_TYPE_ID		NUMBER(10) NOT NULL,
	FLOW_INVOLVEMENT_TYPE_ID		NUMBER(10) NOT NULL,
	INTERNAL_AUDIT_TYPE_ID			NUMBER(10) NOT NULL,
	MIN_USERS						NUMBER(10) NOT NULL,
	MAX_USERS						NUMBER(10),
	USERS_ROLE_OR_GROUP_SID			NUMBER(10) NULL,
	CONSTRAINT PK_ADT_T_FL_INV_T PRIMARY KEY (CSRIMP_SESSION_ID, AUDIT_TYPE_FLOW_INV_TYPE_ID),
	CONSTRAINT FK_ADT_T_FL_INV_T_IS FOREIGN KEY (CSRIMP_SESSION_ID)
	REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_INVOLVEMENT_COVER
(
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_COVER_ID					NUMBER(10)		NOT NULL,
	USER_GIVING_COVER_SID			NUMBER(10, 0)   NOT NULL,
    USER_BEING_COVERED_SID			NUMBER(10, 0)   NOT NULL,
	FLOW_INVOLVEMENT_TYPE_ID		NUMBER(10, 0)	NOT NULL,
	FLOW_ITEM_ID					NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_FLOW_INV_COVER PRIMARY KEY (CSRIMP_SESSION_ID, USER_COVER_ID, USER_GIVING_COVER_SID, USER_BEING_COVERED_SID, FLOW_INVOLVEMENT_TYPE_ID, FLOW_ITEM_ID),
	CONSTRAINT FK_FLOW_INV_COVER_IS FOREIGN KEY	(CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_INV_TYPE_ALERT_CLASS
(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_INVOLVEMENT_TYPE_ID		NUMBER(10) NOT NULL,
	FLOW_ALERT_CLASS				VARCHAR2(256) NOT NULL,
	CONSTRAINT PK_FLOW_INV_TYPE_ALERT_CLASS PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_INVOLVEMENT_TYPE_ID, FLOW_ALERT_CLASS),
	CONSTRAINT FK_FLOW_INV_TYPE_ALERT_CLS_IS FOREIGN KEY (CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IA_TYPE_SURVEY_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IA_TYPE_SURVEY_GROUP_ID NUMBER(10,0) NOT NULL,
	SURVEY_CAPABILITY_ID NUMBER(10, 0) NOT NULL,
	CHANGE_SURVEY_CAPABILITY_ID NUMBER(10, 0) NOT NULL,
	LABEL VARCHAR2(1024) NOT NULL,
	LOOKUP_KEY VARCHAR2(256),
	CONSTRAINT PK_IA_TYPE_SURVEY_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, IA_TYPE_SURVEY_GROUP_ID),
	CONSTRAINT FK_IA_TYPE_SURVEY_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_TYPE_SURVEY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INTERNAL_AUDIT_TYPE_SURVEY_ID NUMBER(10,0) NOT NULL,
	ACTIVE NUMBER(1,0) NOT NULL,
	DEFAULT_SURVEY_SID NUMBER(10,0),
	IA_TYPE_SURVEY_GROUP_ID NUMBER(10,0),
	INTERNAL_AUDIT_TYPE_ID NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(1024) NOT NULL,
	MANDATORY NUMBER(1,0) NOT NULL,
	SURVEY_FIXED NUMBER(1,0) NOT NULL,
	SURVEY_GROUP_KEY VARCHAR2(256),
	CONSTRAINT PK_IA_TYPE_SURVEY PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_SURVEY_ID),
	CONSTRAINT FK_IA_TYPE_SURVEY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_SURVEY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INTERNAL_AUDIT_SID NUMBER(10,0) NOT NULL,
	INTERNAL_AUDIT_TYPE_SURVEY_ID NUMBER(10,0) NOT NULL,
	SURVEY_RESPONSE_ID NUMBER(10,0),
	SURVEY_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INTERNAL_AUDIT_SURVEY PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID, INTERNAL_AUDIT_TYPE_SURVEY_ID),
	CONSTRAINT FK_INTERNAL_AUDIT_SURVEY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_SCORE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INTERNAL_AUDIT_SID NUMBER(10,0) NOT NULL,
	SCORE_TYPE_ID NUMBER(10,0) NOT NULL,
	SCORE NUMBER(15,5),
	SCORE_THRESHOLD_ID NUMBER(10,0),
	CONSTRAINT PK_INTERNAL_AUDIT_SCORE PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID, SCORE_TYPE_ID),
	CONSTRAINT FK_INTERNAL_AUDIT_SCORE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_LOCKED_TAG(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INTERNAL_AUDIT_SID				NUMBER(10) NOT NULL,
	TAG_GROUP_ID					NUMBER(10) NOT NULL,
	TAG_ID							NUMBER(10),
	CONSTRAINT PK_IA_LOCKED_TAG PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID, TAG_GROUP_ID, TAG_ID),
	CONSTRAINT FK_AUD_SURV_LOCK_TAG FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

----

CREATE TABLE CSRIMP.METER_DATA_SOURCE_HI_RES_INPUT (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	RAW_DATA_SOURCE_ID			NUMBER(10) NOT NULL,
	METER_INPUT_ID				NUMBER(10) NOT NULL,
	CONSTRAINT PK_METER_DATA_SRC_HI_RES_INPUT PRIMARY KEY (CSRIMP_SESSION_ID, RAW_DATA_SOURCE_ID, METER_INPUT_ID),
	CONSTRAINT FK_METER_DATA_SRC_HI_RES_IN_IS FOREIGN KEY (CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_DATA_PRIORITY(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PRIORITY                NUMBER(10, 0)       NOT NULL,
    LABEL                   VARCHAR2(1024)      NOT NULL,
    LOOKUP_KEY              VARCHAR2(256),
    IS_INPUT                NUMBER(1, 0)        NOT NULL,
    IS_OUTPUT               NUMBER(1, 0)        NOT NULL,
    IS_PATCH                NUMBER(1, 0)        NOT NULL,
    IS_AUTO_PATCH           NUMBER(1, 0)        NOT NULL,
    CHECK (IS_INPUT IN(0,1)),
    CHECK (IS_OUTPUT IN(0,1)),
    CHECK (IS_PATCH IN(0,1)),
    CHECK (IS_AUTO_PATCH IN(0,1)),
    CONSTRAINT PK_METER_DATA_PRIORITY PRIMARY KEY (CSRIMP_SESSION_ID, PRIORITY),
    CONSTRAINT FK_METER_DATA_PRIORITY FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ELEMENT_LAYOUT (
	CSRIMP_SESSION_ID				NUMBER(10,0)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	METER_ELEMENT_LAYOUT_ID			NUMBER(10) NOT NULL,
	POS								NUMBER(10) NOT NULL,
	IND_SID							NUMBER(10),
	TAG_GROUP_ID					NUMBER(10),
	CONSTRAINT PK_METER_ELEMENT_LAYOUT PRIMARY KEY (CSRIMP_SESSION_ID, METER_ELEMENT_LAYOUT_ID),
	CONSTRAINT CHK_METER_EL_LAYOUT_IND_TG_GRP
		CHECK ((IND_SID IS NOT NULL AND TAG_GROUP_ID IS NULL) OR (IND_SID IS NULL AND TAG_GROUP_ID IS NOT NULL)),
	CONSTRAINT FK_METER_ELEMENT_LAYOUT_IS FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_PATCH_DATA(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID              NUMBER(10, 0)       NOT NULL,
    METER_INPUT_ID          NUMBER(10, 0)       NOT NULL,
    PRIORITY                NUMBER(10, 0)       NOT NULL,
    START_DTM               DATE                NOT NULL,
    END_DTM                 DATE                NOT NULL,
    CONSUMPTION             NUMBER(24, 10),
    UPDATED_DTM             DATE                NOT NULL,
    CONSTRAINT PK_METER_PATCH_DATA PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, METER_INPUT_ID, PRIORITY, START_DTM),
    CONSTRAINT FK_METER_PATCH_DATA FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_INPUT(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_INPUT_ID          NUMBER(10, 0)       NOT NULL,
    LABEL                   VARCHAR2(1024)      NOT NULL,
    LOOKUP_KEY              VARCHAR2(256)       NOT NULL,
    IS_CONSUMPTION_BASED    NUMBER(1, 0)        NOT NULL,
    PATCH_HELPER            VARCHAR2(256),
    GAP_FINDER              VARCHAR2(256),
    IS_VIRTUAL              NUMBER(1, 0)        NOT NULL,
    VALUE_HELPER            VARCHAR2(256),
    CONSTRAINT CHK_METER_INPUT_IS_VIRTUAL_1_0 CHECK (IS_VIRTUAL IN(0,1)),
    CHECK (IS_CONSUMPTION_BASED IN(0,1)),
    CONSTRAINT PK_METER_INPUT PRIMARY KEY (CSRIMP_SESSION_ID, METER_INPUT_ID),
    CONSTRAINT FK_METER_INPUT FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);
CREATE UNIQUE INDEX CSRIMP.UK_INPUT_LOOKUP_KEY ON CSRIMP.METER_INPUT(CSRIMP_SESSION_ID, LOOKUP_KEY);

CREATE TABLE CSRIMP.METER_INPUT_AGGR_IND(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID              NUMBER(10, 0)       NOT NULL,
    METER_INPUT_ID          NUMBER(10, 0)       NOT NULL,
    AGGREGATOR              VARCHAR2(32)        NOT NULL,
    METER_TYPE_ID            NUMBER(10, 0)       NOT NULL,
    MEASURE_SID             NUMBER(10, 0),
    MEASURE_CONVERSION_ID   NUMBER(10, 0),
    CONSTRAINT PK_METER_INPUT_AGGR_IND PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, METER_INPUT_ID, AGGREGATOR),
    CONSTRAINT FK_METER_INPUT_AGGR_IND FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_INPUT_AGGREGATOR(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_INPUT_ID          NUMBER(10, 0)       NOT NULL,
    AGGREGATOR              VARCHAR2(32)        NOT NULL,
    AGGR_PROC               VARCHAR2(256),
    IS_MANDATORY            NUMBER(1, 0)		NOT NULL,
    CONSTRAINT CHK_METER_INPUT_AGG_MAND_1_0 CHECK(IS_MANDATORY IN (0,1)),
    CONSTRAINT PK_METER_INPUT_AGGREGATOR PRIMARY KEY (CSRIMP_SESSION_ID, METER_INPUT_ID, AGGREGATOR),
    CONSTRAINT FK_METER_INPUT_AGGREGATOR FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_PATCH_JOB(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID              NUMBER(10, 0)       NOT NULL,
    METER_INPUT_ID          NUMBER(10, 0)       NOT NULL,
    START_DTM               DATE                NOT NULL,
    END_DTM                 DATE                NOT NULL,
    CREATED_DTM             DATE                NOT NULL,
    CONSTRAINT PK_METER_PATCH_JOB PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID, METER_INPUT_ID),
    CONSTRAINT FK_METER_PATCH_JOB FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_PATCH_BATCH_JOB(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    BATCH_JOB_ID            NUMBER(10, 0)       NOT NULL,
    REGION_SID              NUMBER(10, 0)       NOT NULL,
    IS_REMOVE               NUMBER(1, 0),
    CREATED_DTM             DATE                NOT NULL,
    CHECK(IS_REMOVE IN (0,1)),
    CONSTRAINT PK_METER_PATCH_BATCH_JOB PRIMARY KEY (CSRIMP_SESSION_ID, BATCH_JOB_ID),
    CONSTRAINT FK_METER_PATCH_BATCH_JOB FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_PATCH_BATCH_DATA(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    BATCH_JOB_ID            NUMBER(10, 0)       NOT NULL,
    METER_INPUT_ID          NUMBER(10, 0)       NOT NULL,
    PRIORITY                NUMBER(10, 0)       NOT NULL,
    START_DTM               DATE                NOT NULL,
    END_DTM                 DATE                NOT NULL,
    PERIOD_TYPE             VARCHAR2(32),
    CONSUMPTION             NUMBER(24, 10),
    CONSTRAINT PK_METER_PATCH_BATCH_DATA PRIMARY KEY (CSRIMP_SESSION_ID, BATCH_JOB_ID, METER_INPUT_ID, PRIORITY, START_DTM),
    CONSTRAINT FK_METER_PATCH_BATCH_DATA FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_DATA_COVERAGE_IND(
    CSRIMP_SESSION_ID       NUMBER(10)          DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_INPUT_ID          NUMBER(10, 0)       NOT NULL,
    PRIORITY                NUMBER(10, 0)       NOT NULL,
    IND_SID                 NUMBER(10, 0)       NOT NULL,
    CONSTRAINT PK_METER_DATA_COVERAGE_IND PRIMARY KEY (CSRIMP_SESSION_ID, METER_INPUT_ID, PRIORITY),
    CONSTRAINT FK_METER_DATA_COVERAGE_IND FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CAPABILITY_FLOW_CAP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_CAPABILITY_ID NUMBER(10,0) NOT NULL,
	CAPABILITY_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_CAPABI_FLOW_CAPABI PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_CAPABILITY_ID, CAPABILITY_ID),
	CONSTRAINT FK_CHAIN_CAPABI_FLOW_CAPABI_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.customer_file_upload_type_opt (
	csrimp_session_id	NUMBER(10,0)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	file_extension		VARCHAR2(255)		NOT NULL,
	is_allowed			NUMBER(1,0)			NOT NULL,
	CONSTRAINT pk_customer_file_upld_type_opt PRIMARY KEY (csrimp_session_id, file_extension),
	CONSTRAINT chk_file_upld_type_is_allowed CHECK (is_allowed IN (0, 1)),
	CONSTRAINT chk_file_upld_type_file_ext CHECK (file_extension = LOWER(TRIM(file_extension))),
	CONSTRAINT fk_file_upld_type_opt_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.customer_file_upload_mime_opt (
	csrimp_session_id	NUMBER(10,0)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	mime_type			VARCHAR2(255)		NOT NULL,
	is_allowed			NUMBER(1,0)			NOT NULL,
	CONSTRAINT pk_customer_file_upld_mime_opt PRIMARY KEY (csrimp_session_id, mime_type),
	CONSTRAINT chk_file_upld_mime_is_allowed CHECK (is_allowed IN (0, 1)),
	CONSTRAINT chk_file_upld_mime_file_ext CHECK (mime_type = LOWER(TRIM(mime_type))),
	CONSTRAINT fk_file_upld_mime_opt_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMAGE_UPLOAD_PORTLET (
    CSRIMP_SESSION_ID   NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FILE_NAME           VARCHAR2(255)   NOT NULL,
    IMAGE BLOB                          NOT NULL,
    IMG_ID              NUMBER(10,0)    NOT NULL,
    MIME_TYPE           VARCHAR2(255)   NOT NULL,
    CONSTRAINT FK_IMAGE_UPLOAD_PORTLET_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.LOOKUP_TABLE
(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LOOKUP_ID						NUMBER(10) NOT NULL,
	LOOKUP_NAME						VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_LOOKUP_TABLE PRIMARY KEY (CSRIMP_SESSION_ID, LOOKUP_ID)
);

CREATE TABLE CSRIMP.LOOKUP_TABLE_ENTRY
(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LOOKUP_ID						NUMBER(10) NOT NULL,
	START_DTM						DATE NOT NULL,
	VAL								NUMBER,
	CONSTRAINT PK_LOOKUP_TABLE_ENTRY PRIMARY KEY (CSRIMP_SESSION_ID, LOOKUP_ID, START_DTM)
);

CREATE TABLE CSRIMP.R_REPORT_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	R_REPORT_TYPE_ID NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(100) NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_R_REPORT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, R_REPORT_TYPE_ID),
	CONSTRAINT FK_R_REPORT_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.R_REPORT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	R_REPORT_SID NUMBER(10,0) NOT NULL,
	JS_DATA CLOB,
	PREPARED_DTM DATE NOT NULL,
	REQUESTED_BY_USER_SID NUMBER(10,0) NOT NULL,
	R_REPORT_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_R_REPORT PRIMARY KEY (CSRIMP_SESSION_ID, R_REPORT_SID),
	CONSTRAINT FK_R_REPORT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.R_REPORT_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	R_REPORT_FILE_ID NUMBER(10,0) NOT NULL,
	DATA BLOB NOT NULL,
	FILENAME VARCHAR2(255) NOT NULL,
	MIME_TYPE VARCHAR2(255) NOT NULL,
	R_REPORT_SID NUMBER(10,0) NOT NULL,
	SHOW_AS_DOWNLOAD NUMBER(1,0) NOT NULL,
	SHOW_AS_TAB NUMBER(1,0) NOT NULL,
	TITLE VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_R_REPORT_FILE PRIMARY KEY (CSRIMP_SESSION_ID, R_REPORT_FILE_ID),
	CONSTRAINT FK_R_REPORT_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.chain_company_type_tag_group(
	csrimp_session_id	NUMBER(10,0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	COMPANY_TYPE_ID		NUMBER(10, 0)	NOT NULL,
	TAG_GROUP_ID		NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_COMPANY_TYPE_TAG_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TYPE_ID, TAG_GROUP_ID),
	CONSTRAINT fk_chain_company_type_tag_gr FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.internal_audit_type_tag_group(
	csrimp_session_id	NUMBER(10,0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	internal_audit_type_id	NUMBER(10, 0)	NOT NULL,
	tag_group_id			NUMBER(10, 0)    NOT NULL,
	CONSTRAINT PK_INTERNAL_AUDIT_TYPE_TAG_GR PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_TYPE_ID, TAG_GROUP_ID),
	CONSTRAINT fk_internal_audit_type_tag_gr FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.internal_audit_tag(
	csrimp_session_id	NUMBER(10,0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	internal_audit_sid	NUMBER(10, 0)	NOT NULL,
	tag_id				NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_INTERNAL_AUDIT_TAG PRIMARY KEY (CSRIMP_SESSION_ID, INTERNAL_AUDIT_SID, TAG_ID),
	CONSTRAINT fk_internal_audit_tag FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.non_compliance_type_tag_group(
	csrimp_session_id		NUMBER(10,0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	non_compliance_type_id	NUMBER(10, 0)	NOT NULL,
	tag_group_id			NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_NON_COMPLIANCE_TYPE_TAG_GR PRIMARY KEY (csrimp_session_id, non_compliance_type_id, tag_group_id),
	CONSTRAINT fk_non_compliance_type_tag_gr FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.benchmark_dashboard (
    csrimp_session_id               NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    benchmark_dashboard_sid         NUMBER(10)      NOT NULL,
    name                            VARCHAR2(255)   NOT NULL,
    start_dtm                       DATE            NOT NULL,
    end_dtm                         DATE,
    lookup_key                      VARCHAR2(255),
    period_set_id                   NUMBER(10)      NOT NULL,
    period_interval_id              NUMBER(10)      NOT NULL,
    CONSTRAINT PK_BENCHMARK_DASHBOARD PRIMARY KEY (csrimp_session_id, benchmark_dashboard_sid),
    CONSTRAINT FK_BENCHMARK_DASHBOARD_IS
        FOREIGN KEY (csrimp_session_id)
        REFERENCES csrimp.csrimp_session (csrimp_session_id)
        ON DELETE CASCADE
);

CREATE TABLE csrimp.benchmark_dashboard_char (
    csrimp_session_id               NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    benchmark_dashboard_sid         NUMBER(10)      NOT NULL,
    benchmark_dashboard_char_id     NUMBER(10)      NOT NULL,
    pos                             NUMBER(10)      NOT NULL,
    ind_sid                         NUMBER(10),
    tag_group_id                    NUMBER(10),
    CONSTRAINT PK_BENCHMARK_DASHB_CHAR PRIMARY KEY (csrimp_session_id, benchmark_dashboard_char_id),
    CONSTRAINT UK_BENCHMARK_DASHB_IND_TG_GRP UNIQUE (csrimp_session_id, benchmark_dashboard_sid, ind_sid, tag_group_id),
    CONSTRAINT CHK_BENCHMARK_DASHB_IND_TG_GRP CHECK ((ind_sid IS NOT NULL AND tag_group_id IS NULL) OR (ind_sid IS NULL AND tag_group_id IS NOT NULL)),
    CONSTRAINT FK_BENCHMARK_DASHBOARD_CHAR_IS
        FOREIGN KEY (csrimp_session_id)
        REFERENCES csrimp.csrimp_session (csrimp_session_id)
        ON DELETE CASCADE
);

CREATE TABLE csrimp.benchmark_dashboard_ind (
    csrimp_session_id               NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    benchmark_dashboard_sid         NUMBER(10)      NOT NULL,
    ind_sid                         NUMBER(10)      NOT NULL,
    display_name                    VARCHAR2(255),
    scenario_run_sid                NUMBER(10),
    floor_area_ind_sid              NUMBER(10)      NOT NULL,
    pos                             NUMBER(10)      NOT NULL,
    CONSTRAINT PK_BENCHMARK_DASHBOARD_IND PRIMARY KEY (csrimp_session_id, benchmark_dashboard_sid, ind_sid),
    CONSTRAINT FK_BENCHMARK_DASHBOARD_IND_IS
        FOREIGN KEY (csrimp_session_id)
        REFERENCES csrimp.csrimp_session (csrimp_session_id)
        ON DELETE CASCADE
);

CREATE TABLE csrimp.benchmark_dashboard_plugin (
    csrimp_session_id               NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    benchmark_dashboard_sid         NUMBER(10)      NOT NULL,
    plugin_id                       NUMBER(10)      NOT NULL,
    CONSTRAINT PK_BENCHMARK_DASHBOARD_PLUGIN PRIMARY KEY (csrimp_session_id, benchmark_dashboard_sid, plugin_id),
    CONSTRAINT FK_BENCHMARK_DASHBOARD_PLG_IS
        FOREIGN KEY (csrimp_session_id)
        REFERENCES csrimp.csrimp_session (csrimp_session_id)
        ON DELETE CASCADE
);

CREATE TABLE csrimp.metric_dashboard (
    csrimp_session_id               NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    metric_dashboard_sid            NUMBER(10)      NOT NULL,
    name                            VARCHAR2(255)   NOT NULL,
    start_dtm                       DATE            NOT NULL,
    end_dtm                         DATE,
    lookup_key                      VARCHAR2(255),
    period_set_id                   NUMBER(10)      NOT NULL,
    period_interval_id              NUMBER(10)      NOT NULL,
    CONSTRAINT PK_METRIC_DASHBOARD PRIMARY KEY (csrimp_session_id, metric_dashboard_sid),
    CONSTRAINT FK_METRIC_DASHBOARD_IS
        FOREIGN KEY (csrimp_session_id)
        REFERENCES csrimp.csrimp_session (csrimp_session_id)
        ON DELETE CASCADE
);

CREATE TABLE csrimp.metric_dashboard_ind (
    csrimp_session_id               NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    metric_dashboard_sid            NUMBER(10)      NOT NULL,
    ind_sid                         NUMBER(10)      NOT NULL,
    pos                             NUMBER(10)      NOT NULL,
    block_title                     VARCHAR2(32)    NOT NULL,
    block_css_class                 VARCHAR2(32)    NOT NULL,
    inten_view_scenario_run_sid     NUMBER(10),
    inten_view_floor_area_ind_sid   NUMBER(10)      NOT NULL,
    absol_view_scenario_run_sid     NUMBER(10),
    CONSTRAINT PK_METRIC_DASHBOARD_IND PRIMARY KEY (csrimp_session_id, metric_dashboard_sid, ind_sid),
    CONSTRAINT FK_METRIC_DASHBOARD_IND_IS
        FOREIGN KEY (csrimp_session_id)
        REFERENCES csrimp.csrimp_session (csrimp_session_id)
        ON DELETE CASCADE
);

CREATE TABLE csrimp.metric_dashboard_plugin (
    csrimp_session_id               NUMBER(10)      DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    metric_dashboard_sid            NUMBER(10)      NOT NULL,
    plugin_id                       NUMBER(10)      NOT NULL,
    CONSTRAINT PK_METRIC_DASHBOARD_PLUGIN PRIMARY KEY (csrimp_session_id, metric_dashboard_sid, plugin_id),
    CONSTRAINT FK_METRIC_DASHBOARD_PLUGIN_IS
        FOREIGN KEY (csrimp_session_id)
        REFERENCES csrimp.csrimp_session (csrimp_session_id)
        ON DELETE CASCADE
);

CREATE TABLE csrimp.internal_audit_type_carry_fwd (
	csrimp_session_id				NUMBER(10, 0) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	from_internal_audit_type_id		NUMBER(10, 0) NOT NULL,
	to_internal_audit_type_id		NUMBER(10, 0) NOT NULL,
	CONSTRAINT pk_iatcf				PRIMARY KEY (csrimp_session_id, from_internal_audit_type_id, to_internal_audit_type_id),
    CONSTRAINT fk_iatcf_is			FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.GRESB_INDICATOR_MAPPING (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	GRESB_INDICATOR_ID				NUMBER(10, 0) NOT NULL,
	IND_SID							NUMBER(10, 0),
	MEASURE_CONVERSION_ID			NUMBER(10, 0),
	NOT_APPLICABLE					NUMBER(1, 0)  NOT NULL,
	CONSTRAINT PK_GRESB_INDICATOR_MAPPING PRIMARY KEY (CSRIMP_SESSION_ID, GRESB_INDICATOR_ID),
	CONSTRAINT FK_GRESB_INDICATOR_MAPPING FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.GRESB_SUBMISSION_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	GRESB_SUBMISSION_ID				NUMBER(10, 0) NOT NULL,
	GRESB_RESPONSE_ID				VARCHAR2(255),
	GRESB_ENTITY_ID					VARCHAR2(255),
	GRESB_ASSET_ID					VARCHAR2(255),
	SUBMISSION_TYPE					NUMBER(10, 0) NOT NULL,
	SUBMISSION_DATE					DATE NOT NULL,
	REQUEST_DATA					CLOB NULL,
	RESPONSE_DATA					CLOB NULL,
	CONSTRAINT PK_GRESB_SUBMISSION_LOG PRIMARY KEY (CSRIMP_SESSION_ID, GRESB_SUBMISSION_ID),
	CONSTRAINT FK_GRESB_SUBMISSION_LOG FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.property_fund (
	csrimp_session_id				NUMBER(10, 0) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	region_sid						NUMBER(10, 0) NOT NULL,
	fund_id							NUMBER(10, 0) NOT NULL,
	container_sid					NUMBER(10, 0) NULL,
	CONSTRAINT pk_property_fund		PRIMARY KEY (csrimp_session_id, region_sid, fund_id),
	CONSTRAINT fk_property_fund FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.property_gresb(
	csrimp_session_id				NUMBER(10, 0) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	region_sid						NUMBER(10, 0)	NOT NULL,
	asset_id						NUMBER(10, 0)	NOT NULL,
	CONSTRAINT pk_property_gresb PRIMARY KEY (csrimp_session_id, region_sid),
	CONSTRAINT uk_property_gresb_asset_id UNIQUE (csrimp_session_id, asset_id),
	CONSTRAINT fk_property_gresb FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.property_fund_ownership (
	csrimp_session_id				NUMBER(10, 0) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	region_sid						NUMBER(10, 0) NOT NULL,
	fund_id							NUMBER(10, 0) NOT NULL,
	start_dtm						DATE NOT NULL,
	ownership						NUMBER(29, 28) NOT NULL,
	CONSTRAINT pk_property_fund_ownership PRIMARY KEY (csrimp_session_id, region_sid, fund_id, start_dtm),
	CONSTRAINT fk_property_fund_ownership FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_RISK_LEVEL (
	CSRIMP_SESSION_ID				NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	RISK_LEVEL_ID					NUMBER(10, 0)	NOT NULL,
	LABEL							VARCHAR2(255)	NOT NULL,
	LOOKUP_KEY				 		VARCHAR2(255)	NULL,
	CONSTRAINT PK_CHAIN_RISK_LEVEL PRIMARY KEY (CSRIMP_SESSION_ID, RISK_LEVEL_ID),
	CONSTRAINT FK_CHAIN_RISK_LEVEL_SESSION FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE UNIQUE INDEX CSRIMP.UK_CHAIN_RISK_LVL_LKUP_KEY ON CSRIMP.CHAIN_RISK_LEVEL (CSRIMP_SESSION_ID, NVL(UPPER(LOOKUP_KEY), TO_CHAR(RISK_LEVEL_ID)));

CREATE TABLE CSRIMP.CHAIN_COUNTRY_RISK_LEVEL (
	CSRIMP_SESSION_ID				NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COUNTRY							VARCHAR2(2)		NOT NULL,
	RISK_LEVEL_ID					NUMBER(10, 0)	NOT NULL,
	START_DTM				 		DATE			NOT NULL,
	CONSTRAINT PK_CHAIN_COUNTRY_RISK_LEVEL PRIMARY KEY (CSRIMP_SESSION_ID, COUNTRY, START_DTM),
	CONSTRAINT FK_CHAIN_CNTRY_RSK_LVL_SESSION FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.mgt_company_tree_sync_job (
	csrimp_session_id				NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	tree_root_sid					NUMBER(10, 0) NOT NULL,
	CONSTRAINT pk_mgt_company_tree_sync_job PRIMARY KEY (csrimp_session_id, tree_root_sid),
	CONSTRAINT fk_mctsj_session FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_IMPORT_SOURCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IMPORT_SOURCE_ID				NUMBER NOT NULL,
	DEDUPE_NO_MATCH_ACTION_ID		NUMBER(1,0) NOT NULL,
	NAME							VARCHAR2(255) NOT NULL,
	POSITION						NUMBER NOT NULL,
	LOOKUP_KEY						VARCHAR2(32) NOT NULL,
	IS_OWNED_BY_SYSTEM				NUMBER(1,0) NOT NULL,
	OVERRIDE_COMPANY_ACTIVE			NUMBER(1, 0) NOT NULL,
	CONSTRAINT PK_CHAIN_IMPORT_SOURCE PRIMARY KEY (CSRIMP_SESSION_ID, IMPORT_SOURCE_ID),
	CONSTRAINT FK_CHAIN_IMPORT_SOURCE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_STAGIN_LINK (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DEDUPE_STAGING_LINK_ID NUMBER NOT NULL,
	DESCRIPTION VARCHAR2(64) NOT NULL,
	DESTINATION_TAB_SID NUMBER(10,0),
	IMPORT_SOURCE_ID NUMBER NOT NULL,
	PARENT_STAGING_LINK_ID NUMBER(10,0),
	POSITION NUMBER(10,0) NOT NULL,
	STAGING_BATCH_NUM_COL_SID NUMBER(10,0),
	STAGING_ID_COL_SID NUMBER(10,0),
	STAGING_TAB_SID NUMBER(10,0),
	STAGING_SOURCE_LOOKUP_COL_SID NUMBER(10,0),
	IS_OWNED_BY_SYSTEM NUMBER(1) NOT NULL,
	CONSTRAINT PK_CHAIN_DEDUPE_STAGIN_LINK PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_STAGING_LINK_ID),
	CONSTRAINT CHK_IS_OWNED_BY_SYSTEM_ST CHECK (IS_OWNED_BY_SYSTEM IN (0,1)),
	CONSTRAINT CHK_SYSTEM_TAB_COL CHECK ((IS_OWNED_BY_SYSTEM = 0 AND STAGING_TAB_SID IS NOT NULL AND STAGING_ID_COL_SID IS NOT NULL) 
		OR (IS_OWNED_BY_SYSTEM = 1 AND STAGING_TAB_SID IS NULL AND STAGING_ID_COL_SID IS NULL)),
	CONSTRAINT FK_CHAIN_DEDUPE_STAGIN_LINK_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_MAPPING (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DEDUPE_MAPPING_ID NUMBER NOT NULL,
	COL_SID NUMBER,
	DEDUPE_FIELD_ID NUMBER,
	REFERENCE_ID NUMBER,
	TAG_GROUP_ID NUMBER,
	TAB_SID NUMBER,
	DESTINATION_TAB_SID NUMBER(10, 0),
	DESTINATION_COL_SID NUMBER(10, 0),
	DEDUPE_STAGING_LINK_ID NUMBER(10, 0),
	ROLE_SID NUMBER(10, 0),
	IS_OWNED_BY_SYSTEM NUMBER(1) NOT NULL,
	ALLOW_CREATE_ALT_COMPANY_NAME NUMBER(1),
	FILL_NULLS_UNDER_UI_SOURCE NUMBER(1),
	CONSTRAINT PK_CHAIN_DEDUPE_MAPPING PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_MAPPING_ID),
	CONSTRAINT CHK_IS_OWNED_BY_SYSTEM_MAP CHECK (IS_OWNED_BY_SYSTEM IN (0,1)),
	CONSTRAINT CHK_SYSTEM_MAPPING_TAB_COL CHECK ((IS_OWNED_BY_SYSTEM = 0 AND TAB_SID IS NOT NULL AND COL_SID IS NOT NULL)
		OR (IS_OWNED_BY_SYSTEM = 1 AND TAB_SID IS NULL AND COL_SID IS NULL)),
	CONSTRAINT FK_CHAIN_DEDUPE_MAPPING_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_RULE_SET (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DEDUPE_RULE_SET_ID NUMBER NOT NULL,
	DESCRIPTION VARCHAR2(255) NOT NULL,
	DEDUPE_STAGING_LINK_ID NUMBER NOT NULL,
	DEDUPE_MATCH_TYPE_ID NUMBER NOT NULL,
	POSITION NUMBER NOT NULL,
	CONSTRAINT PK_CHAIN_DEDUPE_RULE_SET PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_RULE_SET_ID),
	CONSTRAINT FK_CHAIN_DEDUPE_RULE_SET_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_RULE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DEDUPE_RULE_ID NUMBER NOT NULL,
	DEDUPE_RULE_SET_ID NUMBER NOT NULL,
	DEDUPE_MAPPING_ID NUMBER NOT NULL,
	POSITION NUMBER NOT NULL,
	DEDUPE_RULE_TYPE_ID NUMBER NOT NULL,
	MATCH_THRESHOLD NUMBER NOT NULL,
	CONSTRAINT PK_CHAIN_DEDUPE_RULE PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_RULE_ID),
	CONSTRAINT FK_CHAIN_DEDUPE_RULE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_MERGE_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DEDUPE_MERGE_LOG_ID NUMBER(10,0) NOT NULL,
	DEDUPE_FIELD_ID NUMBER(10,0),
	DEDUPE_PROCESSED_RECORD_ID NUMBER(10,0) NOT NULL,
	NEW_VAL VARCHAR2(4000),
	OLD_VAL VARCHAR2(4000),
	REFERENCE_ID NUMBER(10,0),
	TAG_GROUP_ID NUMBER(10,0),
	ROLE_SID NUMBER(10, 0),
	DESTINATION_TAB_SID NUMBER(10, 0),
	DESTINATION_COL_SID NUMBER(10, 0),
	ERROR_MESSAGE VARCHAR2(4000),
	current_desc_val		VARCHAR2(4000),
	new_raw_val				VARCHAR2(4000),
	new_translated_val		VARCHAR2(4000),
	ALT_COMP_NAME_DOWNGRADE NUMBER(1),
	CONSTRAINT PK_CHAIN_DEDUPE_MERGE_LOG PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_MERGE_LOG_ID),
	CONSTRAINT FK_CHAIN_DEDUPE_MERGE_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHAIN_DEDU_MERGE_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_DEDUPE_MERGE_LOG_ID NUMBER(10) NOT NULL,
	NEW_DEDUPE_MERGE_LOG_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHAIN_DEDU_MERGE_LOG PRIMARY KEY (CSRIMP_SESSION_ID, OLD_DEDUPE_MERGE_LOG_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHAIN_DEDU_MERGE_LOG UNIQUE (CSRIMP_SESSION_ID, NEW_DEDUPE_MERGE_LOG_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHAIN_DEDU_MERGE_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_PREPRO_COMP (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COMPANY_SID NUMBER(10,0) NOT NULL,
    ADDRESS VARCHAR2(1024),
    CITY VARCHAR2(255),
    NAME VARCHAR2(255) NOT NULL,
    POSTCODE VARCHAR2(255),
    STATE VARCHAR2(255),
    WEBSITE VARCHAR2(1000),
	PHONE VARCHAR2(255),
    EMAIL_DOMAIN VARCHAR2(255),
    UPDATED_DTM DATE,
    CONSTRAINT PK_CHAIN_DEDUPE_PREPRO_COMP PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID),
    CONSTRAINT FK_CHAIN_DEDUPE_PREPRO_COMP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_PREPRO_RULE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DEDUPE_PREPROC_RULE_ID NUMBER(10,0) NOT NULL,
    PATTERN VARCHAR2(1000) NOT NULL,
    REPLACEMENT VARCHAR2(1000),
    RUN_ORDER NUMBER(10,0) NOT NULL,
    CONSTRAINT PK_CHAIN_DEDUPE_PREPRO_RULE PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_PREPROC_RULE_ID),
    CONSTRAINT FK_CHAIN_DEDUPE_PREPRO_RULE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDU_PP_FIEL_CNTRY (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COUNTRY_CODE VARCHAR2(2),
    DEDUPE_FIELD_ID NUMBER(10,0),
    DEDUPE_PREPROC_RULE_ID NUMBER(10,0) NOT NULL,
    CONSTRAINT FK_CHAIN_DEDU_PP_FIEL_CNTRY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_PP_ALT_COMP_NAME (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALT_COMPANY_NAME_ID NUMBER(10) NOT NULL,
	COMPANY_SID NUMBER(10,0) NOT NULL,
	NAME VARCHAR2(255) NOT NULL,
	CONSTRAINT FK_CHAIN_DEDU_PP_ALT_COMP_NAME FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_SUB (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DEDUPE_SUB_ID NUMBER(10) NOT NULL,
    PATTERN VARCHAR2(1000) NOT NULL,
    SUBSTITUTION VARCHAR2(1000) NOT NULL,
    PROC_PATTERN VARCHAR2(1000),
    PROC_SUBSTITUTION VARCHAR2(1000),
    UPDATED_DTM DATE,
    CONSTRAINT PK_CHAIN_DEDUPE_SUB PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_SUB_ID),
    CONSTRAINT FK_CHAIN_DEDUPE_SUB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PEND_CMPNY_SUGGSTD_MATCH (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PENDING_COMPANY_SID			NUMBER(10) NOT NULL,
	MATCHED_COMPANY_SID			NUMBER(10) NOT NULL,
	DEDUPE_RULE_SET_ID			NUMBER(10) NULL,
	CONSTRAINT PK_PEND_CMPNY_SUGGSTD_MATCH PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_COMPANY_SID, MATCHED_COMPANY_SID),
	CONSTRAINT CHK_PEND_COMPANY_MATCHED_NE CHECK (PENDING_COMPANY_SID != MATCHED_COMPANY_SID),
	CONSTRAINT FK_PEND_CMPNY_SUGGSTD_MATCH_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_PENDING_COMPANY_TAG(
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PENDING_COMPANY_SID 		NUMBER(10) NOT NULL,
	TAG_ID						NUMBER(10) NOT NULL,
	CONSTRAINT PK_CHAIN_PENDING_COMPANY_TAG PRIMARY KEY (CSRIMP_SESSION_ID, PENDING_COMPANY_SID, TAG_ID),
	CONSTRAINT FK_CHAIN_PENDING_CMPNY_TAG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COMPANY_REQUEST_ACTION(
	CSRIMP_SESSION_ID			NUMBER(10) 		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_SID 				NUMBER(10)		NOT NULL,
	MATCHED_COMPANY_SID			NUMBER(10),
	ACTION						NUMBER(10)		NOT NULL,
	IS_PROCESSED				NUMBER(1)		NOT NULL,
	BATCH_JOB_ID				NUMBER(10),
	ERROR_MESSAGE				VARCHAR2(4000),
	ERROR_DETAIL				VARCHAR2(4000),
	CONSTRAINT PK_CHAIN_COMPANY_REQUEST_ACT PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_SID),
	CONSTRAINT CHK_COMPANY_REQUEST_ACTION CHECK (ACTION IN (0, 1, 2)),
	CONSTRAINT CHK_ACTION_MATCHED CHECK ((ACTION = 2 AND MATCHED_COMPANY_SID IS NOT NULL) OR MATCHED_COMPANY_SID IS NULL),
	CONSTRAINT FK_CHAIN_CMPNY_RQST_ACTION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.like_for_like_slot (
	csrimp_session_id			NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	like_for_like_sid			NUMBER(10, 0) NOT NULL,
	name						VARCHAR2(255) NOT NULL,
	ind_sid						NUMBER(10, 0) NOT NULL,
	region_sid  				NUMBER(10, 0) NOT NULL,
	include_inactive_regions	NUMBER(1, 0) NOT NULL,
	period_start_dtm			DATE NOT NULL,
	period_end_dtm				DATE NOT NULL,
	period_set_id				NUMBER(10, 0) NOT NULL,
	period_interval_id			NUMBER(10, 0) NOT NULL,
	rule_type					NUMBER(1, 0) NOT NULL,
	scenario_run_sid			NUMBER(10, 0) NOT NULL,
	created_by_user_sid			NUMBER(10, 0),
	created_dtm 				DATE,
	last_refresh_user_sid 		NUMBER(10, 0),
	last_refresh_dtm 			DATE,
	CONSTRAINT PK_LIKE_FOR_LIKE 		PRIMARY KEY	(CSRIMP_SESSION_ID, LIKE_FOR_LIKE_SID),
	CONSTRAINT FK_LIKE_FOR_LIKE_SESSION FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE,
	CONSTRAINT CK_L4L_RULE_TYPE			CHECK 		(RULE_TYPE IN (0, 1)),
	CONSTRAINT CK_L4L_INCL_INACT_REG	CHECK 		(INCLUDE_INACTIVE_REGIONS IN (0, 1))
);

CREATE TABLE csrimp.like_for_like_email_sub (
	csrimp_session_id		NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	like_for_like_sid		NUMBER(10, 0) NOT NULL,
	csr_user_sid			NUMBER(10, 0) NOT NULL,
	CONSTRAINT PK_L4L_EMAIL		 		PRIMARY KEY	(CSRIMP_SESSION_ID, LIKE_FOR_LIKE_SID, CSR_USER_SID),
	CONSTRAINT FK_L4L_EMAIL_SESSION 	FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_RAW_DATA_LOG(
    CSRIMP_SESSION_ID    NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_RAW_DATA_ID    NUMBER(10, 0)     NOT NULL,
    LOG_ID               NUMBER(10, 0)     NOT NULL,
    USER_SID             NUMBER(10, 0),
    LOG_TEXT             VARCHAR2(4000)    NOT NULL,
    LOG_DTM              DATE              NOT NULL,
    MIME_TYPE            VARCHAR2(256),
    FILE_NAME            VARCHAR2(1024),
    DATA                 BLOB,
    CONSTRAINT PK_METER_RAW_DATA_LOG PRIMARY KEY (CSRIMP_SESSION_ID, METER_RAW_DATA_ID, LOG_ID),
    CONSTRAINT FK_METER_RAW_DATA_LOG FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.degreeday_settings (
    csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	account_name					VARCHAR2(128) NOT NULL,
	download_enabled				NUMBER(1, 0) NOT NULL,
	earliest_fetch_dtm				DATE NOT NULL,
	average_years					NUMBER(3, 0) NOT NULL,
	heating_base_temp_ind_sid		NUMBER(10, 0) NULL,
	cooling_base_temp_ind_sid		NUMBER(10, 0) NULL,
	heating_degree_days_ind_sid		NUMBER(10, 0) NULL,
	cooling_degree_days_ind_sid		NUMBER(10, 0) NULL,
	heating_average_ind_sid			NUMBER(10, 0) NULL,
	cooling_average_ind_sid			NUMBER(10, 0) NULL,
	last_sync_dtm					DATE NULL,
	CONSTRAINT pk_degreeday_settings PRIMARY KEY (csrimp_session_id),
    CONSTRAINT fk_degreeday_settings_session
		FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_HIGG (
	CSRIMP_SESSION_ID       NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FTP_FOLDER				VARCHAR2(1000),
	FTP_PROFILE_LABEL		VARCHAR2(255),
    CONSTRAINT PK_HIGG PRIMARY KEY (CSRIMP_SESSION_ID),
	CONSTRAINT FK_HIGG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_CONFIG (
    CSRIMP_SESSION_ID       		NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_CONFIG_ID					NUMBER(10)	NOT NULL,
    COMPANY_TYPE_ID         		NUMBER(10)  NULL,
    AUDIT_TYPE_ID           		NUMBER(10)  NOT NULL,
    SURVEY_SID   					NUMBER(10)  NOT NULL,
    CLOSURE_TYPE_ID         		NUMBER(10)  NULL,
    AUDIT_COORDINATOR_SID   		NUMBER(10)  NOT NULL,
	AGGREGATE_IND_GROUP_ID 			NUMBER(10)  NULL,
	COPY_SCORE_ON_SURVEY_SUBMIT 	NUMBER(1)	NOT NULL,
    CONSTRAINT PK_HIGG_CONFIG PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_CONFIG_ID),
	CONSTRAINT FK_HIGG_CONFIG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_MODULE_TAG_GROUP (
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_MODULE_ID					NUMBER(10) 		NOT NULL,
	TAG_GROUP_ID					NUMBER(10)		NULL,
	CONSTRAINT PK_HIGG_MODULE_TAG_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_MODULE_ID, TAG_GROUP_ID),
	CONSTRAINT FK_HIGG_MODULE_TAG_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_CONFIG_MODULE (
	CSRIMP_SESSION_ID							NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_CONFIG_ID					NUMBER(10)	NOT NULL,
	HIGG_MODULE_ID					NUMBER(10)	NOT NULL,
	SCORE_TYPE_ID 					NUMBER(10)  NOT NULL,
	CONSTRAINT PK_HIGG_CONFIG_MODULE PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_CONFIG_ID, HIGG_MODULE_ID),
	CONSTRAINT FK_HIGG_CONFIG_MODULE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_QUESTION_SURVEY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_QUESTION_ID				NUMBER(10) NOT NULL,
	SURVEY_SID						NUMBER(10) NOT NULL,
	QS_QUESTION_ID					NUMBER(10) NOT NULL,
	QS_QUESTION_VERSION				NUMBER(10) NOT NULL,
	SURVEY_VERSION					NUMBER(10) NOT NULL,
	CONSTRAINT PK_HIGG_QUESTION_SURVEY PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_QUESTION_ID, SURVEY_SID),
	CONSTRAINT FK_HIGG_QUESTION_SURVEY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_QUESTION_OPTION_SURVEY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_QUESTION_ID				NUMBER(10) NOT NULL,
	HIGG_QUESTION_OPTION_ID			NUMBER(10) NOT NULL,
	SURVEY_SID						NUMBER(10) NOT NULL,
	QS_QUESTION_ID					NUMBER(10) NOT NULL,
	QS_QUESTION_VERSION				NUMBER(10) NOT NULL,
	QS_QUESTION_DRAFT				NUMBER(1)  NOT NULL,
	QS_QUESTION_OPTION_ID			NUMBER(10) NOT NULL,
	SURVEY_VERSION					NUMBER(10) NOT NULL,
	CONSTRAINT CHK_HQOS_QUESTION_DRAFT CHECK (QS_QUESTION_DRAFT IN (0,1)),
	CONSTRAINT PK_HIGG_QO_SURVEY PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_QUESTION_OPTION_ID, SURVEY_SID),
	CONSTRAINT FK_HIGG_QUESTION_OP_SURVEY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_PROFILE (
	CSRIMP_SESSION_ID							NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_PROFILE_ID					NUMBER(10)		NOT NULL,
	RESPONSE_YEAR					NUMBER(10)		NOT NULL,
	CONSTRAINT PK_HIGG_PROFILE PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_PROFILE_ID, RESPONSE_YEAR),
	CONSTRAINT FK_HIGG_PROFILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_RESPONSE (
	CSRIMP_SESSION_ID							NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_RESPONSE_ID				NUMBER(10)		NOT NULL,
	HIGG_MODULE_ID					NUMBER(10)		NOT NULL,
	HIGG_ACCOUNT_ID					NUMBER(10)		NULL, -- DO WE NEED THIS?
	HIGG_PROFILE_ID					NUMBER(10)		NOT NULL,
	RESPONSE_YEAR					NUMBER(10)		NOT NULL,
	MODULE_NAME						VARCHAR2(255)	NULL,
	POSTED							NUMBER(1)		NULL,
	VERIFICATION_STATUS				VARCHAR2(1000)	NULL,
	VERIFICATION_DOCUMENT_URL		VARCHAR2(1000)	NULL,
	IS_BENCHMARKED					NUMBER(1)		NULL,
	RESPONSE_SCORE					DECIMAL(10,4)	NULL,
	LAST_UPDATED_DTM				DATE			NULL,
	CONSTRAINT PK_HIGG_RESPONSE_ID PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_RESPONSE_ID),
	CONSTRAINT FK_HIGG_RESPONSE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_SECTION_SCORE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_RESPONSE_ID				NUMBER(10)		NOT NULL,
	HIGG_SECTION_ID					NUMBER(10)		NOT NULL,
	SCORE							DECIMAL(10,4)	NULL,
	CONSTRAINT PK_HIGG_SECTION_SCORE PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_RESPONSE_ID, HIGG_SECTION_ID),
	CONSTRAINT FK_HIGG_SECTION_SCORE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_SUB_SECTION_SCORE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_RESPONSE_ID				NUMBER(10)		NOT NULL,
	HIGG_SECTION_ID					NUMBER(10)		NOT NULL,
	HIGG_SUB_SECTION_ID				NUMBER(10)		NOT NULL,
	SCORE							DECIMAL(10,4)	NULL,
	CONSTRAINT PK_HIGG_SUB_SECTION_SCORE PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_RESPONSE_ID, HIGG_SUB_SECTION_ID),
	CONSTRAINT FK_HIGG_SUB_SEC_SCORE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_QUESTION_RESPONSE (
	CSRIMP_SESSION_ID				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_RESPONSE_ID				NUMBER(10)		NOT NULL,
	HIGG_QUESTION_ID				NUMBER(10)		NOT NULL,
	SCORE							NUMBER(10)		NULL,
	ANSWER							VARCHAR2(4000)	NULL,
	OPTION_ID						NUMBER(10)		NULL,
	CONSTRAINT PK_HIGG_QUESTION_RESPONSE PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_RESPONSE_ID, HIGG_QUESTION_ID),
	CONSTRAINT FK_HIGG_QUESTION_RESPONSE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_CONFIG_PROFILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HIGG_CONFIG_ID					NUMBER(10) NOT NULL,
	HIGG_PROFILE_ID					NUMBER(10) NOT NULL,
	RESPONSE_YEAR					NUMBER(10) NOT NULL,
	INTERNAL_AUDIT_SID				NUMBER(10) NOT NULL,
	CONSTRAINT PK_HIGG_CONFIG_PROFILE PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_CONFIG_ID, HIGG_PROFILE_ID, RESPONSE_YEAR),
	CONSTRAINT FK_HIGG_CONFIG_PROFILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HIGG_QUESTION_OPT_CONVERSION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	HIGG_QUESTION_ID				NUMBER(10) NOT NULL,
	HIGG_QUESTION_OPTION_ID			NUMBER(10) NOT NULL,
	MEASURE_CONVERSION_ID			NUMBER(10) NOT NULL,
	CONSTRAINT PK_HIGG_Q_OPT_CONV PRIMARY KEY (CSRIMP_SESSION_ID, HIGG_QUESTION_ID, HIGG_QUESTION_OPTION_ID),
    CONSTRAINT FK_HIGG_Q_OPT_CONV_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.degreeday_region (
    csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	region_sid						NUMBER(10) NOT NULL,
	station_id						VARCHAR2(32) NOT NULL,
	station_description				VARCHAR2(512) NULL,
	station_update_dtm				DATE NOT NULL,
	CONSTRAINT pk_degreeday_region PRIMARY KEY (csrimp_session_id, region_sid, station_id),
    CONSTRAINT pk_degreeday_region_session
		FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AGGREGATION_PERIOD (
	CSRIMP_SESSION_ID		NUMBER(10,0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID'),
	AGGREGATION_PERIOD_ID	NUMBER(10,0)	NOT NULL,
	LABEL					VARCHAR2(100)	NOT NULL,
	NO_OF_MONTHS			NUMBER(2)		NOT NULL,
	CONSTRAINT PK_AGGREGATION_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, AGGREGATION_PERIOD_ID),
	CONSTRAINT FK_AGGREGATION_PERIOD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.GEO_MAP(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    GEO_MAP_SID             	    NUMBER(10, 0)    NOT NULL,
    LABEL                   	    VARCHAR2(255)    NOT NULL,
    REGION_SELECTION_TYPE_ID	    NUMBER(10, 0)    NOT NULL,
    INCLUDE_INACTIVE_REGIONS	    NUMBER(1, 0)     NOT NULL,
    START_DTM               	    DATE             NOT NULL,
    END_DTM                 	    DATE,
    INTERVAL                	    VARCHAR2(10)     NOT NULL,
	TAG_ID                          NUMBER(10),
    CONSTRAINT CHK_GEO_MAP_INCL_INACT CHECK (INCLUDE_INACTIVE_REGIONS IN (0,1)),
    CONSTRAINT CHK_GEO_MAP_INTERVAL CHECK (INTERVAL IN ('m','q','h','y')),
    CONSTRAINT PK_GEO_MAP PRIMARY KEY (CSRIMP_SESSION_ID, GEO_MAP_SID),
    CONSTRAINT FK_GEO_MAP
		FOREIGN KEY (CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUP_PROCE_RECORD (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DEDUPE_PROCESSED_RECORD_ID NUMBER(10,0) NOT NULL,
	REFERENCE VARCHAR2(512) NOT NULL,
	DEDUPE_ACTION_TYPE_ID NUMBER(10,0),
	DEDUPE_STAGING_LINK_ID NUMBER(10,0) NOT NULL,
	ITERATION_NUM NUMBER(10,0) NOT NULL,
	MATCHED_BY_USER_SID NUMBER(10,0),
	MATCHED_DTM DATE,
	MATCHED_TO_COMPANY_SID NUMBER(10,0),
	PROCESSED_DTM DATE NOT NULL,
	CREATED_COMPANY_SID NUMBER(10,0),
	BATCH_NUM NUMBER(10,0),
	CMS_RECORD_ID NUMBER(10,0),
	PARENT_PROCESSED_RECORD_ID NUMBER(10,0),
	DATA_MERGED NUMBER(1, 0) NOT NULL,
	IMPORTED_USER_SID	NUMBER(10),
	MERGE_STATUS_ID NUMBER(10) NULL,
	DEDUPE_ACTION	NUMBER(1),
	CONSTRAINT PK_CHAIN_DEDUP_PROCE_RECORD PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_PROCESSED_RECORD_ID),
	CONSTRAINT FK_CHAIN_DEDUP_PROCE_RECORD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DEDUPE_MATCH (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DEDUPE_MATCH_ID NUMBER(10,0) NOT NULL,
	DEDUPE_PROCESSED_RECORD_ID NUMBER(10,0) NOT NULL,
	DEDUPE_RULE_SET_ID NUMBER(10,0) NOT NULL,
	MATCHED_TO_COMPANY_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_DEDUPE_MATCH PRIMARY KEY (CSRIMP_SESSION_ID, DEDUPE_MATCH_ID),
	CONSTRAINT FK_CHAIN_DEDUPE_MATCH_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);


CREATE TABLE CSRIMP.GEO_MAP_REGION(
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    GEO_MAP_SID						NUMBER(10, 0)    NOT NULL,
    REGION_SID     					NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_GEO_MAP_REGION PRIMARY KEY (CSRIMP_SESSION_ID, GEO_MAP_SID, REGION_SID),
    CONSTRAINT FK_GEO_MAP_REGION
		FOREIGN KEY (CSRIMP_SESSION_ID)
		REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CUSTOMER_GRID_EXT (
	CSRIMP_SESSION_ID				NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	GRID_EXTENSION_ID				NUMBER(10),
	ENABLED							NUMBER(1),
	CONSTRAINT PK_CUSTOMER_GRID_EXTENSION PRIMARY KEY (CSRIMP_SESSION_ID, GRID_EXTENSION_ID),
	CONSTRAINT FK_CUSTOMER_GRID_EXTENSION FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);


CREATE TABLE CSRIMP.INITIATIVE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	CREATED_BY_SID NUMBER(10,0) NOT NULL,
	CREATED_DTM DATE NOT NULL,
	DOC_LIBRARY_SID NUMBER(10,0),
	FIELDS_XML CLOB,
	FLOW_ITEM_ID NUMBER(10,0) NOT NULL,
	FLOW_SID NUMBER(10,0) NOT NULL,
	INTERNAL_REF VARCHAR2(255),
	IS_RAMPED NUMBER(1,0) NOT NULL,
	NAME VARCHAR2(1024) NOT NULL,
	PARENT_SID NUMBER(10,0),
	PERIOD_DURATION NUMBER(10,0) NOT NULL,
	PROJECT_END_DTM DATE,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	PROJECT_START_DTM DATE,
	RAG_STATUS_ID NUMBER(10,0),
	RUNNING_END_DTM DATE,
	RUNNING_START_DTM DATE,
	SAVING_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_SID),
	CONSTRAINT FK_INITIATIVE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_METRIC (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_METRIC_ID NUMBER(10,0) NOT NULL,
	DIVISIBILITY NUMBER(10,0) NOT NULL,
	IS_DURING NUMBER(1,0) NOT NULL,
	IS_EXTERNAL NUMBER(1,0) NOT NULL,
	IS_RAMPABLE NUMBER(1,0) NOT NULL,
	IS_RUNNING NUMBER(1,0) NOT NULL,
	IS_SAVING NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(1024) NOT NULL,
	LOOKUP_KEY VARCHAR2(255),
	MEASURE_SID NUMBER(10,0) NOT NULL,
	ONE_OFF_PERIOD NUMBER(10,0),
	PER_PERIOD_DURATION NUMBER(10,0),
	CONSTRAINT PK_INITIATIVE_METRIC PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_METRIC_ID),
	CONSTRAINT FK_INITIATIVE_METRIC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_PROJECT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	ABBREVIATION VARCHAR2(16),
	CATEGORY_LEVEL NUMBER(10,0),
	END_DTM DATE,
	FIELDS_XML XMLTYPE NOT NULL,
	FLOW_SID NUMBER(10,0) NOT NULL,
	HELPER_PKG VARCHAR2(255),
	ICON VARCHAR2(256),
	LIVE_FLOW_STATE_ID NUMBER(10,0) NOT NULL,
	NAME VARCHAR2(1024) NOT NULL,
	PERIOD_FIELDS_XML XMLTYPE NOT NULL,
	POS NUMBER(10,0),
	POS_GROUP NUMBER(10,0),
	START_DTM DATE,
	TAB_SID NUMBER(10,0),
	CONSTRAINT PK_INITIATIVE_PROJECT PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID),
	CONSTRAINT FK_INITIATIVE_PROJECT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIA_PROJEC_RAG_STATUS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	RAG_STATUS_ID NUMBER(10,0) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIA_PROJEC_RAG_STATUS PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, RAG_STATUS_ID),
	CONSTRAINT FK_INITIA_PROJEC_RAG_STATUS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_INIT_SAVING_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SAVING_TYPE_ID NUMBER(10,0) NOT NULL,
	IS_DURING NUMBER(1,0),
	IS_RUNNING NUMBER(1,0),
	CONSTRAINT PK_CUSTOME_INIT_SAVING_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, SAVING_TYPE_ID),
	CONSTRAINT FK_CUSTOME_INIT_SAVING_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_METRIC_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	POS_GROUP NUMBER(10,0) NOT NULL,
	INFO_TEXT VARCHAR2(4000),
	IS_GROUP_MANDATORY NUMBER(1,0) NOT NULL,
	LABEL VARCHAR2(1024),
	CONSTRAINT PK_INITIATIVE_METRIC_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, POS_GROUP),
	CONSTRAINT FK_INITIATIVE_METRIC_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROJECT_INITIATIVE_METRIC (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	INITIATIVE_METRIC_ID NUMBER(10,0) NOT NULL,
	DEFAULT_VALUE NUMBER(24,10),
	DISPLAY_CONTEXT VARCHAR2(255),
	FLOW_SID NUMBER(10,0) NOT NULL,
	INFO_TEXT VARCHAR2(4000),
	INPUT_DP NUMBER(10,0) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	POS_GROUP NUMBER(10,0) NOT NULL,
	UPDATE_PER_PERIOD NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_PROJECT_INITIATIV_METRIC PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, INITIATIVE_METRIC_ID),
	CONSTRAINT FK_PROJECT_INITIATIV_METRIC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_METRIC_ASSOC (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	PROPOSED_METRIC_ID NUMBER(10,0) NOT NULL,
	MEASURED_METRIC_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE_METRIC_ASSOC PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, PROPOSED_METRIC_ID, MEASURED_METRIC_ID),
	CONSTRAINT FK_INITIATIVE_METRIC_ASSOC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROJECT_INIT_METRIC_FLOW_STATE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_METRIC_ID NUMBER(10,0) NOT NULL,
	FLOW_STATE_ID NUMBER(10,0) NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	FLOW_SID NUMBER(10,0) NOT NULL,
	MANDATORY NUMBER(1,0) NOT NULL,
	VISIBLE NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_PROJ_INIT_METR_FLOW_STAT PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_METRIC_ID, FLOW_STATE_ID, PROJECT_SID),
	CONSTRAINT FK_PROJ_INIT_METR_FLOW_STAT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIAT_METRIC_STATE_IND (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_METRIC_ID NUMBER(10,0) NOT NULL,
	FLOW_STATE_GROUP_ID NUMBER(10,0) NOT NULL,
	IND_SID NUMBER(10,0) NOT NULL,
	MEASURE_SID NUMBER(10,0) NOT NULL,
	NET_PERIOD NUMBER(10,0),
	CONSTRAINT PK_INITIAT_METRIC_STATE_IND PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_METRIC_ID, FLOW_STATE_GROUP_ID, IND_SID),
	CONSTRAINT FK_INITIAT_METRIC_STATE_IND_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AGGR_TAG_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AGGR_TAG_GROUP_ID NUMBER(10,0) NOT NULL,
	COUNT_IND_SID NUMBER(10,0),
	LABEL VARCHAR2(1024) NOT NULL,
	LOOKUP_KEY VARCHAR2(256) NOT NULL,
	CONSTRAINT PK_AGGR_TAG_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, AGGR_TAG_GROUP_ID),
	CONSTRAINT FK_AGGR_TAG_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIV_METRIC_TAG_IND (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_METRIC_ID NUMBER(10,0) NOT NULL,
	AGGR_TAG_GROUP_ID NUMBER(10,0) NOT NULL,
	IND_SID NUMBER(10,0) NOT NULL,
	MEASURE_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIV_METRIC_TAG_IND PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_METRIC_ID, AGGR_TAG_GROUP_ID, IND_SID),
	CONSTRAINT FK_INITIATIV_METRIC_TAG_IND_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AGGR_TAG_GROUP_MEMBER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AGGR_TAG_GROUP_ID NUMBER(10,0) NOT NULL,
	TAG_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_AGGR_TAG_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, AGGR_TAG_GROUP_ID, TAG_ID),
	CONSTRAINT FK_AGGR_TAG_GROUP_MEMBER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_COMMENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_COMMENT_ID NUMBER(10,0) NOT NULL,
	COMMENT_TEXT CLOB,
	INITIATIVE_SID NUMBER(10,0),
	POSTED_DTM DATE NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE_COMMENT PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_COMMENT_ID),
	CONSTRAINT FK_INITIATIVE_COMMENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_EVENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_EVENT_ID NUMBER(10,0) NOT NULL,
	CREATED_BY_SID NUMBER(10,0) NOT NULL,
	CREATED_DTM DATE NOT NULL,
	DESCRIPTION VARCHAR2(4000),
	END_DTM DATE,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	LOCATION VARCHAR2(1000),
	START_DTM DATE NOT NULL,
	CONSTRAINT PK_INITIATIVE_EVENT PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_EVENT_ID),
	CONSTRAINT FK_INITIATIVE_EVENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_GROUP_ID NUMBER(10,0) NOT NULL,
	IS_PUBLIC NUMBER(1,0) NOT NULL,
	NAME VARCHAR2(256) NOT NULL,
	CONSTRAINT PK_INITIATIVE_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_GROUP_ID),
	CONSTRAINT FK_INITIATIVE_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIAT_GROUP_FLOW_STATE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_USER_GROUP_ID NUMBER(10,0) NOT NULL,
	FLOW_STATE_ID NUMBER(10,0) NOT NULL,
	FLOW_SID NUMBER(10,0) NOT NULL,
	GENERATE_ALERTS NUMBER(1,0) NOT NULL,
	IS_EDITABLE NUMBER(1,0) NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIAT_GROUP_FLOW_STATE PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_USER_GROUP_ID, FLOW_STATE_ID, PROJECT_SID),
	CONSTRAINT FK_INITIAT_GROUP_FLOW_STATE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_GROUP_MEMBER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_GROUP_ID NUMBER(10,0) NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_GROUP_ID, INITIATIVE_SID),
	CONSTRAINT FK_INITIATIVE_GROUP_MEMBER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_GROUP_USER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_GROUP_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	CAN_EDIT NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE_GROUP_USER PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_GROUP_ID, USER_SID),
	CONSTRAINT FK_INITIATIVE_GROUP_USER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_IMPORT_MAP_MRU (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CSR_USER_SID NUMBER(10,0) NOT NULL,
	FROM_NAME VARCHAR2(1024) NOT NULL,
	TO_NAME VARCHAR2(1024) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIV_IMPORT_MAP_MRU PRIMARY KEY (CSRIMP_SESSION_ID, CSR_USER_SID, FROM_NAME, TO_NAME),
	CONSTRAINT FK_INITIATIV_IMPORT_MAP_MRU_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATI_IMPORT_TEMPLATE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IMPORT_TEMPLATE_ID NUMBER(10,0) NOT NULL,
	HEADING_ROW_IDX NUMBER(10,0) NOT NULL,
	IS_DEFAULT NUMBER(1,0) NOT NULL,
	NAME VARCHAR2(1024) NOT NULL,
	PROJECT_SID NUMBER(10,0),
	WORKBOOK BLOB,
	WORKSHEET_NAME VARCHAR2(1024) NOT NULL,
	CONSTRAINT PK_INITIATI_IMPORT_TEMPLATE PRIMARY KEY (CSRIMP_SESSION_ID, IMPORT_TEMPLATE_ID),
	CONSTRAINT FK_INITIATI_IMPORT_TEMPLATE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIA_IMPORT_TEMPLA_MAP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IMPORT_TEMPLATE_ID NUMBER(10,0) NOT NULL,
	TO_NAME VARCHAR2(1024) NOT NULL,
	FROM_IDX NUMBER(10,0) NOT NULL,
	FROM_NAME VARCHAR2(1024) NOT NULL,
	CONSTRAINT PK_INITIA_IMPORT_TEMPLA_MAP PRIMARY KEY (CSRIMP_SESSION_ID, IMPORT_TEMPLATE_ID, TO_NAME),
	CONSTRAINT FK_INITIA_IMPORT_TEMPLA_MAP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_METRIC_VAL (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_METRIC_ID NUMBER(10,0) NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	ENTRY_MEASURE_CONVERSION_ID NUMBER(10,0),
	ENTRY_VAL NUMBER(24,10),
	MEASURE_SID NUMBER(10,0),
	PROJECT_SID NUMBER(10,0) NOT NULL,
	VAL NUMBER(24,10),
	CONSTRAINT PK_INITIATIVE_METRIC_VAL PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_METRIC_ID, INITIATIVE_SID),
	CONSTRAINT FK_INITIATIVE_METRIC_VAL_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_PERIOD_STATUS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_PERIOD_STATUS_ID NUMBER(10,0) NOT NULL,
	COLOUR NUMBER(10,0),
	LABEL VARCHAR2(255) NOT NULL,
	MEANS_PCT_COMPLETE NUMBER(3,2),
	CONSTRAINT PK_INITIATIVE_PERIOD_STATUS PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_PERIOD_STATUS_ID),
	CONSTRAINT FK_INITIATIVE_PERIOD_STATUS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_PERIOD (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	START_DTM DATE NOT NULL,
	APPROVED_BY_SID NUMBER(10,0),
	APPROVED_DTM DATE,
	END_DTM DATE NOT NULL,
	ENTERED_BY_SID NUMBER(10,0) NOT NULL,
	ENTERED_DTM DATE NOT NULL,
	FIELDS_XML CLOB,
	INITIATIVE_PERIOD_STATUS_ID NUMBER(10,0) NOT NULL,
	NEEDS_AGGREGATION NUMBER(1,0) NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	PUBLIC_COMMENT_APPROVED_BY_SID NUMBER(10,0),
	PUBLIC_COMMENT_APPROVED_DTM DATE,
	SET_FLOW_STATE_ID NUMBER(10,0),
	CONSTRAINT PK_INITIATIVE_PERIOD PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_SID, REGION_SID, START_DTM),
	CONSTRAINT FK_INITIATIVE_PERIOD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_PROJECT_TAB (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	PLUGIN_TYPE_ID NUMBER(10,0) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	TAB_LABEL VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_INITIATIVE_PROJECT_TAB PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, PLUGIN_ID),
	CONSTRAINT FK_INITIATIVE_PROJECT_TAB_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIA_PROJECT_TAB_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	GROUP_SID NUMBER(10,0) NOT NULL,
	IS_READ_ONLY NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_INITIA_PROJECT_TAB_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, PLUGIN_ID, GROUP_SID),
	CONSTRAINT FK_INITIA_PROJECT_TAB_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_PROJECT_TEAM (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EMAIL VARCHAR2(512),
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	NAME VARCHAR2(512) NOT NULL,
	CONSTRAINT FK_INITIATIVE_PROJECT_TEAM_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_REGION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	USE_FOR_CALC NUMBER(1,0),
	CONSTRAINT PK_INITIATIVE_REGION PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_SID, REGION_SID),
	CONSTRAINT FK_INITIATIVE_REGION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_SPONSOR (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EMAIL VARCHAR2(512),
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	NAME VARCHAR2(512) NOT NULL,
	CONSTRAINT FK_INITIATIVE_SPONSOR_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_TAG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	TAG_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE_TAG PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_SID, TAG_ID),
	CONSTRAINT FK_INITIATIVE_TAG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_USER_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_USER_GROUP_ID NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(255) NOT NULL,
	LOOKUP_KEY VARCHAR2(255),
	SYNCH_ISSUES NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE_USER_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_USER_GROUP_ID),
	CONSTRAINT FK_INITIATIVE_USER_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIA_PROJEC_USER_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_USER_GROUP_ID NUMBER(10,0) NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIA_PROJEC_USER_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_USER_GROUP_ID, PROJECT_SID),
	CONSTRAINT FK_INITIA_PROJEC_USER_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_USER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	INITIATIVE_USER_GROUP_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE_USER PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_SID, INITIATIVE_USER_GROUP_ID, USER_SID),
	CONSTRAINT FK_INITIATIVE_USER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_USER_MSG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	USER_MSG_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_INITIATIVE_USER_MSG PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_SID, USER_MSG_ID),
	CONSTRAINT FK_INITIATIVE_USER_MSG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVES_OPTIONS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AUTO_COMPLETE_DATE NUMBER(1,0) NOT NULL,
	CURRENT_REPORT_DATE DATE,
	GANTT_PERIOD_COLOUR NUMBER(1,0) NOT NULL,
	INITIATIVES_HOST VARCHAR2(256),
	INITIATIVE_NAME_GEN_PROC VARCHAR2(256),
	INITIATIVE_NEW_DAYS NUMBER(10,0) NOT NULL,
	INITIATIVE_REMINDER_ALERTS NUMBER(1,0) NOT NULL,
	METRICS_END_YEAR NUMBER(10,0) NOT NULL,
	METRICS_START_YEAR NUMBER(10,0) NOT NULL,
	MY_INITIATIVES_OPTIONS VARCHAR2(1024),
	UPDATE_REF_ON_AMEND NUMBER(1,0) NOT NULL,
	CONSTRAINT FK_INITIATIVES_OPTIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_MSG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_MSG_ID NUMBER(10,0) NOT NULL,
	MSG_DTM DATE NOT NULL,
	MSG_TEXT CLOB NOT NULL,
	REPLY_TO_MSG_ID NUMBER(10,0),
	USER_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_USER_MSG PRIMARY KEY (CSRIMP_SESSION_ID, USER_MSG_ID),
	CONSTRAINT FK_USER_MSG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROJECT_INITIATIVE_PERIOD_STAT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	INITIATIVE_PERIOD_STATUS_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_PROJE_INITIA_PERIOD_STAT PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, INITIATIVE_PERIOD_STATUS_ID),
	CONSTRAINT FK_PROJE_INITIA_PERIOD_STAT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DEFAULT_INITIATIVE_USER_STATE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_STATE_ID NUMBER(10,0) NOT NULL,
	FLOW_SID NUMBER(10,0),
	IS_EDITABLE NUMBER(1,0) NOT NULL,
	GENERATE_ALERTS NUMBER(1,0) NOT NULL,
	CONSTRAINT PK_DEFAUL_INITIA_USER_STATE PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_STATE_ID),
	CONSTRAINT FK_DEFAUL_INITIA_USER_STATE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_INITIATIVE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_INITIATIVE_ID NUMBER(10,0) NOT NULL,
	INITIATIVE_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_ISSUE_INITIATIVE PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_INITIATIVE_ID),
	CONSTRAINT FK_ISSUE_INITIATIVE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.AGGR_REGION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	AGGR_REGION_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_AGGR_REGION PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID),
	CONSTRAINT FK_AGGR_REGION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_BATCH_RUN (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CUSTOMER_ALERT_TYPE_ID NUMBER(10,0) NOT NULL,
	CSR_USER_SID NUMBER(10,0) NOT NULL,
	NEXT_FIRE_TIME TIMESTAMP(6) NOT NULL,
	PREV_FIRE_TIME TIMESTAMP(6),
	CONSTRAINT PK_ALERT_BATCH_RUN PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_ALERT_TYPE_ID, CSR_USER_SID),
	CONSTRAINT FK_ALERT_BATCH_RUN_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROJECT_DOC_FOLDER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	NAME VARCHAR2(256) NOT NULL,
	INFO_TEXT VARCHAR2(4000),
	LABEL VARCHAR2(1024) NOT NULL,
	CONSTRAINT PK_PROJECT_DOC_FOLDER PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, NAME),
	CONSTRAINT FK_PROJECT_DOC_FOLDER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROJECT_TAG_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	TAG_GROUP_ID NUMBER(10,0) NOT NULL,
	DEFAULT_TAG_ID NUMBER(10,0),
	POS NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_PROJECT_TAG_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, TAG_GROUP_ID),
	CONSTRAINT FK_PROJECT_TAG_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PROJECT_TAG_FILTER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROJECT_SID NUMBER(10,0) NOT NULL,
	TAG_GROUP_ID NUMBER(10,0) NOT NULL,
	TAG_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_PROJECT_TAG_FILTER PRIMARY KEY (CSRIMP_SESSION_ID, PROJECT_SID, TAG_GROUP_ID, TAG_ID),
	CONSTRAINT FK_PROJECT_TAG_FILTER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INITIATIVE_HEADER_ELEMENT (
    CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	INITIATIVE_HEADER_ELEMENT_ID	NUMBER(10) NOT NULL,
	POS								NUMBER(10) NOT NULL,
	COL								NUMBER(10) NOT NULL,
	INITIATIVE_METRIC_ID			NUMBER(10),
	TAG_GROUP_ID					NUMBER(10),
	INIT_HEADER_CORE_ELEMENT_ID		NUMBER(10),
	CONSTRAINT PK_INITIATIVE_HEADER_ELEMENT PRIMARY KEY (CSRIMP_SESSION_ID, INITIATIVE_HEADER_ELEMENT_ID),
	CONSTRAINT CHK_INITIATIVE_HEADER_ELEMENT
		CHECK ((INITIATIVE_METRIC_ID IS NOT NULL AND TAG_GROUP_ID IS NULL AND INIT_HEADER_CORE_ELEMENT_ID IS NULL) OR
				(INITIATIVE_METRIC_ID IS NULL AND TAG_GROUP_ID IS NOT NULL AND INIT_HEADER_CORE_ELEMENT_ID IS NULL) OR
				(INITIATIVE_METRIC_ID IS NULL AND TAG_GROUP_ID IS NULL AND INIT_HEADER_CORE_ELEMENT_ID IS NOT NULL)),
	CONSTRAINT FK_INITIATIVE_HEADER_EL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INIT_TAB_ELEMENT_LAYOUT (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	ELEMENT_ID			NUMBER(10) NOT NULL,
	PLUGIN_ID			NUMBER(10) NOT NULL,
	TAG_GROUP_ID		NUMBER(10),
	XML_FIELD_ID		VARCHAR2(255),
	POS					NUMBER(10) NOT NULL,
	CONSTRAINT PK_INITIATIVE_TAB_EL_LAYOUT PRIMARY KEY (CSRIMP_SESSION_ID, ELEMENT_ID),
	CONSTRAINT CHK_INIT_TAB_LAYT_TYPES CHECK ((XML_FIELD_ID IS NULL AND TAG_GROUP_ID IS NULL) OR (XML_FIELD_ID IS NOT NULL AND TAG_GROUP_ID IS NULL) OR (XML_FIELD_ID IS NULL AND TAG_GROUP_ID IS NOT NULL)),
	CONSTRAINT FK_INIT_TAB_ELEMENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE UNIQUE INDEX CSRIMP.IDX_INIT_TAB_LAYOUT_TAG_GRP_ID ON CSRIMP.INIT_TAB_ELEMENT_LAYOUT (
	CSRIMP_SESSION_ID, NVL(TO_CHAR(TAG_GROUP_ID), ELEMENT_ID)
);

CREATE UNIQUE INDEX CSRIMP.IDX_INIT_TAB_LAYOUT_XML_FLD_ID ON CSRIMP.INIT_TAB_ELEMENT_LAYOUT (
	CSRIMP_SESSION_ID, NVL(TO_CHAR(XML_FIELD_ID), ELEMENT_ID)
);

CREATE TABLE CSRIMP.INIT_CREATE_PAGE_EL_LAYOUT (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	ELEMENT_ID			VARCHAR2(255) NOT NULL,
	TAG_GROUP_ID		NUMBER(10),
	XML_FIELD_ID		VARCHAR2(255),
	SECTION_ID			VARCHAR2(255) NOT NULL,
	POS					NUMBER(10) NOT NULL,
	CONSTRAINT PK_INITIATIVE_EL_LAYOUT PRIMARY KEY (CSRIMP_SESSION_ID, ELEMENT_ID),
	CONSTRAINT CHK_INIT_EL_LAYT_TYPES CHECK ((XML_FIELD_ID IS NULL AND TAG_GROUP_ID IS NULL) OR (XML_FIELD_ID IS NOT NULL AND TAG_GROUP_ID IS NULL) OR (XML_FIELD_ID IS NULL AND TAG_GROUP_ID IS NOT NULL)),
	CONSTRAINT FK_INIT_CREATE_ELEMENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE UNIQUE INDEX CSRIMP.IDX_INIT_EL_LAYOUT_TAG_GRP_ID ON CSRIMP.INIT_CREATE_PAGE_EL_LAYOUT (
	CSRIMP_SESSION_ID, NVL(TO_CHAR(TAG_GROUP_ID), ELEMENT_ID)
);

CREATE TABLE CSRIMP.CUSTOM_FACTOR_SET(
    CSRIMP_SESSION_ID       NUMBER(10, 0)   DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOM_FACTOR_SET_ID    NUMBER(10, 0)     NOT NULL,
    NAME                    VARCHAR2(1000)    NOT NULL,
	CREATED_BY_SID			NUMBER(10, 0),
	CREATED_DTM				DATE,
	FACTOR_SET_GROUP_ID		NUMBER(10, 0),
	INFO_NOTE 				CLOB,
   CONSTRAINT PK_CUSTOM_FACTOR_SET PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOM_FACTOR_SET_ID),
    CONSTRAINT FK_CUSTOM_FACTOR_SET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOM_FACTOR(
    CSRIMP_SESSION_ID            NUMBER(10, 0)   DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOM_FACTOR_ID             NUMBER(10, 0)     NOT NULL,
    CUSTOM_FACTOR_SET_ID         NUMBER(10, 0)     NOT NULL,
    FACTOR_TYPE_ID               NUMBER(10, 0)     NOT NULL,
    GAS_TYPE_ID                  NUMBER(10, 0)     NOT NULL,
    GEO_COUNTRY                  VARCHAR2(2),
    GEO_REGION                   VARCHAR2(2),
    EGRID_REF                    VARCHAR2(4),
	REGION_SID					 NUMBER(10, 0),
    STD_MEASURE_CONVERSION_ID    NUMBER(10, 0)     NOT NULL,
    START_DTM                    DATE              NOT NULL,
    END_DTM                      DATE,
    VALUE                        NUMBER(24, 10)    NOT NULL,
    NOTE                         CLOB,
	CONSTRAINT CK_CUSTOM_FCTR_DATES CHECK ((START_DTM = TRUNC(START_DTM, 'MON') AND END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM)),
    CONSTRAINT PK_CUSTOM_FACTOR PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOM_FACTOR_ID),
    CONSTRAINT FK_CUSTOM_FACTOR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.EMISSION_FACTOR_PROFILE(
    CSRIMP_SESSION_ID       NUMBER(10, 0)   DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROFILE_ID 				NUMBER(10, 0)     NOT NULL,
	NAME 					VARCHAR2(1000)    NOT NULL,
	START_DTM 				DATE,
	END_DTM 				DATE,
	APPLIED		 			NUMBER(1, 0)      NOT NULL,
	CONSTRAINT CK_EMISSION_FCTR_DATES CHECK ((START_DTM = TRUNC(START_DTM, 'MON') AND END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM)),
	CONSTRAINT CK_EMISSION_FCTR_PROF_APPLIED CHECK (APPLIED IN (1, 0)),
    CONSTRAINT PK_EMISSION_FACTOR_PROFILE PRIMARY KEY (CSRIMP_SESSION_ID, PROFILE_ID),
    CONSTRAINT FK_EMISSION_FACTOR_PROFILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.EMISSION_FACTOR_PROFILE_FACTOR(
    CSRIMP_SESSION_ID       NUMBER(10, 0)   DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PROFILE_ID 				NUMBER(10, 0)     NOT NULL,
	FACTOR_TYPE_ID 			NUMBER(10, 0)     NOT NULL,
	STD_FACTOR_SET_ID		NUMBER(10, 0),
	CUSTOM_FACTOR_SET_ID	NUMBER(10, 0),
	REGION_SID 				NUMBER(10, 0),
    GEO_COUNTRY             VARCHAR2(2),
    GEO_REGION              VARCHAR2(2),
    EGRID_REF               VARCHAR2(4),
	CONSTRAINT CK_EMISSION_FCTR_PROF_FACTOR CHECK
        (NOT (STD_FACTOR_SET_ID IS NULL AND CUSTOM_FACTOR_SET_ID IS NULL) AND
         NOT (STD_FACTOR_SET_ID IS NOT NULL AND CUSTOM_FACTOR_SET_ID IS NOT NULL)),
    CONSTRAINT FK_EMSSN_FCTR_PRFLE_FCTR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE,
	CONSTRAINT UK_EMISSION_FCTR_PROFILE_FCTR UNIQUE (csrimp_session_id, profile_id, factor_type_id, std_factor_set_id, custom_factor_set_id,
													 region_sid, geo_country, geo_region, egrid_ref)
);

CREATE TABLE CSRIMP.STD_FACTOR_SET_ACTIVE(
	CSRIMP_SESSION_ID       NUMBER(10, 0)   DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	STD_FACTOR_SET_ID		NUMBER(10, 0)   NOT NULL,
	CONSTRAINT PK_STD_FACTOR_SET_ACTIVE PRIMARY KEY (CSRIMP_SESSION_ID, STD_FACTOR_SET_ID),
	CONSTRAINT FK_STD_FACTOR_SET_ACTIVE_IS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ENHESA_OPTIONS(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CLIENT_ID						VARCHAR2(1024) NOT NULL,
	USERNAME						VARCHAR2(1024),
	PASSWORD						VARCHAR2(1024),
	LAST_SUCCESS					DATE,
	LAST_RUN						DATE,
	LAST_MESSAGE					VARCHAR2(1024),
	NEXT_RUN						DATE,
	MANUAL_RUN						NUMBER(1) NOT NULL,
	PACKAGES_IMPORTED				NUMBER(10),
	PACKAGES_TOTAL					NUMBER(10),
	ITEMS_IMPORTED					NUMBER(10),
	ITEMS_TOTAL						NUMBER(10),
	LINKS_CREATED					NUMBER(10),
	LINKS_TOTAL						NUMBER(10),
    CONSTRAINT pk_enhesa_options PRIMARY KEY (csrimp_session_id),
    CONSTRAINT fk_enhesa_options
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ENHESA_ERROR_LOG(
	CSRIMP_SESSION_ID	NUMBER(10, 0) DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	ERROR_LOG_ID		NUMBER(10) NOT NULL,
	ERROR_DTM			DATE NOT NULL,
	ERROR_MESSAGE		VARCHAR2(255) NOT NULL,
	STACK_TRACE			CLOB,
	CONSTRAINT PK_ENHESA_ERROR_LOG_ID PRIMARY KEY (CSRIMP_SESSION_ID, ERROR_LOG_ID)
);

CREATE TABLE CSRIMP.ENHESA_SITE_TYPE(
    CSRIMP_SESSION_ID           NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SITE_TYPE_ID				NUMBER(10)		NOT NULL,
	LABEL						VARCHAR2(256)	NOT NULL,
	CONSTRAINT pk_enhesa_site_type PRIMARY KEY (csrimp_session_id, site_type_id),
    CONSTRAINT fk_enhesa_site_type
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.ENHESA_SITE_TYPE_HEADING(
    CSRIMP_SESSION_ID           NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SITE_TYPE_HEADING_ID		NUMBER(10)		NOT NULL,
	SITE_TYPE_ID				NUMBER(10)		NOT NULL,
	HEADING_CODE				VARCHAR2(256)	NOT NULL,
	CONSTRAINT pk_enhesa_site_type_heading PRIMARY KEY (csrimp_session_id, site_type_heading_id),
    CONSTRAINT fk_enhesa_site_type_heading
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE,
	CONSTRAINT uk_site_type_heading UNIQUE (csrimp_session_id, site_type_id, heading_code)
)
;

CREATE TABLE csrimp.compliance_root_regions (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	region_sid						NUMBER(10,0) NOT NULL,
	region_type						NUMBER(2,0) NOT NULL,
	rollout_level					NUMBER(10,0),
	CONSTRAINT pk_compliance_root_regions PRIMARY KEY (csrimp_session_id, region_sid, region_type),
	CONSTRAINT fk_compliance_root_regions
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_options (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	quick_survey_type_id			NUMBER(10, 0) NOT NULL,
	requirement_flow_sid			NUMBER(10) NULL,
	regulation_flow_sid				NUMBER(10) NULL,
	permit_flow_sid					NUMBER(10) NULL,
	application_flow_sid			NUMBER(10) NULL,
	condition_flow_sid				NUMBER(10) NULL,
	rollout_delay					NUMBER(5) NOT NULL,
	rollout_option					NUMBER(10) NOT NULL,
	score_type_id					NUMBER(10),
	auto_involve_managers			NUMBER(1,0) NOT NULL,
	permit_doc_lib_sid				NUMBER(10,0),
	permit_score_type_id			NUMBER(10),
	CONSTRAINT pk_compliance_options	PRIMARY KEY (csrimp_session_id),
	CONSTRAINT fk_compliance_options_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_language (
	csrimp_session_id			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	lang_id						NUMBER(10, 0)	NOT NULL,
	added_dtm					DATE			NOT NULL,
	active						NUMBER(1)		NOT NULL,
	CONSTRAINT pk_compliance_language PRIMARY KEY (csrimp_session_id, lang_id),
	CONSTRAINT ck_compliance_language_active CHECK (active IN (0,1))
);

CREATE TABLE csrimp.compliance_item (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	compliance_item_id				NUMBER(10,0) NOT NULL,
	title							VARCHAR2(1024) NOT NULL,
	summary							CLOB,
	details							CLOB NULL, -- xhtml
	source							NUMBER(3,0) NOT NULL, -- 0 = Manual, 1 = ENHESA
	reference_code					VARCHAR2(255) NULL,
	user_comment					VARCHAR2(1024) NULL,
	citation						VARCHAR2(4000) NULL,
	external_link					VARCHAR2(1024) NULL,
	created_dtm						DATE NOT NULL,
	updated_dtm						DATE NOT NULL,
	compliance_item_status_id		NUMBER(10) NOT NULL,
	major_version					NUMBER(10,0) NOT NULL,
	minor_version					NUMBER(10,0) NOT NULL,
	lookup_key						VARCHAR2(1024),
	compliance_item_type			NUMBER(10) NOT NULL,
    CONSTRAINT pk_compliance_item	PRIMARY KEY (csrimp_session_id, compliance_item_id),
	CONSTRAINT ck_compliance_item_source CHECK (source in (0, 1)),
    CONSTRAINT fk_compliance_item_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_requirement (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	compliance_item_id				NUMBER(10,0) NOT NULL,
    CONSTRAINT pk_compliance_requirement PRIMARY KEY (csrimp_session_id, compliance_item_id),
    CONSTRAINT fk_compliance_requirement_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_regulation (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	compliance_item_id				NUMBER(10,0) NOT NULL,
	adoption_dtm					DATE NULL,
	external_id						NUMBER(10),
	is_policy						NUMBER(1) NOT NULL,
	CONSTRAINT pk_compliance_regulation PRIMARY KEY (csrimp_session_id, compliance_item_id),
	CONSTRAINT fk_compliance_regulation_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE,
	CONSTRAINT CK_IS_POLICY			CHECK(IS_POLICY IN (0, 1))
);

CREATE TABLE csrimp.compliance_item_tag (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	compliance_item_id				NUMBER(10,0) NOT NULL,
	tag_id							NUMBER(10,0) NOT NULL,
	CONSTRAINT pk_compliance_item_tag PRIMARY KEY (csrimp_session_id, compliance_item_id, tag_id),
    CONSTRAINT fk_compliance_item_tag_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_item_region (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	compliance_item_id				NUMBER(10,0) NOT NULL,
	region_sid						NUMBER(10,0) NOT NULL,
	flow_item_id					NUMBER(10,0) NULL,
	out_of_scope					NUMBER(1, 0) NOT NULL,
	CONSTRAINT pk_compliance_item_region PRIMARY KEY (csrimp_session_id, compliance_item_id, region_sid),
	CONSTRAINT fk_compliance_item_region_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE,
	CONSTRAINT CHK_COMPLIANCE_ITEM_REGION_1_0 CHECK (out_of_scope IN (0,1))
);

CREATE TABLE csrimp.flow_item_audit_log (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	flow_item_audit_log_id			NUMBER(10) NOT NULL,
	flow_item_id					NUMBER(10) NOT NULL,
	log_dtm							DATE NOT NULL,
	user_sid						NUMBER(10) NOT NULL,
	description						VARCHAR2(4000) NOT NULL,
	comment_text					CLOB,
	param_1							VARCHAR2(255),
	param_2							VARCHAR2(255),
	param_3							VARCHAR2(255),
	CONSTRAINT pk_flow_item_audit_log PRIMARY KEY (csrimp_session_id, flow_item_audit_log_id),
	CONSTRAINT fk_flow_itm_aud_log_user_is FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_item_version_log (
    csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    compliance_item_version_log_id  NUMBER(10, 0)   NOT NULL,
    compliance_item_id              NUMBER(10, 0)   NOT NULL,
    change_type                     NUMBER(10, 0),
    major_version	                NUMBER(10, 0) NOT NULL,
	minor_version					NUMBER(10, 0) NOT NULL,
	is_major_change					NUMBER(1, 0),
    description                     CLOB,
    change_dtm                      DATE            NOT NULL,
	LANG_ID							NUMBER(10, 0),
	CONSTRAINT pk_compliance_item_version_log PRIMARY KEY (csrimp_session_id, compliance_item_version_log_id),
    CONSTRAINT fk_comp_item_version_log_is FOREIGN KEY (csrimp_session_id)
        REFERENCES csrimp.csrimp_session (csrimp_session_id)
        ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_audit_log (
	csrimp_session_id				NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	compliance_audit_log_id			NUMBER(10, 0)	NOT NULL,
	compliance_item_id				NUMBER(10, 0)	NOT NULL,
	date_time						DATE			NOT NULL,
	responsible_user				NUMBER(10, 0)	NOT NULL,
	user_lang_id					NUMBER(10, 0),
	sys_lang_id						NUMBER(10, 0)	NOT NULL,
	lang_id							NUMBER(10, 0),
	title							VARCHAR2(1024)	NOT NULL, 
	summary							CLOB,
	details							CLOB,
	citation						VARCHAR2(4000),
	CONSTRAINT pk_compliance_audit_log PRIMARY KEY (csrimp_session_id, compliance_audit_log_id),
	CONSTRAINT fk_cal_is FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session(csrimp_session_id)
);

CREATE TABLE csrimp.compliance_req_reg (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	requirement_id					NUMBER(10,0) NOT NULL,
	regulation_id					NUMBER(10,0) NOT NULL,
    CONSTRAINT pk_compliance_req_reg PRIMARY KEY (csrimp_session_id, requirement_id, regulation_id),
    CONSTRAINT fk_compliance_req_reg_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_region_tag(
	CSRIMP_SESSION_ID	NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAG_ID				NUMBER(10, 0)	NOT NULL,
	REGION_SID			NUMBER(10, 0)	NOT NULL,
	CONSTRAINT pk_comp_region_tag PRIMARY KEY (csrimp_session_id, TAG_ID, REGION_SID),
	CONSTRAINT fk_comp_region_tag_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.comp_item_region_sched_issue (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	flow_item_id					NUMBER(10) NOT NULL,
	issue_scheduled_task_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_comp_item_reg_sched_issue PRIMARY KEY (csrimp_session_id, flow_item_id, issue_scheduled_task_id),
	CONSTRAINT fk_cmp_itm_rg_sched_issue_is FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_permit_history (
	CSRIMP_SESSION_ID				NUMBER(10, 0) DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	prev_permit_id					NUMBER(10,0) NOT NULL,
	next_permit_id					NUMBER(10,0) NOT NULL,
	CONSTRAINT pk_compliance_permit_history PRIMARY KEY (CSRIMP_SESSION_ID, prev_permit_id, next_permit_id),
	CONSTRAINT fk_compliance_permit_hist_is FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_PERMIT_TYPE (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PERMIT_TYPE_ID 					NUMBER(10,0) NOT NULL,
	DESCRIPTION 					VARCHAR2(1024) NOT NULL,
	POS								NUMBER(10),
	CONSTRAINT PK_COMPLIANCE_PERMIT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PERMIT_TYPE_ID),
	CONSTRAINT FK_COMPLIANCE_PERMIT_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_CONDITION_TYPE (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CONDITION_TYPE_ID 				NUMBER(10,0) NOT NULL,
	DESCRIPTION 					VARCHAR2(1024) NOT NULL,
	POS								NUMBER(10),
	CONSTRAINT PK_COMPLIANCE_CONDITION_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, CONDITION_TYPE_ID),
	CONSTRAINT FK_COMPLIANC_CONDITION_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_ACTIVITY_TYPE (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ID 				NUMBER(10,0) NOT NULL,
	DESCRIPTION 					VARCHAR2(1024) NOT NULL,
	POS								NUMBER(10),
	CONSTRAINT PK_COMPLIANCE_ACTIVITY_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ID),
	CONSTRAINT FK_COMPLIANCE_ACTIVITY_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_ACTIVITY_SUB_TYPE (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTIVITY_TYPE_ID 				NUMBER(10,0) NOT NULL,
	ACTIVITY_SUB_TYPE_ID 			NUMBER(10,0) NOT NULL,
	DESCRIPTION 					VARCHAR2(1024) NOT NULL,
	POS 							NUMBER(10),
	CONSTRAINT PK_COMPLIANCE_ACTIVITY_SB_TYP PRIMARY KEY (CSRIMP_SESSION_ID, ACTIVITY_TYPE_ID, ACTIVITY_SUB_TYPE_ID),
	CONSTRAINT FK_COMPLIA_ACTIV_SUB_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_APPLICATION_TYPE (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	APPLICATION_TYPE_ID 			NUMBER(10,0) NOT NULL,
	DESCRIPTION 					VARCHAR2(1024) NOT NULL,
	POS								NUMBER(10),
	CONSTRAINT PK_COMPLIANCE_APPLICATION_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, APPLICATION_TYPE_ID),
	CONSTRAINT FK_COMPLIANC_APPLICATI_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_item_description(
	csrimp_session_id			NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	compliance_item_id			NUMBER(10, 0)	NOT NULL,
	lang_id						NUMBER(10, 0)	NOT NULL,
	major_version				NUMBER(10)		NOT NULL,
	minor_version				NUMBER(10)		NOT NULL,
	title						VARCHAR2(2048)	NOT NULL,
	summary						CLOB,
	details						CLOB,
	citation					VARCHAR2(4000),
	CONSTRAINT pk_compliance_item_description 
		PRIMARY KEY (csrimp_session_id, compliance_item_id, lang_id),
	CONSTRAINT fk_compliance_item_description
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_item_desc_hist (
	csrimp_session_id				NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY','CSRIMP_SESSION_ID') NOT NULL,
	compliance_item_desc_hist_id	NUMBER(10, 0)	NOT NULL,
	compliance_item_id				NUMBER(10, 0)	NOT NULL,
	lang_id							NUMBER(10, 0)	NOT NULL,
	major_version					NUMBER(10, 0)	NOT NULL,
	minor_version					NUMBER(10, 0)	NOT NULL,
	title							VARCHAR2(1024)	NOT NULL,
	summary							VARCHAR2(4000),
	summary_clob					CLOB,
	details							CLOB,
	citation						VARCHAR2(4000),
	description						CLOB,
	change_dtm						DATE,
	CONSTRAINT pk_compliance_item_desc_hist PRIMARY KEY (csrimp_session_id, compliance_item_desc_hist_id),
	CONSTRAINT fk_compliance_item_desc_hist
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_PERMIT (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPLIANCE_PERMIT_ID 			NUMBER(10,0) NOT NULL,
	ACTIVITY_END_DTM 				DATE,
	ACTIVITY_START_DTM 				DATE,
	ACTIVITY_TYPE_ID 				NUMBER(10,0) NOT NULL,
	DETAILS 						CLOB,
	FLOW_ITEM_ID 					NUMBER(10,0) NOT NULL,
	PERMIT_END_DTM 					DATE,
	PERMIT_REFERENCE 				VARCHAR2(255),
	SITE_COMMISSIONING_REQUIRED 	NUMBER(1) NOT NULL,
	SITE_COMMISSIONING_DTM 			DATE NULL,
	PERMIT_START_DTM 				DATE,
	PERMIT_SUB_TYPE_ID 				NUMBER(10,0),
	PERMIT_TYPE_ID 					NUMBER(10,0) NOT NULL,
	REGION_SID 						NUMBER(10,0) NOT NULL,
	TITLE 							VARCHAR2(1024) NOT NULL,
	DATE_CREATED 					DATE NOT NULL,
	DATE_UPDATED 					DATE,
	CREATED_BY 						NUMBER(10,0),
	ACTIVITY_DETAILS				CLOB,
	CONSTRAINT PK_COMPLIANCE_PERMIT PRIMARY KEY (CSRIMP_SESSION_ID, COMPLIANCE_PERMIT_ID),
	CONSTRAINT FK_COMPLIANCE_PERMIT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_ITEM_ROLLOUT (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPLIANCE_ITEM_ROLLOUT_ID 		NUMBER NOT NULL,
	COMPLIANCE_ITEM_ID 				NUMBER(10,0) NOT NULL,
	COUNTRY 						VARCHAR2(2),
	COUNTRY_GROUP 					VARCHAR2(3),
	REGION 							VARCHAR2(2),
	REGION_GROUP 					VARCHAR2(3),
	ROLLOUT_DTM 					DATE,
	ROLLOUT_PENDING 				NUMBER(1,0) NOT NULL,
	federal_requirement_code		VARCHAR2(255),
	is_federal_req					NUMBER(10,0),
	source_region					CHAR(3) NULL,
	source_country					CHAR(3) NULL,
    suppress_rollout                NUMBER(1,0),
	CONSTRAINT PK_COMPLIANCE_ITEM_ROLLOUT PRIMARY KEY (CSRIMP_SESSION_ID, COMPLIANCE_ITEM_ROLLOUT_ID),
	CONSTRAINT FK_COMPLIANCE_ITEM_ROLLOUT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE,
	CONSTRAINT CHK_COMP_ITEM_ROL_REGION CHECK((region IS NOT NULL AND country IS NOT NULL) OR region IS NULL),
	CONSTRAINT CHK_COMP_ITEM_ROL_REGION_GRP CHECK((region_group IS NOT NULL AND country IS NOT NULL) OR region_group IS NULL)
);

CREATE UNIQUE INDEX CSRIMP.IX_COMPLIANCE_ITEM_ROLLOUT ON csrimp.compliance_item_rollout(csrimp_session_id, compliance_item_id, NVL(country, compliance_item_id), NVL(region, compliance_item_id), NVL(country_group, compliance_item_id), NVL(region_group, compliance_item_id));

CREATE TABLE CSRIMP.COMPLIANCE_PERMIT_SUB_TYPE (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PERMIT_TYPE_ID 					NUMBER(10,0) NOT NULL,
	PERMIT_SUB_TYPE_ID 				NUMBER(10,0) NOT NULL,
	DESCRIPTION 					VARCHAR2(1024) NOT NULL,
	POS								NUMBER(10),
	CONSTRAINT PK_COMPLIANCE_PERMIT_SUB_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, PERMIT_TYPE_ID, PERMIT_SUB_TYPE_ID),
	CONSTRAINT FK_COMPLIAN_PERMIT_SUB_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_CONDITION_SUB_TYPE (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CONDITION_TYPE_ID 				NUMBER(10,0) NOT NULL,
	CONDITION_SUB_TYPE_ID 			NUMBER(10,0) NOT NULL,
	DESCRIPTION 					VARCHAR2(1024) NOT NULL,
	POS								NUMBER(10),
	CONSTRAINT PK_COMPLIANCE_CONDITION_SB_TYP PRIMARY KEY (CSRIMP_SESSION_ID, CONDITION_TYPE_ID, CONDITION_SUB_TYPE_ID),
	CONSTRAINT FK_COMPLIA_CONDITI_SUB_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_PERMIT_APPLICATION (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PERMIT_APPLICATION_ID 			NUMBER(10,0) NOT NULL,
	APPLICATION_REFERENCE 			VARCHAR2(255),
	APPLICATION_TYPE_ID 			NUMBER(10,0) NOT NULL,
	DETERMINED_DTM 					DATE,
	DULY_MADE_DTM 					DATE,
	NOTES 							CLOB,
	PERMIT_ID 						NUMBER(10,0) NOT NULL,
	FLOW_ITEM_ID					NUMBER(10,0) NOT NULL,
	SUBMISSION_DTM 					DATE,
	TITLE 							VARCHAR2(1024) NOT NULL,
	COMPL_PERMIT_APP_STATUS_ID		NUMBER(1) NOT NULL,
	CONSTRAINT PK_COMPLIANCE_PERMIT_APPL PRIMARY KEY (CSRIMP_SESSION_ID, PERMIT_APPLICATION_ID),
	CONSTRAINT FK_COMPLIAN_PERMIT_APPLICAT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_PERMIT_CONDITION (
	CSRIMP_SESSION_ID 				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPLIANCE_ITEM_ID 				NUMBER(10,0) NOT NULL,
	COMPLIANCE_PERMIT_ID 			NUMBER(10,0) NOT NULL,
	CONDITION_SUB_TYPE_ID 			NUMBER(10,0),
	CONDITION_TYPE_ID 				NUMBER(10,0) NOT NULL,
	COPIED_FROM_ID					NUMBER(10) NULL,
	CONSTRAINT PK_COMPLIANCE_PERMIT_CONDITION PRIMARY KEY (CSRIMP_SESSION_ID, COMPLIANCE_ITEM_ID),
	CONSTRAINT FK_COMPLIAN_PERMIT_CONDITIO_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPL_PERMIT_APPLICATION_PAUSE (
	CSRIMP_SESSION_ID		NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	APPLICATION_PAUSE_ID	NUMBER(10, 0)	NOT NULL,
	PERMIT_APPLICATION_ID	NUMBER(10, 0)	NOT NULL,
	PAUSED_DTM				DATE			NOT NULL,
	RESUMED_DTM				DATE,
	CONSTRAINT PK_COMPL_PERMIT_APP_PAUSE PRIMARY KEY (CSRIMP_SESSION_ID, APPLICATION_PAUSE_ID),
	CONSTRAINT FK_CSRIMP_SESSION_ID FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_PERMIT_SCORE (
	CSRIMP_SESSION_ID 				NUMBER(10) 		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPLIANCE_PERMIT_SCORE_ID		NUMBER(10, 0)	NOT NULL,
	COMPLIANCE_PERMIT_ID			NUMBER(10, 0)	NOT NULL,
	SCORE_THRESHOLD_ID				NUMBER(10, 0),
	SCORE_TYPE_ID					NUMBER(10, 0)	NOT NULL,
	SCORE							NUMBER(15, 5),
	COMMENT_TEXT					CLOB,
	SET_DTM							DATE			NOT NULL,
	CHANGED_BY_USER_SID				NUMBER(10, 0),
	VALID_UNTIL_DTM					DATE,
	SCORE_SOURCE_TYPE				NUMBER(10, 0),
	SCORE_SOURCE_ID					NUMBER(10, 0),
	IS_OVERRIDE						NUMBER(1)		NOT NULL,
	CONSTRAINT PK_COMPL_PERMIT_SCORE PRIMARY KEY (CSRIMP_SESSION_ID, COMPLIANCE_PERMIT_SCORE_ID),
	CONSTRAINT FK_COMPL_PERMIT_SCORE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_permit_tab(
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    plugin_id         				NUMBER(10, 0)	NOT NULL,
    plugin_type_id    				NUMBER(10, 0)	NOT NULL,
    pos               				NUMBER(10, 0)	NOT NULL,
    tab_label         				VARCHAR2(50),
    CONSTRAINT pk_permit_tab PRIMARY KEY (csrimp_session_id, plugin_id),
    CONSTRAINT fk_permit_tab_is 
		FOREIGN KEY (csrimp_session_id) 
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_permit_tab_group (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    plugin_id         				NUMBER(10, 0)	NOT NULL,
    group_sid						NUMBER(10, 0),
    role_sid						NUMBER(10, 0),
    CONSTRAINT pk_permit_tab_group PRIMARY KEY (csrimp_session_id, plugin_id, group_sid),
    CONSTRAINT fk_permit_tab_group_is 
		FOREIGN KEY (csrimp_session_id) 
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_permit_header(
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    plugin_id         				NUMBER(10, 0)	NOT NULL,
    plugin_type_id    				NUMBER(10, 0)	NOT NULL,
    pos               				NUMBER(10, 0)	NOT NULL,
    CONSTRAINT pk_permit_header PRIMARY KEY (csrimp_session_id, plugin_id),
    CONSTRAINT fk_permit_header_is 
		FOREIGN KEY (csrimp_session_id) 
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.compliance_permit_header_group (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    plugin_id         				NUMBER(10, 0)	NOT NULL,
    group_sid						NUMBER(10, 0),
    role_sid						NUMBER(10, 0),
    CONSTRAINT pk_permit_header_group PRIMARY KEY (csrimp_session_id, plugin_id, group_sid),
    CONSTRAINT fk_permit_header_group_is 
		FOREIGN KEY (csrimp_session_id) 
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.doc_type
(
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	doc_type_id						NUMBER(10,0) NOT NULL,
	doc_library_sid					NUMBER(10,0) NOT NULL,
	name							VARCHAR2(255) NOT NULL,
	CONSTRAINT pk_doc_type			PRIMARY KEY (csrimp_session_id, doc_type_id),
	CONSTRAINT fk_doc_type_is
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE csrimp.property_mandatory_roles (
	csrimp_session_id				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	role_sid						NUMBER(10, 0)	NOT NULL,
	CONSTRAINT pk_property_mandatory_roles PRIMARY KEY (csrimp_session_id, role_sid),
    CONSTRAINT fk_property_mandatory_roles
		FOREIGN KEY (csrimp_session_id)
		REFERENCES csrimp.csrimp_session (csrimp_session_id)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORECASTING_RULE (
	CSRIMP_SESSION_ID			NUMBER(10, 0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCENARIO_SID				NUMBER(10, 0) NOT NULL,
	RULE_ID						NUMBER(10, 0) NOT NULL,
	IND_SID						NUMBER(10, 0) NOT NULL,
	REGION_SID					NUMBER(10, 0) NOT NULL,
	START_DTM					DATE NOT NULL,
	END_DTM						DATE NOT NULL,
	RULE_TYPE					VARCHAR2(10) NOT NULL,
	RULE_VAL					NUMBER(24, 10) NOT NULL,
	CONSTRAINT PK_FORECAST_RULE				PRIMARY KEY	(CSRIMP_SESSION_ID, SCENARIO_SID, RULE_ID, IND_SID, REGION_SID, START_DTM, END_DTM),
	CONSTRAINT CK_FORECAST_RULE_RULE_TYPE 	CHECK (RULE_TYPE IN ('FIXED', '*', '+'))
)
;

CREATE TABLE CSRIMP.AGGREGATE_IND_VAL_DETAIL (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	AGGREGATE_IND_GROUP_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(4000) NOT NULL,
	DTM DATE,
	IND_SID NUMBER(10,0) NOT NULL,
	LINK_URL VARCHAR2(256),
	PERIOD_END_DTM DATE NOT NULL,
	PERIOD_START_DTM DATE NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	SRC_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT FK_AGGREGATE_IND_VAL_DETAIL_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_TPL_DELEGATION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TPL_DELEGATION_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_TPL_DELEGATION PRIMARY KEY (CSRIMP_SESSION_ID, TPL_DELEGATION_SID),
	CONSTRAINT FK_CHAIN_TPL_DELEGATION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_FLOW_ALERT_CLASS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	FLOW_ALERT_CLASS VARCHAR2(256) NOT NULL,
	CONSTRAINT PK_CUSTOMER_FLOW_ALERT_CLASS PRIMARY KEY (CSRIMP_SESSION_ID, FLOW_ALERT_CLASS),
	CONSTRAINT FK_CUSTOME_FLOW_ALERT_CLASS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_GEO_MAP_TAB_TYPE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	GEO_MAP_TAB_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CUSTOMER_GEO_MAP_TAB_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, GEO_MAP_TAB_TYPE_ID),
	CONSTRAINT FK_CUSTOME_GEO_MAP_TAB_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_HELP_LANG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HELP_LANG_ID NUMBER(10,0) NOT NULL,
	IS_DEFAULT NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CUSTOMER_HELP_LANG PRIMARY KEY (CSRIMP_SESSION_ID, HELP_LANG_ID),
	CONSTRAINT FK_CUSTOMER_HELP_LANG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMG_CHART_REGION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IMG_CHART_SID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	BACKGROUND_COLOR NUMBER(10,0) NOT NULL,
	BORDER_COLOR NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(1023),
	X NUMBER(10,0) NOT NULL,
	Y NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_IMG_CHART_REGION PRIMARY KEY (CSRIMP_SESSION_ID, IMG_CHART_SID, REGION_SID),
	CONSTRAINT FK_IMG_CHART_REGION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_SET (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IND_SET_ID NUMBER(10,0) NOT NULL,
	DISPOSAL_DTM DATE,
	NAME VARCHAR2(255) NOT NULL,
	OWNER_SID NUMBER(10,0),
	CONSTRAINT PK_IND_SET PRIMARY KEY (CSRIMP_SESSION_ID, IND_SET_ID),
	CONSTRAINT FK_IND_SET_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_SET_IND (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IND_SET_ID NUMBER(10,0) NOT NULL,
	IND_SID NUMBER(10,0) NOT NULL,
	POS NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_IND_SET_IND PRIMARY KEY (CSRIMP_SESSION_ID, IND_SET_ID, IND_SID),
	CONSTRAINT FK_IND_SET_IND_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_WINDOW (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	IND_SID NUMBER(10,0) NOT NULL,
	PERIOD CHAR(1) NOT NULL,
	COMPARISON_OFFSET NUMBER(10,0) NOT NULL,
	LOWER_BRACKET NUMBER(10,4) NOT NULL,
	UPPER_BRACKET NUMBER(10,4) NOT NULL,
	CONSTRAINT PK_IND_WINDOW PRIMARY KEY (CSRIMP_SESSION_ID, IND_SID, PERIOD),
	CONSTRAINT FK_IND_WINDOW_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_ALERT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_ID NUMBER(10,0) NOT NULL,
	CSR_USER_SID NUMBER(10,0) NOT NULL,
	OVERDUE_SENT_DTM DATE,
	REMINDER_SENT_DTM DATE,
	CONSTRAINT PK_ISSUE_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_ID, CSR_USER_SID),
	CONSTRAINT FK_ISSUE_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_METER_MISSING_DATA (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_METER_MISSING_DATA_ID NUMBER(10,0) NOT NULL,
	END_DTM DATE NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	START_DTM DATE NOT NULL,
	CONSTRAINT PK_ISSUE_METER_MISSING_DATA PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_METER_MISSING_DATA_ID),
	CONSTRAINT FK_ISSUE_METER_MISSING_DATA_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ROUTE_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ROUTE_LOG_ID NUMBER(10,0) NOT NULL,
	CSR_USER_SID NUMBER(10,0) NOT NULL,
	DESCRIPTION CLOB,
	LOG_DATE DATE NOT NULL,
	PARAM_1 VARCHAR2(2048),
	PARAM_2 VARCHAR2(2048),
	PARAM_3 VARCHAR2(2048),
	ROUTE_ID NUMBER(10,0) NOT NULL,
	ROUTE_STEP_ID NUMBER(10,0) NOT NULL,
	SUMMARY VARCHAR2(1023) NOT NULL,
	CONSTRAINT PK_ROUTE_LOG PRIMARY KEY (CSRIMP_SESSION_ID, ROUTE_LOG_ID),
	CONSTRAINT FK_ROUTE_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ROUTE_STEP_VOTE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ROUTE_STEP_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	DEST_FLOW_STATE_ID NUMBER(10,0),
	DEST_ROUTE_STEP_ID NUMBER(10,0),
	IS_RETURN NUMBER(1,0) NOT NULL,
	VOTE_DIRECTION NUMBER(10,0) NOT NULL,
	VOTE_DTM DATE NOT NULL,
	CONSTRAINT PK_ROUTE_STEP_VOTE PRIMARY KEY (CSRIMP_SESSION_ID, ROUTE_STEP_ID, USER_SID),
	CONSTRAINT FK_ROUTE_STEP_VOTE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_CHANGE_REQ (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SHEET_CHANGE_REQ_ID NUMBER(10,0) NOT NULL,
	ACTIVE_SHEET_ID NUMBER(10,0) NOT NULL,
	IS_APPROVED NUMBER(1,0),
	PROCESSED_BY_SID NUMBER(10,0),
	PROCESSED_DTM DATE,
	PROCESSED_NOTE CLOB,
	RAISED_BY_SID NUMBER(10,0) NOT NULL,
	RAISED_DTM DATE NOT NULL,
	RAISED_NOTE CLOB,
	REQ_TO_CHANGE_SHEET_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_SHEET_CHANGE_REQ PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_CHANGE_REQ_ID),
	CONSTRAINT FK_SHEET_CHANGE_REQ_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_CHANGE_REQ_ALERT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SHEET_CHANGE_REQ_ALERT_ID NUMBER(10,0) NOT NULL,
	ACTION_TYPE VARCHAR2(1) NOT NULL,
	NOTIFY_USER_SID NUMBER(10,0) NOT NULL,
	RAISED_BY_USER_SID NUMBER(10,0) NOT NULL,
	SHEET_CHANGE_REQ_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_SHEET_CHANGE_REQ_ALERT PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_CHANGE_REQ_ALERT_ID),
	CONSTRAINT FK_SHEET_CHANGE_REQ_ALERT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_CHANGE_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SHEET_VALUE_CHANGE_ID NUMBER(10,0) NOT NULL,
	FILE_UPLOAD_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_SHEET_VALUE_CHANGE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, SHEET_VALUE_CHANGE_ID, FILE_UPLOAD_SID),
	CONSTRAINT FK_SHEET_VALUE_CHANGE_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SUPPLIER_DELEGATION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUPPLIER_SID NUMBER(10,0) NOT NULL,
	TPL_DELEGATION_SID NUMBER(10,0) NOT NULL,
	DELEGATION_SID NUMBER(10,0),
	CONSTRAINT PK_SUPPLIER_DELEGATION PRIMARY KEY (CSRIMP_SESSION_ID, SUPPLIER_SID, TPL_DELEGATION_SID),
	CONSTRAINT FK_SUPPLIER_DELEGATION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_MSG_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USER_MSG_FILE_ID NUMBER(10,0) NOT NULL,
	DATA BLOB NOT NULL,
	FILENAME VARCHAR2(2000) NOT NULL,
	MIME_TYPE VARCHAR2(2000) NOT NULL,
	SHA1 RAW(20) NOT NULL,
	USER_MSG_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_USER_MSG_FILE PRIMARY KEY (CSRIMP_SESSION_ID, USER_MSG_FILE_ID),
	CONSTRAINT FK_USER_MSG_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAL_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	VAL_ID NUMBER(20,0) NOT NULL,
	FILE_UPLOAD_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_VAL_FILE PRIMARY KEY (CSRIMP_SESSION_ID, VAL_ID, FILE_UPLOAD_SID),
	CONSTRAINT FK_VAL_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAL_NOTE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	VAL_NOTE_ID NUMBER(10,0) NOT NULL,
	ENTERED_BY_SID NUMBER(10,0) NOT NULL,
	ENTERED_DTM DATE,
	IND_SID NUMBER(10,0) NOT NULL,
	NOTE CLOB,
	PERIOD_END_DTM DATE,
	PERIOD_START_DTM DATE NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_VAL_NOTE PRIMARY KEY (CSRIMP_SESSION_ID, VAL_NOTE_ID),
	CONSTRAINT FK_VAL_NOTE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCENARIO_EMAIL_SUB (
	CSRIMP_SESSION_ID			NUMBER(10, 0) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCENARIO_SID				NUMBER(10, 0) NOT NULL,
	CSR_USER_SID				NUMBER(10, 0) NOT NULL,
	CONSTRAINT PK_SCENARIO_EMAIL_SUB			PRIMARY KEY (CSRIMP_SESSION_ID, SCENARIO_SID, CSR_USER_SID),
	CONSTRAINT FK_SCENARIO_EMAIL_SESSION	FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CALENDAR (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CALENDAR_SID NUMBER(10,0) NOT NULL,
	APPLIES_TO_INITIATIVES NUMBER(1,0) NOT NULL,
	APPLIES_TO_TEAMROOMS NUMBER(1,0) NOT NULL,
	DESCRIPTION VARCHAR2(255) NOT NULL,
	IS_GLOBAL NUMBER(10,0) NOT NULL,
	JS_CLASS_TYPE VARCHAR2(255) NOT NULL,
	JS_INCLUDE VARCHAR2(255) NOT NULL,
	PLUGIN_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CALENDAR PRIMARY KEY (CSRIMP_SESSION_ID, CALENDAR_SID),
	CONSTRAINT FK_CALENDAR_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CALENDAR_EVENT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CALENDAR_EVENT_ID NUMBER(10,0) NOT NULL,
	CREATED_BY_SID NUMBER(10,0) NOT NULL,
	CREATED_DTM DATE NOT NULL,
	DESCRIPTION VARCHAR2(4000),
	END_DTM DATE,
	LOCATION VARCHAR2(1000),
	REGION_SID NUMBER(10,0),
	START_DTM DATE NOT NULL,
	CONSTRAINT PK_CALENDAR_EVENT PRIMARY KEY (CSRIMP_SESSION_ID, CALENDAR_EVENT_ID),
	CONSTRAINT FK_CALENDAR_EVENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CALENDAR_EVENT_INVITE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CALENDAR_EVENT_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	ACCEPTED_DTM DATE,
	ATTENDED NUMBER(1,0),
	DECLINED_DTM DATE,
	INVITED_BY_SID NUMBER(10,0) NOT NULL,
	INVITED_DTM DATE NOT NULL,
	CONSTRAINT PK_CALENDAR_EVENT_INVITE PRIMARY KEY (CSRIMP_SESSION_ID, CALENDAR_EVENT_ID, USER_SID),
	CONSTRAINT FK_CALENDAR_EVENT_INVITE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CALENDAR_EVENT_OWNER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CALENDAR_EVENT_ID NUMBER(10,0) NOT NULL,
	USER_SID NUMBER(10,0) NOT NULL,
	ADDED_BY_SID NUMBER(10,0) NOT NULL,
	ADDED_DTM DATE NOT NULL,
	CONSTRAINT PK_CALENDAR_EVENT_OWNER PRIMARY KEY (CSRIMP_SESSION_ID, CALENDAR_EVENT_ID, USER_SID),
	CONSTRAINT FK_CALENDAR_EVENT_OWNER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CLIENT_UTIL_SCRIPT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CLIENT_UTIL_SCRIPT_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(2047),
	UTIL_SCRIPT_NAME VARCHAR2(255),
	UTIL_SCRIPT_SP VARCHAR2(255),
	WIKI_ARTICLE VARCHAR2(10),
	CONSTRAINT PK_CLIENT_UTIL_SCRIPT PRIMARY KEY (CSRIMP_SESSION_ID, CLIENT_UTIL_SCRIPT_ID),
	CONSTRAINT FK_CLIENT_UTIL_SCRIPT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CLIENT_UTIL_SCRIPT_PARAM (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CLIENT_UTIL_SCRIPT_ID NUMBER(10,0) NOT NULL,
	POS NUMBER(2,0) NOT NULL,
	PARAM_HIDDEN NUMBER(1,0),
	PARAM_HINT VARCHAR2(1023),
	PARAM_NAME VARCHAR2(1023) NOT NULL,
	PARAM_VALUE VARCHAR2(1024),
	CONSTRAINT PK_CLIENT_UTIL_SCRIPT_PARAM PRIMARY KEY (CSRIMP_SESSION_ID, CLIENT_UTIL_SCRIPT_ID, POS),
	CONSTRAINT FK_CLIENT_UTIL_SCRIPT_PARAM_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.UTIL_SCRIPT_RUN_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CLIENT_UTIL_SCRIPT_ID NUMBER(10,0),
	CSR_USER_SID NUMBER(10,0) NOT NULL,
	PARAMS VARCHAR2(2048),
	RUN_DTM DATE NOT NULL,
	UTIL_SCRIPT_ID NUMBER(10,0),
	CONSTRAINT FK_UTIL_SCRIPT_RUN_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_COM_TYPE_SCOR_CALC (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	SCORE_TYPE_ID NUMBER(10,0) NOT NULL,
	CALC_TYPE VARCHAR2(50) NOT NULL,
	OPERATOR_TYPE VARCHAR2(10),
	SUPPLIER_SCORE_TYPE_ID NUMBER(10,0),
	ACTIVE_SUPPLIERS_ONLY NUMBER(1,0),
	CONSTRAINT PK_CHAIN_COM_TYPE_SCOR_CALC PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TYPE_ID, SCORE_TYPE_ID),
	CONSTRAINT FK_CHAIN_COM_TYPE_SCOR_CALC_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CO_TY_SC_CAL_CO_TY (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	SCORE_TYPE_ID NUMBER(10,0) NOT NULL,
	SUPPLIER_COMPANY_TYPE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_CO_TY_SC_CAL_CO_TY PRIMARY KEY (CSRIMP_SESSION_ID, COMPANY_TYPE_ID, SCORE_TYPE_ID, SUPPLIER_COMPANY_TYPE_ID),
	CONSTRAINT FK_CHAIN_CO_TY_SC_CAL_CO_TY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CERTIFICATION_TYPE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CERTIFICATION_TYPE_ID       NUMBER(10) NOT NULL,
    LABEL                       VARCHAR2(1024) NOT NULL,
    LOOKUP_KEY                  VARCHAR2(30),
	PRODUCT_REQUIREMENT_TYPE_ID	NUMBER(10, 0) NOT NULL,
    CONSTRAINT PK_CERTIFICATION PRIMARY KEY (CSRIMP_SESSION_ID, CERTIFICATION_TYPE_ID),
    CONSTRAINT FK_CERTIFICATION_IS FOREIGN KEY
    (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CERT_TYPE_AUDIT_TYPE (
    CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CERTIFICATION_TYPE_ID       NUMBER(10) NOT NULL,
    INTERNAL_AUDIT_TYPE_ID      NUMBER(10) NOT NULL,
    CONSTRAINT PK_CERTIFICATION_AUDIT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, CERTIFICATION_TYPE_ID, INTERNAL_AUDIT_TYPE_ID),
    CONSTRAINT FK_CERTIFICATION_AUDIT_TYPE_IS FOREIGN KEY
        (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
        ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_ALT_COMPANY_NAME(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ALT_COMPANY_NAME_ID				NUMBER(10) NOT NULL,
	COMPANY_SID						NUMBER(10) NOT NULL,
	NAME							VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHAIN_ALT_COMPANY_NAME PRIMARY KEY (CSRIMP_SESSION_ID, ALT_COMPANY_NAME_ID),
	CONSTRAINT FK_CHAIN_ALT_COMPANY_NAME FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_SUPPL_RELATI_SCORE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUPPLIER_RELATIONSHIP_SCORE_ID	NUMBER(10, 0)	NOT NULL,
	PURCHASER_COMPANY_SID			NUMBER(10, 0)	NOT NULL,
	SUPPLIER_COMPANY_SID			NUMBER(10, 0)	NOT NULL,
	SCORE_THRESHOLD_ID				NUMBER(10, 0),
	SET_DTM							DATE			NOT NULL,
	SCORE							NUMBER(15, 5),
	SCORE_TYPE_ID					NUMBER(10, 0)	NOT NULL,
	CHANGED_BY_USER_SID 			NUMBER(10, 0),
	COMMENT_TEXT           			CLOB,
	VALID_UNTIL_DTM        			DATE,
    SCORE_SOURCE_TYPE      			NUMBER(10),
    SCORE_SOURCE_ID        			NUMBER(10),	
	IS_OVERRIDE						NUMBER(1)		NOT NULL,
	CONSTRAINT PK_CHAIN_SUPPL_RELATI_SCORE PRIMARY KEY (CSRIMP_SESSION_ID, SUPPLIER_RELATIONSHIP_SCORE_ID),
	CONSTRAINT FK_CHAIN_SUPPL_RELATI_SCORE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);


CREATE TABLE CSRIMP.CHAIN_CUST_FILTER_COLUMN (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CUSTOMER_FILTER_COLUMN_ID NUMBER(10,0) NOT NULL,
	CARD_GROUP_ID NUMBER(10,0) NOT NULL,
	COLUMN_NAME VARCHAR2(255) NOT NULL,
	FIXED_WIDTH NUMBER(1,0) NOT NULL,
	LABEL VARCHAR2(1024) NOT NULL,
	SESSION_PREFIX VARCHAR2(255),
	SORTABLE NUMBER(1,0) NOT NULL,
	WIDTH NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_CUST_FILTER_COLUMN PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_FILTER_COLUMN_ID),
	CONSTRAINT FK_CHAIN_CUST_FILTER_COLUMN_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CUSTOM_FILTER_ITEM (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CUSTOMER_FILTER_ITEM_ID NUMBER(10,0) NOT NULL,
	CAN_BREAKDOWN NUMBER(1,0) NOT NULL,
	CARD_GROUP_ID NUMBER(10,0) NOT NULL,
	ITEM_NAME VARCHAR2(255) NOT NULL,
	LABEL VARCHAR2(1024) NOT NULL,
	SESSION_PREFIX VARCHAR2(255),
	CONSTRAINT PK_CHAIN_CUSTOM_FILTER_ITEM PRIMARY KEY (CSRIMP_SESSION_ID, CUSTOMER_FILTER_ITEM_ID),
	CONSTRAINT FK_CHAIN_CUSTOM_FILTER_ITEM_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_CU_FIL_ITE_AGG_TYP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CUST_FILT_ITEM_AGG_TYPE_ID NUMBER(10,0) NOT NULL,
	ANALYTIC_FUNCTION NUMBER(10,0) NOT NULL,
	CUSTOMER_FILTER_ITEM_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHAIN_CU_FIL_ITE_AGG_TYP PRIMARY KEY (CSRIMP_SESSION_ID, CUST_FILT_ITEM_AGG_TYPE_ID),
	CONSTRAINT FK_CHAIN_CU_FIL_ITE_AGG_TYP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE csrimp.chain_supplier_inv_type (
	csrimp_session_id 				NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	flow_involvement_type_id		NUMBER(10)	NOT NULL,
	user_company_type_id			NUMBER(10)	NULL,
	page_company_type_id			NUMBER(10)	NULL,
	purchaser_type					NUMBER(2)	NOT NULL,
	restrict_to_role_sid			NUMBER(10)	NULL,
	CONSTRAINT pk_chain_supp_inv_type PRIMARY KEY (csrimp_session_id, flow_involvement_type_id),
	CONSTRAINT fk_chain_supp_inv_type_ses FOREIGN KEY (csrimp_session_id) REFERENCES csrimp.csrimp_session (csrimp_session_id) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCORE_TYPE_AUDIT_TYPE (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SCORE_TYPE_ID				NUMBER(10, 0)	NOT NULL,
	INTERNAL_AUDIT_TYPE_ID		NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_SCORE_TYPE_AUDIT_TYPE PRIMARY KEY (CSRIMP_SESSION_ID, SCORE_TYPE_ID, INTERNAL_AUDIT_TYPE_ID),
	CONSTRAINT FK_SCORE_TYPE_AUDIT_TYPE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.COMPLIANCE_ROLLOUT_REGIONS (
	CSRIMP_SESSION_ID			NUMBER(10)		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	COMPLIANCE_ITEM_ID			NUMBER(10)		NOT NULL,
	REGION_SID					NUMBER(10,0)	NOT NULL,
	CONSTRAINT PK_COMPLIANCE_ROLLOUT_REGIONS PRIMARY KEY (CSRIMP_SESSION_ID, COMPLIANCE_ITEM_ID, REGION_SID),
	CONSTRAINT FK_COMP_ROLLOUT_REGIONS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHAIN_DD_CUST_BLCKLST_EMAIL(
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	EMAIL_DOMAIN				VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHAIN_DD_CUST_BLCKLST_EML PRIMARY KEY(CSRIMP_SESSION_ID, EMAIL_DOMAIN)
);

CREATE TABLE CSRIMP.INTAPI_COMPANY_USER_GROUP(
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	GROUP_SID_ID				NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_INTAPI_COMPANY_USER_GROUP PRIMARY KEY(CSRIMP_SESSION_ID, GROUP_SID_ID)
);

CREATE TABLE CSRIMP.SECONDARY_REGION_TREE_CTRL(
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REGION_SID			NUMBER(10, 0)		NOT NULL,
	SP_NAME				VARCHAR2(30)		NOT NULL,
	REGION_ROOT_SID		NUMBER(10, 0),
	TAG_ID				NUMBER(10, 0),
	TAG_GROUP_IDS		VARCHAR2(1024),
	ACTIVE_ONLY			NUMBER(1),
	REDUCE_CONTENTION	NUMBER(1),
	APPLY_DELEG_PLANS	NUMBER(1),
	IGNORE_SIDS			CLOB,
	USER_SID			NUMBER(10, 0),
	LAST_RUN_DTM		DATE,
	CONSTRAINT PK_SECONDARY_REGION_TREE_CTRL PRIMARY KEY (CSRIMP_SESSION_ID, REGION_SID),
	CONSTRAINT CK_SRT_ACTIVE_ONLY CHECK (ACTIVE_ONLY IN (1,0)),
	CONSTRAINT CK_SRT_REDUCE_CONTENTION CHECK (REDUCE_CONTENTION IN (1,0)),
	CONSTRAINT CK_SRT_APPLY_DELEG_PLANS CHECK (APPLY_DELEG_PLANS IN (1,0))
);

CREATE TABLE CSRIMP.SECONDARY_REGION_TREE_LOG
(
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LOG_ID				NUMBER(10,0) NOT NULL,
	REGION_SID			NUMBER(10, 0) NOT NULL,
	USER_SID			NUMBER(10, 0) NOT NULL,
	LOG_DTM				DATE NOT NULL,
	PRESYNC_TREE		BLOB,
	POSTSYNC_TREE		BLOB,
	CONSTRAINT PK_SCNDRY_REGION_TREE_LOG PRIMARY KEY (CSRIMP_SESSION_ID, LOG_ID, REGION_SID)
);

CREATE TABLE CSRIMP.ISSUE_TEMPLATE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_TEMPLATE_ID NUMBER(10,0) NOT NULL,
	ASSIGN_TO_USER_SID NUMBER(10,0),
	DESCRIPTION CLOB,
	DUE_DTM DATE,
	DUE_DTM_RELATIVE NUMBER(10,0),
	DUE_DTM_RELATIVE_UNIT VARCHAR2(1),
	ISSUE_TYPE_ID NUMBER(10,0) NOT NULL,
	IS_CRITICAL NUMBER(1,0),
	IS_URGENT NUMBER(1,0),
	LABEL VARCHAR2(2048) NOT NULL,
	CONSTRAINT PK_ISSUE_TEMPLATE PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_TEMPLATE_ID),
	CONSTRAINT FK_ISSUE_TEMPLATE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_TEMPLATE_CUSTOM_FIELD (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_TEMPLATE_ID NUMBER(10,0) NOT NULL,
	ISSUE_CUSTOM_FIELD_ID NUMBER(10,0) NOT NULL,
	DATE_VALUE DATE,
	STRING_VALUE VARCHAR2(255),
	CONSTRAINT PK_ISSUE_TEMPLATE_CUSTOM_FIELD PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_TEMPLATE_ID, ISSUE_CUSTOM_FIELD_ID),
	CONSTRAINT FK_ISSUE_TEMPL_CUSTOM_FIELD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_TEMPLATE_CUST_FIELD_OPT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ISSUE_TEMPLATE_ID NUMBER(10,0) NOT NULL,
	ISSUE_CUSTOM_FIELD_ID NUMBER(10,0) NOT NULL,
	ISSUE_CUSTOM_FIELD_OPT_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_ISSUE_TEMPLATE_CUST_FLD_OPT PRIMARY KEY (CSRIMP_SESSION_ID, ISSUE_TEMPLATE_ID, ISSUE_CUSTOM_FIELD_ID, ISSUE_CUSTOM_FIELD_OPT_ID),
	CONSTRAINT FK_ISSU_TEMP_CUST_FIELD_OPT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAB_DESCRIPTION(
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TAB_ID				NUMBER(10, 0)	NOT NULL,
	LANG				VARCHAR2(10)	NOT NULL,
	DESCRIPTION			VARCHAR2(1023)	NOT NULL,
	LAST_CHANGED_DTM	DATE,
	CONSTRAINT PK_TAB_DESCRIPTION PRIMARY KEY (CSRIMP_SESSION_ID, TAB_ID, LANG),
	CONSTRAINT FK_TAB_DESCRIPTION FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SCRAGPP_AUDIT_LOG(
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	ACTION					VARCHAR2(1023)	NOT NULL,
	ACTION_DTM				DATE,
	USER_SID				NUMBER(10, 0) NOT NULL,
	CONSTRAINT PK_SCRAGPP_AUDIT_LOG PRIMARY KEY (CSRIMP_SESSION_ID, ACTION, ACTION_DTM),
	CONSTRAINT FK_SCRAGPP_AUDIT_LOG FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.SCRAGPP_STATUS(
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SCRAG					NUMBER(1)	DEFAULT 1 NOT NULL,
	TESTCUBE_ENABLED			NUMBER(1)	DEFAULT 0 NOT NULL,
	VALIDATION_APPROVED_REF		VARCHAR2(1023),
	SCRAGPP_ENABLED				NUMBER(1)	DEFAULT 0 NOT NULL,
	CONSTRAINT PK_SCRAGPP_STATUS PRIMARY KEY (CSRIMP_SESSION_ID),
	CONSTRAINT FK_SCRAG_STATUS FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE,
	CONSTRAINT CHK_SCRAGPP_STATUS_OLD_SCRAG CHECK (OLD_SCRAG IN (0,1)),
	CONSTRAINT CHK_SCRAGPP_STATUS_TESTCUBE CHECK (TESTCUBE_ENABLED IN (0,1)),
	CONSTRAINT CHK_SCRAGPP_STATUS_SCRAGPP CHECK (SCRAGPP_ENABLED IN (0,1))
)
;

CREATE TABLE CSRIMP.OSHA_CONFIG(
	CSRIMP_SESSION_ID		NUMBER(10,0)	DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CMS_TAB_SID				NUMBER(10,0),
	DATE_CMS_COL_SID		NUMBER(10,0),
	REGION_CMS_COL_SID		NUMBER(10,0),
	CONSTRAINT PK_OSHA_CONFIG PRIMARY KEY (CSRIMP_SESSION_ID),
	CONSTRAINT FK_OSHA_CONFIG FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.OSHA_MAPPING(
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OSHA_MAP_FIELD_ID		NUMBER(10,0)	NOT NULL,
	IND_SID					NUMBER(10,0),
	CMS_COL_SID				NUMBER(10,0),
	REGION_DATA_MAP_ID		NUMBER(10,0),
	CONSTRAINT PK_OSHA_MAPPING PRIMARY KEY (CSRIMP_SESSION_ID, OSHA_MAP_FIELD_ID),
	CONSTRAINT FK_OSHA_MAPPING FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.SYS_TRANSLATIONS_AUDIT_LOG(
	CSRIMP_SESSION_ID				NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SYS_TRANSLATIONS_AUDIT_LOG_ID	NUMBER(10)			NOT NULL,
	AUDIT_DATE						DATE 				NOT NULL,
	APP_SID							NUMBER(10,0)		NOT NULL,
	TRANSLATED_ID					NUMBER(10,0)		NOT NULL,
	USER_SID						NUMBER(10,0)		NOT NULL,
	DESCRIPTION						VARCHAR2(4000)		NOT NULL,
	CONSTRAINT PK_SYS_TRANS_AUDIT_LOG PRIMARY KEY (CSRIMP_SESSION_ID, SYS_TRANSLATIONS_AUDIT_LOG_ID),
	CONSTRAINT FK_SYS_TRANS_AUDIT_LOG FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.SYS_TRANSLATIONS_AUDIT_DATA(
	CSRIMP_SESSION_ID				NUMBER(10)			DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SYS_TRANSLATIONS_AUDIT_LOG_ID	NUMBER(10)			NOT NULL,
	AUDIT_DATE						DATE				NOT NULL,
	APP_SID							NUMBER(10,0)		NOT NULL,
	IS_DELETE						NUMBER(1,0)			NOT NULL,
	ORIGINAL						VARCHAR2(4000),
	TRANSLATION						VARCHAR2(4000),
	OLD_TRANSLATION					VARCHAR2(4000),
	CONSTRAINT PK_SYS_TRANS_AUDIT_DATA PRIMARY KEY (CSRIMP_SESSION_ID, SYS_TRANSLATIONS_AUDIT_LOG_ID),
	CONSTRAINT FK_SYS_TRANS_AUDIT_DATA FOREIGN KEY
		(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
		ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.CAMPAIGN(
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CAMPAIGN_SID              	NUMBER(10, 0)	NOT NULL,
    NAME                        VARCHAR2(255),
    TABLE_SID                   NUMBER(10, 0),
    FILTER_SID                  NUMBER(10, 0),
    SURVEY_SID                  NUMBER(10, 0),
    FRAME_ID                    NUMBER(10, 0),
    SUBJECT                     CLOB,
    BODY                        CLOB,
    SEND_AFTER_DTM              DATE,
    STATUS                      VARCHAR2(20)	NOT NULL,
    SENT_DTM                    DATE,
    PERIOD_START_DTM            DATE,
    PERIOD_END_DTM              DATE,
    AUDIENCE_TYPE               CHAR(2)			NOT NULL,
    FLOW_SID                    NUMBER(10, 0),  
    INC_REGIONS_WITH_NO_USERS   NUMBER(1, 0)	NOT NULL,
    SKIP_OVERLAPPING_REGIONS    NUMBER(1, 0)	NOT NULL,
	CARRY_FORWARD_ANSWERS		NUMBER(1)		NOT NULL,
	SEND_TO_COLUMN_SID			NUMBER(10),
	REGION_COLUMN_SID			NUMBER(10),
	CREATED_BY_SID				NUMBER(10),
	FILTER_XML					CLOB,
	RESPONSE_COLUMN_SID			NUMBER(10),
	TAG_LOOKUP_KEY_COLUMN_SID	NUMBER(10),
	IS_SYSTEM_GENERATED			NUMBER(10)		NOT NULL,
	CUSTOMER_ALERT_TYPE_ID		NUMBER(10),
	CAMPAIGN_END_DTM 			DATE,
	SEND_ALERT 					NUMBER(1)		NOT NULL,
	DYNAMIC 					NUMBER(1)		NOT NULL,
	RESEND 						NUMBER(1)		NOT NULL,
    CONSTRAINT CHK_CAMPAIGN_STATUS CHECK (STATUS IN ('draft', 'pending', 'sending', 'sent', 'error', 'emailing')),
    CONSTRAINT CHK_PERIOD_DATES CHECK ((period_start_dtm IS NULL AND period_end_dtm IS NULL) OR period_start_dtm < period_end_dtm),
    CONSTRAINT CHK_CAMPAIGN_AUD_TYPE CHECK (AUDIENCE_TYPE IN ('LF', 'WF')),
    CONSTRAINT CHK_AUDIENCE_REFERENCES CHECK ((AUDIENCE_TYPE='LF' AND FLOW_SID IS NULL) OR
	(AUDIENCE_TYPE='WF' AND TABLE_SID IS NULL AND FILTER_SID IS NULL)),
    CONSTRAINT CHK_CAMP_REG_NO_USR_0_1 CHECK (INC_REGIONS_WITH_NO_USERS IN (0, 1)),
	CONSTRAINT CHK_CARRY_FORWARD_ANSWERS CHECK (CARRY_FORWARD_ANSWERS IN (0,1)),
	CONSTRAINT CHK_SURVEY_SID_NOT_DRAFT CHECK ((LOWER(status) != 'draft' AND survey_sid IS NOT NULL) OR
	(LOWER(status) = 'draft' AND survey_sid IS NOT NULL) OR (LOWER(status) = 'draft' AND survey_sid IS NULL)),
    CONSTRAINT PK_CAMPAIGN PRIMARY KEY (CSRIMP_SESSION_ID, CAMPAIGN_SID),
    CONSTRAINT FK_CAMPAIGN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CAMPAIGN_REGION(
	CSRIMP_SESSION_ID			NUMBER(10) 		DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAMPAIGN_SID				NUMBER(10, 0)	NOT NULL,
	REGION_SID					NUMBER(10, 0)	NOT NULL,
	HAS_MANUAL_AMENDS			NUMBER(1, 0)	DEFAULT 0 NOT NULL,
	PENDING_DELETION			NUMBER(1, 0)	DEFAULT 0 NOT NULL,
	REGION_SELECTION			VARCHAR2(2)	  	DEFAULT 'R' NOT NULL,
	TAG_ID						NUMBER(10, 0),
	CONSTRAINT CHK_CAMPAIGN_REG_PENDING_DEL CHECK (PENDING_DELETION IN (0,1,2)),
	CONSTRAINT CHK_CAMPAIGN_REGION_AMENDS CHECK (HAS_MANUAL_AMENDS IN (0,1)),
	CONSTRAINT CHK_CAMPAIGN_REGION_RS CHECK (REGION_SELECTION IN ('R','L','P','RT','LT','PT')),
	CONSTRAINT PK_CAMPAIGN_REGION PRIMARY KEY (CSRIMP_SESSION_ID, CAMPAIGN_SID, REGION_SID),
	CONSTRAINT FK_CAMPAIGN_REGION FOREIGN KEY
	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
	ON DELETE CASCADE
)
;

CREATE TABLE CSRIMP.CAMPAIGN_REGION_RESPONSE (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAMPAIGN_SID		NUMBER(10)	NOT NULL,
	REGION_SID			NUMBER(10)	NOT NULL,
	RESPONSE_ID			NUMBER(10)	NOT NULL,
	SURVEYS_VERSION		NUMBER(1)	NOT NULL,
	FLOW_ITEM_ID		NUMBER(10),
	CONSTRAINTS PK_CAMPAIGN_REGION_RESPONSE PRIMARY KEY (CSRIMP_SESSION_ID, CAMPAIGN_SID, REGION_SID, RESPONSE_ID),
    CONSTRAINT FK_CMPGN_REGION_RESPONSE_CSI FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTERNAL_AUDIT_LISTENER_LAST_UPDATE (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	TENANT_ID			VARCHAR2(255) NOT NULL,
	EXTERNAL_PARENT_REF VARCHAR2(255) NOT NULL,
	EXTERNAL_REF 		VARCHAR2(255) NOT NULL,
	LAST_UPDATE 		TIMESTAMP NOT NULL,
	CORRELATION_ID		VARCHAR2(64),
	CONSTRAINT PK_INTERNAL_AUDIT_LISTENER_LAST_UPDATE PRIMARY KEY (CSRIMP_SESSION_ID, TENANT_ID, EXTERNAL_PARENT_REF, EXTERNAL_REF)
);


CREATE TABLE CSRIMP.CREDENTIAL_MANAGEMENT (
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CREDENTIAL_ID		NUMBER(10, 0)		NOT NULL,
	LABEL				VARCHAR2(255)		NOT NULL,
	AUTH_TYPE_ID		NUMBER(10, 0)		NOT NULL,
	AUTH_SCOPE_ID		NUMBER(10, 0),
	CREATED_DTM			DATE				NOT NULL,
	UPDATED_DTM			DATE				NOT NULL,
	LOGIN_HINT			VARCHAR2(500),
	CONSTRAINT PK_CREDENTIAL_MANAGEMENT PRIMARY KEY (CSRIMP_SESSION_ID, CREDENTIAL_ID),
	CONSTRAINT UK_CREDENTIAL_MANAGEMENT_LABEL UNIQUE (CSRIMP_SESSION_ID, LABEL),
	CONSTRAINT FK_CREDENTIAL_MANAGEMENT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.INTEGRATION_QUESTION_ANSWER(
	CSRIMP_SESSION_ID	NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	PARENT_REF			VARCHAR2(255)	NOT NULL,
	QUESTION_REF		VARCHAR2(255)	NOT NULL,
	QUESTIONNAIRE_NAME	VARCHAR2(255),
	INTERNAL_AUDIT_SID	NUMBER(10, 0),
	SECTION_NAME		VARCHAR2(1024),
	SECTION_CODE		VARCHAR2(1024),
	SECTION_SCORE		NUMBER(10, 5),
	SUBSECTION_NAME		VARCHAR2(1024),
	SUBSECTION_CODE		VARCHAR2(1024),
	QUESTION_TEXT		VARCHAR2(4000),
	RATING				VARCHAR2(1024),
	CONCLUSION			CLOB,
	ANSWER				CLOB,
	DATA_POINTS			CLOB,
	LAST_UPDATED		DATE,
	ID					NUMBER(10, 0)	NOT NULL,
	CONSTRAINT PK_INTEGRATION_QUESTION_ANSWER PRIMARY KEY (CSRIMP_SESSION_ID, PARENT_REF, QUESTION_REF),
	CONSTRAINT UK_INTEGRATION_QUESTION_ANSWER_ID UNIQUE (CSRIMP_SESSION_ID, ID),
	CONSTRAINT FK_INTEGRATION_QUESTION_ANSWER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_CERTIFICATE (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REGION_CERTIFICATE_ID		NUMBER(24,0) NOT NULL,
	REGION_SID					NUMBER(10,0) NOT NULL,
	CERTIFICATION_ID			NUMBER(10,0) NOT NULL,
	CERTIFICATION_LEVEL_ID		NUMBER(10,0),
	CERTIFICATE_NUMBER			NUMBER(10,0),
	FLOOR_AREA					NUMBER(10,2) NOT NULL,
	ISSUED_DTM					DATE,
	EXPIRY_DTM					DATE,
	EXTERNAL_CERTIFICATE_ID		NUMBER(10,0),
	NOTE						VARCHAR2(2048) NULL,
	SUBMIT_TO_GRESB				NUMBER(1) DEFAULT 0 NOT NULL,
	DELETED						NUMBER(1, 0) NOT NULL,
	CONSTRAINT PK_REGION_CERTS PRIMARY KEY (CSRIMP_SESSION_ID, REGION_CERTIFICATE_ID),
	CONSTRAINT CK_REGION_CERT_DELETED CHECK (DELETED in (0,1)),
	CONSTRAINT FK_REGION_CERTIFICATE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_ENERGY_RATING (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	REGION_ENERGY_RATING_ID		NUMBER(10,0) NOT NULL,
	REGION_SID					NUMBER(10,0) NOT NULL,
	ENERGY_RATING_ID			NUMBER(10,0) NOT NULL,
	FLOOR_AREA					NUMBER(10,2) NOT NULL,
	ISSUED_DTM					DATE,
	EXPIRY_DTM					DATE,
	NOTE						VARCHAR2(2048),
	SUBMIT_TO_GRESB				NUMBER(1) NOT NULL,
	CONSTRAINT PK_REGION_ENERGY_RAT PRIMARY KEY (CSRIMP_SESSION_ID, REGION_ENERGY_RATING_ID),
	CONSTRAINT CHK_REGION_ENERGY_RAT_EXP_AFTER_ISS CHECK ((ISSUED_DTM IS NULL OR EXPIRY_DTM IS NULL) OR (ISSUED_DTM IS NOT NULL AND EXPIRY_DTM IS NOT NULL AND ISSUED_DTM < EXPIRY_DTM)),
	CONSTRAINT FK_REGION_ENERGY_RATING_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MODULE_HISTORY (
	CSRIMP_SESSION_ID			NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MODULE_ID					NUMBER(10, 0)	NOT NULL,
	ENABLED_DTM					DATE,
	LAST_ENABLED_DTM			DATE,
	DISABLED_DTM				DATE,
	CONSTRAINT PK_MODULE_HSTORY_MODULE_ID PRIMARY KEY (CSRIMP_SESSION_ID, MODULE_ID),
	CONSTRAINT FK_MODULE_HISTORY_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.BASELINE_CONFIG (
	CSRIMP_SESSION_ID			NUMBER(10)  DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BASELINE_CONFIG_ID			NUMBER(10, 0)  NOT NULL,
	BASELINE_NAME				VARCHAR2(200)  NOT NULL,
	BASELINE_LOOKUP_KEY			VARCHAR2(200)  NOT NULL,
	CONSTRAINT pk_baseline_config PRIMARY KEY (CSRIMP_SESSION_ID, BASELINE_CONFIG_ID),
	CONSTRAINT FK_BASELINE_CONFIG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.BASELINE_CONFIG_PERIOD (
	CSRIMP_SESSION_ID					NUMBER(10)   DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	BASELINE_CONFIG_PERIOD_ID			NUMBER(10, 0)   NOT NULL,
	BASELINE_CONFIG_ID					NUMBER(10, 0)   NOT NULL,
	BASELINE_PERIOD_DTM					DATE NOT NULL,
	BASELINE_COVER_PERIOD_START_DTM		DATE,
	BASELINE_COVER_PERIOD_END_DTM		DATE,
	CONSTRAINT pk_baseline_config_period PRIMARY KEY (CSRIMP_SESSION_ID, BASELINE_CONFIG_PERIOD_ID),
	CONSTRAINT FK_BASELINE_CONFIG_PERIOD_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

-- please make sure this file ends with a new line (the same goes for all source code -- this avoids merge issues)
