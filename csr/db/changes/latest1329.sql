-- Please update version.sql too -- this keeps clean builds in sync
define version=1329
@update_header

BEGIN
	FOR r IN (SELECT 1 FROM ALL_TABLES WHERE OWNER='CSRIMP' AND TABLE_NAME='CSRIMP_SESSION') LOOP
		EXECUTE IMMEDIATE 'DROP TABLE CSRIMP.CSRIMP_SESSION CASCADE CONSTRAINTS';
	END LOOP;
	FOR r IN (SELECT 1 FROM ALL_TABLES WHERE OWNER='CSRIMP' AND TABLE_NAME='CMS_TIDY_DDL') LOOP
		EXECUTE IMMEDIATE 'DROP TABLE CSRIMP.CMS_TIDY_DDL CASCADE CONSTRAINTS';
	END LOOP;
END;
/
DROP TABLE CSRIMP.ACCOUNT_POLICY;
DROP TABLE CSRIMP.ACCURACY_TYPE;
DROP TABLE CSRIMP.ACCURACY_TYPE_OPTION;
DROP TABLE CSRIMP.ACC_POLICY_PWD_REGEXP;
DROP TABLE CSRIMP.ACL;
DROP TABLE CSRIMP.ALERT_FRAME;
DROP TABLE CSRIMP.ALERT_FRAME_BODY;
DROP TABLE CSRIMP.ALERT_TEMPLATE;
DROP TABLE CSRIMP.ALERT_TEMPLATE_BODY;
DROP TABLE CSRIMP.ALL_METER;
DROP TABLE CSRIMP.APPLICATION;
DROP TABLE CSRIMP.APPROVAL_STEP;
DROP TABLE CSRIMP.APPROVAL_STEP_IND;
DROP TABLE CSRIMP.APPROVAL_STEP_REGION;
DROP TABLE CSRIMP.APPROVAL_STEP_ROLE;
DROP TABLE CSRIMP.APPROVAL_STEP_SHEET;
DROP TABLE CSRIMP.APPROVAL_STEP_SHEET_LOG;
DROP TABLE CSRIMP.APPROVAL_STEP_USER;
DROP TABLE CSRIMP.ATTACHMENT;
DROP TABLE CSRIMP.ATTACHMENT_HISTORY;
DROP TABLE CSRIMP.ATTRIBUTES;
DROP TABLE CSRIMP.CALC_DEPENDENCY;
DROP TABLE CSRIMP.CMS_APP_SCHEMA;
DROP TABLE CSRIMP.CMS_APP_SCHEMA_TABLE;
DROP TABLE CSRIMP.CMS_CK_CONS;
DROP TABLE CSRIMP.CMS_CK_CONS_COL;
DROP TABLE CSRIMP.CMS_DISPLAY_TEMPLATE;
DROP TABLE CSRIMP.CMS_FILTER;
DROP TABLE CSRIMP.CMS_FK_CONS;
DROP TABLE CSRIMP.CMS_FK_CONS_COL;
DROP TABLE CSRIMP.CMS_FLOW_TAB_COLUMN_CONS;
DROP TABLE CSRIMP.CMS_FORM;
DROP TABLE CSRIMP.CMS_IMAGE;
DROP TABLE CSRIMP.CMS_IMAGE_TAG;
DROP TABLE CSRIMP.CMS_LINK_TRACK;
DROP TABLE CSRIMP.CMS_TAB;
DROP TABLE CSRIMP.CMS_TAB_COLUMN;
DROP TABLE CSRIMP.CMS_TAB_COLUMN_MEASURE;
DROP TABLE CSRIMP.CMS_TAB_COLUMN_ROLE_PERMISSION;
DROP TABLE CSRIMP.CMS_TAG;
DROP TABLE CSRIMP.CMS_UK_CONS;
DROP TABLE CSRIMP.CMS_UK_CONS_COL;
DROP TABLE CSRIMP.CMS_WEB_PUBLICATION;
DROP TABLE CSRIMP.CORRESPONDENT;
DROP TABLE CSRIMP.CSR_USER;
DROP TABLE CSRIMP.CUSTOMER;
DROP TABLE CSRIMP.CUSTOMER_ALERT_TYPE;
DROP TABLE CSRIMP.CUSTOMER_REGION_TYPE;
DROP TABLE CSRIMP.DATAVIEW;
DROP TABLE CSRIMP.DATAVIEW_IND_DESCRIPTION;
DROP TABLE CSRIMP.DATAVIEW_IND_MEMBER;
DROP TABLE CSRIMP.DATAVIEW_REGION_DESCRIPTION;
DROP TABLE CSRIMP.DATAVIEW_REGION_MEMBER;
DROP TABLE CSRIMP.DELEGATION;
DROP TABLE CSRIMP.DELEGATION_GRID;
DROP TABLE CSRIMP.DELEGATION_GRID_AGGREGATE_IND;
DROP TABLE CSRIMP.DELEGATION_IND;
DROP TABLE CSRIMP.DELEGATION_IND_COND;
DROP TABLE CSRIMP.DELEGATION_IND_COND_ACTION;
DROP TABLE CSRIMP.DELEGATION_IND_DESCRIPTION;
DROP TABLE CSRIMP.DELEGATION_IND_TAG;
DROP TABLE CSRIMP.DELEGATION_IND_TAG_LIST;
DROP TABLE CSRIMP.DELEGATION_REGION;
DROP TABLE CSRIMP.DELEGATION_REGION_DESCRIPTION;
DROP TABLE CSRIMP.DELEGATION_ROLE;
DROP TABLE CSRIMP.DELEGATION_USER;
DROP TABLE CSRIMP.DELEG_IND_FORM_EXPR;
DROP TABLE CSRIMP.DELEG_IND_GROUP;
DROP TABLE CSRIMP.DELEG_IND_GROUP_MEMBER;
DROP TABLE CSRIMP.DELEG_PLAN;
DROP TABLE CSRIMP.DELEG_PLAN_APPLIED;
DROP TABLE CSRIMP.DELEG_PLAN_COL;
DROP TABLE CSRIMP.DELEG_PLAN_COL_DELEG;
DROP TABLE CSRIMP.DELEG_PLAN_COL_SURVEY;
DROP TABLE CSRIMP.DELEG_PLAN_DELEG_REGION;
DROP TABLE CSRIMP.DELEG_PLAN_DELEG_REGION_DELEG;
DROP TABLE CSRIMP.DELEG_PLAN_REGION;
DROP TABLE CSRIMP.DELEG_PLAN_ROLE;
DROP TABLE CSRIMP.EVENT;
DROP TABLE CSRIMP.FACTOR;
DROP TABLE CSRIMP.FILE_UPLOAD;
DROP TABLE CSRIMP.FLOW;
DROP TABLE CSRIMP.FLOW_ALERT_TYPE;
DROP TABLE CSRIMP.FLOW_ITEM;
DROP TABLE CSRIMP.FLOW_ITEM_ALERT;
DROP TABLE CSRIMP.FLOW_STATE;
DROP TABLE CSRIMP.FLOW_STATE_LOG;
DROP TABLE CSRIMP.FLOW_STATE_LOG_FILE;
DROP TABLE CSRIMP.FLOW_STATE_ROLE;
DROP TABLE CSRIMP.FLOW_STATE_TRANSITION;
DROP TABLE CSRIMP.FLOW_STATE_TRANSITION_ROLE;
DROP TABLE CSRIMP.FLOW_STATE_TRANS_HELPER;
DROP TABLE CSRIMP.FLOW_TRANSITION_ALERT;
DROP TABLE CSRIMP.FLOW_TRANSITION_ALERT_ROLE;
DROP TABLE CSRIMP.FORM;
DROP TABLE CSRIMP.FORM_ALLOCATION;
DROP TABLE CSRIMP.FORM_ALLOCATION_ITEM;
DROP TABLE CSRIMP.FORM_ALLOCATION_USER;
DROP TABLE CSRIMP.FORM_COMMENT;
DROP TABLE CSRIMP.FORM_EXPR;
DROP TABLE CSRIMP.FORM_IND_MEMBER;
DROP TABLE CSRIMP.FORM_REGION_MEMBER;
DROP TABLE CSRIMP.GROUP_MEMBERS;
DROP TABLE CSRIMP.GROUP_TABLE;
DROP TABLE CSRIMP.HOME_PAGE;
DROP TABLE CSRIMP.IMG_CHART;
DROP TABLE CSRIMP.IMG_CHART_IND;
DROP TABLE CSRIMP.IMP_CONFLICT;
DROP TABLE CSRIMP.IMP_CONFLICT_VAL;
DROP TABLE CSRIMP.IMP_IND;
DROP TABLE CSRIMP.IMP_MEASURE;
DROP TABLE CSRIMP.IMP_REGION;
DROP TABLE CSRIMP.IMP_SESSION;
DROP TABLE CSRIMP.IMP_VAL;
DROP TABLE CSRIMP.IND;
DROP TABLE CSRIMP.IND_ACCURACY_TYPE;
DROP TABLE CSRIMP.IND_DESCRIPTION;
DROP TABLE CSRIMP.IND_FLAG;
DROP TABLE CSRIMP.IND_START_POINT;
DROP TABLE CSRIMP.IND_TAG;
DROP TABLE CSRIMP.IND_VALIDATION_RULE;
DROP TABLE CSRIMP.IP_RULE;
DROP TABLE CSRIMP.IP_RULE_ENTRY;
DROP TABLE CSRIMP.ISSUE;
DROP TABLE CSRIMP.ISSUE_ACTION;
DROP TABLE CSRIMP.ISSUE_ACTION_LOG;
DROP TABLE CSRIMP.ISSUE_CUSTOM_FIELD;
DROP TABLE CSRIMP.ISSUE_CUSTOM_FIELD_OPTION;
DROP TABLE CSRIMP.ISSUE_CUSTOM_FIELD_OPT_SEL;
DROP TABLE CSRIMP.ISSUE_CUSTOM_FIELD_STR_VAL;
DROP TABLE CSRIMP.ISSUE_LOG;
DROP TABLE CSRIMP.ISSUE_LOG_FILE;
DROP TABLE CSRIMP.ISSUE_LOG_READ;
DROP TABLE CSRIMP.ISSUE_METER;
DROP TABLE CSRIMP.ISSUE_METER_ALARM;
DROP TABLE CSRIMP.ISSUE_METER_DATA_SOURCE;
DROP TABLE CSRIMP.ISSUE_METER_RAW_DATA;
DROP TABLE CSRIMP.ISSUE_NON_COMPLIANCE;
DROP TABLE CSRIMP.ISSUE_PENDING_VAL;
DROP TABLE CSRIMP.ISSUE_PRIORITY;
DROP TABLE CSRIMP.ISSUE_SCHEDULED_TASK;
DROP TABLE CSRIMP.ISSUE_SHEET_VALUE;
DROP TABLE CSRIMP.ISSUE_SUPPLIER;
DROP TABLE CSRIMP.ISSUE_SURVEY_ANSWER;
DROP TABLE CSRIMP.ISSUE_TYPE;
DROP TABLE CSRIMP.ISSUE_USER;
DROP TABLE CSRIMP.KNOWN_SO;
DROP TABLE CSRIMP.LIVE_DATA_DURATION;
DROP TABLE CSRIMP.MAIL_ACCOUNT;
DROP TABLE CSRIMP.MAIL_MAILBOX;
DROP TABLE CSRIMP.MAIL_MESSAGE;
DROP TABLE CSRIMP.MAIL_MESSAGE_ADDRESS_FIELD;
DROP TABLE CSRIMP.MAIL_MESSAGE_HEADER;
DROP TABLE CSRIMP.MAP_ACCURACY_TYPE;
DROP TABLE CSRIMP.MAP_ACCURACY_TYPE_OPTION;
DROP TABLE CSRIMP.MAP_ACL;
DROP TABLE CSRIMP.MAP_ALERT_FRAME;
DROP TABLE CSRIMP.MAP_APPROVAL_STEP_SHEET;
DROP TABLE CSRIMP.MAP_ATTACHMENT;
DROP TABLE CSRIMP.MAP_CMS_CK_CONS;
DROP TABLE CSRIMP.MAP_CMS_DISPLAY_TEMPLATE;
DROP TABLE CSRIMP.MAP_CMS_FK_CONS;
DROP TABLE CSRIMP.MAP_CMS_IMAGE;
DROP TABLE CSRIMP.MAP_CMS_SCHEMA;
DROP TABLE CSRIMP.MAP_CMS_TAB_COLUMN;
DROP TABLE CSRIMP.MAP_CMS_TAG;
DROP TABLE CSRIMP.MAP_CMS_UK_CONS;
DROP TABLE CSRIMP.MAP_CORRESPONDENT;
DROP TABLE CSRIMP.MAP_CUSTOMER_ALERT_TYPE;
DROP TABLE CSRIMP.MAP_DELEGATION_IND_COND;
DROP TABLE CSRIMP.MAP_DELEG_IND_GROUP;
DROP TABLE CSRIMP.MAP_DELEG_PLAN_COL;
DROP TABLE CSRIMP.MAP_DELEG_PLAN_COL_DELEG;
DROP TABLE CSRIMP.MAP_EVENT;
DROP TABLE CSRIMP.MAP_FACTOR;
BEGIN
	FOR r IN (SELECT 1 FROM ALL_TABLES WHERE OWNER='CSRIMP' AND TABLE_NAME='MAP_FILE_UPLOAD') LOOP
		EXECUTE IMMEDIATE 'DROP TABLE CSRIMP.MAP_FILE_UPLOAD';
	END LOOP;
END;
/
DROP TABLE CSRIMP.MAP_FLOW_ITEM;
DROP TABLE CSRIMP.MAP_FLOW_STATE;
DROP TABLE CSRIMP.MAP_FLOW_STATE_LOG;
DROP TABLE CSRIMP.MAP_FLOW_STATE_TRANSITION;
DROP TABLE CSRIMP.MAP_FORM_ALLOCATION;
DROP TABLE CSRIMP.MAP_FORM_EXPR;
DROP TABLE CSRIMP.MAP_IMP_CONFLICT;
DROP TABLE CSRIMP.MAP_IMP_IND;
DROP TABLE CSRIMP.MAP_IMP_MEASURE;
DROP TABLE CSRIMP.MAP_IMP_REGION;
DROP TABLE CSRIMP.MAP_IMP_VAL;
DROP TABLE CSRIMP.MAP_IND_VALIDATION_RULE;
DROP TABLE CSRIMP.MAP_IP_RULE;
DROP TABLE CSRIMP.MAP_ISSUE;
DROP TABLE CSRIMP.MAP_ISSUE_CUSTOM_FIELD;
DROP TABLE CSRIMP.MAP_ISSUE_LOG;
DROP TABLE CSRIMP.MAP_ISSUE_METER;
DROP TABLE CSRIMP.MAP_ISSUE_METER_ALARM;
DROP TABLE CSRIMP.MAP_ISSUE_METER_DATA_SOURCE;
DROP TABLE CSRIMP.MAP_ISSUE_METER_RAW_DATA;
DROP TABLE CSRIMP.MAP_ISSUE_PENDING_VAL;
DROP TABLE CSRIMP.MAP_ISSUE_PRIORITY;
DROP TABLE CSRIMP.MAP_ISSUE_SHEET_VALUE;
DROP TABLE CSRIMP.MAP_LIVE_DATA_DURATION;
DROP TABLE CSRIMP.MAP_MEASURE_CONVERSION;
DROP TABLE CSRIMP.MAP_METER_ALARM;
DROP TABLE CSRIMP.MAP_METER_ALARM_COMPARISON;
DROP TABLE CSRIMP.MAP_METER_ALARM_ISSUE_PERIOD;
DROP TABLE CSRIMP.MAP_METER_ALARM_STATISTIC;
DROP TABLE CSRIMP.MAP_METER_ALARM_TEST_TIME;
DROP TABLE CSRIMP.MAP_METER_DOCUMENT;
DROP TABLE CSRIMP.MAP_METER_RAW_DATA;
DROP TABLE CSRIMP.MAP_METER_RAW_DATA_SOURCE;
DROP TABLE CSRIMP.MAP_METER_READING;
DROP TABLE CSRIMP.MAP_PASSWORD_REGEXP;
DROP TABLE CSRIMP.MAP_PENDING_IND;
DROP TABLE CSRIMP.MAP_PENDING_PERIOD;
DROP TABLE CSRIMP.MAP_PENDING_REGION;
DROP TABLE CSRIMP.MAP_PENDING_VAL;
DROP TABLE CSRIMP.MAP_SECTION_COMMENT;
DROP TABLE CSRIMP.MAP_SHEET;
DROP TABLE CSRIMP.MAP_SHEET_HISTORY;
DROP TABLE CSRIMP.MAP_SHEET_VALUE;
DROP TABLE CSRIMP.MAP_SHEET_VALUE_CHANGE;
DROP TABLE CSRIMP.MAP_SID;
DROP TABLE CSRIMP.MAP_TAG;
DROP TABLE CSRIMP.MAP_TAG_GROUP;
DROP TABLE CSRIMP.MAP_UTILITY_CONTRACT;
DROP TABLE CSRIMP.MAP_UTILITY_INVOICE;
DROP TABLE CSRIMP.MAP_UTILITY_SUPPLIER;
DROP TABLE CSRIMP.MAP_VAL;
DROP TABLE CSRIMP.MAP_VAR_EXPL;
DROP TABLE CSRIMP.MAP_VAR_EXPL_GROUP;
DROP TABLE CSRIMP.MASTER_DELEG;
DROP TABLE CSRIMP.MEASURE;
DROP TABLE CSRIMP.MEASURE_CONVERSION;
DROP TABLE CSRIMP.MEASURE_CONVERSION_PERIOD;
DROP TABLE CSRIMP.MENU;
DROP TABLE CSRIMP.METER_ALARM;
DROP TABLE CSRIMP.METER_ALARM_COMPARISON;
DROP TABLE CSRIMP.METER_ALARM_EVENT;
DROP TABLE CSRIMP.METER_ALARM_ISSUE_PERIOD;
DROP TABLE CSRIMP.METER_ALARM_STATISTIC;
DROP TABLE CSRIMP.METER_ALARM_STATISTIC_JOB;
DROP TABLE CSRIMP.METER_ALARM_STATISTIC_PERIOD;
DROP TABLE CSRIMP.METER_ALARM_STAT_RUN;
DROP TABLE CSRIMP.METER_ALARM_TEST_TIME;
DROP TABLE CSRIMP.METER_DOCUMENT;
DROP TABLE CSRIMP.METER_EXCEL_MAPPING;
DROP TABLE CSRIMP.METER_EXCEL_OPTION;
DROP TABLE CSRIMP.METER_LIST_CACHE;
DROP TABLE CSRIMP.METER_LIVE_DATA;
DROP TABLE CSRIMP.METER_METER_ALARM_STATISTIC;
DROP TABLE CSRIMP.METER_ORPHAN_DATA;
DROP TABLE CSRIMP.METER_RAW_DATA;
DROP TABLE CSRIMP.METER_RAW_DATA_ERROR;
DROP TABLE CSRIMP.METER_RAW_DATA_SOURCE;
DROP TABLE CSRIMP.METER_RAW_DATA_STATUS;
DROP TABLE CSRIMP.METER_READING;
DROP TABLE CSRIMP.METER_READING_PERIOD;
DROP TABLE CSRIMP.METER_SOURCE_DATA;
DROP TABLE CSRIMP.METER_SOURCE_TYPE;
DROP TABLE CSRIMP.METER_UTILITY_CONTRACT;
DROP TABLE CSRIMP.METER_XML_OPTION;
DROP TABLE CSRIMP.PASSWORD_REGEXP;
DROP TABLE CSRIMP.PCT_OWNERSHIP;
DROP TABLE CSRIMP.PENDING_DATASET;
DROP TABLE CSRIMP.PENDING_IND;
DROP TABLE CSRIMP.PENDING_IND_ACCURACY_TYPE;
DROP TABLE CSRIMP.PENDING_PERIOD;
DROP TABLE CSRIMP.PENDING_REGION;
DROP TABLE CSRIMP.PENDING_VAL;
DROP TABLE CSRIMP.PENDING_VAL_ACCURACY_TYPE_OPT;
DROP TABLE CSRIMP.PENDING_VAL_LOG;
DROP TABLE CSRIMP.PENDING_VAL_VARIANCE;
DROP TABLE CSRIMP.PERMISSION_MAPPING;
DROP TABLE CSRIMP.PERMISSION_NAME;
DROP TABLE CSRIMP.REGION;
DROP TABLE CSRIMP.REGION_DESCRIPTION;
DROP TABLE CSRIMP.REGION_EVENT;
DROP TABLE CSRIMP.REGION_METER_ALARM;
DROP TABLE CSRIMP.REGION_PROC_DOC;
DROP TABLE CSRIMP.REGION_PROC_FILE;
DROP TABLE CSRIMP.REGION_ROLE_MEMBER;
DROP TABLE CSRIMP.REGION_TAG;
DROP TABLE CSRIMP.REGION_TREE;
DROP TABLE CSRIMP.REPORTING_PERIOD;
DROP TABLE CSRIMP.ROLE;
DROP TABLE CSRIMP.ROLE_GRANT;
DROP TABLE CSRIMP.ROOT_SECTION_USER;
DROP TABLE CSRIMP.SECTION;
DROP TABLE CSRIMP.SECTION_APPROVERS;
DROP TABLE CSRIMP.SECTION_COMMENT;
DROP TABLE CSRIMP.SECTION_MODULE;
DROP TABLE CSRIMP.SECTION_STATUS;
DROP TABLE CSRIMP.SECTION_VERSION;
DROP TABLE CSRIMP.SECURABLE_OBJECT;
DROP TABLE CSRIMP.SECURABLE_OBJECT_ATTRIBUTES;
DROP TABLE CSRIMP.SECURABLE_OBJECT_CLASS;
DROP TABLE CSRIMP.SECURABLE_OBJECT_KEYED_ACL;
DROP TABLE CSRIMP.SHEET;
DROP TABLE CSRIMP.SHEET_ALERT;
DROP TABLE CSRIMP.SHEET_HISTORY;
DROP TABLE CSRIMP.SHEET_INHERITED_VALUE;
DROP TABLE CSRIMP.SHEET_VALUE;
DROP TABLE CSRIMP.SHEET_VALUE_ACCURACY;
DROP TABLE CSRIMP.SHEET_VALUE_CHANGE;
DROP TABLE CSRIMP.SHEET_VALUE_FILE;
DROP TABLE CSRIMP.SHEET_VALUE_VAR_EXPL;
DROP TABLE CSRIMP.SO_RENAME;
DROP TABLE CSRIMP.SUPERADMIN;
DROP TABLE CSRIMP.TAG;
DROP TABLE CSRIMP.TAG_GROUP;
DROP TABLE CSRIMP.TAG_GROUP_MEMBER;
DROP TABLE CSRIMP.TRANSLATION_SET;
DROP TABLE CSRIMP.USER_CERTIFICATES;
DROP TABLE CSRIMP.USER_PASSWORD_HISTORY;
DROP TABLE CSRIMP.USER_TABLE;
DROP TABLE CSRIMP.UTILITY_CONTRACT;
DROP TABLE CSRIMP.UTILITY_INVOICE;
DROP TABLE CSRIMP.UTILITY_SUPPLIER;
DROP TABLE CSRIMP.VAL;
DROP TABLE CSRIMP.VAL_CHANGE;
DROP TABLE CSRIMP.VAR_EXPL;
DROP TABLE CSRIMP.VAR_EXPL_GROUP;
DROP TABLE CSRIMP.WEBSITE;
DROP TABLE CSRIMP.WEB_RESOURCE;

CREATE TABLE CSRIMP.CSRIMP_SESSION(
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	HOST							VARCHAR2(255) NOT NULL,
	STEP							NUMBER(10) DEFAULT 0 NOT NULL,
	CONSTRAINT PK_CSRIMP_SESSION PRIMARY KEY (CSRIMP_SESSION_ID)
);

CREATE UNIQUE INDEX CSRIMP.IX_CSRIMP_SESSION_HOST ON CSRIMP.CSRIMP_SESSION (LOWER(HOST));

CREATE TABLE CSRIMP.CMS_TIDY_DDL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	POS								NUMBER(10) NOT NULL,
	DDL								CLOB NOT NULL,
    CONSTRAINT PK_CMS_TIDY_DDL PRIMARY KEY (CSRIMP_SESSION_ID, POS),
    CONSTRAINT FK_CMS_TIDY_DDL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REPORTING_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REPORTING_PERIOD_SID    NUMBER(10, 0)    NOT NULL,
    NAME                    VARCHAR2(255)    NOT NULL,
    START_DTM               DATE             NOT NULL,
    END_DTM                 DATE             NOT NULL,
    CONSTRAINT PK_REPORTING_PERIOD PRIMARY KEY (REPORTING_PERIOD_SID),
    CONSTRAINT FK_REPORTING_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_ALERT_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CUSTOMER_ALERT_TYPE_ID		NUMBER(10, 0)    NOT NULL,
    STD_ALERT_TYPE_ID    		NUMBER(10, 0)    NULL,
    GET_PARAMS_SP               VARCHAR2(255),
    CONSTRAINT PK356 PRIMARY KEY (CUSTOMER_ALERT_TYPE_ID),
    CONSTRAINT FK_CUSTOMER_ALERT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACCURACY_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ACCURACY_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    LABEL               VARCHAR2(255)    NOT NULL,
    Q_OR_C              CHAR(1)          NOT NULL,
    MAX_SCORE           NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ACCURACY_TYPE PRIMARY KEY (ACCURACY_TYPE_ID),
    CONSTRAINT FK_ACCURACY_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACCURACY_TYPE_OPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ACCURACY_TYPE_OPTION_ID    NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_ID           NUMBER(10, 0)    NOT NULL,
    LABEL                      VARCHAR2(255)    NOT NULL,
    ACCURACY_WEIGHTING         NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ACCURACY_TYPE_OPTION PRIMARY KEY (ACCURACY_TYPE_OPTION_ID),
    CONSTRAINT FK_ACCURACY_TYPE_OPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_FRAME (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ALERT_FRAME_ID    NUMBER(10, 0)     NOT NULL,
    NAME              VARCHAR2(1000)    NOT NULL,
    CONSTRAINT PK_ALERT_FRAME PRIMARY KEY (ALERT_FRAME_ID),
    CONSTRAINT FK_ALERT_FRAME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_FRAME_BODY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ALERT_FRAME_ID    NUMBER(10, 0)    NOT NULL,
    LANG              VARCHAR2(10)     NOT NULL,
    HTML              CLOB             NOT NULL,
    CONSTRAINT PK_ALERT_FRAME_BODY PRIMARY KEY (ALERT_FRAME_ID, LANG),
    CONSTRAINT FK_ALERT_FRAME_BODY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_TEMPLATE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOMER_ALERT_TYPE_ID  NUMBER(10, 0)    NOT NULL,
    ALERT_FRAME_ID    		NUMBER(10, 0)    NOT NULL,
    SEND_TYPE         		VARCHAR2(10)     NOT NULL,
    REPLY_TO_NAME     		VARCHAR2(255),
    REPLY_TO_EMAIL    		VARCHAR2(255),
    CONSTRAINT CK_ALERT_TEMPLATE_SEND_TYPE CHECK (SEND_TYPE IN ('manual', 'automatic')),
    CONSTRAINT PK_ALERT_TEMPLATE PRIMARY KEY (CUSTOMER_ALERT_TYPE_ID),
    CONSTRAINT FK_ALERT_TPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ALERT_TEMPLATE_BODY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOMER_ALERT_TYPE_ID  NUMBER(10, 0)    NOT NULL,
    LANG            		VARCHAR2(10)     NOT NULL,
    SUBJECT          		CLOB             NOT NULL,
    BODY_HTML        		CLOB             NOT NULL,
    ITEM_HTML        		CLOB             NOT NULL,
    CONSTRAINT PK_ALERT_TEMPLATE_BODY PRIMARY KEY (CUSTOMER_ALERT_TYPE_ID, LANG),
    CONSTRAINT FK_ALERT_FTPL_BODY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ROLE_SID                 NUMBER(10, 0)    NOT NULL,
    NAME                     VARCHAR2(255)    NOT NULL,
    LOOKUP_KEY               VARCHAR2(255),
    REGION_PERMISSION_SET    NUMBER(10, 0),
    IS_METERING              NUMBER(1, 0)     NOT NULL,
    IS_PROPERTY_MANAGER      NUMBER(1, 0)     NOT NULL,
    IS_DELEGATION            NUMBER(1, 0)     NOT NULL,
    IS_SUPPLIER              NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CHK_ROLE_IS_METERING CHECK (IS_METERING IN (0,1)),
    CONSTRAINT CHK_ROLE_IS_PROP_MGR CHECK (IS_PROPERTY_MANAGER IN (0,1)),
    CONSTRAINT CHK_ROLE_IS_DELEG CHECK (IS_DELEGATION IN (0,1)),
    CONSTRAINT CHK_ROLE_IS_SUPPLIER CHECK (IS_SUPPLIER IN (0,1)),
    CONSTRAINT PK_ROLE PRIMARY KEY (ROLE_SID),
    CONSTRAINT FK_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID         NUMBER(10, 0)     NOT NULL,
    TAG            VARCHAR2(255)     NOT NULL,
    EXPLANATION    VARCHAR2(1024),
    LOOKUP_KEY     VARCHAR2(30),    
    CONSTRAINT PK_TAG PRIMARY KEY (TAG_ID),
    CONSTRAINT FK_TAG_BODY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TAG_GROUP (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_GROUP_ID                  NUMBER(10, 0)    NOT NULL,
    NAME                          VARCHAR2(255)    NOT NULL,
    MULTI_SELECT                  NUMBER(10, 0)    NOT NULL,
    MANDATORY                     NUMBER(10, 0)    NOT NULL,
    APPLIES_TO_INDS               NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_REGIONS            NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_NON_COMPLIANCES    NUMBER(1, 0)     NOT NULL,
    APPLIES_TO_SUPPLIERS          NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_TAG_GROUP PRIMARY KEY (TAG_GROUP_ID),
    CONSTRAINT FK_TAG_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);
    
CREATE TABLE CSRIMP.TAG_GROUP_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_GROUP_ID    NUMBER(10, 0)    NOT NULL,
    TAG_ID          NUMBER(10, 0)    NOT NULL,
    POS             NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_TAG_GROUP_MEMBER PRIMARY KEY (TAG_GROUP_ID, TAG_ID),
    CONSTRAINT FK_TAG_GROUP_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MEASURE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MEASURE_SID                  NUMBER(10, 0)     NOT NULL,
    NAME                         VARCHAR2(255)     NOT NULL,
    DESCRIPTION                  VARCHAR2(255),
    SCALE                        NUMBER(10, 0)     NOT NULL,
    FORMAT_MASK                  VARCHAR2(255)     NOT NULL,
    REGIONAL_AGGREGATION         VARCHAR2(255)     NOT NULL,
    CUSTOM_FIELD                 VARCHAR2(4000),
    OPTION_SET_ID                NUMBER(10, 0),
    PCT_OWNERSHIP_APPLIES        NUMBER(1, 0)      NOT NULL,
    STD_MEASURE_CONVERSION_ID    NUMBER(10, 0),    
    FACTOR                       NUMBER(10, 0),
    M                            NUMBER(10, 0),
    KG                           NUMBER(10, 0),
    S                            NUMBER(10, 0),
    A                            NUMBER(10, 0),
    K                            NUMBER(10, 0),
    MOL                          NUMBER(10, 0),
    CD                           NUMBER(10, 0),
    CONSTRAINT CK_MEASURE_SI_DETAIL CHECK (( factor is not null and m is not null and kg is not null and s is not null and a is not null and k is not null and mol is not null and cd is not null ) or
	( factor is null and m is null and kg is null and s is null and a is null and k is null and mol is null and cd is null )),    
    CONSTRAINT PK_MEASURE PRIMARY KEY (MEASURE_SID),
    CONSTRAINT FK_MEASURE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MEASURE_CONVERSION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MEASURE_CONVERSION_ID        NUMBER(10, 0)     NOT NULL,
    MEASURE_SID                  NUMBER(10, 0)     NOT NULL,
    STD_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    DESCRIPTION                  VARCHAR2(255),
    A                            NUMBER(24, 10),
    B                            NUMBER(24, 10),
    C                            NUMBER(24, 10),
    CONSTRAINT CK_MCONV_COMPLETED CHECK ((a is null and b is null and c is null) or (a is not null and b is not null and c is not null)),
    CONSTRAINT PK_MEASURE_CONVERSION PRIMARY KEY (MEASURE_CONVERSION_ID),
    CONSTRAINT FK_MEASURE_CONVERSION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MEASURE_CONVERSION_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MEASURE_CONVERSION_ID    NUMBER(10, 0)    NOT NULL,
    START_DTM                DATE             NOT NULL,
    END_DTM                  DATE,
    A                        NUMBER(24, 10)    NOT NULL,
    B                        NUMBER(24, 10)    NOT NULL,
    C                        NUMBER(24, 10)    NOT NULL,
    CONSTRAINT CK_MCONV_PERIOD_COMPLETED CHECK ((a is null and b is null and c is null) or (a is not null and b is not null and c is not null)),
    CONSTRAINT PK_MEASURE_CONVERSION_PERIOD PRIMARY KEY (MEASURE_CONVERSION_ID, START_DTM),
    CONSTRAINT FK_MEASURE_CONV_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID                       NUMBER(10, 0)     NOT NULL,
    PARENT_SID                    NUMBER(10, 0),
    NAME                          VARCHAR2(255)     NOT NULL,
    IND_TYPE                      NUMBER(10, 0)     NOT NULL,
    TOLERANCE_TYPE                NUMBER(2, 0)      NOT NULL,
    PCT_UPPER_TOLERANCE           NUMBER(10, 4)     NOT NULL,
    PCT_LOWER_TOLERANCE           NUMBER(10, 4)     NOT NULL,
    MEASURE_SID                   NUMBER(10, 0),
    MULTIPLIER                    NUMBER(10, 0)     NOT NULL,
    SCALE                         NUMBER(10, 0),
    FORMAT_MASK                   VARCHAR2(255),
    LAST_MODIFIED_DTM             DATE,
    ACTIVE                        NUMBER(10, 0),
    TARGET_DIRECTION              NUMBER(10, 0)     NOT NULL,
    POS                           NUMBER(10, 0)     NOT NULL,
    INFO_XML                      SYS.XMLType,
    START_MONTH                   NUMBER(10, 0),
    DIVISIBLE                     NUMBER(10, 0),
    NULL_MEANS_NULL               NUMBER(10, 0),
    AGGREGATE                     VARCHAR2(24)      NOT NULL,
    DEFAULT_INTERVAL              CHAR(1)           NOT NULL,
    CALC_START_DTM_ADJUSTMENT     NUMBER(10, 0)     NOT NULL,
    CALC_END_DTM_ADJUSTMENT      NUMBER(10, 0)     NOT NULL,
    CALC_FIXED_START_DTM         DATE,
    CALC_FIXED_END_DTM           DATE,
    CALC_XML                      SYS.XMLType,
    GRI                           VARCHAR2(255),
    LOOKUP_KEY                    VARCHAR2(64),
    OWNER_SID                     NUMBER(10, 0),
    IND_ACTIVITY_TYPE_ID          NUMBER(10, 0),
    CORE                          NUMBER(1, 0)      NOT NULL,
    ROLL_FORWARD                  NUMBER(1, 0)      NOT NULL,
    FACTOR_TYPE_ID                NUMBER(10, 0),
    MAP_TO_IND_SID                NUMBER(10, 0),
    GAS_MEASURE_SID               NUMBER(10, 0),
    GAS_TYPE_ID                   NUMBER(10, 0),
    CALC_DESCRIPTION              VARCHAR2(4000),
    NORMALIZE                     NUMBER(1, 0)      NOT NULL,
    DO_TEMPORAL_AGGREGATION       NUMBER(1, 0)      NOT NULL,
	PROP_DOWN_REGION_TREE_SID     NUMBER(10),
	IS_SYSTEM_MANAGED			  NUMBER(1)			NOT NULL,
    CONSTRAINT IND_TOLERANCE CHECK (tolerance_type = 0 OR (pct_upper_tolerance IS NOT NULL AND pct_lower_tolerance IS NOT NULL)),
    CONSTRAINT CK_IND_AGGR CHECK (aggregate IN ('SUM', 'FORCE SUM', 'AVERAGE', 'NONE', 'DOWN', 'FORCE DOWN')),
    CONSTRAINT CK_IND_TYPE CHECK (IND_TYPE IN (0,1,2,3)),
    CHECK (CORE IN (0,1)),
    CONSTRAINT CK_IND_ROLL_FORWARD CHECK (ROLL_FORWARD IN (0, 1)),
    CONSTRAINT CK_IND_NORMALIZE CHECK (NORMALIZE IN (0,1)),
    CHECK (DO_TEMPORAL_AGGREGATION IN (0,1)),
    CONSTRAINT CK_IND_START_MONTH CHECK (start_month between 1 and 12),
    CONSTRAINT CK_IND_MUST_BE_MANAGED CHECK (( gas_type_id is not null and is_system_managed = 1 ) or 
	( ind_type = 3 and is_system_managed = 1 ) or 
	( ind_type != 3 and gas_type_id is null )),
    CONSTRAINT CK_IND_IS_SYSTEM_MANAGED CHECK (IS_SYSTEM_MANAGED IN (0,1)),
    CONSTRAINT PK_IND PRIMARY KEY (IND_SID),
    CONSTRAINT FK_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_DESCRIPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID                       NUMBER(10, 0)     NOT NULL,
    LANG					 	  VARCHAR2(10)      NOT NULL,
    DESCRIPTION				 	  VARCHAR2(1023)	NOT NULL,
    CONSTRAINT PK_IND_DESCRIPTION PRIMARY KEY (IND_SID, LANG),
    CONSTRAINT FK_IND_DESCRIPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_FLAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID          NUMBER(10, 0)    NOT NULL,
    FLAG             NUMBER(10, 0)    NOT NULL,
    DESCRIPTION      VARCHAR2(256)    NOT NULL,
    REQUIRES_NOTE    NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK105 PRIMARY KEY (IND_SID, FLAG),
    CONSTRAINT FK_IND_FLAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_TAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID     NUMBER(10, 0)    NOT NULL,
    IND_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK138 PRIMARY KEY (TAG_ID, IND_SID),
    CONSTRAINT FK_IND_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_ACCURACY_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID             NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK165 PRIMARY KEY (IND_SID, ACCURACY_TYPE_ID),
    CONSTRAINT FK_IND_ACCURACY_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER_REGION_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_TYPE    NUMBER(2, 0)     NOT NULL,
    CONSTRAINT PK_CUSTOMER_REGION_TYPE PRIMARY KEY (REGION_TYPE),
    CONSTRAINT FK_CUSTOMER_REGION_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_TREE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_TREE_ROOT_SID    NUMBER(10, 0)    NOT NULL,
    IS_PRIMARY              NUMBER(1, 0)     NOT NULL,
    IS_DIVISIONS            NUMBER(1, 0)     NOT NULL,
    CHECK (IS_DIVISIONS IN (0,1)),
    CONSTRAINT PK_REGION_TREE PRIMARY KEY (REGION_TREE_ROOT_SID),
    CONSTRAINT FK_REGION_TREE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID            NUMBER(10, 0)     NOT NULL,
    LINK_TO_REGION_SID    NUMBER(10, 0),
    PARENT_SID            NUMBER(10, 0),
    NAME                  VARCHAR2(255)     NOT NULL,
    ACTIVE                NUMBER(10, 0),
    POS                   NUMBER(10, 0)     NOT NULL,
    INFO_XML              SYS.XMLType,
    FLAG                  NUMBER(1, 0),
    ACQUISITION_DTM       DATE,
    DISPOSAL_DTM          DATE,
    REGION_TYPE           NUMBER(2, 0)      NOT NULL,
    LOOKUP_KEY            VARCHAR2(64),
    GEO_COUNTRY           VARCHAR2(2),
    GEO_REGION            VARCHAR2(2),
    GEO_CITY_ID           NUMBER(10, 0),
    GEO_LONGITUDE         NUMBER(14, 10),
    GEO_LATITUDE          NUMBER(14, 10),
    GEO_TYPE              NUMBER(10, 0),
    MAP_ENTITY            VARCHAR2(32),
    EGRID_REF             VARCHAR2(4),
    EGRID_REF_OVERRIDDEN    NUMBER(1, 0)      NOT NULL,
    CONSTRAINT CK_GEO_TYPE CHECK ((GEO_TYPE = 0 AND GEO_LONGITUDE IS NOT NULL AND GEO_LATITUDE IS NOT NULL) OR
(GEO_TYPE = 1 AND GEO_COUNTRY IS NOT NULL AND GEO_LONGITUDE IS NOT NULL AND GEO_LATITUDE IS NOT NULL) OR
(GEO_TYPE = 2 AND MAP_ENTITY IS NOT NULL) OR
(GEO_TYPE = 3 AND GEO_COUNTRY IS NOT NULL AND GEO_REGION IS NOT NULL) OR
(GEO_TYPE = 4 AND GEO_COUNTRY IS NOT NULL AND GEO_REGION IS NOT NULL AND GEO_CITY_ID IS NOT NULL AND GEO_LONGITUDE IS NOT NULL AND GEO_LATITUDE IS NOT NULL) OR
(GEO_TYPE = 5 AND GEO_COUNTRY IS NULL AND GEO_REGION IS NULL AND GEO_CITY_ID IS NULL AND GEO_LONGITUDE IS NULL AND GEO_LATITUDE IS NULL) OR
(GEO_TYPE = 6)),
    CONSTRAINT PK_REGION PRIMARY KEY (REGION_SID),
    CONSTRAINT FK_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_DESCRIPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID                    NUMBER(10, 0)     NOT NULL,
    LANG					 	  VARCHAR2(10)      NOT NULL,
    DESCRIPTION				 	  VARCHAR2(1023)	NOT NULL,
    CONSTRAINT PK_REGION_DESCRIPTION PRIMARY KEY (REGION_SID, LANG),
    CONSTRAINT FK_REGION_DESCRIPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_TAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID        NUMBER(10, 0)    NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK137 PRIMARY KEY (TAG_ID, REGION_SID),
    CONSTRAINT FK_REGION_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PCT_OWNERSHIP (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    START_DTM     DATE             NOT NULL,
    END_DTM       DATE,
    PCT           NUMBER(10, 5)    NOT NULL,
    CONSTRAINT PK315 PRIMARY KEY (REGION_SID, START_DTM),
    CONSTRAINT FK_PCT_OWNERSHIP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CSR_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CSR_USER_SID                   NUMBER(10, 0)    NOT NULL,
    EMAIL                          VARCHAR2(256),
    GUID                           CHAR(36)         NOT NULL,
    REGION_MOUNT_POINT_SID         NUMBER(10, 0),
    FULL_NAME                      VARCHAR2(256),
    USER_NAME                      VARCHAR2(256)    NOT NULL,
    FRIENDLY_NAME                  VARCHAR2(255)    NOT NULL,
    INFO_XML                       SYS.XMLType,
    SEND_ALERTS                    NUMBER(1, 0)     NOT NULL,
    SHOW_PORTAL_HELP               NUMBER(1, 0)     NOT NULL,
    DONATIONS_REPORTS_FILTER_ID    NUMBER(10, 0),
    DONATIONS_BROWSE_FILTER_ID     NUMBER(10, 0),
    HIDDEN                         NUMBER(1, 0)     NOT NULL,
    PHONE_NUMBER                   VARCHAR2(100),
    JOB_TITLE                      VARCHAR2(100),
    SHOW_SAVE_CHART_WARNING        NUMBER(1, 0)     NOT NULL,
    ENABLE_ARIA                    NUMBER(1, 0)     NOT NULL,
    CREATED_DTM                    DATE             NOT NULL,
    IMP_SESSION_MOUNT_POINT_SID    NUMBER(10, 0),
    CHECK (HIDDEN IN (0, 1)),
    CONSTRAINT PK_CSR_USER PRIMARY KEY (CSR_USER_SID),
    CONSTRAINT FK_CSR_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SUPERADMIN (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CSR_USER_SID     NUMBER(10, 0)    NOT NULL,
    EMAIL            VARCHAR2(256),
    GUID             CHAR(36)         NOT NULL,
    FULL_NAME        VARCHAR2(256),
    USER_NAME        VARCHAR2(256)    NOT NULL,
    FRIENDLY_NAME    VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_SUPERADMIN PRIMARY KEY (CSR_USER_SID),
    CONSTRAINT FK_SUPERADMIN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_START_POINT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID     NUMBER(10, 0)    NOT NULL,
    USER_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IND_START_POINT PRIMARY KEY (IND_SID, USER_SID),
    CONSTRAINT FK_IND_START_POINT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_ROLE_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    USER_SID              NUMBER(10, 0)    NOT NULL,
    REGION_SID            NUMBER(10, 0)    NOT NULL,
    ROLE_SID              NUMBER(10, 0)    NOT NULL,
    INHERITED_FROM_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_REGION_ROLE_MEMBER PRIMARY KEY (USER_SID, REGION_SID, ROLE_SID, INHERITED_FROM_SID),
    CONSTRAINT FK_REGION_ROLE_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_DATASET (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_DATASET_ID      NUMBER(10, 0)    NOT NULL,
    LABEL                   VARCHAR2(255)    NOT NULL,
    REPORTING_PERIOD_SID    NUMBER(10, 0)    NOT NULL,
    HELPER_PKG              VARCHAR2(255),
    CONSTRAINT PK_PENDING_DATASET PRIMARY KEY (PENDING_DATASET_ID),
    CONSTRAINT FK_PENDING_DATASET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_IND_ID           NUMBER(10, 0)     NOT NULL,
    PENDING_DATASET_ID       NUMBER(10, 0),
    PARENT_IND_ID            NUMBER(10, 0),
    MAPS_TO_IND_SID          NUMBER(10, 0),
    LINK_TO_IND_ID           NUMBER(10, 0),
    DESCRIPTION              VARCHAR2(2047)    NOT NULL,
    TOLERANCE_TYPE           NUMBER(2, 0)      NOT NULL,
    PCT_UPPER_TOLERANCE      NUMBER(10, 4)     NOT NULL,
    PCT_LOWER_TOLERANCE      NUMBER(10, 4)     NOT NULL,
    VAL_MANDATORY            NUMBER(1, 0)      NOT NULL,
    NOTE_MANDATORY           NUMBER(1, 0)      NOT NULL,
    FILE_UPLOAD_MANDATORY    NUMBER(1, 0)      NOT NULL,
    MEASURE_SID              NUMBER(10, 0),
    POS                      NUMBER(10, 0)     NOT NULL,
    FORMAT_XML               SYS.XMLType,
    ELEMENT_TYPE             NUMBER(10, 0)     NOT NULL,
    READ_ONLY                NUMBER(1, 0)      NOT NULL,
    DP                       NUMBER(10, 0),
    INFO_XML                 SYS.XMLType,
    DEFAULT_VAL_NUMBER       NUMBER(24, 10),
    DEFAULT_VAL_STRING       VARCHAR2(255),
    LOOKUP_KEY               VARCHAR2(64),
    AGGREGATE                VARCHAR2(24)      NOT NULL,
    ALLOW_FILE_UPLOAD        NUMBER(1, 0)      NOT NULL,
    CONSTRAINT PENDING_IND_TOLERANCE CHECK (tolerance_type = 0 OR (pct_upper_tolerance IS NOT NULL AND pct_lower_tolerance IS NOT NULL)),
    CONSTRAINT CK_PENDING_IND_FILUPLOAD_MAND CHECK (FILE_UPLOAD_MANDATORY IN (0,1)),
    CONSTRAINT PK_PENDING_IND PRIMARY KEY (PENDING_IND_ID),
    CONSTRAINT FK_PENDING_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_REGION_ID     NUMBER(10, 0)    NOT NULL,
    PARENT_REGION_ID      NUMBER(10, 0),
    PENDING_DATASET_ID    NUMBER(10, 0)    NOT NULL,
    MAPS_TO_REGION_SID    NUMBER(10, 0),
    DESCRIPTION           VARCHAR2(255)    NOT NULL,
    POS                   NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_PENDING_REGION PRIMARY KEY (PENDING_REGION_ID),
    CONSTRAINT FK_PENDING_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.PENDING_IND_ACCURACY_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_IND_ID      NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_PENDING_IND_ACCURACY_TYPE PRIMARY KEY (PENDING_IND_ID, ACCURACY_TYPE_ID),
    CONSTRAINT FK_PENDING_IND_ACC_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_STEP (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID               NUMBER(10, 0)    NOT NULL,
    PARENT_STEP_ID                 NUMBER(10, 0),
    PENDING_DATASET_ID             NUMBER(10, 0)    NOT NULL,
    BASED_ON_STEP_ID               NUMBER(10, 0),
    LABEL                          VARCHAR2(255)    NOT NULL,
    LAYOUT_TYPE                    NUMBER(10, 0)    NOT NULL,
    MAX_SHEET_VALUE_COUNT          NUMBER(10, 0)    NOT NULL,
    WORKING_DAY_OFFSET_FROM_DUE    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP PRIMARY KEY (APPROVAL_STEP_ID),
    CONSTRAINT FK_APPROVAL_STEP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_STEP_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID     NUMBER(10, 0)    NOT NULL,
    USER_SID             NUMBER(10, 0)    NOT NULL,
    FALLBACK_USER_SID    NUMBER(10, 0),
    READ_ONLY            NUMBER(1, 0)     NOT NULL,
    IS_LURKER            NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP_USER PRIMARY KEY (APPROVAL_STEP_ID, USER_SID),
    CONSTRAINT FK_APPROVAL_STEP_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.APPROVAL_STEP_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID    NUMBER(10, 0)    NOT NULL,
    PENDING_IND_ID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP_IND PRIMARY KEY (APPROVAL_STEP_ID, PENDING_IND_ID),
    CONSTRAINT FK_APPROVAL_STEP_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_STEP_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID         NUMBER(10, 0)    NOT NULL,
    ROLLS_UP_TO_REGION_ID    NUMBER(10, 0),
    PENDING_REGION_ID        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP_REGION PRIMARY KEY (APPROVAL_STEP_ID, PENDING_REGION_ID),
    CONSTRAINT FK_APPROVAL_STEP_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.APPROVAL_STEP_SHEET (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID             NUMBER(10, 0)     NOT NULL,
    SHEET_KEY                    VARCHAR2(255)     NOT NULL,
    LABEL                        VARCHAR2(1204)    NOT NULL,
    PENDING_PERIOD_ID            NUMBER(10, 0),
    PENDING_IND_ID               NUMBER(10, 0),
    PENDING_REGION_ID            NUMBER(10, 0),
    SUBMITTED_VALUE_COUNT        NUMBER(10, 0)     NOT NULL,
    SUBMIT_BLOCKED               NUMBER(1, 0)      NOT NULL,
    VISIBLE                      NUMBER(1, 0)      NOT NULL,
    DUE_DTM                      DATE,
    REMINDER_DTM                 DATE              NOT NULL,
    APPROVER_RESPONSE_DUE_DTM    DATE,
    CONSTRAINT PK_APPROVAL_STEP_SHEET PRIMARY KEY (APPROVAL_STEP_ID, SHEET_KEY),
    CONSTRAINT FK_APPROVAL_STEP_SHEET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPROVAL_STEP_SHEET_LOG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID    NUMBER(10, 0)    NOT NULL,
    SHEET_KEY           VARCHAR2(255)    NOT NULL,
    DTM                 DATE             NOT NULL,
    BY_USER_SID         NUMBER(10, 0)    NOT NULL,
    UP_OR_DOWN          NUMBER(1, 0)     NOT NULL,
    NOTE                CLOB
);

CREATE TABLE CSRIMP.APPROVAL_STEP_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPROVAL_STEP_ID    NUMBER(10, 0)    NOT NULL,
    ROLE_SID            NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_APPROVAL_STEP_ROLE PRIMARY KEY (APPROVAL_STEP_ID, ROLE_SID),
    CONSTRAINT FK_APPROVAL_STEP_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_VAL_ID                NUMBER(10, 0)     NOT NULL,
    PENDING_IND_ID                NUMBER(10, 0)     NOT NULL,
    PENDING_REGION_ID             NUMBER(10, 0)     NOT NULL,
    PENDING_PERIOD_ID             NUMBER(10, 0)     NOT NULL,
    APPROVAL_STEP_ID              NUMBER(10, 0),
    VAL_NUMBER                    NUMBER(24, 10),
    VAL_STRING                    VARCHAR2(4000),
    FROM_VAL_NUMBER               NUMBER(24, 10),
    FROM_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    NOTE                          CLOB,
    ACTION                        CHAR(1)           NOT NULL,
    MERGED_STATE                  CHAR(1)           NOT NULL,
    CONSTRAINT CK_MERGED_STATE CHECK (MERGED_STATE IN ('U', 'S', 'R')),
    CONSTRAINT PK_PENDING_VAL PRIMARY KEY (PENDING_VAL_ID),
    CONSTRAINT FK_PENDING_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_VAL_ACCURACY_TYPE_OPT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_VAL_ID             NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_OPTION_ID    NUMBER(10, 0)    NOT NULL,
    PCT                        NUMBER(10, 4)    NOT NULL,
    CONSTRAINT PK_PENDING_VAL_ACC_TYPE_OPT PRIMARY KEY (PENDING_VAL_ID, ACCURACY_TYPE_OPTION_ID),
    CONSTRAINT FK_PENDING_VAL_ACC_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_VAL_VARIANCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_VAL_ID             NUMBER(10, 0)    NOT NULL,
    COMPARED_WITH_START_DTM    DATE             NOT NULL,
    COMPARED_WITH_END_DTM      DATE             NOT NULL,
    VARIANCE                   NUMBER(14, 4)    NOT NULL,
    EXPLANATION                CLOB,
    CONSTRAINT PK_PENDING_VAL_VARIANCE PRIMARY KEY (PENDING_VAL_ID),
    CONSTRAINT FK_PENDING_VAL_VAR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID           NUMBER(10, 0)     NOT NULL,
    PARENT_SID               NUMBER(10, 0),
    NAME                     VARCHAR2(1023)    NOT NULL,
    MASTER_DELEGATION_SID    NUMBER(10, 0),
    CREATED_BY_SID           NUMBER(10, 0)     NOT NULL,
    SCHEDULE_XML             CLOB              NOT NULL,
    NOTE                     CLOB,
    INTERVAL                 VARCHAR2(32)      NOT NULL,
    GROUP_BY                 VARCHAR2(64)      NOT NULL,
    ALLOCATE_USERS_TO        VARCHAR2(64)      NOT NULL,
    START_DTM                DATE              NOT NULL,
    END_DTM                  DATE              NOT NULL,
    REMINDER_OFFSET          NUMBER(10, 0)     NOT NULL,
    IS_NOTE_MANDATORY        NUMBER(10, 0)     NOT NULL,
    SECTION_XML              CLOB,
    EDITING_URL              VARCHAR2(255)     NOT NULL,
    FULLY_DELEGATED          NUMBER(1, 0)      NOT NULL,
    GRID_XML                 CLOB,
    IS_FLAG_MANDATORY        NUMBER(1, 0)      NOT NULL,
    SHOW_AGGREGATE           NUMBER(1, 0)      NOT NULL,
    CONSTRAINT CK_DELEGATION_DATES CHECK (START_DTM = TRUNC(START_DTM, 'MON') AND END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM),
    CONSTRAINT PK_DELEGATION PRIMARY KEY (DELEGATION_SID),
    CONSTRAINT FK_DELEGATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID        NUMBER(10, 0)     NOT NULL,
    IND_SID               NUMBER(10, 0)     NOT NULL,
    MANDATORY             NUMBER(10, 0)     NOT NULL,
    POS                   NUMBER(10, 0)     NOT NULL,
    SECTION_KEY           VARCHAR2(128),
    VAR_EXPL_GROUP_ID     NUMBER(10, 0),
    VISIBILITY            VARCHAR2(32)      NOT NULL,
    CSS_CLASS             VARCHAR2(64),
    CONSTRAINT CK_DELEG_IND_VISIBLE CHECK (VISIBILITY IN ('SHOW','READONLY','HIDE', 'VALIDATE')),
    CONSTRAINT PK60 PRIMARY KEY (DELEGATION_SID, IND_SID),
    CONSTRAINT FK_DELEGATION_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID             NUMBER(10, 0)    NOT NULL,
    REGION_SID                 NUMBER(10, 0)    NOT NULL,
    MANDATORY                  NUMBER(10, 0)    NOT NULL,
    POS                        NUMBER(10, 0)    NOT NULL,
    AGGREGATE_TO_REGION_SID    NUMBER(10, 0)    NOT NULL,
    VISIBILITY                 VARCHAR2(255)    NOT NULL,
    CONSTRAINT CK_DELEG_REGION_VISIBLE CHECK (VISIBILITY IN ('HIDE','SHOW','READONLY')),
    CONSTRAINT PK61 PRIMARY KEY (DELEGATION_SID, REGION_SID),
    CONSTRAINT FK_DELEGATION_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_REGION_DESCRIPTION
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DELEGATION_SID				 	NUMBER(10, 0) 		NOT NULL,
	REGION_SID						NUMBER(10, 0)		NOT NULL,
	LANG 							VARCHAR2(10) 		NOT NULL,
	DESCRIPTION						VARCHAR2(1023) 		NOT NULL,
	CONSTRAINT PK_DELEGATION_REGION_DESC PRIMARY KEY (DELEGATION_SID, REGION_SID, LANG),
    CONSTRAINT FK_DELEGATION_RGN_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    USER_SID          NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK62 PRIMARY KEY (DELEGATION_SID, USER_SID),
    CONSTRAINT FK_DELEGATION_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_SID             NUMBER(10, 0)    NOT NULL,
    PARENT_SID           NUMBER(10, 0)    NOT NULL,
    NAME                 VARCHAR2(256)    NOT NULL,
    NOTE                 CLOB,
    START_DTM            DATE             NOT NULL,
    END_DTM              DATE             NOT NULL,
    GROUP_BY             VARCHAR2(128)    NOT NULL,
    INTERVAL             VARCHAR2(10)     NOT NULL,
    ALLOCATE_USERS_TO    VARCHAR2(10)     NOT NULL,
    TAB_DIRECTION        NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CK_FORM_TAB_DIRECTION CHECK (TAB_DIRECTION IN (0,1)),
    CONSTRAINT PK_FORM PRIMARY KEY (FORM_SID),
    CONSTRAINT FK_FORM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_IND_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RANGE_SID                NUMBER(10, 0)     NOT NULL,
    IND_SID                  NUMBER(10, 0)     NOT NULL,
    DESCRIPTION              VARCHAR2(1023)    NOT NULL,
    POS                      NUMBER(10, 0)     NOT NULL,
    SCALE                    NUMBER(10, 0),
    FORMAT_MASK              VARCHAR2(255),
    MEASURE_DESCRIPTION      VARCHAR2(255),
    FLAGS                    NUMBER(10, 0)     NOT NULL,
    MULTIPLIER_IND_SID       NUMBER(10, 0),
    MEASURE_CONVERSION_ID    NUMBER(10, 0),
    CONSTRAINT PK_FORM_IND_MEMBER PRIMARY KEY (RANGE_SID, IND_SID),
    CONSTRAINT FK_FORM_IND_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_REGION_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RANGE_SID      NUMBER(10, 0)    NOT NULL,
    REGION_SID     NUMBER(10, 0)    NOT NULL,
    DESCRIPTION    VARCHAR2(255)    NOT NULL,
    POS            NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FORM_REGION_MEMBER PRIMARY KEY (RANGE_SID, REGION_SID),
    CONSTRAINT FK_FORM_REG_MEMBER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_ALLOCATION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_ALLOCATION_ID    NUMBER(10, 0)    NOT NULL,
    FORM_SID              NUMBER(10, 0)    NOT NULL,
    NOTE                  CLOB,
    CONSTRAINT PK_FORM_ALLOCATION PRIMARY KEY (FORM_ALLOCATION_ID),
    CONSTRAINT FK_FORM_ALLOCATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_ALLOCATION_ITEM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_ALLOCATION_ID    NUMBER(10, 0)    NOT NULL,
    ITEM_SID		      NUMBER(10, 0)	   NOT NULL
);

CREATE TABLE CSRIMP.FORM_ALLOCATION_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_ALLOCATION_ID    NUMBER(10, 0)    NOT NULL,
    USER_SID              NUMBER(10, 0)    NOT NULL,
    READ_ONLY             NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_FORM_ALLOCATION_USER PRIMARY KEY (FORM_ALLOCATION_ID, USER_SID),
    CONSTRAINT FK_FORM_ALLOC_USR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FORM_COMMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_SID               NUMBER(10, 0)    NOT NULL,
    Z_KEY                  VARCHAR2(255)    NOT NULL,
    FORM_COMMENT           CLOB,
    LAST_UPDATED_BY_SID    NUMBER(10, 0)    NOT NULL,
    LAST_UPDATED_DTM       DATE             NOT NULL,
    FORM_ALLOCATION_ID     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FORM_COMMENT PRIMARY KEY (FORM_SID, Z_KEY, FORM_ALLOCATION_ID),
    CONSTRAINT FK_FORM_COMMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID                   NUMBER(10, 0)     NOT NULL,
    PARENT_SID                     NUMBER(10, 0)     NOT NULL,
    NAME                           VARCHAR2(256),
    START_DTM                      DATE              NOT NULL,
    END_DTM                        DATE,
    GROUP_BY                       VARCHAR2(128)     NOT NULL,
    INTERVAL                       VARCHAR2(10)      NOT NULL,
    CHART_CONFIG_XML               CLOB,
    CHART_STYLE_XML                CLOB,
    POS                            NUMBER(10, 0)	 NOT NULL,
    DESCRIPTION                    VARCHAR2(2048),
    DATAVIEW_TYPE_ID               NUMBER(6, 0)      NOT NULL,
    USE_UNMERGED                   NUMBER(1, 0)      NOT NULL,
    USE_BACKFILL                   NUMBER(1, 0)      NOT NULL,
    USE_PENDING                    NUMBER(1, 0)      NOT NULL,
    SHOW_CALC_TRACE                NUMBER(1, 0)      NOT NULL,
    SHOW_VARIANCE                  NUMBER(1, 0)      NOT NULL,
    SORT_BY_MOST_RECENT            NUMBER(1, 0)      NOT NULL,
    INCLUDE_PARENT_REGION_NAMES    NUMBER(10, 0)     NOT NULL,
    LAST_UPDATED_DTM               DATE              NOT NULL,
    LAST_UPDATED_SID               NUMBER(10, 0),
    CONSTRAINT CK_DATAVIEW_USE_UNMERGED CHECK (USE_UNMERGED IN (0,1)),
    CONSTRAINT CK_DATAVIEW_USE_BACKFILL CHECK (USE_BACKFILL IN (0,1)),
    CONSTRAINT CK_DATAVIEW_SHOW_CALC_TRACE CHECK (SHOW_CALC_TRACE IN (0,1)),
    CONSTRAINT CK_DATAVIEW_SHOW_VARIANCE CHECK (SHOW_VARIANCE IN (0,1)),
    CONSTRAINT CK_DATASOURCE_USE_PENDING CHECK (USE_PENDING IN (0,1)),
    CONSTRAINT PK_DATAVIEW PRIMARY KEY (DATAVIEW_SID),
    CONSTRAINT FK_DATAVIEW_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_IND_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID             NUMBER(10, 0)     NOT NULL,
    IND_SID                  NUMBER(10, 0)     NOT NULL,
    NORMALIZATION_IND_SID    NUMBER(10, 0),
    CALCULATION_TYPE_ID      NUMBER(10, 0),
    POS                      NUMBER(10, 0)     NOT NULL,
    FORMAT_MASK              VARCHAR2(255),
    MEASURE_CONVERSION_ID    NUMBER(10, 0),
    CONSTRAINT FK_DATAVIEW_IND_MEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_IND_DESCRIPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID             NUMBER(10, 0)     NOT NULL,
    POS                      NUMBER(10, 0)     NOT NULL,
    LANG					 VARCHAR2(10)      NOT NULL,
    DESCRIPTION				 VARCHAR2(1023)	   NOT NULL,
    CONSTRAINT PK_DATAVIEW_IND_DESCRIPTION PRIMARY KEY (DATAVIEW_SID, POS, LANG),
    CONSTRAINT FK_DATAVIEW_IND_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_REGION_MEMBER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID    NUMBER(10, 0)     NOT NULL,
    REGION_SID      NUMBER(10, 0)     NOT NULL,
    POS             NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK754 PRIMARY KEY (DATAVIEW_SID, REGION_SID),
    CONSTRAINT FK_DATAVIEW_REG_MEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DATAVIEW_REGION_DESCRIPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DATAVIEW_SID             NUMBER(10, 0)     NOT NULL,
    REGION_SID				 NUMBER(10, 0)     NOT NULL,
    LANG					 VARCHAR2(10)      NOT NULL,
    DESCRIPTION				 VARCHAR2(1023)	   NOT NULL,
    CONSTRAINT PK_DATAVIEW_REGION_DESC PRIMARY KEY (DATAVIEW_SID, REGION_SID, LANG),
    CONSTRAINT FK_DATAVIEW_REG_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    VAL_ID                         NUMBER(10, 0)     NOT NULL,
    IND_SID                        NUMBER(10, 0)     NOT NULL,
    REGION_SID                     NUMBER(10, 0)     NOT NULL,
    PERIOD_START_DTM               DATE              NOT NULL,
    PERIOD_END_DTM                 DATE,
    VAL_NUMBER                     NUMBER(24, 10),
    ERROR_CODE					   NUMBER(10),
    ALERT                          VARCHAR2(255),
    SOURCE_TYPE_ID                 NUMBER(10, 0)     NOT NULL,
    FLAGS                          NUMBER(10, 0)     NOT NULL,
    SOURCE_ID                      NUMBER(10, 0),
    ENTRY_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    ENTRY_VAL_NUMBER               NUMBER(24, 10),
    NOTE                           CLOB,
    CHANGED_DTM                    DATE              NOT NULL,
    CHANGED_BY_SID                 NUMBER(10, 0)     NOT NULL,
    CONSTRAINT CK_VAL_NUM CHECK ((val_number IS NOT NULL AND entry_val_number IS NOT NULL) OR (val_number IS NULL AND entry_val_number IS NULL)),
    CONSTRAINT CK_VAL_DATES CHECK (PERIOD_START_DTM = TRUNC(PERIOD_START_DTM, 'MON') AND PERIOD_END_DTM = TRUNC(PERIOD_END_DTM, 'MON') AND PERIOD_END_DTM > PERIOD_START_DTM),
    CONSTRAINT PK_VAL PRIMARY KEY (VAL_ID),
    CONSTRAINT FK_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAL_CHANGE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    VAL_CHANGE_ID                  NUMBER(10, 0)     NOT NULL,
    IND_SID                        NUMBER(10, 0)     NOT NULL,
    REGION_SID                     NUMBER(10, 0)     NOT NULL,
    PERIOD_START_DTM               DATE              NOT NULL,
    PERIOD_END_DTM                 DATE              NOT NULL,
    VAL_NUMBER                     NUMBER(24, 10),
    SOURCE_TYPE_ID                 NUMBER(10, 0)     NOT NULL,
    SOURCE_ID                      NUMBER,
    ENTRY_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    ENTRY_VAL_NUMBER               NUMBER(24, 10),
    NOTE                           CLOB,
    CHANGED_BY_SID                 NUMBER(10, 0)     NOT NULL,
    CHANGED_DTM                    DATE              NOT NULL,
    REASON                         VARCHAR2(1024)    NOT NULL,
    CONSTRAINT CK_VAL_CHANGE_DATES CHECK (PERIOD_START_DTM = TRUNC(PERIOD_START_DTM, 'MON') AND PERIOD_END_DTM = TRUNC(PERIOD_END_DTM, 'MON') AND PERIOD_END_DTM > PERIOD_START_DTM),
    CONSTRAINT PK_VAL_CHANGE PRIMARY KEY (VAL_CHANGE_ID),
    CONSTRAINT FK_VAL_CHANGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_MODULE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MODULE_ROOT_SID       NUMBER(10, 0)     NOT NULL,
    LABEL                 VARCHAR2(1024)    NOT NULL,
    SHOW_SUMMARY_TAB      NUMBER(1, 0)      NOT NULL,
    DEFAULT_STATUS_SID    NUMBER(10, 0)     NOT NULL,
-- not used yet as in the model but not on live
--    FLOW_SID              NUMBER(10, 0),
--    REGION_SID            NUMBER(10, 0),
    CONSTRAINT PK_SECTION_MODULE PRIMARY KEY (MODULE_ROOT_SID),
    CONSTRAINT FK_SECTION_MODULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_STATUS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_STATUS_SID    NUMBER(10, 0)    NOT NULL,
    DESCRIPTION           VARCHAR2(255)    NOT NULL,
    COLOUR                NUMBER(10, 0)    NOT NULL,
    POS                   NUMBER(10, 0)    NOT NULL,
    ICON_PATH             VARCHAR2(256),
    CONSTRAINT PK543 PRIMARY KEY (SECTION_STATUS_SID),
    CONSTRAINT FK_SECTION_STATUS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_SID                   NUMBER(10, 0)     NOT NULL,
    PARENT_SID                    NUMBER(10, 0),
    CHECKED_OUT_TO_SID            NUMBER(10, 0),
    CHECKED_OUT_DTM               DATE,
    CHECKED_OUT_VERSION_NUMBER    NUMBER(10, 0),
    VISIBLE_VERSION_NUMBER        NUMBER(10, 0),
    SECTION_POSITION              NUMBER(10, 0)     NOT NULL,
    ACTIVE                        NUMBER(1, 0)      NOT NULL,
    MODULE_ROOT_SID               NUMBER(10, 0)     NOT NULL,
    TITLE_ONLY                    NUMBER(10, 0)     NOT NULL,
    REF                           VARCHAR2(64),
    PLUGIN                        VARCHAR2(255),
    PLUGIN_CONFIG                 VARCHAR2(2048),
    SECTION_STATUS_SID            NUMBER(10, 0)     NOT NULL,
    FURTHER_INFO_URL              VARCHAR2(1024),
    CONSTRAINT PK_SECTION PRIMARY KEY (SECTION_SID),
    CONSTRAINT FK_SECTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_VERSION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_SID          NUMBER(10, 0)     NOT NULL,
    VERSION_NUMBER       NUMBER(10, 0)     NOT NULL,
    TITLE                VARCHAR2(1023)    NOT NULL,
    BODY                 CLOB,
    CHANGED_BY_SID       NUMBER(10, 0),
    CHANGED_DTM          DATE,
    REASON_FOR_CHANGE    CLOB,
    APPROVED_BY_SID      NUMBER(10, 0),
    APPROVED_DTM         DATE,
    CONSTRAINT PK_SECTION_VERSION PRIMARY KEY (SECTION_SID, VERSION_NUMBER),
    CONSTRAINT FK_SECTION_VERSION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ATTACHMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ATTACHMENT_ID                 NUMBER(10, 0)     NOT NULL,
    FILENAME                      VARCHAR2(1024)    NOT NULL,
    MIME_TYPE                     VARCHAR2(255)     NOT NULL,
    DATA                          BLOB,
    EMBED                         NUMBER(1, 0)      NOT NULL,
    DATAVIEW_SID                  NUMBER(10, 0),
    LAST_UPDATED_FROM_DATAVIEW    DATE,
    VIEW_AS_TABLE                 NUMBER(1, 0),
    INDICATOR_SID                 NUMBER(10, 0),
    DOC_ID                        NUMBER(10, 0),
    URL                           VARCHAR2(1023),
    CONSTRAINT PK_ATTACHMENT PRIMARY KEY (ATTACHMENT_ID),
    CONSTRAINT FK_ATTACHMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ATTACHMENT_HISTORY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_SID       NUMBER(10, 0)    NOT NULL,
    VERSION_NUMBER    NUMBER(10, 0)    NOT NULL,
    ATTACHMENT_ID     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ATTACHMENT_HISTORY PRIMARY KEY (SECTION_SID, VERSION_NUMBER, ATTACHMENT_ID),
    CONSTRAINT FK_ATTACHMENT_HISTORY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_COMMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_COMMENT_ID    NUMBER(10, 0)    NOT NULL,
    SECTION_SID           NUMBER(10, 0),
    IN_REPLY_TO_ID        NUMBER(10, 0),
    COMMENT_TEXT          CLOB             NOT NULL,
    ENTERED_BY_SID        NUMBER(10, 0)    NOT NULL,
    ENTERED_DTM           DATE,
    IS_CLOSED             NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_SECTION_COMMENT PRIMARY KEY (SECTION_COMMENT_ID),
    CONSTRAINT FK_SECTION_COMMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECTION_APPROVERS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SECTION_SID     NUMBER(10, 0)    NOT NULL,
    APPROVER_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK12 PRIMARY KEY (SECTION_SID, APPROVER_SID),
    CONSTRAINT FK_SECTION_APPROVERS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ROOT_SECTION_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CSR_USER_SID        NUMBER(10, 0)    NOT NULL,
    ROOT_SECTION_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK9 PRIMARY KEY (CSR_USER_SID, ROOT_SECTION_SID),
    CONSTRAINT FK_SECTION_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CUSTOMER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    NAME                             VARCHAR2(255)     NOT NULL,
    HOST                             VARCHAR2(255)     NOT NULL,
    SYSTEM_MAIL_ADDRESS              VARCHAR2(255)     NOT NULL,
    TRACKER_MAIL_ADDRESS             VARCHAR2(255)     NOT NULL,
    ALERT_MAIL_ADDRESS               VARCHAR2(255)     NOT NULL,
    ALERT_MAIL_NAME                  VARCHAR2(255)     NOT NULL,
    ALERT_BATCH_RUN_TIME             INTERVAL DAY (2) TO SECOND (6) NOT NULL,
    TRASH_SID                        NUMBER(10, 0)     NOT NULL,
    AGGREGATION_ENGINE_VERSION       NUMBER(1, 0)      NOT NULL,
    CONTACT_EMAIL                    VARCHAR2(255),
    EDITING_URL                      VARCHAR2(255)     NOT NULL,
    MESSAGE                          CLOB,
    IND_INFO_XML_FIELDS              SYS.XMLType,
    REGION_INFO_XML_FIELDS           SYS.XMLType,
    USER_INFO_XML_FIELDS             SYS.XMLType,
    RAISE_REMINDERS                  NUMBER(1, 0)      NOT NULL,
    ACCOUNT_POLICY_SID               NUMBER(10, 0)     NOT NULL,
    STATUS                           NUMBER(2, 0)      NOT NULL,
    RAISE_SPLIT_DELEG_ALERTS         NUMBER(10, 0)     NOT NULL,
    CURRENT_REPORTING_PERIOD_SID     NUMBER(10, 0),
    LOCK_START_DTM                   DATE              NOT NULL,
    LOCK_END_DTM                     DATE              NOT NULL,
    REGION_ROOT_SID                  NUMBER(10, 0),
    IND_ROOT_SID                     NUMBER(10, 0),
    CASCADE_REJECT                   NUMBER(1, 0)      NOT NULL,
    APPROVER_RESPONSE_WINDOW         NUMBER(10, 0)     NOT NULL,
    SELF_REG_GROUP_SID               NUMBER(10, 0),
    SELF_REG_NEEDS_APPROVAL          NUMBER(1, 0)      NOT NULL,
    SELF_REG_APPROVER_SID            NUMBER(10, 0),
    ALLOW_PARTIAL_SUBMIT             NUMBER(1, 0)      NOT NULL,
    HELPER_ASSEMBLY                  VARCHAR2(255),
    APPROVAL_STEP_SHEET_URL          VARCHAR2(255)     NOT NULL,
    USE_TRACKER                      NUMBER(1, 0)      NOT NULL,
    USE_USER_SHEETS                  NUMBER(1, 0)      NOT NULL,
    ALLOW_VAL_EDIT                   NUMBER(1, 0)      NOT NULL,
    FULLY_HIDE_SHEETS                NUMBER(1, 0)      NOT NULL,
    CALC_SUM_ZERO_FILL               NUMBER(1, 0)      NOT NULL,
    CREATE_SHEETS_AT_PERIOD_END      NUMBER(1, 0)      NOT NULL,
    AUDIT_CALC_CHANGES               NUMBER(1, 0)      NOT NULL,
    ORACLE_SCHEMA                    VARCHAR2(255),
    IND_CMS_TABLE                    VARCHAR2(255),
    TARGET_LINE_COL_FROM_GRADIENT    NUMBER(1, 0)      NOT NULL,
    USE_CARBON_EMISSION              NUMBER(1, 0)      NOT NULL,
    HELPER_PKG                       VARCHAR2(255),
    CHAIN_INVITE_LANDING_PREABLE     VARCHAR2(4000),
    CHAIN_INVITE_LANDING_QSTN        VARCHAR2(4000),
    ALLOW_DELEG_PLAN                 NUMBER(1, 0)      NOT NULL,
    SUPPLIER_REGION_ROOT_SID         NUMBER(10, 0),
    TRUCOST_COMPANY_ID               NUMBER(10, 0),
    TRUCOST_PORTLET_TAB_ID           NUMBER(10, 0),
    FOGBUGZ_IXPROJECT                NUMBER(10, 0),
    FOGBUGZ_SAREA                    VARCHAR2(50),
    FWD_ESTIMATE_METERS              NUMBER(1, 0)      NOT NULL,
    PROPAGATE_DELEG_VALUES_DOWN      NUMBER(1, 0)      NOT NULL,
    ENABLE_SAVE_CHART_WARNING        NUMBER(1, 0)      NOT NULL,
    ISSUE_EDITOR_URL                 VARCHAR2(200)     NOT NULL,
    ALLOW_MAKE_EDITABLE              NUMBER(1, 0)      NOT NULL,
    ALERT_URI_FORMAT                 VARCHAR2(250),
    UNMERGED_CONSISTENT              NUMBER(1, 0)      NOT NULL,
    UNMERGED_SCENARIO_RUN_SID        NUMBER(10, 0),
    IND_SELECTIONS_ENABLED           NUMBER(1, 0)      NOT NULL,
    CHECK_TOLERANCE_AGAINST_ZERO     NUMBER(1, 0)      NOT NULL,
    SCENARIOS_ENABLED                NUMBER(1, 0)      NOT NULL,
    CALC_JOB_PRIORITY                NUMBER(10, 0)     NOT NULL,
    COPY_VALS_TO_NEW_SHEETS          NUMBER(1, 0)      NOT NULL,
    USE_VAR_EXPL_GROUPS              NUMBER(1, 0)      NOT NULL,
	APPLY_FACTORS_TO_CHILD_REGIONS    NUMBER(1, 0)      DEFAULT 1 NOT NULL,
    CHECK (ALLOW_PARTIAL_SUBMIT IN (0,1)),
    CHECK (USE_TRACKER IN (0,1)),
    CONSTRAINT CK_CUST_USE_USER_SHEETS CHECK (USE_USER_SHEETS IN (0,1)),
    CONSTRAINT CK_AGGREGATION_ENGINE_VERSION CHECK (AGGREGATION_ENGINE_VERSION IN (4)),
    CHECK (ALLOW_VAL_EDIT IN (0,1)),
    CONSTRAINT CK_CUST_FULLY_HIDE_SHEETS CHECK (FULLY_HIDE_SHEETS IN (0,1)),
    CONSTRAINT CK_CUSTOMER_CALC_SUM_0_FILL CHECK (CALC_SUM_ZERO_FILL IN (0,1)),
    CONSTRAINT CK_CUSTOMER_AUDIT_CALC_CHANGES CHECK (AUDIT_CALC_CHANGES IN (0,1)),
    CHECK (TARGET_LINE_COL_FROM_GRADIENT IN (0,1)),
    CHECK (USE_CARBON_EMISSION IN (0,1)),
    CHECK (ALLOW_DELEG_PLAN IN (0,1)),
    CONSTRAINT CK_CUSTOMER_FWD_EST_METERS CHECK (FWD_ESTIMATE_METERS IN (0,1)),
    CONSTRAINT CK_UNMERGED_CONSISTENT CHECK (unmerged_consistent in (0,1)),
    CONSTRAINT CK_CUSTOMER_IND_SEL_ENABLED CHECK (IND_SELECTIONS_ENABLED IN (0,1)),
    CONSTRAINT CHK_CUS_CHK_TOL_ZERO CHECK (CHECK_TOLERANCE_AGAINST_ZERO IN (0,1)),
    CONSTRAINT CK_CUSTOMER_SCENARIOS_ENABLED CHECK (scenarios_enabled in (0,1)),
    CONSTRAINT CHK_CPY_VAL_TO_NEW_SHT CHECK (COPY_VALS_TO_NEW_SHEETS IN (0,1)),
    CONSTRAINT CK_USE_VAR_EXPL_GROUPS CHECK (USE_VAR_EXPL_GROUPS IN (0,1)),
	CONSTRAINT CHK_CUS_APPLY_FCTRS_CHLDRN CHECK (APPLY_FACTORS_TO_CHILD_REGIONS IN (0,1)),
    CONSTRAINT FK_CUSTOMER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.TRANSLATION_SET (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	LANG							VARCHAR2(10)		NOT NULL,
	HIDDEN							NUMBER(1, 0)		NOT NULL,
    CONSTRAINT FK_TRANSLATION_SET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_PERIOD_ID     NUMBER(10, 0)    NOT NULL,
    PENDING_DATASET_ID    NUMBER(10, 0)    NOT NULL,
    START_DTM             DATE             NOT NULL,
    END_DTM               DATE             NOT NULL,
    LABEL                 VARCHAR2(255)    NOT NULL,
    DEFAULT_DUE_DTM       DATE             NOT NULL,
    CONSTRAINT PK_PENDING_PERIOD PRIMARY KEY (PENDING_PERIOD_ID),
    CONSTRAINT FK_PENDING_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PENDING_VAL_LOG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PENDING_VAL_LOG_ID    NUMBER(10, 0)     NOT NULL,
    PENDING_VAL_ID        NUMBER(10, 0)     NOT NULL,
    SET_DTM               DATE              NOT NULL,
    SET_BY_USER_SID       NUMBER(10, 0)     NOT NULL,
    DESCRIPTION           VARCHAR2(255)     NOT NULL,
    PARAM_1               VARCHAR2(4000),
    PARAM_2               VARCHAR2(4000),
    PARAM_3               VARCHAR2(4000),
    CONSTRAINT PK_PENDING_VAL_LOG PRIMARY KEY (PENDING_VAL_LOG_ID),
    CONSTRAINT FK_PENDING_VAL_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_ID                 NUMBER(10, 0)    NOT NULL,
    DELEGATION_SID           NUMBER(10, 0)    NOT NULL,
    START_DTM                DATE             NOT NULL,
    END_DTM                  DATE             NOT NULL,
    SUBMISSION_DTM           DATE             NOT NULL,
    REMINDER_DTM             DATE             NOT NULL,
    LAST_SHEET_HISTORY_ID    NUMBER(10, 0),
    IS_VISIBLE               NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CK_SHEET_DATES CHECK (START_DTM = TRUNC(START_DTM, 'MON') AND END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM),
    CONSTRAINT PK_SHEET PRIMARY KEY (SHEET_ID),
    CONSTRAINT FK_SHEET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_ALERT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_ID             NUMBER(10, 0)    NOT NULL,
    USER_SID             NUMBER(10, 0)    NOT NULL,
    REMINDER_SENT_DTM    DATE,
    OVERDUE_SENT_DTM     DATE,
    CONSTRAINT PK_SHEET_ALERT PRIMARY KEY (SHEET_ID, USER_SID),
    CONSTRAINT FK_SHEET_ALERT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_HISTORY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_HISTORY_ID     NUMBER(10, 0)    NOT NULL,
    SHEET_ID             NUMBER(10, 0)    NOT NULL,
    FROM_USER_SID        NUMBER(10, 0)    NOT NULL,
    TO_DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    ACTION_DTM           DATE             NOT NULL,
    NOTE                 CLOB,
    SHEET_ACTION_ID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SHEET_HISTORY PRIMARY KEY (SHEET_HISTORY_ID),
    CONSTRAINT FK_SHEET_HISTORY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_INHERITED_VALUE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID        NUMBER(10, 0)    NOT NULL,
    INHERITED_VALUE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SHEET_INHERITED_VALUE PRIMARY KEY (SHEET_VALUE_ID, INHERITED_VALUE_ID),
    CONSTRAINT FK_SHEET_INHERITED_VALUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID                 NUMBER(10, 0)     NOT NULL,
    SHEET_ID                       NUMBER(10, 0)     NOT NULL,
    IND_SID                        NUMBER(10, 0)     NOT NULL,
    REGION_SID                     NUMBER(10, 0)     NOT NULL,
    VAL_NUMBER                     NUMBER(24, 10),
    SET_BY_USER_SID                NUMBER(10, 0)     NOT NULL,
    SET_DTM                        DATE              NULL,
    NOTE                           CLOB,
    ENTRY_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    ENTRY_VAL_NUMBER               NUMBER(24, 10),
    IS_INHERITED                   NUMBER(10, 0)     NOT NULL,
    STATUS                         NUMBER(10, 0)     NOT NULL,
    LAST_SHEET_VALUE_CHANGE_ID     NUMBER(10, 0),
    ALERT                          VARCHAR2(255),
    FLAG                           NUMBER(10, 0),
    VAR_EXPL_NOTE                  VARCHAR2(2000),
    CONSTRAINT PK_SHEET_VALUE PRIMARY KEY (SHEET_VALUE_ID),
    CONSTRAINT FK_SHEET_VALUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_ACCURACY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID             NUMBER(10, 0)    NOT NULL,
    ACCURACY_TYPE_OPTION_ID    NUMBER(10, 0)    NOT NULL,
    PCT                        NUMBER(10, 4)    NOT NULL,
    CONSTRAINT PK_SHEET_VALUE_ACCURACY PRIMARY KEY (SHEET_VALUE_ID, ACCURACY_TYPE_OPTION_ID),
    CONSTRAINT FK_SHEET_VALUE_ACC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_CHANGE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_CHANGE_ID          NUMBER(10, 0)     NOT NULL,
    SHEET_VALUE_ID                 NUMBER(10, 0)     NOT NULL,
    IND_SID                        NUMBER(10, 0)     NOT NULL,
    REGION_SID                     NUMBER(10, 0)     NOT NULL,
    VAL_NUMBER                     NUMBER(24, 10),
    REASON                         VARCHAR2(1024),
    CHANGED_BY_SID                 NUMBER(10, 0)     NOT NULL,
    CHANGED_DTM                    DATE              NOT NULL,
    ENTRY_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    ENTRY_VAL_NUMBER               NUMBER(24, 10),
    NOTE                           CLOB,
    FLAG                           NUMBER(10, 0),
    CONSTRAINT PK_SHEET_VALUE_CHANGE PRIMARY KEY (SHEET_VALUE_CHANGE_ID),
    CONSTRAINT FK_SHEET_VALUE_CHANGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_VAR_EXPL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID    NUMBER(10, 0)    NOT NULL,
    VAR_EXPL_ID       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SHEET_VALUE_VAR_EXPL PRIMARY KEY (SHEET_VALUE_ID, VAR_EXPL_ID),
    CONSTRAINT FK_SHEET_VALUE_VAR_EXPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SHEET_VALUE_FILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SHEET_VALUE_ID     NUMBER(10, 0)    NOT NULL,
    FILE_UPLOAD_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SHEET_VALUE_FILE PRIMARY KEY (SHEET_VALUE_ID, FILE_UPLOAD_SID),
    CONSTRAINT FK_SHEET_VALUE_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_CONFLICT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_CONFLICT_ID         NUMBER(10, 0)    NOT NULL,
    IMP_SESSION_SID         NUMBER(10, 0)    NOT NULL,
    RESOLVED_BY_USER_SID    NUMBER(10, 0),
    START_DTM               DATE             NOT NULL,
    END_DTM                 DATE             NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    IND_SID                 NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IMP_CONFLICT PRIMARY KEY (IMP_CONFLICT_ID),
    CONSTRAINT FK_IMP_CONFLICT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_CONFLICT_VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_CONFLICT_ID    NUMBER(10, 0)    NOT NULL,
    IMP_VAL_ID         NUMBER(10, 0)    NOT NULL,
    ACCEPT             NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IMP_CONFLICT_VAL PRIMARY KEY (IMP_CONFLICT_ID, IMP_VAL_ID),
    CONSTRAINT FK_IMP_CONFLICT_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_IND_ID         NUMBER(10, 0)     NOT NULL,
    DESCRIPTION        VARCHAR2(1023)    NOT NULL,
    MAPS_TO_IND_SID    NUMBER(10, 0),
    IGNORE             NUMBER(1, 0)      NOT NULL,
    CONSTRAINT PK_IMP_IND PRIMARY KEY (IMP_IND_ID),
    CONSTRAINT FK_IMP_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_MEASURE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_MEASURE_ID                   NUMBER(10, 0)    NOT NULL,
    DESCRIPTION                      VARCHAR2(255)    NOT NULL,
    MAPS_TO_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    MAPS_TO_MEASURE_SID              NUMBER(10, 0),
    IMP_IND_ID                       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IMP_MEASURE PRIMARY KEY (IMP_MEASURE_ID),
    CONSTRAINT FK_IMP_MEASURE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_REGION_ID         NUMBER(10, 0)    NOT NULL,
    DESCRIPTION           VARCHAR2(255)    NOT NULL,
    MAPS_TO_REGION_SID    NUMBER(10, 0),
    IGNORE                NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_IMP_REGION PRIMARY KEY (IMP_REGION_ID),
    CONSTRAINT FK_IMP_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_SESSION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_SESSION_SID      NUMBER(10, 0)     NOT NULL,
    PARENT_SID           NUMBER(10, 0)     NOT NULL,
    NAME                 VARCHAR2(256),
    OWNER_SID            NUMBER(10, 0)     NOT NULL,
    UPLOADED_DTM         DATE,
    FILE_PATH            VARCHAR2(256)     NOT NULL,
    PARSE_STARTED_DTM    DATE,
    PARSED_DTM           DATE,
    MERGED_DTM           DATE,
    RESULT_CODE          NUMBER(10, 0),
    MESSAGE              VARCHAR2(2048),
    CONSTRAINT PK_IMP_SESSION PRIMARY KEY (IMP_SESSION_SID),
    CONSTRAINT FK_IMP_SESSION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IMP_VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMP_VAL_ID         NUMBER(10, 0)     NOT NULL,
    IMP_IND_ID         NUMBER(10, 0)     NOT NULL,
    IMP_REGION_ID      NUMBER(10, 0)     NOT NULL,
    IMP_MEASURE_ID     NUMBER(10, 0),
    UNKNOWN            VARCHAR2(2048),
    START_DTM          DATE              NOT NULL,
    END_DTM            DATE              NOT NULL,
    VAL                NUMBER(24, 10),
    FILE_SID           NUMBER(10, 0),
    A                  NUMBER(10, 0),
    B                  NUMBER(10, 0),
    C                  NUMBER(10, 0),
    IMP_SESSION_SID    NUMBER(10, 0)     NOT NULL,
    SET_VAL_ID         NUMBER(10, 0),
    NOTE               CLOB,
    CONSTRAINT CK_IMP_VAL_DATES CHECK (START_DTM = TRUNC(START_DTM, 'MON') AND END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM),
    CONSTRAINT CK_IMP_VAL_CONV_COMPLETED CHECK ((a is null and b is null and c is null) or (a is not null and b is not null and c is not null)),
    CONSTRAINT PK_IMP_VAL PRIMARY KEY (IMP_VAL_ID),
    CONSTRAINT FK_IMP_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FILE_UPLOAD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FILE_UPLOAD_SID      NUMBER(10, 0)    NOT NULL,
    FILENAME             VARCHAR2(255)    NOT NULL,
    MIME_TYPE            VARCHAR2(256)    NOT NULL,
    PARENT_SID           NUMBER(10, 0)    NOT NULL,
    DATA                 BLOB,
    SHA1                 RAW(20)          NOT NULL,
    LAST_MODIFIED_DTM    DATE             NOT NULL,
    CONSTRAINT PK_FILE_UPLOAD PRIMARY KEY (FILE_UPLOAD_SID),
    CONSTRAINT FK_FILE_UPLOAD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CALC_DEPENDENCY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID         NUMBER(10, 0)    NOT NULL,
    CALC_IND_SID    NUMBER(10, 0)    NOT NULL,
    DEP_TYPE        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_CALC_DEPENDENCY PRIMARY KEY (IND_SID, CALC_IND_SID, DEP_TYPE),
    CONSTRAINT FK_CALC_DEPENDENCY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IND_VALIDATION_RULE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_VALIDATION_RULE_ID    NUMBER(10, 0)     NOT NULL,
    IND_SID                   NUMBER(10, 0)     NOT NULL,
    EXPR                      VARCHAR2(2000)    NOT NULL,
    MESSAGE                   VARCHAR2(2000)    NOT NULL,
    POSITION                  NUMBER(10, 0)     NOT NULL,
    TYPE                      VARCHAR2(1)       NOT NULL,
    CONSTRAINT CHK_IND_VALID_RULE_TYPE CHECK (TYPE IN ('E','W','X')),
    CONSTRAINT PK_IND_VALIDATION_RULE PRIMARY KEY (IND_VALIDATION_RULE_ID),
    CONSTRAINT FK_IND_VAIDATION_RULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ROLE_GRANT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ROLE_SID          NUMBER(10, 0)    NOT NULL,
    GRANT_ROLE_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ROLE_GRANT PRIMARY KEY (ROLE_SID, GRANT_ROLE_SID),
    CONSTRAINT FK_ROLE_GRANT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


/*****************************************/
/******** OTHER DELEGATION STUFF *********/
/*****************************************/
CREATE TABLE CSRIMP.DELEGATION_GRID (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID            NUMBER(10, 0)    NOT NULL,
    NAME               VARCHAR2(255)    NOT NULL,
    PATH               VARCHAR2(255)    NOT NULL,
    HELPER_PKG         VARCHAR2(255),
    AGGREGATION_XML    SYS.XMLType,
    CONSTRAINT PK_DELEGATION_GRID PRIMARY KEY (IND_SID),
    CONSTRAINT FK_DELEGATION_GRID_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_GRID_AGGREGATE_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IND_SID                 NUMBER(10, 0)    NOT NULL,
    AGGREGATE_TO_IND_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEGATION_GRID_AGGR_IND PRIMARY KEY (IND_SID, AGGREGATE_TO_IND_SID),
    CONSTRAINT FK_DELEG_GRID_AGGR_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    ROLE_SID          NUMBER(10, 0)    NOT NULL,
    IS_READ_ONLY      NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_DELEGATION_ROLE PRIMARY KEY (DELEGATION_SID, ROLE_SID),
    CONSTRAINT FK_DELEGATION_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEGATION_IND_COND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID            NUMBER(10, 0)    NOT NULL,
    IND_SID                   NUMBER(10, 0)    NOT NULL,
    DELEGATION_IND_COND_ID    NUMBER(10, 0)    NOT NULL,
    EXPR                      VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK697 PRIMARY KEY (DELEGATION_SID, IND_SID, DELEGATION_IND_COND_ID),
    CONSTRAINT FK_DELEG_IND_COND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEGATION_IND_COND_ACTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID            NUMBER(10, 0)    NOT NULL,
    IND_SID                   NUMBER(10, 0)    NOT NULL,
    DELEGATION_IND_COND_ID    NUMBER(10, 0)    NOT NULL,
    ACTION                    VARCHAR2(255)    NOT NULL,
    TAG                       VARCHAR2(255)    NOT NULL
);


CREATE TABLE CSRIMP.DELEGATION_IND_TAG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    IND_SID           NUMBER(10, 0)    NOT NULL,
    TAG               VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK702 PRIMARY KEY (DELEGATION_SID, IND_SID, TAG),
    CONSTRAINT FK_DELEG_IND_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEGATION_IND_TAG_LIST (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    TAG               VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_DELEGATION_IND_TAG_LIST PRIMARY KEY (DELEGATION_SID, TAG),
    CONSTRAINT FK_DELEG_IND_TAG_LIST_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



/*****************************************/
/************** DELEG PLANS **************/
/*****************************************/
CREATE TABLE CSRIMP.DELEG_PLAN (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_SID     NUMBER(10, 0)     NOT NULL,
    NAME               VARCHAR2(1023)    NOT NULL,
    START_DTM          DATE              NOT NULL,
    END_DTM            DATE              NOT NULL,
    INTERVAL           VARCHAR2(10)      NOT NULL,
    REMINDER_OFFSET    NUMBER(10, 0)     NOT NULL,
    SCHEDULE_XML       CLOB              NOT NULL,
    NAME_TEMPLATE      VARCHAR2(1000),
    ACTIVE             NUMBER(1, 0)      NOT NULL,
    NOTES              CLOB,
    DYNAMIC            NUMBER(1, 0)      NOT NULL,
    CONSTRAINT CK_DELEG_TPL_DATES CHECK (START_DTM = TRUNC(START_DTM, 'MON') AND END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM),
    CONSTRAINT CHK_DELEG_PLAN_ACTIVE CHECK (ACTIVE IN (0,1)),
    CONSTRAINT CK_DYNAMIC CHECK (dynamic in (0,1)),
    CONSTRAINT PK890 PRIMARY KEY (DELEG_PLAN_SID),
    CONSTRAINT FK_DELEG_PLAN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEG_PLAN_APPLIED (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_APPLIED_ID    NUMBER(10, 0)    NOT NULL,
    DELEG_PLAN_SID           NUMBER(10, 0)    NOT NULL,
    APPLIED_BY_USER_SID      NUMBER(10, 0)    NOT NULL,
    APPLIED_DTM              DATE             NOT NULL,
    CONSTRAINT PK_DELEG_PLAN_LOG PRIMARY KEY (DELEG_PLAN_APPLIED_ID),
    CONSTRAINT FK_DELEG_PLAN_APPLIED_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



CREATE TABLE CSRIMP.DELEG_PLAN_COL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_ID           NUMBER(10, 0)    NOT NULL,
    DELEG_PLAN_SID              NUMBER(10, 0)    NOT NULL,
    IS_HIDDEN                   NUMBER(1, 0)     NOT NULL,
    DELEG_PLAN_COL_DELEG_ID     NUMBER(10, 0),
    DELEG_PLAN_COL_SURVEY_ID    NUMBER(10, 0),
    QS_CAMPAIGN_SID             NUMBER(10, 0),
    CONSTRAINT CHK_DELEG_PLAN_ENTITY_HIDDEN CHECK (IS_HIDDEN IN (0,1)),
    CONSTRAINT PK_DELEG_PLAN_COL PRIMARY KEY (DELEG_PLAN_COL_ID),
    CONSTRAINT FK_DELEG_PLAN_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_COL_DELEG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_DELEG_ID    NUMBER(10, 0)    NOT NULL,
    DELEGATION_SID             NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEG_PLAN_COL_DELEG PRIMARY KEY (DELEG_PLAN_COL_DELEG_ID),
    CONSTRAINT FK_DLG_PLAN_COL_DLG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEG_PLAN_COL_SURVEY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_SURVEY_ID    NUMBER(10, 0)    NOT NULL,
    SURVEY_SID                  NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_DELEG_PLAN_COL_SURVEY PRIMARY KEY (DELEG_PLAN_COL_SURVEY_ID, SURVEY_SID),
    CONSTRAINT UK_DELEG_PLAN_COL_SURVEY  UNIQUE (DELEG_PLAN_COL_SURVEY_ID),
    CONSTRAINT FK_DLG_PLAN_COL_SURVEY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_DELEG_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_DELEG_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID                 NUMBER(10, 0)    NOT NULL,
    PENDING_DELETION           NUMBER(1, 0)     NOT NULL,
    REGION_SELECTION           VARCHAR2(2)      NOT NULL,
    REGION_COLLATION           VARCHAR2(1)      NOT NULL,
    TAG_ID                     NUMBER(10, 0),
    CONSTRAINT CHK_DELEG_PLAN_DR_PENDING_DEL CHECK (PENDING_DELETION IN (0,1,2)),
    CONSTRAINT CHK_DLG_PLN_DLG_RGN_RS CHECK (REGION_SELECTION IN ('R','L','P','RT','LT','PT')),
    CONSTRAINT CHK_DLG_PLN_DLG_RGN_RC CHECK (REGION_COLLATION IN ('S','M')),
    CONSTRAINT PK_DELEG_PLAN_DELEG_REGION PRIMARY KEY (DELEG_PLAN_COL_DELEG_ID, REGION_SID),
    CONSTRAINT FK_DLG_PLN_DLG_REG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_DELEG_REGION_DELEG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_COL_DELEG_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID                 NUMBER(10, 0)    NOT NULL,
    APPLIED_TO_REGION_SID      NUMBER(10, 0)    NOT NULL,
    HAS_MANUAL_AMENDS          NUMBER(1, 0)     NOT NULL,
    MAPS_TO_ROOT_DELEG_SID     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT CK_DELGPLNDLGREGDELG_MAN_AMND CHECK (HAS_MANUAL_AMENDS IN (0,1)),
    CONSTRAINT PK_DLG_PLAN_DLG_REG_DLG PRIMARY KEY (DELEG_PLAN_COL_DELEG_ID, REGION_SID, APPLIED_TO_REGION_SID),
    CONSTRAINT FK_DLG_PLN_DLG_REG_DLG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.DELEG_PLAN_REGION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_SID    NUMBER(10, 0)    NOT NULL,
    REGION_SID        NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK894 PRIMARY KEY (DELEG_PLAN_SID, REGION_SID),
    CONSTRAINT FK_DLG_PLN_REG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_PLAN_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_PLAN_SID    NUMBER(10, 0)    NOT NULL,
    ROLE_SID          NUMBER(10, 0)    NOT NULL,
    POS               NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK891 PRIMARY KEY (DELEG_PLAN_SID, ROLE_SID),
    CONSTRAINT FK_DLG_PLN_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MASTER_DELEG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_MASTER_DELEG PRIMARY KEY (DELEGATION_SID),
    CONSTRAINT FK_MASTER_DELEG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


/************************************/
/************ IMG CHARTS ************/
/************************************/
CREATE TABLE CSRIMP.IMG_CHART (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMG_CHART_SID        NUMBER(10, 0)     NOT NULL,
    PARENT_SID           NUMBER(10, 0)     NOT NULL,
    LABEL                VARCHAR2(1023)    NOT NULL,
    MIME_TYPE            VARCHAR2(255)     NOT NULL,
    DATA                 BLOB              NOT NULL,
    SHA1                 RAW(20)           NOT NULL,
    LAST_MODIFIED_DTM    DATE              NOT NULL,
    CONSTRAINT PK_IMG_CHART PRIMARY KEY (IMG_CHART_SID),
    CONSTRAINT FK_IMG_CHART_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.IMG_CHART_IND (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMG_CHART_SID            NUMBER(10, 0)     NOT NULL,
    IND_SID                  NUMBER(10, 0)     NOT NULL,
    DESCRIPTION              VARCHAR2(1023),
    MEASURE_CONVERSION_ID    NUMBER(10, 0),
    X                        NUMBER(10, 0)     NOT NULL,
    Y                        NUMBER(10, 0)     NOT NULL,
    BACKGROUND_COLOR         NUMBER(10, 0)     NOT NULL,
    BORDER_COLOR             NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_IMG_CHART_IND PRIMARY KEY (IMG_CHART_SID, IND_SID),
    CONSTRAINT FK_IMG_CHART_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



CREATE TABLE CSRIMP.FORM_EXPR
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_EXPR_ID            NUMBER(10, 0) NOT NULL,
    DELEGATION_SID          NUMBER(10, 0) NOT NULL,
    DESCRIPTION             VARCHAR2(255 BYTE),
    EXPR                    SYS.XMLType NOT NULL,
    CONSTRAINT PK_FORM_EXPR PRIMARY KEY (FORM_EXPR_ID),
    CONSTRAINT FK_FORM_EXPR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_IND_FORM_EXPR
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID          NUMBER(10, 0) NOT NULL,
    IND_SID                 NUMBER(10, 0) NOT NULL,
    FORM_EXPR_ID            NUMBER(10, 0) NOT NULL,
    CONSTRAINT PK_DELEG_IND_FORM_EXPR PRIMARY KEY (DELEGATION_SID, IND_SID, FORM_EXPR_ID),
    CONSTRAINT FK_DELEG_IND_FORM_EXPR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_IND_GROUP
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEG_IND_GROUP_ID      NUMBER(10, 0) NOT NULL,
    DELEGATION_SID          NUMBER(10, 0) NOT NULL,
    TITLE                   VARCHAR2(255 BYTE),
    CONSTRAINT PK_DELEG_IND_GROUP PRIMARY KEY (DELEGATION_SID, DELEG_IND_GROUP_ID),
    CONSTRAINT FK_DELEG_IND_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEG_IND_GROUP_MEMBER
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DELEGATION_SID          NUMBER(10, 0) NOT NULL,
    IND_SID                 NUMBER(10, 0) NOT NULL,
    DELEG_IND_GROUP_ID      NUMBER(10, 0) NOT NULL,
    CONSTRAINT PK_DEL_IND_DEL_IND_GROUP PRIMARY KEY (DELEGATION_SID, IND_SID, DELEG_IND_GROUP_ID),
    CONSTRAINT FK_DELEG_IND_GRP_MEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FACTOR
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FACTOR_ID                    NUMBER(10, 0)     NOT NULL,
    FACTOR_TYPE_ID               NUMBER(10, 0)     NOT NULL,
    GAS_TYPE_ID                  NUMBER(10, 0)     NOT NULL,
    REGION_SID                   NUMBER(10, 0),
    GEO_COUNTRY                  VARCHAR2(2),
    GEO_REGION                   VARCHAR2(2),
    EGRID_REF                    VARCHAR2(4),
    IS_SELECTED                  NUMBER(1, 0)      NOT NULL,
    START_DTM                    DATE              NOT NULL,
    END_DTM                      DATE,
    VALUE                        NUMBER(24, 10)    NOT NULL,
    NOTE                         CLOB,
    STD_MEASURE_CONVERSION_ID    NUMBER(10, 0)     NOT NULL,
    STD_FACTOR_ID                NUMBER(10, 0),
    ORIGINAL_FACTOR_ID           NUMBER(10, 0),
    CONSTRAINT CK_FACTOR_DATES CHECK ((START_DTM = TRUNC(START_DTM, 'MON') AND END_DTM = TRUNC(END_DTM, 'MON') AND END_DTM > START_DTM)),
    CONSTRAINT PK_FACTOR PRIMARY KEY (FACTOR_ID),
    CONSTRAINT FK_FACTOR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.DELEGATION_IND_DESCRIPTION
 (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	DELEGATION_SID				 	NUMBER(10, 0) 		NOT NULL,
	IND_SID							NUMBER(10, 0)		NOT NULL,
	LANG 							VARCHAR2(10) 		NOT NULL,
	DESCRIPTION						VARCHAR2(1023) 		NOT NULL,
	CONSTRAINT PK_DELEGATION_IND_DESCRIPTION PRIMARY KEY (DELEGATION_SID, IND_SID, LANG),
    CONSTRAINT FK_DELEG_IND_DESC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAR_EXPL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    VAR_EXPL_ID          NUMBER(10, 0)    NOT NULL,
    VAR_EXPL_GROUP_ID    NUMBER(10, 0)    NOT NULL,
    LABEL                VARCHAR2(255)    NOT NULL,
    REQUIRES_NOTE        NUMBER(1, 0)     NOT NULL,
    POS                  NUMBER(10, 0),
    HIDDEN 				 NUMBER(1) DEFAULT 0 NOT NULL,
    CONSTRAINT CHK_REQUIRES_NOTE CHECK (REQUIRES_NOTE IN (0,1)),
    CONSTRAINT PK_VAR_EXPL PRIMARY KEY (VAR_EXPL_ID),
    CONSTRAINT CK_VAR_EXPL_HIDDEN CHECK (HIDDEN IN (0,1)),
    CONSTRAINT FK_VAR_EXPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.VAR_EXPL_GROUP (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    VAR_EXPL_GROUP_ID    NUMBER(10, 0)    NOT NULL,
    LABEL                VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_VAR_EXPL_GROUP PRIMARY KEY (VAR_EXPL_GROUP_ID),
    CONSTRAINT FK_VAR_EXPL_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACCOUNT_POLICY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                         NUMBER(10, 0)    NOT NULL,
    MAX_LOGON_FAILURES             NUMBER(10, 0),
    EXPIRE_INACTIVE                NUMBER(10, 0),
    MAX_PASSWORD_AGE               NUMBER(10, 0),
    REMEMBER_PREVIOUS_PASSWORDS    NUMBER(10, 0),
    REMEMBER_PREVIOUS_DAYS         NUMBER(10, 0),
    SINGLE_SESSION                 NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK_ACCOUNT_POLICY PRIMARY KEY (SID_ID),
    CONSTRAINT FK_ACCOUNT_POLICY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PASSWORD_REGEXP  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
  APPLICATION_SID_ID    NUMBER(10,0),
  PASSWORD_REGEXP_ID    NUMBER(10,0) NOT NULL,
  REGEXP                VARCHAR2(256) NOT NULL,
  DESCRIPTION           VARCHAR2(2000) NOT NULL,
  CONSTRAINT PK_PWD_REGEX PRIMARY KEY (PASSWORD_REGEXP_ID),
    CONSTRAINT FK_PASSWORD_REGEXP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACC_POLICY_PWD_REGEXP  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
  ACCOUNT_POLICY_SID     NUMBER(10,0) NOT NULL,
  PASSWORD_REGEXP_ID    NUMBER(10,0) NOT NULL,
  CONSTRAINT PK_ACC_POLICY_PWD_REGEXP PRIMARY KEY(ACCOUNT_POLICY_SID, PASSWORD_REGEXP_ID),
    CONSTRAINT FK_ACC_POL_PWD_REG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ACL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ACL_ID            NUMBER(10, 0)    NOT NULL,
    ACL_INDEX         NUMBER(10, 0)    NOT NULL,
    ACE_TYPE          NUMBER(10, 0)    NOT NULL,
    ACE_FLAGS         NUMBER(10, 0)    NOT NULL,
    SID_ID            NUMBER(10, 0)    NOT NULL,
    PERMISSION_SET    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ACL PRIMARY KEY (ACL_ID, ACL_INDEX),
    CONSTRAINT FK_ACL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.APPLICATION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    APPLICATION_SID_ID    NUMBER(10, 0)    NOT NULL,
    EVERYONE_SID_ID       NUMBER(10, 0)    NOT NULL,
    LANGUAGE              VARCHAR2(20),
    CULTURE               VARCHAR2(20),
    TIMEZONE              VARCHAR2(100),
    CONSTRAINT PK_APPLICATION PRIMARY KEY (APPLICATION_SID_ID),
    CONSTRAINT FK_APPLICATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ATTRIBUTES (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ATTRIBUTE_ID    NUMBER(10, 0)    NOT NULL,
    CLASS_ID        NUMBER(10, 0)    NOT NULL,
    NAME            VARCHAR2(255),
    FLAGS           NUMBER(10, 0)    NOT NULL,
    EXTERNAL_PKG    VARCHAR2(255),
    CONSTRAINT PK_ATTRIBUTES PRIMARY KEY (ATTRIBUTE_ID),
    CONSTRAINT FK_ATTRIBUTES_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.HOME_PAGE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID     NUMBER(10, 0)    NOT NULL,
    URL        VARCHAR2(900)    NOT NULL,
    CONSTRAINT PK_HOME_PAGE PRIMARY KEY (SID_ID),
    CONSTRAINT FK_HOME_PAGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IP_RULE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IP_RULE_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_IP_RULE PRIMARY KEY (IP_RULE_ID),
    CONSTRAINT FK_IP_RULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.IP_RULE_ENTRY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IP_RULE_ID       NUMBER(10, 0)    NOT NULL,
    IP_RULE_INDEX    NUMBER(10, 0)    NOT NULL,
    IPV4_ADDRESS     NUMBER(10, 0),
    IPV4_BITMASK     NUMBER(10, 0),
    REQUIRE_SSL      NUMBER(1, 0),
    ALLOW            NUMBER(1, 0),
    CONSTRAINT PK_IP_RULE_ENTRY PRIMARY KEY (IP_RULE_ID, IP_RULE_INDEX),
    CONSTRAINT FK_IP_RULE_ENTRY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERMISSION_MAPPING (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PARENT_CLASS_ID      NUMBER(10, 0)    NOT NULL,
    PARENT_PERMISSION    NUMBER(10, 0)    NOT NULL,
    CHILD_CLASS_ID       NUMBER(10, 0)    NOT NULL,
    CHILD_PERMISSION     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_PERMISSION_MAPPING PRIMARY KEY (PARENT_CLASS_ID, PARENT_PERMISSION, CHILD_CLASS_ID, CHILD_PERMISSION),
    CONSTRAINT FK_PERMISSION_MAPPING_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.PERMISSION_NAME (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CLASS_ID           NUMBER(10, 0)    NOT NULL,
    PERMISSION         NUMBER(10, 0)    NOT NULL,
    PERMISSION_NAME    VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_PERMISSION_NAME PRIMARY KEY (CLASS_ID, PERMISSION),
    CONSTRAINT FK_PERMISSION_NAME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECURABLE_OBJECT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                NUMBER(10, 0)    NOT NULL,
    PARENT_SID_ID         NUMBER(10, 0),
    DACL_ID               NUMBER(10, 0),
    CLASS_ID              NUMBER(10, 0)    NOT NULL,
    NAME                  VARCHAR2(255),
    FLAGS                 NUMBER(10, 0),
    OWNER                 NUMBER(10, 0),
    LINK_SID_ID           NUMBER(10, 0),
    APPLICATION_SID_ID    NUMBER(10, 0),
    CONSTRAINT PK_SECURABLE_OBJECT PRIMARY KEY (SID_ID),
    CONSTRAINT FK_SECURABLE_OBJECT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECURABLE_OBJECT_ATTRIBUTES (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID          NUMBER(10, 0)     NOT NULL,
    ATTRIBUTE_ID    NUMBER(10, 0)     NOT NULL,
    STRING_VALUE    VARCHAR2(511),
    NUMBER_VALUE    NUMBER(36, 10),
    DATE_VALUE      DATE,
    BLOB_VALUE      BLOB,
    ISOBJECT        NUMBER(1, 0),
    CLOB_VALUE      CLOB,
    CONSTRAINT PK_SEC_OBJ_ATTRIBUTES PRIMARY KEY (SID_ID, ATTRIBUTE_ID),
    CONSTRAINT FK_SEC_OBJ_ATTR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECURABLE_OBJECT_CLASS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CLASS_ID           NUMBER(10, 0)    NOT NULL,
    CLASS_NAME         VARCHAR2(255)    NOT NULL,
    HELPER_PKG         VARCHAR2(255),
    HELPER_PROG_ID     VARCHAR2(255),
    PARENT_CLASS_ID    NUMBER(10, 0),
    CONSTRAINT PK_SECURABLE_OBJECT_CLASS PRIMARY KEY (CLASS_ID),
    CONSTRAINT FK_SEC_OBJECT_CLASS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SECURABLE_OBJECT_KEYED_ACL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID    NUMBER(10, 0)    NOT NULL,
    KEY_ID    NUMBER(10, 0)    NOT NULL,
    ACL_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_SECURABLE_OBJECT_KEYED_ACL PRIMARY KEY (SID_ID, KEY_ID, ACL_ID),
    CONSTRAINT FK_SEC_OBJECT_KEYED_ACL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.GROUP_MEMBERS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    GROUP_SID_ID     NUMBER(10, 0)    NOT NULL,
    MEMBER_SID_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_GROUP_MEMBERS PRIMARY KEY (GROUP_SID_ID, MEMBER_SID_ID),
    CONSTRAINT FK_GROUP_MEMBERS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.GROUP_TABLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID        NUMBER(10, 0)    NOT NULL,
    GROUP_TYPE    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_GROUP_TABLE PRIMARY KEY (SID_ID),
    CONSTRAINT FK_GROUP_TABLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MENU (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID         NUMBER(10, 0)     NOT NULL,
    DESCRIPTION    VARCHAR2(1000)    NOT NULL,
    ACTION         VARCHAR2(2000)    NOT NULL,
    POS            NUMBER(10, 0)     NOT NULL,
    CONTEXT        NUMBER(10, 0),
    CONSTRAINT PK_MENU PRIMARY KEY (SID_ID),
    CONSTRAINT FK_MENU_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_CERTIFICATES (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID          NUMBER(10, 0)    NOT NULL,
    CERT_HASH       RAW(64)          NOT NULL,
    CERT            BLOB             NOT NULL,
    WEBSITE_NAME    VARCHAR2(256),
    CONSTRAINT PK_USER_CERTIFICATES PRIMARY KEY (SID_ID, CERT_HASH),
    CONSTRAINT FK_USER_CERTIFICATES_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_PASSWORD_HISTORY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                 NUMBER(10, 0)    NOT NULL,
    SERIAL                 NUMBER(10, 0)    NOT NULL,
    LOGIN_PASSWORD         VARCHAR2(127),
    LOGIN_PASSWORD_SALT    NUMBER(10, 0),
    RETIRED_DTM            DATE             NOT NULL,
    CONSTRAINT PK_USER_PASSWORD_HISTORY PRIMARY KEY (SID_ID, SERIAL),
    CONSTRAINT FK_USER_PASS_HIST_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.USER_TABLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                   NUMBER(10, 0)    NOT NULL,
    LOGIN_PASSWORD           VARCHAR2(127),
    LOGIN_PASSWORD_SALT      NUMBER(10, 0),
    ACCOUNT_ENABLED          NUMBER(1, 0)     NOT NULL
                             CHECK (ACCOUNT_ENABLED IN (0,1)),
    LAST_PASSWORD_CHANGE     DATE             NOT NULL,
    LAST_LOGON               DATE             NOT NULL,
    LAST_BUT_ONE_LOGON       DATE             NOT NULL,
    FAILED_LOGON_ATTEMPTS    NUMBER(10, 0)    NOT NULL,
    EXPIRATION_DTM           DATE,
    LANGUAGE                 VARCHAR2(20),
    CULTURE                  VARCHAR2(20),
    TIMEZONE                 VARCHAR2(100),
    CONSTRAINT PK_USER_TABLE PRIMARY KEY (SID_ID),
    CONSTRAINT FK_USER_TABLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WEB_RESOURCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    WEB_ROOT_SID_ID    NUMBER(10, 0)    NOT NULL,
    PATH               VARCHAR2(900)    NOT NULL,
    SID_ID             NUMBER(10, 0)    NOT NULL,
    IP_RULE_ID         NUMBER(10, 0),
    REWRITE_PATH       VARCHAR2(900),
    CONSTRAINT PK_WEB_RESOURCE PRIMARY KEY (WEB_ROOT_SID_ID, PATH),
    CONSTRAINT FK_WEB_RESOURCE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.WEBSITE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    WEBSITE_NAME          VARCHAR2(256)    NOT NULL,
    SERVER_GROUP          VARCHAR2(256),
    WEB_ROOT_SID_ID       NUMBER(10, 0)    NOT NULL,
    DENIED_PAGE           VARCHAR2(256)    NOT NULL,
    ACT_TIMEOUT           NUMBER(10, 0)    NOT NULL,
    CERT_ACT_TIMEOUT      NUMBER(10, 0)    NOT NULL,
    SECURE_ONLY           NUMBER(1, 0)     NOT NULL
                          CHECK (SECURE_ONLY IN (0, 1)),
    HTTP_ONLY_COOKIES     NUMBER(1, 0)     NOT NULL
                          CHECK (HTTP_ONLY_COOKIES IN (0, 1)),
    XSRF_CHECK_ENABLED    NUMBER(1, 0)     NOT NULL
                          CHECK (XSRF_CHECK_ENABLED IN (0, 1)),
    APPLICATION_SID_ID    NUMBER(10, 0)    NOT NULL,
    PROXY_SECURE          NUMBER(1, 0)     NOT NULL
                          CHECK (PROXY_SECURE IN (0, 1)),
    IP_RULE_ID            NUMBER(10, 0),
    CONSTRAINT FK_WEBSITE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.KNOWN_SO (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SID_ID					NUMBER(10) NOT NULL,
	PATH					VARCHAR2(4000) NOT NULL,
	CONSTRAINT PK_KNOWN_SO PRIMARY KEY (SID_ID),
    CONSTRAINT FK_KNOWN_SO_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.MAIL_ACCOUNT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ACCOUNT_SID         NUMBER(10, 0)    NOT NULL,
    EMAIL_ADDRESS       VARCHAR2(255)    NOT NULL,
    ROOT_MAILBOX_SID    NUMBER(10, 0),
    INBOX_SID           NUMBER(10, 0),
    PASSWORD            VARCHAR2(255),
    PASSWORD_SALT       NUMBER(10, 0),
    APOP_SECRET         VARCHAR2(255),
    DESCRIPTION         VARCHAR2(511),
    CONSTRAINT PK_ACCOUNT PRIMARY KEY (ACCOUNT_SID),
    CONSTRAINT FK_MAIL_ACCOUNT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MAILBOX (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MAILBOX_SID                    NUMBER(10, 0)    NOT NULL,
    PARENT_SID                     NUMBER(10, 0),
    LINK_TO_MAILBOX_SID            NUMBER(10, 0),
    MAILBOX_NAME                   VARCHAR2(255)    NOT NULL,
    LAST_MESSAGE_UID               NUMBER(38, 0)    NOT NULL,
    FLAGS_SERIAL                   NUMBER(10, 0)    NOT NULL,
    INSERT_SERIAL                  NUMBER(10, 0)    NOT NULL,
    DELETE_SERIAL                  NUMBER(10, 0)    NOT NULL,
    FILTER_DUPLICATE_MESSAGE_ID    NUMBER(1, 0)     NOT NULL
                                   CHECK (FILTER_DUPLICATE_MESSAGE_ID IN (0,1)),
    CONSTRAINT PK_MAILBOX PRIMARY KEY (MAILBOX_SID),
    CONSTRAINT FK_MAIL_MAILBOX_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MESSAGE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MAILBOX_SID        NUMBER(10, 0)    NOT NULL,
    MESSAGE_UID        NUMBER(10, 0)    NOT NULL,
    PARENT_SID         NUMBER(10, 0),
    FLAGS              NUMBER(10, 0)    NOT NULL,
    SUBJECT            VARCHAR2(255),
    MESSAGE_DTM        DATE,
    MESSAGE_ID         VARCHAR2(255),
    IN_REPLY_TO        VARCHAR2(255),
    PRIORITY           NUMBER(1, 0),
    HAS_ATTACHMENTS    NUMBER(1, 0)     NOT NULL,
    RECEIVED_DTM       DATE             NOT NULL,
    BODY               BLOB,
    CONSTRAINT PK_MESSAGE PRIMARY KEY (MAILBOX_SID, MESSAGE_UID),
    CONSTRAINT FK_MAIL_MESSAGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MESSAGE_ADDRESS_FIELD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MAILBOX_SID    NUMBER(10, 0)    NOT NULL,
    MESSAGE_UID    NUMBER(10, 0)    NOT NULL,
    FIELD_ID       NUMBER(10, 0)    NOT NULL,
    POSITION       NUMBER(10, 0)    NOT NULL,
    ADDRESS        VARCHAR2(255),
    NAME           VARCHAR2(255),
    CONSTRAINT PK_MESSAGE_ADDRESS_FIELD PRIMARY KEY (MAILBOX_SID, MESSAGE_UID, FIELD_ID, POSITION),
    CONSTRAINT FK_MAIL_MSG_ADDR_FLD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAIL_MESSAGE_HEADER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    MAILBOX_SID    NUMBER(10, 0)     NOT NULL,
    MESSAGE_UID    NUMBER(10, 0)     NOT NULL,
    POSITION       NUMBER(10, 0)     NOT NULL,
    NAME           VARCHAR2(255)     NOT NULL,
    VALUE          VARCHAR2(1023),
    CONSTRAINT PK_MESSAGE_HEADER PRIMARY KEY (MAILBOX_SID, MESSAGE_UID, POSITION),
    CONSTRAINT FK_MAIL_MESSAGE_HEADER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.SO_RENAME (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID                NUMBER(10, 0)    NOT NULL,
    NAME                  VARCHAR2(255),
    CONSTRAINT FK_SO_RENAME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CORRESPONDENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CORRESPONDENT_ID    NUMBER(10, 0)     NOT NULL,
    FULL_NAME           VARCHAR2(255)     NOT NULL,
    EMAIL               VARCHAR2(255),
    PHONE               VARCHAR2(255),
    GUID                RAW(16)           NOT NULL,
    MORE_INFO_1         VARCHAR2(1000),
    CONSTRAINT PK_CORRESPONDENT PRIMARY KEY (CORRESPONDENT_ID),
    CONSTRAINT FK_CORRESPONDENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_SID            NUMBER(10, 0)    NOT NULL,
    LABEL               VARCHAR2(255)    NOT NULL,
    DEFAULT_STATE_ID    NUMBER(10, 0)	 NOT NULL,
    HELPER_PKG          VARCHAR2(255),
    CONSTRAINT PK_FLOW PRIMARY KEY (FLOW_SID),
    CONSTRAINT FK_FLOW_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.FLOW_ALERT_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CUSTOMER_ALERT_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_SID                  NUMBER(10, 0)    NOT NULL,
    LABEL                     VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_FLOW_ALERT_TYPE PRIMARY KEY (CUSTOMER_ALERT_TYPE_ID),
    CONSTRAINT UK_FLOW_ALERT_TYPE  UNIQUE (CUSTOMER_ALERT_TYPE_ID, FLOW_SID),
    CONSTRAINT FK_FLOW_ALERT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_ITEM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_ITEM_ID             NUMBER(10, 0)    NOT NULL,
    FLOW_SID                 NUMBER(10, 0)    NOT NULL,
    CURRENT_STATE_ID         NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID       NUMBER(10, 0),
    DASHBOARD_INSTANCE_ID    NUMBER(10, 0),
    CONSTRAINT PK_FLOW_ITEM PRIMARY KEY (FLOW_ITEM_ID),
    CONSTRAINT FK_FLOW_ITEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_ITEM_ALERT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_ITEM_ALERT_ID          NUMBER(10, 0)    NOT NULL,
    FLOW_ITEM_ID                NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_LOG_ID           NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    CUSTOMER_ALERT_TYPE_ID      NUMBER(10, 0)    NOT NULL,
    PROCESSED_DTM               DATE,
    CONSTRAINT PK_FLOW_ITEM_ALERT PRIMARY KEY (FLOW_ITEM_ALERT_ID),
    CONSTRAINT FK_FLOW_ITEM_ALERT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_ID     NUMBER(10, 0)    NOT NULL,
    FLOW_SID          NUMBER(10, 0)    NOT NULL,
    LABEL             VARCHAR2(255)    NOT NULL,
    LOOKUP_KEY        VARCHAR2(255),
    ATTRIBUTES_XML    SYS.XMLType,
    IS_DELETED        NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CHK_FLOW_STATE_DELETED CHECK (IS_DELETED IN (0,1)),
    CONSTRAINT PK_FLOW_STATE PRIMARY KEY (FLOW_STATE_ID),
    CONSTRAINT CONS_FLOW_STATE  UNIQUE (FLOW_STATE_ID, FLOW_SID),
    CONSTRAINT FK_FLOW_STATE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_LOG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_LOG_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_ITEM_ID         NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_ID        NUMBER(10, 0)    NOT NULL,
    SET_BY_USER_SID      NUMBER(10, 0)    NOT NULL,
    SET_DTM              DATE             NOT NULL,
    COMMENT_TEXT         CLOB,
    CONSTRAINT PK_FLOW_STATE_LOG PRIMARY KEY (FLOW_STATE_LOG_ID),
    CONSTRAINT UK_FLOW_STATE_LOG  UNIQUE (FLOW_STATE_LOG_ID, FLOW_ITEM_ID),
    CONSTRAINT FK_FLOW_STATE_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_LOG_FILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_LOG_FILE_ID    NUMBER(10, 0)    NOT NULL,
    FLOW_STATE_LOG_ID         NUMBER(10, 0)    NOT NULL,
    FILENAME                  VARCHAR2(255)    NOT NULL,
    MIME_TYPE                 VARCHAR2(256)    NOT NULL,
    DATA                      BLOB             NOT NULL,
    SHA1                      RAW(20)          NOT NULL,
    UPLOADED_DTM              DATE             NOT NULL,
    CONSTRAINT PK_FLOW_STATE_LOG_FILE PRIMARY KEY (FLOW_STATE_LOG_FILE_ID),
    CONSTRAINT FK_FLOW_ST_LOG_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_ID    NUMBER(10, 0)    NOT NULL,
    ROLE_SID         NUMBER(10, 0)    NOT NULL,
    IS_EDITABLE      NUMBER(1, 0)     NOT NULL,
    CONSTRAINT CHK_FLOW_STATE_ROLE_EDIT CHECK (IS_EDITABLE IN (0,1)),
    CONSTRAINT PK_FLOW_STATE_ROLE PRIMARY KEY (FLOW_STATE_ID, ROLE_SID),
    CONSTRAINT FK_FLOW_STATE_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_TRANS_HELPER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_SID     NUMBER(10, 0)    NOT NULL,
    HELPER_SP    VARCHAR2(255)    NOT NULL,
    LABEL        VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_FLOW_STATE_TRANS_HELPER PRIMARY KEY (FLOW_SID, HELPER_SP),
    CONSTRAINT FK_FLOW_ST_TRANS_HELP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_TRANSITION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    FROM_STATE_ID               NUMBER(10, 0)    NOT NULL,
    TO_STATE_ID                 NUMBER(10, 0)    NOT NULL,
    FLOW_SID                    NUMBER(10, 0)    NOT NULL,
    VERB                        VARCHAR2(255)    NOT NULL,
    ASK_FOR_COMMENT             VARCHAR2(16)     NOT NULL,
    POS                         NUMBER(10, 0)    NOT NULL,
    ATTRIBUTES_XML              SYS.XMLType,
    HELPER_SP                   VARCHAR2(255),
    LOOKUP_KEY                  VARCHAR2(255),
    MANDATORY_FIELDS_MESSAGE    VARCHAR2(255),
    BUTTON_ICON_PATH            VARCHAR2(255)    NOT NULL,
    CHECK (ASK_FOR_COMMENT IN ('none','required','optional')),
    CONSTRAINT PK_FLOW_STATE_TRANSITION PRIMARY KEY (FLOW_STATE_TRANSITION_ID),
    CONSTRAINT UK_FLOW_STATE_TRANSITION  UNIQUE (FROM_STATE_ID, TO_STATE_ID),
    CONSTRAINT UK_FLOW_STATE_TRANS_FROM  UNIQUE (FLOW_STATE_TRANSITION_ID, FROM_STATE_ID),
    CONSTRAINT FK_FLOW_STATE_TRANS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_STATE_TRANSITION_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    FROM_STATE_ID               NUMBER(10, 0)    NOT NULL,
    ROLE_SID                    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FLOW_STATE_TRANS_ROLE PRIMARY KEY (FLOW_STATE_TRANSITION_ID, FROM_STATE_ID, ROLE_SID),
    CONSTRAINT FK_FL_ST_TRANS_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    CUSTOMER_ALERT_TYPE_ID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FLOW_TRANSITION_ALERT PRIMARY KEY (FLOW_STATE_TRANSITION_ID, CUSTOMER_ALERT_TYPE_ID),
    CONSTRAINT FK_FL_TRANS_ALERT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.FLOW_TRANSITION_ALERT_ROLE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FLOW_STATE_TRANSITION_ID    NUMBER(10, 0)    NOT NULL,
    CUSTOMER_ALERT_TYPE_ID      NUMBER(10, 0)    NOT NULL,
    ROLE_SID                    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_FLOW_TRANS_ALERT_ROLE PRIMARY KEY (FLOW_STATE_TRANSITION_ID, CUSTOMER_ALERT_TYPE_ID, ROLE_SID),
    CONSTRAINT FK_FL_TRANS_ALERT_ROLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.CMS_APP_SCHEMA  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ORACLE_SCHEMA VARCHAR2(30) NOT NULL,
    CONSTRAINT PK_APP_SCHEMA PRIMARY KEY (ORACLE_SCHEMA),
    CONSTRAINT FK_CMS_APP_SCHEMA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_APP_SCHEMA_TABLE  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ORACLE_SCHEMA VARCHAR2(30) NOT NULL,
    ORACLE_TABLE VARCHAR2(30) NOT NULL,
    CONSTRAINT PK_APP_SCHEMA_TABLE PRIMARY KEY (ORACLE_SCHEMA, ORACLE_TABLE),
    CONSTRAINT FK_CMS_APP_SCHEMA_TABLE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

/* 
XXX: no app_sid -- but needed for cms editor

CREATE TABLE CSRIMP.CMS_CONTEXT  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CONTEXT_ID NUMBER(10) NOT NULL,
    PARENT_CONTEXT_ID NUMBER(10),
    CONSTRAINT FK_CMS_CONTEXT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FAST_CONTEXT  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CONTEXT_ID NUMBER(10) NOT NULL,
    PARENT_CONTEXT_ID NUMBER(10) NOT NULL,
    CONSTRAINT PK_FAST_CONTEXT PRIMARY KEY (CONTEXT_ID, PARENT_CONTEXT_ID),
    CONSTRAINT FK_CMS_FAST_CONTEXT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);
*/

CREATE TABLE CSRIMP.CMS_IMAGE  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    IMAGE_ID NUMBER(10) NOT NULL,
    MIME_TYPE VARCHAR2(100) NOT NULL,
    SHA1 RAW(20) NOT NULL,
    FILENAME VARCHAR2(200) NOT NULL,
    DESCRIPTION VARCHAR2(1000),
    DATA BLOB NOT NULL,
    MODIFIED_DTM TIMESTAMP,
    WIDTH NUMBER(10),
    HEIGHT NUMBER(10),
    RECYCLED NUMBER(1) NOT NULL,
    CONSTRAINT PK_IMAGE PRIMARY KEY (IMAGE_ID),
    CHECK (RECYCLED IN (0,1)),
    CONSTRAINT FK_CMS_IMAGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


/*
XXX: no app sid -- but needed for cms editor

CREATE TABLE CSRIMP.CMS_SECURABLE_OBJECT_WHITELIST  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SID_ID NUMBER(10) NOT NULL,
    CONSTRAINT PK_SECURABLE_OBJECT_WHITELIST PRIMARY KEY (SID_ID),
    CONSTRAINT FK_CMS_CK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);
*/

CREATE TABLE CSRIMP.CMS_CK_CONS  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CK_CONS_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    SEARCH_CONDITION CLOB,
    CONSTRAINT PK_CK_CONS PRIMARY KEY (CK_CONS_ID),
    CONSTRAINT FK_CMS_CK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_CK_CONS_COL  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    CK_CONS_ID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    CONSTRAINT PK_CK_CONS_COL PRIMARY KEY (CK_CONS_ID, COLUMN_SID),
    CONSTRAINT FK_CMS_CK_CONS_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_DISPLAY_TEMPLATE  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    DISPLAY_TEMPLATE_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10),
    TEMPLATE_URL VARCHAR2(500) NOT NULL,
    PRIORITY NUMBER(10) NOT NULL,
    NAME VARCHAR2(1000) NOT NULL,
    DESCRIPTION VARCHAR2(2000),
    CONSTRAINT PK_DISPLAY_TEMPLATE PRIMARY KEY (DISPLAY_TEMPLATE_ID),
    CONSTRAINT FK_CMS_DISPLAY_TPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FILTER  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FILTER_SID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    NAME VARCHAR2(500) NOT NULL,
    USER_SID NUMBER(10),
    FILTER_XML XMLTYPE NOT NULL,
    IS_ACTIVE_SESSION_FILTER NUMBER(1) NOT NULL,
    CONSTRAINT PK_FILTER PRIMARY KEY (FILTER_SID),
    CONSTRAINT FK_CMS_FILTER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FK_CONS  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FK_CONS_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    R_CONS_ID NUMBER(10) NOT NULL,
    DELETE_RULE VARCHAR2(1) NOT NULL,
    CONSTRAINT PK_FK_CONS PRIMARY KEY (FK_CONS_ID),
    CHECK (delete_rule in ('R','C','N')),
    CONSTRAINT FK_CMS_FK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FK_CONS_COL  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FK_CONS_ID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    POS NUMBER(10) NOT NULL,
    CONSTRAINT PK_FK_CONS_COL PRIMARY KEY (FK_CONS_ID, COLUMN_SID),
    CONSTRAINT FK_CMS_FK_CONS_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FORM  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FORM_SID NUMBER(10) NOT NULL,
    DESCRIPTION VARCHAR2(2000) NOT NULL,
    FORM_XML XMLTYPE NOT NULL,
    PARENT_TAB_SID NUMBER(10),
    CONSTRAINT PK_CMS_FORM PRIMARY KEY (FORM_SID),
    CONSTRAINT FK_CMS_FORM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_IMAGE_TAG  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    PARENT_TAG_ID NUMBER(10) NOT NULL,
    IMAGE_ID NUMBER(10) NOT NULL,
    CONSTRAINT PK_IMAGE_TAG PRIMARY KEY (PARENT_TAG_ID, IMAGE_ID),
    CONSTRAINT FK_CMS_IMAGE_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_LINK_TRACK  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ITEM_ID NUMBER(10) NOT NULL,
    CONTEXT_ID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10),
    PATH VARCHAR2(1000) NOT NULL,
    QUERY_STRING VARCHAR2(2000),
    CONSTRAINT FK_CMS_LINK_TRACK_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    ORACLE_SCHEMA VARCHAR2(30) NOT NULL,
    ORACLE_TABLE VARCHAR2(30) NOT NULL,
    DESCRIPTION VARCHAR2(2000),
    FORMAT_SQL VARCHAR2(500),
    PK_CONS_ID NUMBER(10),
    MANAGED NUMBER(1) NOT NULL,
    AUTO_REGISTERED NUMBER(1) NOT NULL,
    CMS_EDITOR NUMBER(10) NOT NULL,
    ISSUES NUMBER(1) NOT NULL,
    FLOW_SID NUMBER(10),
    CONSTRAINT PK_TAB PRIMARY KEY (TAB_SID),
    CHECK (CMS_EDITOR IN (0,1)),
    CHECK (managed in (0,1)),
    CHECK (auto_registered in (0,1)),
    CHECK (ISSUES IN (0,1)),
    CONSTRAINT FK_CMS_TAB_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_COLUMN  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10),
    ORACLE_COLUMN VARCHAR2(30) NOT NULL,
    DESCRIPTION VARCHAR2(2000),
    POS NUMBER(10) NOT NULL,
    COL_TYPE NUMBER(10) NOT NULL,
    MASTER_COLUMN_SID NUMBER(10),
    ENUMERATED_DESC_FIELD VARCHAR2(30),
    ENUMERATED_POS_FIELD VARCHAR2(30),
    ENUMERATED_HIDDEN_FIELD VARCHAR2(30),
    HELP CLOB,
    CHECK_MSG VARCHAR2(2000),
    CALC_XML XMLTYPE,
    DATA_TYPE VARCHAR2(106),
    DATA_LENGTH NUMBER,
    DATA_PRECISION NUMBER,
    DATA_SCALE NUMBER,
    NULLABLE VARCHAR2(1),
    CHAR_LENGTH NUMBER,
    VALUE_PLACEHOLDER NUMBER(1) CONSTRAINT NN_TAB_COLUMN_VAL_PLACEHOLDER NOT NULL,
    HELPER_PKG VARCHAR2(255),
    TREE_DESC_FIELD VARCHAR2(30),
    TREE_ID_FIELD VARCHAR2(30),
    TREE_PARENT_ID_FIELD VARCHAR2(30),
    FULL_TEXT_INDEX_NAME	VARCHAR2(255),
    CONSTRAINT PK_TAB_COLUMN PRIMARY KEY (COLUMN_SID),
    CONSTRAINT CC_TAB_COLUMN_VAL_PLACEHOLDER CHECK (VALUE_PLACEHOLDER IN(0,1)),
    CONSTRAINT CK_TAB_COL_CALC_XML CHECK ((calc_xml is null and col_type != 25) or (calc_xml is not null and col_type = 25)),
    CONSTRAINT FK_CMS_TAB_COLUMN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_COLUMN_MEASURE  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    MEASURE_SID NUMBER(10) NOT NULL,
    CONSTRAINT PK_TAB_COLUMN_MEASURE PRIMARY KEY (COLUMN_SID, MEASURE_SID),
    CONSTRAINT FK_CMS_TAB_COL_MEAS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAG  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TAG_ID NUMBER(10) NOT NULL,
    TAG VARCHAR2(300) NOT NULL,
    PARENT_TAG_ID NUMBER(10),
    CONSTRAINT PK_CMS_TAG PRIMARY KEY (TAG_ID),
    CONSTRAINT FK_CMS_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_UK_CONS  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UK_CONS_ID NUMBER(10) NOT NULL,
    TAB_SID NUMBER(10) NOT NULL,
    CONSTRAINT PK_UK_CONS PRIMARY KEY (UK_CONS_ID),
    CONSTRAINT FK_CMS_UK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_UK_CONS_COL  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UK_CONS_ID NUMBER(10) NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    POS NUMBER(10) NOT NULL,
    CONSTRAINT PK_UK_CONS_COL PRIMARY KEY (UK_CONS_ID, COLUMN_SID),
    CONSTRAINT FK_CMS_UK_CONS_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_WEB_PUBLICATION  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    WEB_PUBLICATION_ID NUMBER(10) NOT NULL,
    DISPLAY_TEMPLATE_ID NUMBER(10) NOT NULL,
    ITEM_ID NUMBER(10) NOT NULL,
    CONSTRAINT PK_WEB_PUBLICATION PRIMARY KEY (WEB_PUBLICATION_ID),
    CONSTRAINT FK_CMS_WEB_PUBL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_TAB_COLUMN_ROLE_PERMISSION  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    ROLE_SID NUMBER(10) NOT NULL,
    PERMISSION NUMBER(1) NOT NULL,
    CONSTRAINT PK_TAB_COLUMN_ROLE_PERMISSION PRIMARY KEY (COLUMN_SID, ROLE_SID),
    CHECK (PERMISSION IN (0, 1, 2)),
    CONSTRAINT FK_CMS_TAB_COL_ROL_PERM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CMS_FLOW_TAB_COLUMN_CONS  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COLUMN_SID NUMBER(10) NOT NULL,
    FLOW_STATE_ID NUMBER NOT NULL,
    NULLABLE NUMBER(1) NOT NULL,
    CONSTRAINT PK_FLOW_TAB_COLUMN_CONS PRIMARY KEY (COLUMN_SID, FLOW_STATE_ID),
    CHECK (NULLABLE IN (0, 1)),
    CONSTRAINT FK_CMS_FLOW_TAB_COL_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ALL_METER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID                        NUMBER(10, 0)     NOT NULL,
    NOTE                              VARCHAR2(4000),
    PRIMARY_IND_SID                   NUMBER(10, 0)     NOT NULL,
    PRIMARY_MEASURE_CONVERSION_ID     NUMBER(10, 0),
    METER_SOURCE_TYPE_ID              NUMBER(10, 0)     NOT NULL,
    REFERENCE                         VARCHAR2(256),
    CRC_METER                         NUMBER(1, 0)      NOT NULL,
    ACTIVE                            NUMBER(1, 0)      NOT NULL,
    EXPORT_LIVE_DATA_AFTER_DTM        DATE,
    COST_IND_SID                      NUMBER(10, 0),
    COST_MEASURE_CONVERSION_ID        NUMBER(10, 0),
    DAYS_IND_SID                      NUMBER(10, 0),
    DAYS_MEASURE_CONVERSION_ID        NUMBER(10, 0),
    COSTDAYS_IND_SID                  NUMBER(10, 0),
    COSTDAYS_MEASURE_CONVERSION_ID    NUMBER(10, 0),
    APPROVED_BY_SID                   NUMBER(10, 0),
    APPROVED_DTM                      DATE,
    IS_CORE                           NUMBER(1, 0)      NOT NULL,
    CHECK (CRC_METER IN (0,1)),
    CHECK (ACTIVE IN (0, 1)),
    CONSTRAINT CK_ALL_METER_IS_CORE CHECK (IS_CORE IN (0,1)),
    CONSTRAINT PK406 PRIMARY KEY (REGION_SID),
    CONSTRAINT FK_ALL_METER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



CREATE TABLE CSRIMP.EVENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    EVENT_ID                 NUMBER(10, 0)     NOT NULL,
    LABEL                    VARCHAR2(4000)    NOT NULL,
    RAISED_BY_USER_SID       NUMBER(10, 0)     NOT NULL,
    RAISED_DTM               DATE              NOT NULL,
    EVENT_TEXT               CLOB              NOT NULL,
    RAISED_FOR_REGION_SID    NUMBER(10, 0)     NOT NULL,
    EVENT_DTM                DATE              NOT NULL,
    CONSTRAINT PK1 PRIMARY KEY (EVENT_ID),
    CONSTRAINT FK_EVENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.LIVE_DATA_DURATION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    LIVE_DATA_DURATION_ID    NUMBER(10, 0)    NOT NULL,
    DURATION                 NUMBER(10, 0),
    DESCRIPTION              VARCHAR2(256)    NOT NULL,
    IS_HOURS                 NUMBER(10, 0)    NOT NULL,
    IS_WEEKS                 NUMBER(1, 0)     NOT NULL,
    WEEK_START_DAY           NUMBER(10, 0),
    IS_MONTHS                NUMBER(1, 0)     NOT NULL,
    START_MONTH              NUMBER(10, 0),
    IS_SYSTEM_PERIOD         NUMBER(1, 0)     NOT NULL,
    CHECK (IS_HOURS = 0 OR (IS_HOURS  = 1 AND IS_WEEKS = 0 AND IS_MONTHS = 0)),
    CHECK (IS_WEEKS = 0 OR (IS_WEEKS = 1 AND IS_HOURS = 0 AND IS_MONTHS = 0)),
    CHECK (WEEK_START_DAY IS NULL OR IS_WEEKS = 1),
    CHECK (IS_MONTHS = 0 OR (IS_MONTHS = 1 AND IS_HOURS = 0 AND IS_WEEKS = 0)),
    CHECK (START_MONTH IS NULL OR IS_MONTHS = 1),
    CHECK (IS_SYSTEM_PERIOD IN (0,1)),
    CONSTRAINT PK912 PRIMARY KEY (LIVE_DATA_DURATION_ID),
    CONSTRAINT FK_LIVE_DATA_DUR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    FIRST_PRIORITY_SET_DTM        DATE,
    ISSUE_ID                      NUMBER(10, 0)     NOT NULL,
    LABEL                         VARCHAR2(2048),
    LAST_LABEL                    VARCHAR2(2048),
    SOURCE_LABEL                  VARCHAR2(2000),
    CORRESPONDENT_ID              NUMBER(10, 0),
    CORRESPONDENT_NOTIFIED        NUMBER(1, 0)      NOT NULL,
    RAISED_BY_USER_SID            NUMBER(10, 0)     NOT NULL,
    RAISED_DTM                    DATE              NOT NULL,
    OWNER_USER_SID                NUMBER(10, 0),
    OWNER_ROLE_SID                NUMBER(10, 0),
    RESOLVED_BY_USER_SID          NUMBER(10, 0),
    RESOLVED_DTM                  DATE,
    CLOSED_BY_USER_SID            NUMBER(10, 0),
    CLOSED_DTM                    DATE,
    ASSIGNED_TO_USER_SID          NUMBER(10, 0),
    ASSIGNED_TO_ROLE_SID          NUMBER(10, 0),
    REGION_SID                    NUMBER(10, 0),
    REJECTED_DTM                  DATE,
    REJECTED_BY_USER_SID          NUMBER(10, 0),
    DUE_DTM                       DATE,
    LAST_DUE_DTM                  DATE,
    GUID                          RAW(16),
    ISSUE_PENDING_VAL_ID          NUMBER(10, 0),
    ISSUE_SHEET_VALUE_ID          NUMBER(10, 0),
    ISSUE_SURVEY_ANSWER_ID        NUMBER(10, 0),
    ISSUE_TYPE_ID                 NUMBER(10, 0)     NOT NULL,
    ISSUE_NON_COMPLIANCE_ID       NUMBER(10, 0),
    ISSUE_ACTION_ID               NUMBER(10, 0),
    ISSUE_METER_ID                NUMBER(10, 0),
    ISSUE_METER_ALARM_ID          NUMBER(10, 0),
    ISSUE_METER_RAW_DATA_ID       NUMBER(10, 0),
    ISSUE_PRIORITY_ID             NUMBER(10, 0),
    LAST_ISSUE_PRIORITY_ID        NUMBER(10, 0),
    ISSUE_METER_DATA_SOURCE_ID    NUMBER(10, 0),
    ISSUE_SUPPLIER_ID             NUMBER(10, 0),
    IS_VISIBLE                    NUMBER(1, 0)      NOT NULL,
    SOURCE_URL                    VARCHAR2(2000),
    DELETED                       NUMBER(1, 0)      NOT NULL,
    PARENT_ID                     NUMBER(10, 0),
    CONSTRAINT CHK_ISSUE_FKS CHECK ((ISSUE_PENDING_VAL_ID IS NOT NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_SHEET_VALUE_ID IS NOT NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_SURVEY_ANSWER_ID IS NOT NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_NON_COMPLIANCE_ID IS NOT NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_ACTION_ID IS NOT NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_METER_ID IS NOT NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_METER_ALARM_ID IS NOT NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_METER_RAW_DATA_ID IS NOT NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_METER_DATA_SOURCE_ID IS NOT NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_SUPPLIER_ID IS NULL)
OR
(ISSUE_METER_DATA_SOURCE_ID IS NULL AND ISSUE_NON_COMPLIANCE_ID IS NULL AND ISSUE_SHEET_VALUE_ID IS NULL AND ISSUE_PENDING_VAL_ID IS NULL AND ISSUE_SURVEY_ANSWER_ID IS NULL AND ISSUE_ACTION_ID IS NULL AND ISSUE_METER_ID IS NULL AND ISSUE_METER_ALARM_ID IS NULL AND ISSUE_METER_RAW_DATA_ID IS NULL AND ISSUE_SUPPLIER_ID IS NOT NULL)),
    CONSTRAINT CHK_ISSUE_XOR_IS_ASSIGNED CHECK ((ASSIGNED_TO_USER_SID IS NOT NULL OR ASSIGNED_TO_ROLE_SID IS NOT NULL)
AND
(ASSIGNED_TO_USER_SID IS NULL OR ASSIGNED_TO_ROLE_SID IS NULL)),
    CONSTRAINT CHK_ISSUE_XOR_OWNER CHECK ((OWNER_USER_SID IS NOT NULL OR OWNER_ROLE_SID IS NOT NULL)
AND
(OWNER_USER_SID IS NULL OR OWNER_ROLE_SID IS NULL)),
    CONSTRAINT CHK_ISSUE_IS_VISIBLE CHECK (IS_VISIBLE IN (0,1)),
    CONSTRAINT CHK_DELETED_0_OR_1 CHECK (DELETED IN (0,1)),
    CONSTRAINT PK_ISSUE PRIMARY KEY (ISSUE_ID),
    CONSTRAINT FK_ISSUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_ACTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ACTION_ID    NUMBER(10, 0)    NOT NULL,
    TASK_SID           NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK777 PRIMARY KEY (ISSUE_ACTION_ID),
    CONSTRAINT FK_ISSUE_ACTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_ACTION_LOG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ACTION_LOG_ID           NUMBER(10, 0)     NOT NULL,
    ISSUE_ACTION_TYPE_ID          NUMBER(10, 0)     NOT NULL,
    ISSUE_ID                      NUMBER(10, 0),
    ISSUE_LOG_ID                  NUMBER(10, 0),
    LOGGED_BY_USER_SID            NUMBER(10, 0),
    LOGGED_BY_CORRESPONDENT_ID    NUMBER(10, 0),
    LOGGED_DTM                    DATE              NOT NULL,
    ASSIGNED_TO_ROLE_SID          NUMBER(10, 0),
    ASSIGNED_TO_USER_SID          NUMBER(10, 0),
    RE_USER_SID                   NUMBER(10, 0),
    RE_ROLE_SID                   NUMBER(10, 0),
    OLD_LABEL                     VARCHAR2(2048),
    NEW_LABEL                     VARCHAR2(2048),
    OLD_DUE_DTM                   DATE,
    NEW_DUE_DTM                   DATE,
    OLD_PRIORITY_ID               NUMBER(10, 0),
    NEW_PRIORITY_ID               NUMBER(10, 0),
    CONSTRAINT CHK_IAL_XOR_ASSIGNED CHECK (ISSUE_ACTION_TYPE_ID NOT IN (1)
OR
(
	(ASSIGNED_TO_USER_SID IS NOT NULL OR ASSIGNED_TO_ROLE_SID IS NOT NULL)
	AND
	(ASSIGNED_TO_USER_SID IS NULL OR ASSIGNED_TO_ROLE_SID IS NULL)
)),
    CONSTRAINT CHK_IAL_XOR_LOGGED_BY CHECK ((LOGGED_BY_USER_SID IS NOT NULL OR LOGGED_BY_CORRESPONDENT_ID IS NOT NULL)
AND
(LOGGED_BY_USER_SID IS NULL OR LOGGED_BY_CORRESPONDENT_ID IS NULL)),
    CONSTRAINT PK_ISSUE_ACTION_LOG PRIMARY KEY (ISSUE_ACTION_LOG_ID),
    CONSTRAINT FK_ISSUE_ACTION_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_CUSTOM_FIELD_ID    NUMBER(10, 0)    NOT NULL,
    ISSUE_TYPE_ID            NUMBER(10, 0)    NOT NULL,
    FIELD_TYPE               CHAR(1)          NOT NULL,
    LABEL                    VARCHAR2(64)     NOT NULL,
    CONSTRAINT CHK_ISS_CUST_FLD_TYP CHECK (FIELD_TYPE IN ('T', 'O','M')),
    CONSTRAINT PK_ISSUE_CUSTOM_FIELD PRIMARY KEY (ISSUE_CUSTOM_FIELD_ID),
    CONSTRAINT FK_ISSUE_CUSTOM_FIELD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD_OPT_SEL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ID                     NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_ID        NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_OPT_ID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_CUSTOM_FIELD_OPT_SEL PRIMARY KEY (ISSUE_ID, ISSUE_CUSTOM_FIELD_ID, ISSUE_CUSTOM_FIELD_OPT_ID),
    CONSTRAINT FK_ISS_CUST_FLD_OPT_SEL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD_OPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_CUSTOM_FIELD_ID        NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_OPT_ID    NUMBER(10, 0)    NOT NULL,
    LABEL                        VARCHAR2(64)     NOT NULL,
    CONSTRAINT PK_ISSUE_CUSTOM_FIELD_OPTION PRIMARY KEY (ISSUE_CUSTOM_FIELD_ID, ISSUE_CUSTOM_FIELD_OPT_ID),
    CONSTRAINT FK_ISSUE_CUST_FLD_OPT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_CUSTOM_FIELD_STR_VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ID                 NUMBER(10, 0)    NOT NULL,
    ISSUE_CUSTOM_FIELD_ID    NUMBER(10, 0)    NOT NULL,
    STRING_VALUE             VARCHAR2(255)    NOT NULL,
    CONSTRAINT PK_ISSUE_CUSTOM_FIELD_STR_VAL PRIMARY KEY (ISSUE_ID, ISSUE_CUSTOM_FIELD_ID),
    CONSTRAINT FK_ISSUE_CUST_FLD_STR_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);



CREATE TABLE CSRIMP.ISSUE_LOG (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_LOG_ID                  NUMBER(10, 0)     NOT NULL,
    ISSUE_ID                      NUMBER(10, 0),
    MESSAGE                       CLOB              NOT NULL,
    LOGGED_DTM                    DATE              NOT NULL,
    IS_SYSTEM_GENERATED           NUMBER(1, 0)      NOT NULL,
    LOGGED_BY_USER_SID            NUMBER(10, 0),
    LOGGED_BY_CORRESPONDENT_ID    NUMBER(10, 0),
    PARAM_1                       VARCHAR2(2048),
    PARAM_2                       VARCHAR2(2048),
    PARAM_3                       VARCHAR2(2048),
    CONSTRAINT CHK_IL_XOR_LOGGED_BY CHECK ((LOGGED_BY_USER_SID IS NOT NULL OR LOGGED_BY_CORRESPONDENT_ID IS NOT NULL)
AND
(LOGGED_BY_USER_SID IS NULL OR LOGGED_BY_CORRESPONDENT_ID IS NULL)),
    CONSTRAINT PK_ISSUE_LOG PRIMARY KEY (ISSUE_LOG_ID),
    CONSTRAINT FK_ISSUE_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_LOG_FILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_LOG_FILE_ID    NUMBER(10, 0)    NOT NULL,
    ISSUE_LOG_ID         NUMBER(10, 0)    NOT NULL,
    FILENAME             VARCHAR2(255)    NOT NULL,
    MIME_TYPE            VARCHAR2(256)    NOT NULL,
    DATA                 BLOB             NOT NULL,
    SHA1                 RAW(20)          NOT NULL,
    UPLOADED_DTM         DATE             NOT NULL,
    CONSTRAINT PK_ISSUE_LOG_FILE PRIMARY KEY (ISSUE_LOG_FILE_ID),
    CONSTRAINT FK_ISSUE_LOG_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_LOG_READ (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_LOG_ID    NUMBER(10, 0)    NOT NULL,
    READ_DTM        TIMESTAMP(6)     NOT NULL,
    CSR_USER_SID    NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_LOG_READ PRIMARY KEY (ISSUE_LOG_ID, CSR_USER_SID),
    CONSTRAINT FK_ISSUE_LOG_READ_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_METER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_METER_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID        NUMBER(10, 0)    NOT NULL,
    ISSUE_DTM         DATE,
    CONSTRAINT PK914 PRIMARY KEY (ISSUE_METER_ID),
    CONSTRAINT FK_ISSUE_METER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_METER_ALARM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_METER_ALARM_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    METER_ALARM_ID          NUMBER(10, 0)    NOT NULL,
    ISSUE_DTM               DATE             NOT NULL,
    CONSTRAINT PK979 PRIMARY KEY (ISSUE_METER_ALARM_ID),
    CONSTRAINT FK_ISSUE_METER_ALRM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.ISSUE_METER_DATA_SOURCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_METER_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    RAW_DATA_SOURCE_ID            NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK1193 PRIMARY KEY (ISSUE_METER_DATA_SOURCE_ID),
    CONSTRAINT FK_ISSUE_MTR_DAT_SRC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_METER_RAW_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_METER_RAW_DATA_ID    NUMBER(10, 0)    NOT NULL,
    METER_RAW_DATA_ID          NUMBER(10, 0)    NOT NULL,
    REGION_SID                 NUMBER(10, 0),
    CONSTRAINT PK994 PRIMARY KEY (ISSUE_METER_RAW_DATA_ID),
    CONSTRAINT FK_ISSUE_MTR_RAW_DAT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_NON_COMPLIANCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_NON_COMPLIANCE_ID    NUMBER(10, 0)    NOT NULL,
    NON_COMPLIANCE_ID          NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK663 PRIMARY KEY (ISSUE_NON_COMPLIANCE_ID),
    CONSTRAINT FK_ISSUE_NON_COMPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_PENDING_VAL (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_PENDING_VAL_ID    NUMBER(10, 0)    NOT NULL,
    PENDING_REGION_ID       NUMBER(10, 0)    NOT NULL,
    PENDING_IND_ID          NUMBER(10, 0)    NOT NULL,
    PENDING_PERIOD_ID       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_PENDING_VAL PRIMARY KEY (ISSUE_PENDING_VAL_ID),
    CONSTRAINT UK_ISSUE_PENDING_VAL  UNIQUE (PENDING_IND_ID, PENDING_REGION_ID, PENDING_PERIOD_ID),
    CONSTRAINT FK_ISSUE_PENDING_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_PRIORITY (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_PRIORITY_ID    NUMBER(10, 0)     NOT NULL,
    DESCRIPTION          VARCHAR2(1000)    NOT NULL,
    DUE_DATE_OFFSET      NUMBER(10, 0)     NOT NULL,
    CONSTRAINT PK_ISSUE_PRIORITY PRIMARY KEY (ISSUE_PRIORITY_ID),
    CONSTRAINT FK_ISSUE_PRIORITY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_SCHEDULED_TASK (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_SCHEDULED_TASK_ID    NUMBER(10, 0)    NOT NULL,
    LABEL                      VARCHAR2(255)    NOT NULL,
    SCHEDULE_XML               SYS.XMLType      NOT NULL,
    PERIOD_XML                 SYS.XMLType      NOT NULL,
    LAST_CREATED               DATE,
    ASSIGN_TO_USER_SID         NUMBER(10, 0)    NOT NULL,
    NEXT_RUN_DTM               TIMESTAMP(6),
    CONSTRAINT PK_ISSUE_SCHEDULED_TASK PRIMARY KEY (ISSUE_SCHEDULED_TASK_ID),
    CONSTRAINT FK_ISSUE_SCH_TASK_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_SHEET_VALUE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_SHEET_VALUE_ID    NUMBER(10, 0)    NOT NULL,
    IND_SID                 NUMBER(10, 0)    NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    START_DTM               DATE             NOT NULL,
    END_DTM                 DATE             NOT NULL,
    CONSTRAINT PK_ISSUE_SHEET_VALUE PRIMARY KEY (ISSUE_SHEET_VALUE_ID),
    CONSTRAINT UK_ISSUE_SHEET_VALUE  UNIQUE (IND_SID, REGION_SID, START_DTM, END_DTM),
    CONSTRAINT FK_ISSUE_SHEET_VALUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_SUPPLIER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_SUPPLIER_ID              NUMBER(10, 0)    NOT NULL,
    SUPPLIER_SID                   NUMBER(10, 0)    NOT NULL,
    QS_EXPR_NON_COMPL_ACTION_ID    NUMBER(10, 0),
    CONSTRAINT PK_ISSUE_SUPPLIER PRIMARY KEY (ISSUE_SUPPLIER_ID),
    CONSTRAINT FK_ISSUE_SUPPLIER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_SURVEY_ANSWER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_SURVEY_ANSWER_ID    NUMBER(10, 0)    NOT NULL,
    SURVEY_RESPONSE_ID        NUMBER(10, 0)    NOT NULL,
    QUESTION_ID               NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK642 PRIMARY KEY (ISSUE_SURVEY_ANSWER_ID),
    CONSTRAINT UK_ISSUE_SURVEY_ANSWER  UNIQUE (SURVEY_RESPONSE_ID, QUESTION_ID),
    CONSTRAINT FK_ISSUE_SURVEY_ANS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_TYPE_ID                NUMBER(10, 0)    NOT NULL,
    LABEL                        VARCHAR2(255)    NOT NULL,
    DEFAULT_REGION_SID           NUMBER(10, 0),
    DEFAULT_ISSUE_PRIORITY_ID    NUMBER(10, 0),
    ALERT_MAIL_ADDRESS           VARCHAR2(100),
    ALERT_MAIL_NAME              VARCHAR2(100),
    REQUIRE_PRIORITY             NUMBER(1, 0)     NOT NULL,
    ALLOW_CHILDREN               NUMBER(1, 0)     NOT NULL,
    CONSTRAINT PK643 PRIMARY KEY (ISSUE_TYPE_ID),
    CONSTRAINT FK_ISSUE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.ISSUE_USER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_ID       NUMBER(10, 0)    NOT NULL,
    IS_AN_OWNER    NUMBER(1, 0)     NOT NULL,
    USER_SID       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK_ISSUE_USER PRIMARY KEY (ISSUE_ID, USER_SID),
    CONSTRAINT FK_ISSUE_USER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_ALARM_ID          NUMBER(10, 0)     NOT NULL,
    INHERITABLE             NUMBER(1, 0)      NOT NULL,
    ENABLED                 NUMBER(1, 0)      NOT NULL,
    NAME                    VARCHAR2(1024)    NOT NULL,
    TEST_TIME_ID            NUMBER(10, 0)     NOT NULL,
    LOOK_AT_STATISTIC_ID    NUMBER(10, 0)     NOT NULL,
    COMPARE_STATISTIC_ID    NUMBER(10, 0)     NOT NULL,
    COMPARISON_ID           NUMBER(10, 0)     NOT NULL,
    COMPARISON_PCT          NUMBER(10, 5)     NOT NULL,
    ISSUE_PERIOD_ID         NUMBER(10, 0)     NOT NULL,
    ISSUE_TRIGGER_COUNT     NUMBER(10, 0)     NOT NULL,
    CHECK (INHERITABLE IN(0,1)),
    CHECK (ENABLED IN(0,1)),
    CONSTRAINT PK960 PRIMARY KEY (METER_ALARM_ID),
    CONSTRAINT FK_METER_ALARM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.METER_ALARM_COMPARISON (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    COMPARISON_ID    NUMBER(10, 0)    NOT NULL,
    NAME             VARCHAR2(256)    NOT NULL,
    SHOW_PCT         NUMBER(1, 0)     NOT NULL,
    OP_CODE          VARCHAR2(64)     NOT NULL,
    CHECK (SHOW_PCT IN(0,1)),
    CONSTRAINT PK962 PRIMARY KEY (COMPARISON_ID),
    CONSTRAINT FK_METER_ALRM_COMP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_EVENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID              NUMBER(10, 0)    NOT NULL,
    METER_ALARM_ID          NUMBER(10, 0)    NOT NULL,
    METER_ALARM_EVENT_ID    NUMBER(10, 0)    NOT NULL,
    EVENT_DTM               DATE             NOT NULL,
    CONSTRAINT PK975 PRIMARY KEY (REGION_SID, METER_ALARM_ID, METER_ALARM_EVENT_ID),
    CONSTRAINT FK_METER_ALARM_EV_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_ISSUE_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    ISSUE_PERIOD_ID    NUMBER(10, 0)    NOT NULL,
    NAME               VARCHAR2(256)    NOT NULL,
    TEST_FUNCTION      VARCHAR2(256)    NOT NULL,
    CONSTRAINT PK964 PRIMARY KEY (ISSUE_PERIOD_ID),
    CONSTRAINT FK_METER_ALARM_IS_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_STAT_RUN (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_ALARM_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID        NUMBER(10, 0)    NOT NULL,
    STATISTIC_ID      NUMBER(10, 0)    NOT NULL,
    STATISTIC_DTM     DATE             NOT NULL,
    CONSTRAINT PK977 PRIMARY KEY (METER_ALARM_ID, REGION_SID, STATISTIC_ID),
    CONSTRAINT FK_METER_ALARM_STAT_RUN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.METER_ALARM_STATISTIC (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    STATISTIC_ID    NUMBER(10, 0)    NOT NULL,
    NAME            VARCHAR2(256)    NOT NULL,
    IS_AVERAGE      NUMBER(1, 0)     NOT NULL,
    IS_SUM          NUMBER(1, 0)     NOT NULL,
    COMP_PROC       VARCHAR2(256),
    CHECK (IS_AVERAGE IN(0,1)),
    CHECK (IS_SUM  IN(0,1)),
    CONSTRAINT PK963 PRIMARY KEY (STATISTIC_ID),
    CONSTRAINT FK_METER_ALRM_STAT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_STATISTIC_JOB (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID         NUMBER(10, 0)    NOT NULL,
    STATISTIC_ID       NUMBER(10, 0)    NOT NULL,
    JOB_CREATED_DTM    DATE             NOT NULL,
    CONSTRAINT PK966 PRIMARY KEY (REGION_SID, STATISTIC_ID),
    CONSTRAINT FK_METER_ALRM_STAT_JOB_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_STATISTIC_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID       NUMBER(10, 0)     NOT NULL,
    STATISTIC_ID     NUMBER(10, 0)     NOT NULL,
    STATISTIC_DTM    DATE              NOT NULL,
    VAL              NUMBER(24, 10),
    AVERAGE_COUNT    NUMBER(10, 0),
    CONSTRAINT PK978 PRIMARY KEY (REGION_SID, STATISTIC_ID, STATISTIC_DTM),
    CONSTRAINT FK_METER_ALRM_STATE_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ALARM_TEST_TIME (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    TEST_TIME_ID     NUMBER(10, 0)    NOT NULL,
    NAME             VARCHAR2(256)    NOT NULL,
    TEST_FUNCTION    VARCHAR2(256)    NOT NULL,
    CONSTRAINT PK961 PRIMARY KEY (TEST_TIME_ID),
    CONSTRAINT FK_METER_ALRM_TEST_TIME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_DOCUMENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_DOCUMENT_ID    NUMBER(10, 0)     NOT NULL,
    MIME_TYPE            VARCHAR2(256)     NOT NULL,
    FILE_NAME            VARCHAR2(1024)    NOT NULL,
    DATA                 BLOB              NOT NULL,
    CONSTRAINT PK574 PRIMARY KEY (METER_DOCUMENT_ID),
    CONSTRAINT FK_METER_DOCUMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_EXCEL_MAPPING (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RAW_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    FIELD_NAME            VARCHAR2(256)    NOT NULL,
    COLUMN_NAME           VARCHAR2(256)    NOT NULL,
    COLUMN_INDEX          NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK1203 PRIMARY KEY (RAW_DATA_SOURCE_ID, FIELD_NAME),
    CONSTRAINT FK_METER_EXCEL_MAPPING_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_EXCEL_OPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RAW_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    WORKSHEET_INDEX       NUMBER(10, 0)    NOT NULL,
    ROW_INDEX             NUMBER(10, 0)    NOT NULL,
    CSV_DELIMITER         VARCHAR2(1),
    CONSTRAINT PK1202 PRIMARY KEY (RAW_DATA_SOURCE_ID),
    CONSTRAINT FK_METER_EXCEL_OPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_LIST_CACHE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID              NUMBER(10, 0)     NOT NULL,
    LAST_READING_DTM        DATE,
    ENTERED_DTM             DATE,
    VAL_NUMBER              NUMBER(24, 10),
    AVG_CONSUMPTION         NUMBER(24, 10),
    COST_NUMBER             NUMBER(24, 10),
    READ_BY_SID             NUMBER(10, 0),
    REALTIME_LAST_PERIOD    DATE,
    REALTIME_CONSUMPTION    NUMBER(24, 10),
    CONSTRAINT PK1319 PRIMARY KEY (REGION_SID),
    CONSTRAINT FK_METER_LIST_CACHE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_LIVE_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID               NUMBER(10, 0)     NOT NULL,
    LIVE_DATA_DURATION_ID    NUMBER(10, 0)     NOT NULL,
    START_DTM                DATE              NOT NULL,
    METER_RAW_DATA_ID        NUMBER(10, 0),
    END_DTM                  DATE              NOT NULL,
    MODIFIED_DTM             DATE              NOT NULL,
    CONSUMPTION              NUMBER(24, 10),
    CONSTRAINT PK911 PRIMARY KEY (REGION_SID, LIVE_DATA_DURATION_ID, START_DTM),
    CONSTRAINT FK_METER_LIVE_DATA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_METER_ALARM_STATISTIC (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID        NUMBER(10, 0)    NOT NULL,
    STATISTIC_ID      NUMBER(10, 0)    NOT NULL,
    NOT_BEFORE_DTM    DATE,
    LAST_COMP_DTM     DATE,
    CONSTRAINT PK965 PRIMARY KEY (REGION_SID, STATISTIC_ID),
    CONSTRAINT FK_MTR_MTR_ALRM_STAT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_ORPHAN_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    SERIAL_ID             VARCHAR2(256)     NOT NULL,
    START_DTM             DATE              NOT NULL,
    END_DTM               DATE              NOT NULL,
    METER_RAW_DATA_ID     NUMBER(10, 0)     NOT NULL,
    CONSUMPTION           NUMBER(24, 10)    NOT NULL,
    UOM                   VARCHAR2(256)     NOT NULL,
    RELATED_LOCATION_1    VARCHAR2(256),
    RELATED_LOCATION_2    VARCHAR2(256),
    CONSTRAINT FK_METER_ORPHAN_DATA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_RAW_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_RAW_DATA_ID     NUMBER(10, 0)    NOT NULL,
    RAW_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    RECEIVED_DTM          DATE             NOT NULL,
    START_DTM             DATE             NOT NULL,
    END_DTM               DATE             NOT NULL,
    MIME_TYPE             VARCHAR2(256)    NOT NULL,
    ENCODING_NAME         VARCHAR2(256)    NOT NULL,
    MESSAGE_UID           NUMBER(10, 0),
    DATA                  BLOB             NOT NULL,
    STATUS_ID             NUMBER(10, 0)    NOT NULL,
    ORPHAN_COUNT          NUMBER(10, 0),
    MATCHED_COUNT         NUMBER(10, 0),
    CONSTRAINT PK913 PRIMARY KEY (METER_RAW_DATA_ID),
    CONSTRAINT FK_METER_RAW_DATA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_RAW_DATA_ERROR (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_RAW_DATA_ID    NUMBER(10, 0)     NOT NULL,
    ERROR_ID             NUMBER(10, 0)     NOT NULL,
    MESSAGE              VARCHAR2(4000)    NOT NULL,
    RAISED_DTM           DATE              NOT NULL,
    DATA_DTM             DATE,
    CONSTRAINT PK931 PRIMARY KEY (METER_RAW_DATA_ID, ERROR_ID),
    CONSTRAINT FK_METER_RAW_DATA_ERROR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_RAW_DATA_SOURCE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RAW_DATA_SOURCE_ID        NUMBER(10, 0)     NOT NULL,
    SOURCE_EMAIL              VARCHAR2(1024)    NOT NULL,
    PARSER_TYPE               VARCHAR2(256)     NOT NULL,
    HELPER_PKG                VARCHAR2(256)     NOT NULL,
    EXPORT_SYSTEM_VALUES      NUMBER(1, 0)      NOT NULL,
    EXPORT_AFTER_DTM          DATE,
    DEFAULT_ISSUE_USER_SID    NUMBER(10, 0),
    ORPHAN_COUNT              NUMBER(10, 0),
    MATCHED_COUNT             NUMBER(10, 0),
    CHECK (EXPORT_SYSTEM_VALUES IN(0,1)),
    CONSTRAINT PK919 PRIMARY KEY (RAW_DATA_SOURCE_ID),
    CONSTRAINT FK_METER_RAW_DATA_SRC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.METER_RAW_DATA_STATUS (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    STATUS_ID           NUMBER(10, 0)    NOT NULL,
    DESCRIPTION         VARCHAR2(256)    NOT NULL,
    NEEDS_PROCESSING    NUMBER(1, 0)     NOT NULL,
    CHECK (NEEDS_PROCESSING IN(0,1)),
    CONSTRAINT PK932 PRIMARY KEY (STATUS_ID),
    CONSTRAINT FK_METER_RAW_DATA_STATUS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE CSRIMP.METER_READING (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID             NUMBER(10, 0)     NOT NULL,
    METER_READING_ID       NUMBER(10, 0)     NOT NULL,
    READING_DTM            DATE              NOT NULL,
    VAL_NUMBER             NUMBER(24, 10),
    ENTERED_BY_USER_SID    NUMBER(10, 0)     NOT NULL,
    ENTERED_DTM            DATE              NOT NULL,
    NOTE                   VARCHAR2(4000),
    REFERENCE              VARCHAR2(1024),
    COST                   NUMBER(24, 10),
    METER_DOCUMENT_ID      NUMBER(10, 0),
    CREATED_INVOICE_ID     NUMBER(10, 0),
    CONSTRAINT PK407 PRIMARY KEY (METER_READING_ID),
    CONSTRAINT FK_METER_READING_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_READING_PERIOD (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    START_ID    NUMBER(10, 0)    NOT NULL,
    END_ID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK572 PRIMARY KEY (START_ID, END_ID),
    CONSTRAINT FK_METER_READING_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_SOURCE_DATA (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID           NUMBER(10, 0)     NOT NULL,
    START_DTM            DATE              NOT NULL,
    END_DTM              DATE              NOT NULL,
    METER_RAW_DATA_ID    NUMBER(10, 0),
    CONSUMPTION          NUMBER(24, 10)    NOT NULL
);

CREATE TABLE CSRIMP.METER_SOURCE_TYPE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    METER_SOURCE_TYPE_ID       NUMBER(10, 0)    NOT NULL,
    NAME                       VARCHAR2(256)    NOT NULL,
    DESCRIPTION                VARCHAR2(512)    NOT NULL,
    MANUAL_DATA_ENTRY          NUMBER(1, 0)     NOT NULL,
    SUPPLIER_DATA_MANDATORY    NUMBER(1, 0)     NOT NULL,
    ARBITRARY_PERIOD           NUMBER(1, 0)     NOT NULL,
    REFERENCE_MANDATORY        NUMBER(1, 0)     NOT NULL,
    ADD_INVOICE_DATA           NUMBER(1, 0)     NOT NULL,
    REALTIME_METERING          NUMBER(1, 0)     NOT NULL,
    SHOW_IN_METER_LIST         NUMBER(1, 0)     NOT NULL,
    CHECK (MANUAL_DATA_ENTRY IN (0,1)),
    CHECK (SUPPLIER_DATA_MANDATORY IN (0,1)),
    CHECK (ARBITRARY_PERIOD IN (0,1)),
    CHECK (REFERENCE_MANDATORY IN (0,1)),
    CHECK (ADD_INVOICE_DATA IN (0,1)),
    CHECK (REALTIME_METERING IN(0,1)),
    CHECK (SHOW_IN_METER_LIST IN(0,1)),
    CONSTRAINT PK570 PRIMARY KEY (METER_SOURCE_TYPE_ID),
    CONSTRAINT FK_METER_SOURCE_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_UTILITY_CONTRACT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID             NUMBER(10, 0)    NOT NULL,
    UTILITY_CONTRACT_ID    NUMBER(10, 0)    NOT NULL,
    ACTIVE                 NUMBER(1, 0)     NOT NULL,
    CHECK (ACTIVE IN (0,1)),
    CONSTRAINT PK908 PRIMARY KEY (REGION_SID, UTILITY_CONTRACT_ID),
    CONSTRAINT FK_METER_UTILITY_CONTRACT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.UTILITY_CONTRACT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UTILITY_CONTRACT_ID    NUMBER(10, 0)    NOT NULL,
    UTILITY_SUPPLIER_ID    NUMBER(10, 0)    NOT NULL,
    ACCOUNT_REF            VARCHAR2(256)    NOT NULL,
    FROM_DTM               DATE,
    TO_DTM                 DATE,
    ALERT_WHEN_DUE         NUMBER(1, 0)     NOT NULL,
    FILE_DATA              BLOB,
    FILE_MIME_TYPE         VARCHAR2(256),
    FILE_NAME              VARCHAR2(256),
    CREATED_BY_SID         NUMBER(10, 0),
    CONSTRAINT PK577 PRIMARY KEY (UTILITY_CONTRACT_ID),
    CONSTRAINT FK_UTILITY_CONTRACT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.UTILITY_INVOICE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UTILITY_INVOICE_ID         NUMBER(10, 0)     NOT NULL,
    UTILITY_CONTRACT_ID        NUMBER(10, 0)     NOT NULL,
    REFERENCE                  VARCHAR2(256)     NOT NULL,
    INVOICE_DTM                DATE              NOT NULL,
    COST_VALUE                 NUMBER(24, 16)    NOT NULL,
    COST_MEASURE_SID           NUMBER(10, 0),
    COST_CONV_ID               NUMBER(10, 0),
    CONSUMPTION                NUMBER(10, 0),
    CONSUMPTION_CONV_ID        NUMBER(10, 0),
    FILE_DATA                  BLOB,
    FILE_MIME_TYPE             VARCHAR2(256),
    FILE_NAME                  VARCHAR2(256),
    VERIFIED_BY_SID            NUMBER(10, 0),
    VERIFIED_DTM               DATE,
    CONSUMPTION_MEASURE_SID    NUMBER(10, 0),
    CONSTRAINT PK578 PRIMARY KEY (UTILITY_INVOICE_ID),
    CONSTRAINT FK_UTILITY_INVOICE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.UTILITY_SUPPLIER (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    UTILITY_SUPPLIER_ID    NUMBER(10, 0)     NOT NULL,
    SUPPLIER_NAME          VARCHAR2(1024)    NOT NULL,
    CONTACT_DETAILS        VARCHAR2(4000),
    CONSTRAINT PK576 PRIMARY KEY (UTILITY_SUPPLIER_ID),
    CONSTRAINT FK_UTILITY_SUPPLIER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.METER_XML_OPTION (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    RAW_DATA_SOURCE_ID    NUMBER(10, 0)    NOT NULL,
    DATA_TYPE             VARCHAR2(256)    NOT NULL,
    XSLT                  SYS.XMLType      NOT NULL,
    CONSTRAINT PK1269 PRIMARY KEY (RAW_DATA_SOURCE_ID),
    CONSTRAINT FK_METER_XML_OPTION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_METER_ALARM (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID            NUMBER(10, 0)    NOT NULL,
    INHERITED_FROM_SID    NUMBER(10, 0)    NOT NULL,
    METER_ALARM_ID        NUMBER(10, 0)    NOT NULL,
    IGNORE                NUMBER(1, 0)     NOT NULL,
    IGNORE_CHILDREN       NUMBER(1, 0)     NOT NULL,
    CHECK (IGNORE IN(0,1)),
    CHECK (IGNORE_CHILDREN IN(0,1)),
    CONSTRAINT PK959 PRIMARY KEY (REGION_SID, METER_ALARM_ID),
    CONSTRAINT FK_REGION_METER_ALARM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_PROC_DOC (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    DOC_ID        NUMBER(10, 0)    NOT NULL,
    INHERITED     NUMBER(1, 0)     NOT NULL,
    CHECK (INHERITED IN (0,1)),
    CONSTRAINT PK586 PRIMARY KEY (REGION_SID, DOC_ID),
    CONSTRAINT FK_REGION_PROC_DOC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_PROC_FILE (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID           NUMBER(10, 0)    NOT NULL,
    METER_DOCUMENT_ID    NUMBER(10, 0)    NOT NULL,
    INHERITED            NUMBER(1, 0)     NOT NULL,
    CHECK (INHERITED IN (0,1)),
    CONSTRAINT PK587 PRIMARY KEY (REGION_SID, METER_DOCUMENT_ID),
    CONSTRAINT FK_REGION_PROC_FILE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE CSRIMP.REGION_EVENT (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
    REGION_SID    NUMBER(10, 0)    NOT NULL,
    EVENT_ID      NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK3 PRIMARY KEY (REGION_SID, EVENT_ID),
    CONSTRAINT FK_REGION_EVENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_sid (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_sid							NUMBER(10)	NOT NULL,
	new_sid							NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_sid PRIMARY KEY (old_sid) USING INDEX,
	CONSTRAINT uk_map_sid UNIQUE (new_sid) USING INDEX,
    CONSTRAINT FK_MAP_SID_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_acl (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_acl_id						NUMBER(10)	NOT NULL,
	new_acl_id						NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_acl PRIMARY KEY (old_acl_id) USING INDEX,
	CONSTRAINT uk_map_acl UNIQUE (new_acl_id) USING INDEX,
    CONSTRAINT FK_MAP_ACL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_password_regexp (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_password_regexp_id			NUMBER(10)	NOT NULL,
	new_password_regexp_id			NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_password_regexp PRIMARY KEY (old_password_regexp_id) USING INDEX,
	CONSTRAINT uk_map_password_regexp UNIQUE (new_password_regexp_id) USING INDEX,
    CONSTRAINT FK_MAP_PASSWORD_REGEXP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_ip_rule (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_ip_rule_id			NUMBER(10)	NOT NULL,
	new_ip_rule_id			NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_ip_rule PRIMARY KEY (old_ip_rule_id) USING INDEX,
	CONSTRAINT uk_map_ip_rule UNIQUE (new_ip_rule_id) USING INDEX,
    CONSTRAINT FK_MAP_IP_RULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_form_allocation (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_form_allocation_id			NUMBER(10)	NOT NULL,
	new_form_allocation_id			NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_form_allocation PRIMARY KEY (old_form_allocation_id) USING INDEX,
	CONSTRAINT uk_map_form_allocation UNIQUE (new_form_allocation_id) USING INDEX,
    CONSTRAINT FK_MAP_FORM_ALLOCATION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_measure_conversion (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_measure_conversion_id		NUMBER(10)	NOT NULL,
	new_measure_conversion_id		NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_measure_conversion PRIMARY KEY (old_measure_conversion_id) USING INDEX,
	CONSTRAINT uk_map_measure_conversion UNIQUE (new_measure_conversion_id) USING INDEX,
    CONSTRAINT FK_MAP_MEASURE_CONVERSION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_accuracy_type (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_accuracy_type_id			NUMBER(10)	NOT NULL,
	new_accuracy_type_id			NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_accuracy_type PRIMARY KEY (old_accuracy_type_id) USING INDEX,
	CONSTRAINT uk_map_accuracy_type UNIQUE (new_accuracy_type_id) USING INDEX,
    CONSTRAINT FK_MAP_ACCURACY_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_accuracy_type_option (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_accuracy_type_option_id		NUMBER(10)	NOT NULL,
	new_accuracy_type_option_id		NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_accuracy_type_option PRIMARY KEY (old_accuracy_type_option_id) USING INDEX,
	CONSTRAINT uk_map_accuracy_type_option UNIQUE (new_accuracy_type_option_id) USING INDEX,
    CONSTRAINT FK_MAP_ACCURACY_TYPE_OPT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_tag_group (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_tag_group_id				NUMBER(10)	NOT NULL,
	new_tag_group_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_tag_group PRIMARY KEY (old_tag_group_id) USING INDEX,
	CONSTRAINT uk_map_tag_group UNIQUE (new_tag_group_id) USING INDEX,
    CONSTRAINT FK_MAP_TAG_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_tag (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_tag_id						NUMBER(10)	NOT NULL,
	new_tag_id						NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_tag PRIMARY KEY (old_tag_id) USING INDEX,
	CONSTRAINT uk_map_tag UNIQUE (new_tag_id) USING INDEX,
    CONSTRAINT FK_MAP_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_alert_frame (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_alert_frame_id				NUMBER(10)	NOT NULL,
	new_alert_frame_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_alert_frame PRIMARY KEY (old_alert_frame_id) USING INDEX,
	CONSTRAINT uk_map_alert_frame UNIQUE (new_alert_frame_id) USING INDEX,
    CONSTRAINT FK_MAP_ALERT_FRAME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_customer_alert_type (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_customer_alert_type_id				NUMBER(10)	NOT NULL,
	new_customer_alert_type_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_customer_alert_type PRIMARY KEY (old_customer_alert_type_id) USING INDEX,
	CONSTRAINT uk_map_customer_alert_type UNIQUE (new_customer_alert_type_id) USING INDEX,
    CONSTRAINT FK_MAP_CUST_ALERT_TYPE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_pending_ind (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_pending_ind_id				NUMBER(10)	NOT NULL,
	new_pending_ind_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_pending_ind PRIMARY KEY (old_pending_ind_id) USING INDEX,
	CONSTRAINT uk_map_pending_ind UNIQUE (new_pending_ind_id) USING INDEX,
    CONSTRAINT FK_MAP_PENDING_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_pending_region (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_pending_region_id			NUMBER(10)	NOT NULL,
	new_pending_region_id			NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_pending_region PRIMARY KEY (old_pending_region_id) USING INDEX,
	CONSTRAINT uk_map_pending_region UNIQUE (new_pending_region_id) USING INDEX,
    CONSTRAINT FK_MAP_PENDING_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_pending_period (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_pending_period_id			NUMBER(10)	NOT NULL,
	new_pending_period_id			NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_pending_period PRIMARY KEY (old_pending_period_id) USING INDEX,
	CONSTRAINT uk_map_pending_period UNIQUE (new_pending_period_id) USING INDEX,
    CONSTRAINT FK_MAP_PENDING_PERIOD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_pending_val (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_pending_val_id				NUMBER(10)	NOT NULL,
	new_pending_val_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_pending_val PRIMARY KEY (old_pending_val_id) USING INDEX,
	CONSTRAINT uk_map_pending_val UNIQUE (new_pending_val_id) USING INDEX,
    CONSTRAINT FK_MAP_PENDING_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_approval_step_sheet (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_approval_step_id			NUMBER(10)	NOT NULL,
	old_sheet_key					varchar2(255) NOT NULL,
	new_approval_step_id			NUMBER(10)	NOT NULL,
	new_sheet_key					varchar2(255) NOT NULL,
	CONSTRAINT pk_map_approval_step_sheet PRIMARY KEY (old_approval_step_id, old_sheet_key) USING INDEX,
	CONSTRAINT uk_map_approval_step_sheet UNIQUE (new_approval_step_id, new_sheet_key) USING INDEX,
    CONSTRAINT FK_MAP_APPROVAL_STEP_SHEET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_attachment (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_attachment_id				NUMBER(10)	NOT NULL,
	new_attachment_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_attachment PRIMARY KEY (old_attachment_id) USING INDEX,
	CONSTRAINT uk_map_attachment UNIQUE (new_attachment_id) USING INDEX,
    CONSTRAINT FK_MAP_ATTACHMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_section_comment (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_section_comment_id			NUMBER(10)	NOT NULL,
	new_section_comment_id			NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_section_comment PRIMARY KEY (old_section_comment_id) USING INDEX,
	CONSTRAINT uk_map_section_comment UNIQUE (new_section_comment_id) USING INDEX,
    CONSTRAINT FK_MAP_SECTION_COMMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_sheet (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_sheet_id					NUMBER(10)	NOT NULL,
	new_sheet_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_sheet PRIMARY KEY (old_sheet_id) USING INDEX,
	CONSTRAINT uk_map_sheet UNIQUE (new_sheet_id) USING INDEX,
    CONSTRAINT FK_MAP_SHEET_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_sheet_value (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_sheet_value_id				NUMBER(10)	NOT NULL,
	new_sheet_value_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_sheet_value PRIMARY KEY (old_sheet_value_id) USING INDEX,
	CONSTRAINT uk_map_sheet_value UNIQUE (new_sheet_value_id) USING INDEX,
    CONSTRAINT FK_MAP_SHEET_VALUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_sheet_history (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_sheet_history_id			NUMBER(10)	NOT NULL,
	new_sheet_history_id			NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_sheet_history PRIMARY KEY (old_sheet_history_id) USING INDEX,
	CONSTRAINT uk_map_sheet_history UNIQUE (new_sheet_history_id) USING INDEX,
    CONSTRAINT FK_MAP_SHEET_HISTORY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_sheet_value_change (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_sheet_value_change_id		NUMBER(10)	NOT NULL,
	new_sheet_value_change_id		NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_sheet_value_change PRIMARY KEY (old_sheet_value_change_id) USING INDEX,
	CONSTRAINT uk_map_sheet_value_change UNIQUE (new_sheet_value_change_id) USING INDEX,
    CONSTRAINT FK_MAP_SHEET_VALUE_CHANGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE csrimp.map_imp_conflict (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_imp_conflict_id				NUMBER(10)	NOT NULL,
	new_imp_conflict_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_imp_conflict PRIMARY KEY (old_imp_conflict_id) USING INDEX,
	CONSTRAINT uk_map_imp_conflict UNIQUE (new_imp_conflict_id) USING INDEX,
    CONSTRAINT FK_MAP_IMP_CONFLICT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_imp_ind (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_imp_ind_id					NUMBER(10)	NOT NULL,
	new_imp_ind_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_imp_ind PRIMARY KEY (old_imp_ind_id) USING INDEX,
	CONSTRAINT uk_map_imp_ind UNIQUE (new_imp_ind_id) USING INDEX,
    CONSTRAINT FK_MAP_IMP_IND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_imp_region (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_imp_region_id				NUMBER(10)	NOT NULL,
	new_imp_region_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_imp_region PRIMARY KEY (old_imp_region_id) USING INDEX,
	CONSTRAINT uk_map_imp_region UNIQUE (new_imp_region_id) USING INDEX,
    CONSTRAINT FK_MAP_IMP_REGION_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_imp_measure (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_imp_measure_id				NUMBER(10)	NOT NULL,
	new_imp_measure_id				NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_imp_measure PRIMARY KEY (old_imp_measure_id) USING INDEX,
	CONSTRAINT uk_map_imp_measure UNIQUE (new_imp_measure_id) USING INDEX,
    CONSTRAINT FK_MAP_IMP_MEASURE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_imp_val (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_imp_val_id					NUMBER(10)	NOT NULL,
	new_imp_val_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_imp_val PRIMARY KEY (old_imp_val_id) USING INDEX,
	CONSTRAINT uk_map_imp_val UNIQUE (new_imp_val_id) USING INDEX,
    CONSTRAINT FK_MAP_IMP_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_val (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_val_id						NUMBER(10)	NOT NULL,
	new_val_id						NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_val PRIMARY KEY (old_val_id) USING INDEX,
	CONSTRAINT uk_map_val UNIQUE (new_val_id) USING INDEX,
    CONSTRAINT FK_MAP_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


-- ind validation rules
CREATE TABLE csrimp.map_ind_validation_rule (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_ind_validation_rule_id					NUMBER(10)	NOT NULL,
	new_ind_validation_rule_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_ind_validation_rule PRIMARY KEY (old_ind_validation_rule_id) USING INDEX,
	CONSTRAINT uk_map_ind_validation_rule UNIQUE (new_ind_validation_rule_id) USING INDEX,
    CONSTRAINT FK_MAP_IND_VALIDTN_RULE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


-- delegation conditionmaps
CREATE TABLE csrimp.map_delegation_ind_cond (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_delegation_ind_cond_id					NUMBER(10)	NOT NULL,
	new_delegation_ind_cond_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_delegation_ind_cond PRIMARY KEY (old_delegation_ind_cond_id) USING INDEX,
	CONSTRAINT uk_map_delegation_ind_cond UNIQUE (new_delegation_ind_cond_id) USING INDEX,
    CONSTRAINT FK_DELEGATION_IND_COND_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

-- plan maps
CREATE TABLE csrimp.map_deleg_plan_col (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_deleg_plan_col_id					NUMBER(10)	NOT NULL,
	new_deleg_plan_col_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_deleg_plan_col PRIMARY KEY (old_deleg_plan_col_id) USING INDEX,
	CONSTRAINT uk_map_deleg_plan_col UNIQUE (new_deleg_plan_col_id) USING INDEX,
    CONSTRAINT FK_MAP_DELEG_PLAN_COL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_deleg_plan_col_deleg (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_deleg_plan_col_deleg_id					NUMBER(10)	NOT NULL,
	new_deleg_plan_col_deleg_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_dlg_plan_col_dlg PRIMARY KEY (old_deleg_plan_col_deleg_id) USING INDEX,
	CONSTRAINT uk_map_dlg_plan_col_dlg UNIQUE (new_deleg_plan_col_deleg_id) USING INDEX,
    CONSTRAINT FK_DELEG_PLAN_COL_DELEG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

-- form_expr map
CREATE TABLE csrimp.map_form_expr (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_form_expr_id					NUMBER(10)	NOT NULL,
	new_form_expr_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_form_expr PRIMARY KEY (old_form_expr_id) USING INDEX,
	CONSTRAINT uk_map_form_expr UNIQUE (new_form_expr_id) USING INDEX,
    CONSTRAINT FK_MAP_FORM_EXPR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

-- factor map
CREATE TABLE csrimp.map_factor (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_factor_id					NUMBER(10)	NOT NULL,
	new_factor_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_factor PRIMARY KEY (old_factor_id) USING INDEX,
	CONSTRAINT uk_map_factor UNIQUE (new_factor_id) USING INDEX,
    CONSTRAINT FK_MAP_FACTOR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


-- deleg_ind_group map
CREATE TABLE csrimp.map_deleg_ind_group (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_deleg_ind_group_id					NUMBER(10)	NOT NULL,
	new_deleg_ind_group_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_deleg_ind_group PRIMARY KEY (old_deleg_ind_group_id) USING INDEX,
	CONSTRAINT uk_map_deleg_ind_group UNIQUE (new_deleg_ind_group_id) USING INDEX,
    CONSTRAINT FK_MAP_DELEG_IND_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE csrimp.map_var_expl_group (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_var_expl_group_id					NUMBER(10)	NOT NULL,
	new_var_expl_group_id					NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_var_expl_group PRIMARY KEY (old_var_expl_group_id) USING INDEX,
	CONSTRAINT uk_map_var_expl_group UNIQUE (new_var_expl_group_id) USING INDEX,
    CONSTRAINT FK_MAP_VAR_EXPL_GROUP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_var_expl (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_var_expl_id							NUMBER(10)	NOT NULL,
	new_var_expl_id							NUMBER(10)	NOT NULL,
	CONSTRAINT pk_map_var_expl PRIMARY KEY (old_var_expl_id) USING INDEX,
	CONSTRAINT uk_map_var_expl UNIQUE (new_var_expl_id) USING INDEX,
    CONSTRAINT FK_MAP_VAR_EXPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_cms_schema (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_oracle_schema		varchar2(30) NOT NULL,
	new_oracle_schema		varchar2(30) NOT NULL,
	CONSTRAINT pk_map_cms_schema PRIMARY KEY (old_oracle_schema) USING INDEX,
	CONSTRAINT uk_map_cms_schema UNIQUE (new_oracle_schema) USING INDEX,
    CONSTRAINT FK_MAP_CMS_SCHEMA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_cms_tab_column (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_column_id			NUMBER(10) NOT NULL,
	new_column_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_cms_map_tab_column PRIMARY KEY (old_column_id) USING INDEX,
	CONSTRAINT uk_cms_map_tab_column UNIQUE (new_column_id) USING INDEX,
    CONSTRAINT FK_MAP_CMS_TAB_COLUMN_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_cms_uk_cons (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_uk_cons_id			NUMBER(10) NOT NULL,
	new_uk_cons_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_cms_uk_cons PRIMARY KEY (old_uk_cons_id) USING INDEX,
	CONSTRAINT uk_map_cms_uk_cons UNIQUE (new_uk_cons_id) USING INDEX,
    CONSTRAINT FK_MAP_CMS_UK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_cms_fk_cons (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_fk_cons_id			NUMBER(10) NOT NULL,
	new_fk_cons_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_cms_fk_cons PRIMARY KEY (old_fk_cons_id) USING INDEX,
	CONSTRAINT fk_map_cms_fk_cons UNIQUE (new_fk_cons_id) USING INDEX,
    CONSTRAINT FK_MAP_CMS_FK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_cms_ck_cons (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_ck_cons_id			NUMBER(10) NOT NULL,
	new_ck_cons_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_cms_ck_cons PRIMARY KEY (old_ck_cons_id) USING INDEX,
	CONSTRAINT uk_map_cms_ck_cons UNIQUE (new_ck_cons_id) USING INDEX,
    CONSTRAINT FK_MAP_CMS_CK_CONS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_cms_display_template (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_display_template_id			NUMBER(10) NOT NULL,
	new_display_template_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_cms_display_template PRIMARY KEY (old_display_template_id) USING INDEX,
	CONSTRAINT uk_map_cms_display_template UNIQUE (new_display_template_id) USING INDEX,
    CONSTRAINT FK_MAP_CMS_DISPLAY_TPL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_cms_image (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_image_id			NUMBER(10) NOT NULL,
	new_image_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_cms_image PRIMARY KEY (old_image_id) USING INDEX,
	CONSTRAINT uk_map_cms_image UNIQUE (new_image_id) USING INDEX,
    CONSTRAINT FK_MAP_CMS_IMAGE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_cms_tag (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_tag_id			NUMBER(10) NOT NULL,
	new_tag_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_cms_tag PRIMARY KEY (old_tag_id) USING INDEX,
	CONSTRAINT uk_map_cms_tag UNIQUE (new_tag_id) USING INDEX,
    CONSTRAINT FK_MAP_CMS_TAG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_flow_state (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_flow_state_id		NUMBER(10) NOT NULL,
	new_flow_state_id		NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_flow_state PRIMARY KEY (old_flow_state_id) USING INDEX,
	CONSTRAINT uk_map_flow_state UNIQUE (new_flow_state_id) USING INDEX,
    CONSTRAINT FK_MAP_FLOW_STATE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);
	
CREATE TABLE csrimp.map_flow_item (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_flow_item_id		NUMBER(10) NOT NULL,
	new_flow_item_id		NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_flow_item PRIMARY KEY (old_flow_item_id) USING INDEX,
	CONSTRAINT uk_map_flow_item UNIQUE (new_flow_item_id) USING INDEX,
    CONSTRAINT FK_MAP_FLOW_ITEM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_flow_state_log (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_flow_state_log_id		NUMBER(10) NOT NULL,
	new_flow_state_log_id		NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_flow_state_log PRIMARY KEY (old_flow_state_log_id) USING INDEX,
	CONSTRAINT uk_map_flow_state_log UNIQUE (new_flow_state_log_id) USING INDEX,
    CONSTRAINT FK_MAP_FLOW_STATE_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_flow_state_transition (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_flow_state_transition_id		NUMBER(10) NOT NULL,
	new_flow_state_transition_id		NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_flow_state_transition PRIMARY KEY (old_flow_state_transition_id) USING INDEX,
	CONSTRAINT uk_map_flow_state_transition UNIQUE (new_flow_state_transition_id) USING INDEX,
    CONSTRAINT FK_MAP_FLOW_STATE_TRANS_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE TABLE csrimp.map_meter_raw_data_source  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_raw_data_source_id			NUMBER(10) NOT NULL,
	new_raw_data_source_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_meter_raw_data_source PRIMARY KEY (old_raw_data_source_id) USING INDEX,
	CONSTRAINT uk_map_meter_raw_data_source UNIQUE (new_raw_data_source_id) USING INDEX,
    CONSTRAINT FK_MAP_METER_RAW_DATA_SRC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_live_data_duration  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_live_data_duration_id			NUMBER(10) NOT NULL,
	new_live_data_duration_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_live_data_duration PRIMARY KEY (old_live_data_duration_id) USING INDEX,
	CONSTRAINT uk_map_live_data_duration UNIQUE (new_live_data_duration_id) USING INDEX,
    CONSTRAINT FK_MAP_MTR_LIVE_DAT_DUR_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_utility_supplier  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_utility_supplier_id			NUMBER(10) NOT NULL,
	new_utility_supplier_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_utility_supplier PRIMARY KEY (old_utility_supplier_id) USING INDEX,
	CONSTRAINT uk_map_utility_supplier UNIQUE (new_utility_supplier_id) USING INDEX,
    CONSTRAINT FK_MAP_UTILIY_SUPPLIER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_utility_contract  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_utility_contract_id			NUMBER(10) NOT NULL,
	new_utility_contract_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_utility_contract PRIMARY KEY (old_utility_contract_id) USING INDEX,
	CONSTRAINT uk_map_utility_contract UNIQUE (new_utility_contract_id) USING INDEX,
    CONSTRAINT FK_MAP_UTILITY_ONCTRACT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_utility_invoice  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_utility_invoice_id			NUMBER(10) NOT NULL,
	new_utility_invoice_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_utility_invoice PRIMARY KEY (old_utility_invoice_id) USING INDEX,
	CONSTRAINT uk_map_utility_invoice UNIQUE (new_utility_invoice_id) USING INDEX,
    CONSTRAINT FK_MAP_UTILITY_INVOICE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_meter_alarm  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_meter_alarm_id			NUMBER(10) NOT NULL,
	new_meter_alarm_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_meter_alarm PRIMARY KEY (old_meter_alarm_id) USING INDEX,
	CONSTRAINT uk_map_meter_alarm UNIQUE (new_meter_alarm_id) USING INDEX,
    CONSTRAINT FK_MAP_METER_ALARM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_meter_alarm_statistic  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_statistic_id			NUMBER(10) NOT NULL,
	new_statistic_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_meter_alarm_statistic PRIMARY KEY (old_statistic_id) USING INDEX,
	CONSTRAINT uk_map_meter_alarm_statistic UNIQUE (new_statistic_id) USING INDEX,
    CONSTRAINT FK_MAP_METER_ALARMA_STAT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_meter_alarm_comparison  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_comparison_id			NUMBER(10) NOT NULL,
	new_comparison_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_meter_alarm_comparison PRIMARY KEY (old_comparison_id) USING INDEX,
	CONSTRAINT uk_map_meter_alarm_comparison UNIQUE (new_comparison_id) USING INDEX,
    CONSTRAINT FK_MAP_METER_ALARM_COMP_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_meter_alarm_test_time  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_test_time_id			NUMBER(10) NOT NULL,
	new_test_time_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_test_time PRIMARY KEY (old_test_time_id) USING INDEX,
	CONSTRAINT uk_map_test_time UNIQUE (new_test_time_id) USING INDEX,
    CONSTRAINT FK_MAP_MTR_ALRM_TST_TIME_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_meter_alarm_issue_period  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_period_id			NUMBER(10) NOT NULL,
	new_issue_period_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_meter_alrm_iss_period PRIMARY KEY (old_issue_period_id) USING INDEX,
	CONSTRAINT uk_map_meter_alrm_iss_period UNIQUE (new_issue_period_id) USING INDEX,
    CONSTRAINT FK_MAP_MTR_ALRM_ISS_PRD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_meter_raw_data  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_meter_raw_data_id			NUMBER(10) NOT NULL,
	new_meter_raw_data_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_map_meter_raw_data PRIMARY KEY (old_meter_raw_data_id) USING INDEX,
	CONSTRAINT uk_map_map_meter_raw_data UNIQUE (new_meter_raw_data_id) USING INDEX,
    CONSTRAINT FK_MAP_METER_RAW_DATA_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_meter_reading  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_meter_reading_id			NUMBER(10) NOT NULL,
	new_meter_reading_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_map_meter_reading PRIMARY KEY (old_meter_reading_id) USING INDEX,
	CONSTRAINT uk_map_map_meter_reading UNIQUE (new_meter_reading_id) USING INDEX,
    CONSTRAINT FK_MAP_METER_READING_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_event  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_event_id			NUMBER(10) NOT NULL,
	new_event_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_event PRIMARY KEY (old_event_id) USING INDEX,
	CONSTRAINT uk_map_event UNIQUE (new_event_id) USING INDEX,
    CONSTRAINT FK_MAP_EVENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_meter_document  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_meter_document_id			NUMBER(10) NOT NULL,
	new_meter_document_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_meter_document PRIMARY KEY (old_meter_document_id) USING INDEX,
	CONSTRAINT uk_map_meter_document UNIQUE (new_meter_document_id) USING INDEX,
    CONSTRAINT FK_MAP_METER_DOCUMENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue_pending_val (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_pending_val_id			NUMBER(10) NOT NULL,
	new_issue_pending_val_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_pending_val PRIMARY KEY (old_issue_pending_val_id) USING INDEX,
	CONSTRAINT uk_map_issue_pending_val UNIQUE (new_issue_pending_val_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_PENDING_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);
	
CREATE TABLE csrimp.map_issue_sheet_value (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_sheet_value_id			NUMBER(10) NOT NULL,
	new_issue_sheet_value_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_sheet_value PRIMARY KEY (old_issue_sheet_value_id) USING INDEX,
	CONSTRAINT uk_map_issue_sheet_value UNIQUE (new_issue_sheet_value_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_SHEET_VAL_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue_meter  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_meter_id			NUMBER(10) NOT NULL,
	new_issue_meter_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_meter PRIMARY KEY (old_issue_meter_id) USING INDEX,
	CONSTRAINT uk_map_issue_meter UNIQUE (new_issue_meter_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_METER_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue_meter_alarm  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_meter_alarm_id			NUMBER(10) NOT NULL,
	new_issue_meter_alarm_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_meter_alarm PRIMARY KEY (old_issue_meter_alarm_id) USING INDEX,
	CONSTRAINT uk_map_issue_meter_alarm UNIQUE (new_issue_meter_alarm_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_METER_ALARM_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue_meter_data_source  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_meter_data_source_id			NUMBER(10) NOT NULL,
	new_issue_meter_data_source_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_meter_data_source PRIMARY KEY (old_issue_meter_data_source_id) USING INDEX,
	CONSTRAINT uk_map_issue_meter_data_source UNIQUE (new_issue_meter_data_source_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_MTR_DAT_SRC_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue_meter_raw_data  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_meter_raw_data_id			NUMBER(10) NOT NULL,
	new_issue_meter_raw_data_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_meter_raw_data PRIMARY KEY (old_issue_meter_raw_data_id) USING INDEX,
	CONSTRAINT uk_map_issue_meter_raw_data UNIQUE (new_issue_meter_raw_data_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_MTR_RAW_DAT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue_priority  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_priority_id			NUMBER(10) NOT NULL,
	new_issue_priority_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_priority PRIMARY KEY (old_issue_priority_id) USING INDEX,
	CONSTRAINT uk_map_issue_priority UNIQUE (new_issue_priority_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_PRIORITY_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_id			NUMBER(10) NOT NULL,
	new_issue_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue PRIMARY KEY (old_issue_id) USING INDEX,
	CONSTRAINT uk_map_issue UNIQUE (new_issue_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue_log  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_log_id			NUMBER(10) NOT NULL,
	new_issue_log_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_log PRIMARY KEY (old_issue_log_id) USING INDEX,
	CONSTRAINT uk_map_issue_log UNIQUE (new_issue_log_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_LOG_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_issue_custom_field  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_issue_custom_field_id			NUMBER(10) NOT NULL,
	new_issue_custom_field_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_issue_custom_field PRIMARY KEY (old_issue_custom_field_id) USING INDEX,
	CONSTRAINT uk_map_issue_custom_field UNIQUE (new_issue_custom_field_id) USING INDEX,
    CONSTRAINT FK_MAP_ISSUE_CUSTOM_FIELD_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);

CREATE TABLE csrimp.map_correspondent  (
	CSRIMP_SESSION_ID				NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	old_correspondent_id			NUMBER(10) NOT NULL,
	new_correspondent_id			NUMBER(10) NOT NULL,
	CONSTRAINT pk_map_correspondent PRIMARY KEY (old_correspondent_id) USING INDEX,
	CONSTRAINT uk_map_correspondent UNIQUE (new_correspondent_id) USING INDEX,
    CONSTRAINT FK_MAP_CORRESPONDENT_IS FOREIGN KEY
    	(CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID)
    	ON DELETE CASCADE
);


CREATE OR REPLACE FUNCTION csrimp.SessionIDCheck (
	in_schema 						IN	VARCHAR2, 
	in_object 						IN	VARCHAR2
)
RETURN VARCHAR2
AS
BEGIN
	RETURN 'csrimp_session_id = sys_context(''SECURITY'', ''CSRIMP_SESSION_ID'') or sys_context(''SECURITY'', ''CSRIMP_SESSION_ID'') is null';
END;
/

BEGIN
	FOR r IN (
		SELECT object_name, policy_name 
		  FROM all_policies 
		 WHERE function IN ('SESSIONIDCHECK')
		   AND object_owner = 'CSRIMP'
	) LOOP
		dbms_rls.drop_policy(
            object_schema   => 'CSRIMP',
            object_name     => r.object_name,
            policy_name     => r.policy_name
        );
    END LOOP;
END;
/

BEGIN	
 	FOR r IN (
		SELECT c.owner, c.table_name, c.nullable, (SUBSTR(c.table_name, 1, 26) || '_POL') policy_name
		  FROM all_tables t
		  JOIN all_tab_columns c ON t.owner = c.owner AND t.table_name = c.table_name
		 WHERE t.owner = 'CSRIMP' AND (t.dropped = 'NO' OR t.dropped IS NULL) AND c.column_name = 'CSRIMP_SESSION_ID'
 	)
 	LOOP
		dbms_output.put_line('Writing policy '||r.policy_name);
		dbms_rls.add_policy(
			object_schema   => r.owner,
			object_name     => r.table_name,
			policy_name     => r.policy_name, 
			function_schema => r.owner,
			policy_function => 'SessionIDCheck',
			statement_types => 'select, insert, update, delete',
			update_check	=> true,
			policy_type     => dbms_rls.static);
	END LOOP;
	
END;
/

grant execute on csrimp.imp_pkg to web_user;

-- select 'grant insert,select,update,delete on csrimp.'||lower(table_name)||' to web_user;' 
-- from all_tables where owner='CSRIMP' and table_name not like 'MAP_%' and table_name!='version' and temporary='Y' order by lower(table_name);

-- temporary tables
grant insert,select,update,delete on csrimp.account_policy to web_user;
grant insert,select,update,delete on csrimp.acc_policy_pwd_regexp to web_user;
grant insert,select,update,delete on csrimp.accuracy_type to web_user;
grant insert,select,update,delete on csrimp.accuracy_type_option to web_user;
grant insert,select,update,delete on csrimp.acl to web_user;
grant insert,select,update,delete on csrimp.application to web_user;
grant insert,select,update,delete on csrimp.alert_frame to web_user;
grant insert,select,update,delete on csrimp.alert_frame_body to web_user;
grant insert,select,update,delete on csrimp.alert_template to web_user;
grant insert,select,update,delete on csrimp.alert_template_body to web_user;
grant select,insert,update,delete on csrimp.all_meter to web_user;
grant insert,select,update,delete on csrimp.approval_step to web_user;
grant insert,select,update,delete on csrimp.approval_step_ind to web_user;
grant insert,select,update,delete on csrimp.approval_step_region to web_user;
grant insert,select,update,delete on csrimp.approval_step_role to web_user;
grant insert,select,update,delete on csrimp.approval_step_sheet to web_user;
grant insert,select,update,delete on csrimp.approval_step_sheet_log to web_user;
grant insert,select,update,delete on csrimp.approval_step_user to web_user;
grant insert,select,update,delete on csrimp.attachment to web_user;
grant insert,select,update,delete on csrimp.attachment_history to web_user;
grant insert,select,update,delete on csrimp.attributes to web_user;
grant insert,select,update,delete on csrimp.calc_dependency to web_user;
grant select,insert,update,delete on csrimp.correspondent to web_user;
grant select,insert,update,delete on csrimp.cms_app_schema  to web_user;
grant select,insert,update,delete on csrimp.cms_app_schema_table  to web_user;
--grant select,insert,update,delete on csrimp.cms_context  to web_user;
--grant select,insert,update,delete on csrimp.cms_fast_context  to web_user;
grant select,insert,update,delete on csrimp.cms_image  to web_user;
--grant select,insert,update,delete on csrimp.cms_securable_object_whitelist  to web_user;
grant select,insert,update,delete on csrimp.cms_ck_cons  to web_user;
grant select,insert,update,delete on csrimp.cms_ck_cons_col  to web_user;
grant select,insert,update,delete on csrimp.cms_display_template  to web_user;
grant select,insert,update,delete on csrimp.cms_filter to web_user;
grant select,insert,update,delete on csrimp.cms_fk_cons to web_user;
grant select,insert,update,delete on csrimp.cms_fk_cons_col to web_user;
grant select,insert,update,delete on csrimp.cms_flow_tab_column_cons  to web_user;
grant select,insert,update,delete on csrimp.cms_form to web_user;
grant select,insert,update,delete on csrimp.cms_image_tag  to web_user;
grant select,insert,update,delete on csrimp.cms_link_track  to web_user;
grant select,insert,update,delete on csrimp.cms_tab  to web_user;
grant select,insert,update,delete on csrimp.cms_tab_column  to web_user;
grant select,insert,update,delete on csrimp.cms_tab_column_measure  to web_user;
grant select,insert,update,delete on csrimp.cms_tag  to web_user;
grant select,insert,update,delete on csrimp.cms_uk_cons  to web_user;
grant select,insert,update,delete on csrimp.cms_uk_cons_col  to web_user;
grant select,insert,update,delete on csrimp.cms_web_publication  to web_user;
grant select,insert,update,delete on csrimp.cms_tab_column_role_permission  to web_user;
grant insert,select,update,delete on csrimp.csr_user to web_user;
grant insert,select,update,delete on csrimp.customer to web_user;
grant insert,select,update,delete on csrimp.customer_alert_type to web_user;
grant insert,select,update,delete on csrimp.customer_region_type to web_user;
grant insert,select,update,delete on csrimp.dataview to web_user;
grant insert,select,update,delete on csrimp.dataview_ind_description to web_user;
grant insert,select,update,delete on csrimp.dataview_ind_member to web_user;
grant insert,select,update,delete on csrimp.dataview_region_member to web_user;
grant insert,select,update,delete on csrimp.dataview_region_description to web_user;
grant insert,select,update,delete on csrimp.deleg_ind_group_member to web_user;
grant insert,select,update,delete on csrimp.deleg_ind_form_expr to web_user;
grant insert,select,update,delete on csrimp.deleg_ind_group to web_user;
grant insert,select,update,delete on csrimp.deleg_plan to web_user;
grant insert,select,update,delete on csrimp.deleg_plan_applied to web_user;
grant insert,select,update,delete on csrimp.deleg_plan_col to web_user;
grant insert,select,update,delete on csrimp.deleg_plan_col_deleg to web_user;
grant insert,select,update,delete on csrimp.deleg_plan_col_survey to web_user;
grant insert,select,update,delete on csrimp.deleg_plan_deleg_region to web_user;
grant insert,select,update,delete on csrimp.deleg_plan_deleg_region_deleg to web_user;
grant insert,select,update,delete on csrimp.deleg_plan_region to web_user;
grant insert,select,update,delete on csrimp.deleg_plan_role to web_user;
grant insert,select,update,delete on csrimp.delegation to web_user;
grant insert,select,update,delete on csrimp.delegation_grid to web_user;
grant insert,select,update,delete on csrimp.delegation_grid_aggregate_ind to web_user;
grant insert,select,update,delete on csrimp.delegation_ind to web_user;
grant insert,select,update,delete on csrimp.delegation_ind_cond to web_user;
grant insert,select,update,delete on csrimp.delegation_ind_cond_action to web_user;
grant insert,select,update,delete on csrimp.delegation_ind_description to web_user;
grant insert,select,update,delete on csrimp.delegation_ind_tag to web_user;
grant insert,select,update,delete on csrimp.delegation_ind_tag_list to web_user;
grant insert,select,update,delete on csrimp.delegation_region to web_user;
grant insert,select,update,delete on csrimp.delegation_region_description to web_user;
grant insert,select,update,delete on csrimp.delegation_role to web_user;
grant insert,select,update,delete on csrimp.delegation_user to web_user;
grant select,insert,update,delete on csrimp.event to web_user;
grant insert,select,update,delete on csrimp.factor to web_user;
grant insert,select,update,delete on csrimp.file_upload to web_user;
grant select,insert,update,delete on csrimp.flow to web_user;
grant select,insert,update,delete on csrimp.flow_alert_type to web_user;
grant select,insert,update,delete on csrimp.flow_item to web_user;
grant select,insert,update,delete on csrimp.flow_item_alert to web_user;
grant select,insert,update,delete on csrimp.flow_state to web_user;
grant select,insert,update,delete on csrimp.flow_state_log to web_user;
grant select,insert,update,delete on csrimp.flow_state_log_file to web_user;
grant select,insert,update,delete on csrimp.flow_state_role to web_user;
grant select,insert,update,delete on csrimp.flow_state_trans_helper to web_user;
grant select,insert,update,delete on csrimp.flow_state_transition to web_user;
grant select,insert,update,delete on csrimp.flow_state_transition_role to web_user;
grant select,insert,update,delete on csrimp.flow_transition_alert to web_user;
grant select,insert,update,delete on csrimp.flow_transition_alert_role to web_user;
grant insert,select,update,delete on csrimp.form to web_user;
grant insert,select,update,delete on csrimp.form_allocation to web_user;
grant insert,select,update,delete on csrimp.form_allocation_item to web_user;
grant insert,select,update,delete on csrimp.form_allocation_user to web_user;
grant insert,select,update,delete on csrimp.form_comment to web_user;
grant insert,select,update,delete on csrimp.form_expr to web_user;
grant insert,select,update,delete on csrimp.form_ind_member to web_user;
grant insert,select,update,delete on csrimp.form_region_member to web_user;
grant insert,select,update,delete on csrimp.group_members to web_user;
grant insert,select,update,delete on csrimp.group_table to web_user;
grant insert,select,update,delete on csrimp.home_page to web_user;
grant insert,select,update,delete on csrimp.img_chart to web_user;
grant insert,select,update,delete on csrimp.img_chart_ind to web_user;
grant insert,select,update,delete on csrimp.imp_conflict to web_user;
grant insert,select,update,delete on csrimp.imp_conflict_val to web_user;
grant insert,select,update,delete on csrimp.imp_ind to web_user;
grant insert,select,update,delete on csrimp.imp_measure to web_user;
grant insert,select,update,delete on csrimp.imp_region to web_user;
grant insert,select,update,delete on csrimp.imp_session to web_user;
grant insert,select,update,delete on csrimp.imp_val to web_user;
grant insert,select,update,delete on csrimp.ind to web_user;
grant insert,select,update,delete on csrimp.ind_description to web_user;
grant insert,select,update,delete on csrimp.ind_accuracy_type to web_user;
grant insert,select,update,delete on csrimp.ind_flag to web_user;
grant insert,select,update,delete on csrimp.ind_start_point to web_user;
grant insert,select,update,delete on csrimp.ind_tag to web_user;
grant insert,select,update,delete on csrimp.ind_validation_rule to web_user;
grant insert,select,update,delete on csrimp.ip_rule to web_user;
grant insert,select,update,delete on csrimp.ip_rule_entry to web_user;
grant select,insert,update,delete on csrimp.issue to web_user;
grant select,insert,update,delete on csrimp.issue_action to web_user;
grant select,insert,update,delete on csrimp.issue_action_log to web_user;
grant select,insert,update,delete on csrimp.issue_custom_field to web_user;
grant select,insert,update,delete on csrimp.issue_custom_field_opt_sel to web_user;
grant select,insert,update,delete on csrimp.issue_custom_field_option to web_user;
grant select,insert,update,delete on csrimp.issue_custom_field_str_val to web_user;
grant select,insert,update,delete on csrimp.issue_log to web_user;
grant select,insert,update,delete on csrimp.issue_log_file to web_user;
grant select,insert,update,delete on csrimp.issue_log_read to web_user;
grant select,insert,update,delete on csrimp.issue_meter to web_user;
grant select,insert,update,delete on csrimp.issue_meter_alarm to web_user;
grant select,insert,update,delete on csrimp.issue_meter_data_source to web_user;
grant select,insert,update,delete on csrimp.issue_meter_raw_data to web_user;
grant select,insert,update,delete on csrimp.issue_non_compliance to web_user;
grant select,insert,update,delete on csrimp.issue_pending_val to web_user;
grant select,insert,update,delete on csrimp.issue_priority to web_user;
grant select,insert,update,delete on csrimp.issue_scheduled_task to web_user;
grant select,insert,update,delete on csrimp.issue_sheet_value to web_user;
grant select,insert,update,delete on csrimp.issue_supplier to web_user;
grant select,insert,update,delete on csrimp.issue_survey_answer to web_user;
grant select,insert,update,delete on csrimp.issue_type to web_user;
grant select,insert,update,delete on csrimp.issue_user to web_user;
grant insert,select,update,delete on csrimp.known_so to web_user;
grant select,insert,update,delete on csrimp.live_data_duration to web_user;
grant insert,select,update,delete on csrimp.mail_account to web_user;
grant insert,select,update,delete on csrimp.mail_mailbox to web_user;
grant insert,select,update,delete on csrimp.mail_message to web_user;
grant insert,select,update,delete on csrimp.mail_message_address_field to web_user;
grant insert,select,update,delete on csrimp.mail_message_header to web_user;
grant insert,select,update,delete on csrimp.master_deleg to web_user;
grant insert,select,update,delete on csrimp.measure to web_user;
grant insert,select,update,delete on csrimp.measure_conversion to web_user;
grant insert,select,update,delete on csrimp.measure_conversion_period to web_user;
grant insert,select,update,delete on csrimp.menu to web_user;
grant select,insert,update,delete on csrimp.meter_alarm to web_user;
grant select,insert,update,delete on csrimp.meter_alarm_comparison to web_user;
grant select,insert,update,delete on csrimp.meter_alarm_event to web_user;
grant select,insert,update,delete on csrimp.meter_alarm_issue_period to web_user;
grant select,insert,update,delete on csrimp.meter_alarm_stat_run to web_user;
grant select,insert,update,delete on csrimp.meter_alarm_statistic to web_user;
grant select,insert,update,delete on csrimp.meter_alarm_statistic_job to web_user;
grant select,insert,update,delete on csrimp.meter_alarm_statistic_period to web_user;
grant select,insert,update,delete on csrimp.meter_alarm_test_time to web_user;
grant select,insert,update,delete on csrimp.meter_document to web_user;
grant select,insert,update,delete on csrimp.meter_excel_mapping to web_user;
grant select,insert,update,delete on csrimp.meter_excel_option to web_user;
grant select,insert,update,delete on csrimp.meter_list_cache to web_user;
grant select,insert,update,delete on csrimp.meter_live_data to web_user;
grant select,insert,update,delete on csrimp.meter_meter_alarm_statistic to web_user;
grant select,insert,update,delete on csrimp.meter_orphan_data to web_user;
grant select,insert,update,delete on csrimp.meter_raw_data to web_user;
grant select,insert,update,delete on csrimp.meter_raw_data_error to web_user;
grant select,insert,update,delete on csrimp.meter_raw_data_source to web_user;
grant select,insert,update,delete on csrimp.meter_raw_data_status to web_user;
grant select,insert,update,delete on csrimp.meter_reading to web_user;
grant select,insert,update,delete on csrimp.meter_reading_period to web_user;
grant select,insert,update,delete on csrimp.meter_source_data to web_user;
grant select,insert,update,delete on csrimp.meter_source_type to web_user;
grant select,insert,update,delete on csrimp.meter_utility_contract to web_user;
grant select,insert,update,delete on csrimp.meter_xml_option to web_user;
grant insert,select,update,delete on csrimp.password_regexp to web_user;
grant insert,select,update,delete on csrimp.pct_ownership to web_user;
grant insert,select,update,delete on csrimp.pending_dataset to web_user;
grant insert,select,update,delete on csrimp.pending_ind to web_user;
grant insert,select,update,delete on csrimp.pending_ind_accuracy_type to web_user;
grant insert,select,update,delete on csrimp.pending_period to web_user;
grant insert,select,update,delete on csrimp.pending_region to web_user;
grant insert,select,update,delete on csrimp.pending_val to web_user;
grant insert,select,update,delete on csrimp.pending_val_accuracy_type_opt to web_user;
grant insert,select,update,delete on csrimp.pending_val_log to web_user;
grant insert,select,update,delete on csrimp.pending_val_variance to web_user;
grant insert,select,update,delete on csrimp.permission_mapping to web_user;
grant insert,select,update,delete on csrimp.permission_name to web_user;
grant insert,select,update,delete on csrimp.region to web_user;
grant insert,select,update,delete on csrimp.region_description to web_user;
grant select,insert,update,delete on csrimp.region_event to web_user;
grant select,insert,update,delete on csrimp.region_meter_alarm to web_user;
grant select,insert,update,delete on csrimp.region_proc_doc to web_user;
grant select,insert,update,delete on csrimp.region_proc_file to web_user;
grant insert,select,update,delete on csrimp.region_role_member to web_user;
grant insert,select,update,delete on csrimp.region_tag to web_user;
grant insert,select,update,delete on csrimp.region_tree to web_user;
grant insert,select,update,delete on csrimp.reporting_period to web_user;
grant insert,select,update,delete on csrimp.role to web_user;
grant insert,select,update,delete on csrimp.role_grant to web_user;
grant insert,select,update,delete on csrimp.root_section_user to web_user;
grant insert,select,update,delete on csrimp.section to web_user;
grant insert,select,update,delete on csrimp.section_approvers to web_user;
grant insert,select,update,delete on csrimp.section_comment to web_user;
grant insert,select,update,delete on csrimp.section_module to web_user;
grant insert,select,update,delete on csrimp.section_version to web_user;
grant insert,select,update,delete on csrimp.section_status to web_user;
grant insert,select,update,delete on csrimp.securable_object to web_user;
grant insert,select,update,delete on csrimp.securable_object_attributes to web_user;
grant insert,select,update,delete on csrimp.securable_object_class to web_user;
grant insert,select,update,delete on csrimp.securable_object_keyed_acl to web_user;
grant insert,select,update,delete on csrimp.sheet to web_user;
grant insert,select,update,delete on csrimp.sheet_alert to web_user;
grant insert,select,update,delete on csrimp.sheet_history to web_user;
grant insert,select,update,delete on csrimp.sheet_inherited_value to web_user;
grant insert,select,update,delete on csrimp.sheet_value to web_user;
grant insert,select,update,delete on csrimp.sheet_value_accuracy to web_user;
grant insert,select,update,delete on csrimp.sheet_value_change to web_user;
grant insert,select,update,delete on csrimp.sheet_value_file to web_user;
grant insert,select,update,delete on csrimp.sheet_value_var_expl to web_user;
grant insert,select,update,delete on csrimp.superadmin to web_user;
grant insert,select,update,delete on csrimp.tag to web_user;
grant insert,select,update,delete on csrimp.tag_group to web_user;
grant insert,select,update,delete on csrimp.tag_group_member to web_user;
grant insert,select,update,delete on csrimp.translation_set to web_user;
grant insert,select,update,delete on csrimp.user_certificates to web_user;
grant insert,select,update,delete on csrimp.user_password_history to web_user;
grant insert,select,update,delete on csrimp.user_table to web_user;
grant select,insert,update,delete on csrimp.utility_contract to web_user;
grant select,insert,update,delete on csrimp.utility_invoice to web_user;
grant select,insert,update,delete on csrimp.utility_supplier to web_user;
grant insert,select,update,delete on csrimp.var_expl to web_user;
grant insert,select,update,delete on csrimp.var_expl_group to web_user;
grant insert,select,update,delete on csrimp.val to web_user;
grant insert,select,update,delete on csrimp.val_change to web_user;
grant insert,select,update,delete on csrimp.web_resource to web_user;
grant insert,select,update,delete on csrimp.website to web_user;

grant select,insert,update,delete on csrimp.cms_tab to cms;
grant select,insert,update,delete on csrimp.cms_tab_column to cms;

create sequence csrimp.csrimp_session_id_seq;

drop index csr.ix_meter_reading_start;
drop index csr.ix_meter_reading_end;

@../../../aspen2/cms/db/tab_pkg
@../schema_pkg
@../csrimp/imp_pkg
@../../../aspen2/cms/db/tab_body
@../schema_body
@../csrimp/imp_body
@../actions/project_body
@../csr_data_body

@update_tail
