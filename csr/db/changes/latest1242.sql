-- Please update version.sql too -- this keeps clean builds in sync
define version=1242
@update_header

-- this has been deployed to live

CREATE TABLE CT.EXTRAPOLATION_TYPE (
    EXTRAPOLATION_TYPE_ID NUMBER(10) NOT NULL,
    DESCRIPTION VARCHAR2(1000) NOT NULL,
    CONSTRAINT PK_EXTRAP_TYPE PRIMARY KEY (EXTRAPOLATION_TYPE_ID)
);

ALTER TABLE CT.EC_OPTIONS ADD (
	EXTRAPOLATION_TYPE_ID NUMBER(10) DEFAULT 0 NOT NULL,
	EXTRAPOLATION_PCT NUMBER(10) DEFAULT 15 NOT NULL
);

ALTER TABLE CT.EC_OPTIONS ADD CONSTRAINT CC_EC_OPT_EXT_TYPE_ID 
    CHECK (EXTRAPOLATION_TYPE_ID IN (0, 1));


INSERT INTO CT.EXTRAPOLATION_TYPE (EXTRAPOLATION_TYPE_ID, DESCRIPTION) VALUES (0, 'No extrapolation');
INSERT INTO CT.EXTRAPOLATION_TYPE (EXTRAPOLATION_TYPE_ID, DESCRIPTION) VALUES (1, 'Minimum response percentage');

ALTER TABLE CT.EC_OPTIONS ADD CONSTRAINT EXTRAP_TYPE_EC_OPT 
    FOREIGN KEY (EXTRAPOLATION_TYPE_ID) REFERENCES CT.EXTRAPOLATION_TYPE (EXTRAPOLATION_TYPE_ID);

@..\ct\emp_commute_pkg
@..\ct\emp_commute_body

@update_tail
