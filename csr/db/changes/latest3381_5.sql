-- Please update version.sql too -- this keeps clean builds in sync
define version=3381
define minor_version=5
@update_header

-- *** DDL ***
-- Create tables
CREATE OR REPLACE TYPE CSR.T_USER_PROFILE AS 
	OBJECT (
	PRIMARY_KEY					VARCHAR2(128),
	CSR_USER_SID				NUMBER(10),
	EMPLOYEE_REF				VARCHAR2(128),
	PAYROLL_REF					NUMBER(10),
	FIRST_NAME					VARCHAR2(256),
	LAST_NAME					VARCHAR2(256),
	MIDDLE_NAME					VARCHAR2(256),
	FRIENDLY_NAME				VARCHAR2(256),
	EMAIL_ADDRESS				VARCHAR2(256),
	WORK_PHONE_NUMBER			VARCHAR2(32),
	WORK_PHONE_EXTENSION		VARCHAR2(8),
	HOME_PHONE_NUMBER			VARCHAR2(32),
	MOBILE_PHONE_NUMBER			VARCHAR2(32),
	MANAGER_EMPLOYEE_REF		VARCHAR2(128),
	MANAGER_PAYROLL_REF			NUMBER(10),
	MANAGER_PRIMARY_KEY			VARCHAR2(128),
	EMPLOYMENT_START_DATE		DATE,
	EMPLOYMENT_LEAVE_DATE		DATE,
	DATE_OF_BIRTH				DATE,
	GENDER						VARCHAR2(128),
	JOB_TITLE					VARCHAR2(128),
	CONTRACT					VARCHAR2(256),
	EMPLOYMENT_TYPE				VARCHAR2(256),
	PAY_GRADE					VARCHAR2(256),
	BUSINESS_AREA_REF			VARCHAR2(256),
	BUSINESS_AREA_CODE			NUMBER(10),
	BUSINESS_AREA_NAME			VARCHAR2(256),
	BUSINESS_AREA_DESCRIPTION	VARCHAR2(1024),
	DIVISION_REF				VARCHAR2(256),
	DIVISION_CODE				NUMBER(10),
	DIVISION_NAME				VARCHAR2(256),
	DIVISION_DESCRIPTION		VARCHAR2(1024),
	DEPARTMENT					VARCHAR2(256),
	NUMBER_HOURS				NUMBER(12,2),
	COUNTRY						VARCHAR2(128),
	LOCATION					VARCHAR2(256),
	BUILDING					VARCHAR2(256),
	COST_CENTRE_REF				VARCHAR2(256),
	COST_CENTRE_CODE			NUMBER(10),
	COST_CENTRE_NAME			VARCHAR2(256),
	COST_CENTRE_DESCRIPTION		VARCHAR2(1024),
	WORK_ADDRESS_1				VARCHAR2(256),
	WORK_ADDRESS_2				VARCHAR2(256),
	WORK_ADDRESS_3				VARCHAR2(256),
	WORK_ADDRESS_4				VARCHAR2(256),
	HOME_ADDRESS_1				VARCHAR2(256),
	HOME_ADDRESS_2				VARCHAR2(256),
	HOME_ADDRESS_3				VARCHAR2(256),
	HOME_ADDRESS_4				VARCHAR2(256),
	LOCATION_REGION_SID			NUMBER(10),
	INTERNAL_USERNAME			VARCHAR2(256),
	MANAGER_USERNAME			VARCHAR2(256),
	ACTIVATE_ON					DATE,
	DEACTIVATE_ON				DATE,
	CREATION_INSTANCE_STEP_ID	NUMBER(10),
	CREATED_DTM					DATE,
	CREATED_USER_SID			NUMBER(10),
	CREATION_METHOD				VARCHAR2(256),
	UPDATED_INSTANCE_STEP_ID	NUMBER(10),
	LAST_UPDATED_DTM			DATE,
	LAST_UPDATED_USER_SID		NUMBER(10),
	LAST_UPDATE_METHOD			VARCHAR2(256)
);
/

CREATE OR REPLACE TYPE CSR.T_REGION AS 
	OBJECT (
	REGION_SID					NUMBER(10),
	LINK_TO_REGION_SID			NUMBER(10),
	PARENT_SID					NUMBER(10),
	DESCRIPTION					VARCHAR2(1023),
	ACTIVE						NUMBER(10),
	POS							NUMBER(10),
	INFO_XML					SYS.XMLTYPE,
	ACQUISITION_DTM				DATE,
	DISPOSAL_DTM				DATE,
	REGION_TYPE					NUMBER(2),
	LOOKUP_KEY					VARCHAR2(1024),
	GEO_COUNTRY					VARCHAR2(2),
	GEO_REGION					VARCHAR2(2),
	GEO_CITY_ID					NUMBER(10),
	GEO_LONGITUDE				NUMBER,
	GEO_LATITUDE				NUMBER,
	GEO_TYPE					NUMBER(10),
	EGRID_REF					VARCHAR2(4),
	REGION_REF					VARCHAR2(255)
);
/

-- Alter tables

-- *** Grants ***
GRANT EXECUTE ON cms.form_pkg TO csr;

-- ** Cross schema constraints ***

-- *** Views ***
-- Please paste the content of the view.

-- *** Data changes ***
-- RLS

-- Data

-- ** New package grants **

-- *** Conditional Packages ***

-- *** Packages ***
@../user_profile_pkg
@../region_pkg
@../issue_pkg
@../delegation_pkg
@../customer_pkg
@..\..\..\aspen2\cms\db\form_pkg
@../core_access_pkg

@../user_profile_body
@../region_body
@../issue_body
@../delegation_body
@../customer_body
@..\..\..\aspen2\cms\db\form_body
@../core_access_body

@update_tail
