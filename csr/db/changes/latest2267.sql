-- Please update version.sql too -- this keeps clean builds in sync
define version=2267
@update_header


begin
	for r in (select 1 from all_constraints where owner='CHAIN' and table_name='ALERT_ENTRY' and constraint_type='P') loop
		execute immediate 'alter table chain.alert_entry drop primary key  cascade drop index ';
	end loop;
	for r in (select index_name from all_indexes where owner='CHAIN' and table_name='ALERT_ENTRY') loop
		execute immediate 'drop index chain.'||r.index_name;
	end loop;
end;
/

  CREATE INDEX CHAIN.IX_ALERT_ENTRY_ALERT_ENT_TPL ON CHAIN.ALERT_ENTRY (ALERT_ENTRY_TYPE_ID, TEMPLATE_NAME) ;
 

  CREATE INDEX CHAIN.IX_ALERT_ENTRY_ALRT_EN_TYPE ON CHAIN.ALERT_ENTRY (ALERT_ENTRY_TYPE_ID) ;
 

  CREATE INDEX CHAIN.IX_ALERT_ENTRY_COMPANY_SID ON CHAIN.ALERT_ENTRY (APP_SID, COMPANY_SID) ;
 

  CREATE INDEX CHAIN.IX_ALERT_ENTRY_MESSAGE_ID ON CHAIN.ALERT_ENTRY (APP_SID, MESSAGE_ID) ;
 

  CREATE INDEX CHAIN.IX_ALERT_ENTRY_OWNER_SCHEDUL ON CHAIN.ALERT_ENTRY (APP_SID, OWNER_SCHEDULED_ALERT_ID, USER_SID, ALERT_ENTRY_TYPE_ID) ;
 

  CREATE INDEX CHAIN.IX_ALERT_ENTRY_USER_SID ON CHAIN.ALERT_ENTRY (APP_SID, USER_SID) ;
 

  CREATE INDEX CHAIN.IX_AL_ENT_AL_ENT_APP_ENT_TPL ON CHAIN.ALERT_ENTRY (APP_SID, ALERT_ENTRY_TYPE_ID, TEMPLATE_NAME) ;
  
alter table CHAIN.ALERT_ENTRY add CONSTRAINT PK144 PRIMARY KEY (APP_SID, ALERT_ENTRY_ID) ;
	
ALTER TABLE CHAIN.ALERT_ENTRY_PARAM ADD CONSTRAINT RefALERT_ENTRY1284 
    FOREIGN KEY (APP_SID, ALERT_ENTRY_ID)
    REFERENCES CHAIN.ALERT_ENTRY(APP_SID, ALERT_ENTRY_ID)
;
	
  
@update_tail
