-- Please update version.sql too -- this keeps clean builds in sync
define version=1249
@update_header

--BT Options
ALTER TABLE CT.BT_OPTIONS ADD TEMPORAL_EXTRAPOLATION_TYPE_ID NUMBER(10) DEFAULT 0 NOT NULL;
ALTER TABLE CT.BT_OPTIONS ADD TEMPORAL_EXTRAPOLATION_MONTHS NUMBER(10) DEFAULT 3 NOT NULL;
ALTER TABLE CT.BT_OPTIONS ADD EMPLOYEE_EXTRAPOLATION_TYPE_ID NUMBER(10) DEFAULT 0 NOT NULL;
ALTER TABLE CT.BT_OPTIONS ADD EMPLOYEE_EXTRAPOLATION_PCT NUMBER(10) DEFAULT 25 NOT NULL;
	
ALTER TABLE CT.BT_OPTIONS ADD CONSTRAINT CC_BT_OPT_EMP_EXT_TYPE_ID 
    CHECK (EMPLOYEE_EXTRAPOLATION_TYPE_ID IN (0, 3));
	
ALTER TABLE CT.BT_OPTIONS ADD CONSTRAINT CC_BT_OPT_TEMP_EXT_TYPE_ID 
    CHECK (TEMPORAL_EXTRAPOLATION_TYPE_ID IN (0, 2));
	
ALTER TABLE CT.BT_OPTIONS ADD CONSTRAINT EXTRAP_TYPE_BT_OPT_TMP 
    FOREIGN KEY (TEMPORAL_EXTRAPOLATION_TYPE_ID) REFERENCES CT.EXTRAPOLATION_TYPE (EXTRAPOLATION_TYPE_ID);

ALTER TABLE CT.BT_OPTIONS ADD CONSTRAINT EXTRAP_TYPE_BT_OPT_EMP 
    FOREIGN KEY (EMPLOYEE_EXTRAPOLATION_TYPE_ID) REFERENCES CT.EXTRAPOLATION_TYPE (EXTRAPOLATION_TYPE_ID);

INSERT INTO CT.EXTRAPOLATION_TYPE (EXTRAPOLATION_TYPE_ID, DESCRIPTION) VALUES (2, 'Minimum months of data');
INSERT INTO CT.EXTRAPOLATION_TYPE (EXTRAPOLATION_TYPE_ID, DESCRIPTION) VALUES (3, 'Minimum data percentage');

@..\ct\business_travel_pkg
@..\ct\business_travel_body

@update_tail
