-- Please update version.sql too -- this keeps clean builds in sync
define version=853
@update_header

ALTER TABLE CSR.ALL_METER ADD DAYS_IND_SID                    NUMBER(10);
ALTER TABLE CSR.ALL_METER ADD DAYS_MEASURE_CONVERSION_ID      NUMBER(10);

ALTER TABLE CSR.ALL_METER ADD CONSTRAINT FK_CONSUMPTION_DAYS_IND 
    FOREIGN KEY (APP_SID, DAYS_IND_SID)
    REFERENCES CSR.IND(APP_SID, IND_SID)
;

ALTER TABLE CSR.ALL_METER ADD CONSTRAINT FK_CONSUMPTION_DAYS_MEASURE
    FOREIGN KEY (APP_SID, DAYS_MEASURE_CONVERSION_ID)
    REFERENCES CSR.MEASURE_CONVERSION(APP_SID, MEASURE_CONVERSION_ID)
;

ALTER TABLE CSR.METER_READING MODIFY VAL_NUMBER NULL;

@..\create_views
@..\meter_pkg
@..\meter_body

@update_tail
