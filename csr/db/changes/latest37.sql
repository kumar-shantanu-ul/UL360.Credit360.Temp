-- Please update version.sql too -- this keeps clean builds in sync
define version=37
@update_header

-- THIS IS FOR THE XML FEED STUFF (initially for RWE MADISON system)
-- 
-- SEQUENCE: FEED_REQUEST_ID_SEQ 
--

CREATE SEQUENCE FEED_REQUEST_ID_SEQ 
    START WITH 1
    INCREMENT BY 1
    NOMINVALUE
    NOMAXVALUE
    CACHE 5
    NOORDER
;


-- 
-- TABLE: FEED 
--

CREATE TABLE FEED(
    FEED_SID           NUMBER(10, 0)    NOT NULL,
    CSR_ROOT_SID       NUMBER(10, 0)    NOT NULL,
    LABEL              VARCHAR2(64)     NOT NULL,
    SUPPORT_DETAILS    CLOB,
    CONSTRAINT PK175 PRIMARY KEY (FEED_SID)
)
;



-- 
-- TABLE: FEED_REQUEST 
--

CREATE TABLE FEED_REQUEST(
    FEED_REQUEST_ID       NUMBER(10, 0)    NOT NULL,
    FEED_SID              NUMBER(10, 0)    NOT NULL,
    RECEIVED_DTM          DATE              DEFAULT SYSDATE NOT NULL,
    USER_SID              NUMBER(10, 0)    NOT NULL,
    XML_DATA              CLOB,
    HTTP_RESPONSE_CODE    NUMBER(10, 0),
    REMOTE_ADDR           VARCHAR2(16)     NOT NULL,
    CONSTRAINT PK176 PRIMARY KEY (FEED_REQUEST_ID)
)
;



-- 
-- TABLE: FEED 
--

ALTER TABLE FEED ADD CONSTRAINT RefCUSTOMER284 
    FOREIGN KEY (CSR_ROOT_SID)
    REFERENCES CUSTOMER(CSR_ROOT_SID)
;


-- 
-- TABLE: FEED_REQUEST 
--

ALTER TABLE FEED_REQUEST ADD CONSTRAINT RefFEED286 
    FOREIGN KEY (FEED_SID)
    REFERENCES FEED(FEED_SID)
;



  CREATE INDEX IX_ALERT_TYPE_SENT_NTFY_AFTER ON 
   ALERT(ALERT_TYPE_ID, SENT_DTM, SEND_AFTER_DTM, NOTIFY_USER_SID) 
   TABLESPACE INDX 
   ; 

@update_tail
