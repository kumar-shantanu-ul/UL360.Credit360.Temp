-- Please update version.sql too -- this keeps clean builds in sync
define version=901
@update_header

GRANT SELECT, REFERENCES ON POSTCODE.POSTCODE TO CSR;
GRANT SELECT, REFERENCES ON POSTCODE.POSTCODE_PLACE TO CSR;

CREATE TABLE CSR.POSTCODE_EGRID(
    COUNTRY      VARCHAR2(2)     NOT NULL,
    POSTCODE     VARCHAR2(20)    NOT NULL,
    EGRID_REF    VARCHAR2(4)     NOT NULL,
    CONSTRAINT PK_POSTCODE_EGRID PRIMARY KEY (COUNTRY, POSTCODE, EGRID_REF)
);

ALTER TABLE CSR.POSTCODE_EGRID ADD CONSTRAINT FK_EGRID_POSTCODE_EGRID 
    FOREIGN KEY (EGRID_REF)
    REFERENCES CSR.EGRID(EGRID_REF);

ALTER TABLE CSR.POSTCODE_EGRID ADD CONSTRAINT FK_POSTCODE_POSTCODE_EGRID
    FOREIGN KEY (COUNTRY,POSTCODE)
    REFERENCES POSTCODE.POSTCODE(COUNTRY,POSTCODE);

PROMPT You may want to consider manually running \cvs\csr\db\basedata_postcode_egrid.sql
PROMPT If the database isn't running locally then it might need a path changing in order
PROMPT to import US postcode data correctly.

@update_tail
