-- Please update version.sql too -- this keeps clean builds in sync
define version=439
@update_header

CREATE SEQUENCE DIVISION_ID_SEQ
    START WITH 1
    INCREMENT BY 1
    NOMINVALUE
    NOMAXVALUE
    CACHE 20
    NOORDER
;

CREATE SEQUENCE PROPERTY_ID_SEQ
    START WITH 1
    INCREMENT BY 1
    NOMINVALUE
    NOMAXVALUE
    CACHE 20
    NOORDER
;

CREATE TABLE DIVISION(
    DIVISION_ID    NUMBER(10, 0)     NOT NULL,
    REGION_SID     NUMBER(10, 0)     NOT NULL,
    APP_SID        NUMBER(10, 0)     DEFAULT SYS_CONTEXT('SECURITY','APP') NOT NULL,
    NAME           VARCHAR2(1023)    NOT NULL,
    ACTIVE         NUMBER(1, 0)      NOT NULL,
    CONSTRAINT PK760 PRIMARY KEY (DIVISION_ID)
)
;

CREATE TABLE PROPERTY(
    PROPERTY_ID    NUMBER(10, 0)    NOT NULL,
    REGION_SID     NUMBER(10, 0)    NOT NULL,
    APP_SID        NUMBER(10, 0)    DEFAULT SYS_CONTEXT('SECURITY','APP') NOT NULL,
    GROUP_ID       NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK761 PRIMARY KEY (PROPERTY_ID)
)
;

CREATE TABLE PROPERTY_DIVISION(
    DIVISION_ID    NUMBER(10, 0)    NOT NULL,
    PROPERTY_ID    NUMBER(10, 0)    NOT NULL,
    OWNERSHIP      NUMBER(10, 0)    NOT NULL,
    AREA           NUMBER(10, 0)    NOT NULL,
    START_DTM      TIMESTAMP(6)     NOT NULL,
    END_DTM        TIMESTAMP(6)     NOT NULL,
    CONSTRAINT PK762 PRIMARY KEY (DIVISION_ID, PROPERTY_ID)
)
;

ALTER TABLE DIVISION ADD CONSTRAINT RefREGION1615 
    FOREIGN KEY (APP_SID, REGION_SID)
    REFERENCES REGION(APP_SID, REGION_SID)
;

ALTER TABLE PROPERTY ADD CONSTRAINT RefREGION1616 
    FOREIGN KEY (APP_SID, REGION_SID)
    REFERENCES REGION(APP_SID, REGION_SID)
;

ALTER TABLE PROPERTY_DIVISION ADD CONSTRAINT RefPROPERTY1617 
    FOREIGN KEY (PROPERTY_ID)
    REFERENCES PROPERTY(PROPERTY_ID)
;

ALTER TABLE PROPERTY_DIVISION ADD CONSTRAINT RefDIVISION1618 
    FOREIGN KEY (DIVISION_ID)
    REFERENCES DIVISION(DIVISION_ID)
;

@update_tail
