-- Please update version.sql too -- this keeps clean builds in sync
define version=2565
@update_header

--added chem to csrimp

--schema tables
CREATE TABLE CSRIMP.CHEM_CAS_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAS_GROUP_ID NUMBER(10,0) NOT NULL,
	LABEL VARCHAR2(255),
	LOOKUP_KEY VARCHAR2(64),
	PARENT_GROUP_ID NUMBER(10,0),
	CONSTRAINT PK_CHEM_CAS_GROUP PRIMARY KEY (CSRIMP_SESSION_ID, CAS_GROUP_ID),
	CONSTRAINT FK_CHEM_CAS_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_CAS_GROUP_MEMBER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAS_GROUP_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_CHEM_CAS_GROUP_MEMBER PRIMARY KEY (CSRIMP_SESSION_ID, CAS_GROUP_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_CAS_GROUP_MEMBER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_CAS_RESTRICTED (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	ROOT_REGION_SID NUMBER(10,0) NOT NULL,
	CLP_TABLE_3_1 VARCHAR2(1024),
	CLP_TABLE_3_2 VARCHAR2(1024),
	END_DTM DATE,
	REMARKS VARCHAR2(2048),
	SOURCE VARCHAR2(200),
	START_DTM DATE,
	CONSTRAINT PK_CHEM_CAS_RESTRICTED PRIMARY KEY (CSRIMP_SESSION_ID, CAS_CODE, ROOT_REGION_SID),
	CONSTRAINT FK_CHEM_CAS_RESTRICTED_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_CLASSIFICATION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	CLASSIFICATION_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(100),
	CONSTRAINT PK_CHEM_CLASSIFICATION PRIMARY KEY (CSRIMP_SESSION_ID, CLASSIFICATION_ID),
	CONSTRAINT FK_CHEM_CLASSIFICATION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_MANUFACTURER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	MANUFACTURER_ID NUMBER(10,0) NOT NULL,
	CODE VARCHAR2(50) NOT NULL,
	NAME VARCHAR2(255) NOT NULL,
	CONSTRAINT PK_CHEM_MANUFACTURER PRIMARY KEY (CSRIMP_SESSION_ID, MANUFACTURER_ID),
	CONSTRAINT FK_CHEM_MANUFACTURER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CLASSIFICATION_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(500),
	IS_CENTRAL NUMBER(1,0),
	MANUFACTURER_ID NUMBER(10,0) NOT NULL,
	REF VARCHAR2(20),
	REGION_SID NUMBER(10,0),
	CONSTRAINT PK_CHEM_SUBSTANCE PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID),
	CONSTRAINT FK_CHEM_SUBSTANCE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE_CAS (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	PCT_COMPOSITION NUMBER(5,4),
	CONSTRAINT PK_CHEM_SUBSTANCE_CAS PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_SUBSTANCE_CAS_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_USAGE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USAGE_ID NUMBER(10,0) NOT NULL,
	DESCRIPTION VARCHAR2(100),
	CONSTRAINT PK_CHEM_USAGE PRIMARY KEY (CSRIMP_SESSION_ID, USAGE_ID),
	CONSTRAINT FK_CHEM_USAGE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE_REGION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	FIRST_USED_DTM DATE,
	FLOW_ITEM_ID NUMBER(10,0),
	LOCAL_REF VARCHAR2(40),
	WAIVER_STATUS_ID NUMBER(1,0),
	CONSTRAINT PK_CHEM_SUBSTANCE_REGION PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID, REGION_SID),
	CONSTRAINT FK_CHEM_SUBSTANCE_REGION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBST_REGION_PROCES (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	PROCESS_ID NUMBER(10,0) NOT NULL,
	ACTIVE NUMBER(1,0) NOT NULL,
	FIRST_USED_DTM DATE NOT NULL,
	LABEL VARCHAR2(255) NOT NULL,
	USAGE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHEM_SUBST_REGION_PROCES PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID, REGION_SID, PROCESS_ID),
	CONSTRAINT FK_CHEM_SUBST_REGION_PROCES_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_PROCESS_CAS_DEFAULT (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	PROCESS_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	REMAINING_DEST VARCHAR2(100),
	REMAINING_PCT NUMBER(5,4) NOT NULL,
	TO_AIR_PCT NUMBER(5,4) NOT NULL,
	TO_PRODUCT_PCT NUMBER(5,4) NOT NULL,
	TO_WASTE_PCT NUMBER(5,4) NOT NULL,
	TO_WATER_PCT NUMBER(5,4) NOT NULL,
	CONSTRAINT PK_CHEM_PROCESS_CAS_DEFAULT PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_ID, REGION_SID, PROCESS_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_PROCESS_CAS_DEFAULT_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBS_PROC_USE_CHANG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBST_PROC_USE_CHANGE_ID NUMBER(10,0) NOT NULL,
	CHANGED_BY NUMBER(10,0) NOT NULL,
	CHANGED_DTM TIMESTAMP(6) NOT NULL,
	END_DTM DATE,
	ENTRY_MASS_VALUE NUMBER(24,10),
	ENTRY_STD_MEASURE_CONV_ID NUMBER(10,0),
	MASS_VALUE NUMBER(24,10),
	NOTE CLOB,
	PROCESS_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	RETIRED_DTM TIMESTAMP(6),
	ROOT_DELEGATION_SID NUMBER(10,0),
	START_DTM DATE,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHEM_SUBS_PROC_USE_CHANG PRIMARY KEY (CSRIMP_SESSION_ID, SUBST_PROC_USE_CHANGE_ID),
	CONSTRAINT FK_CHEM_SUBS_PROC_USE_CHANG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUB_PRO_CAS_DES_CHA (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBST_PROC_CAS_DEST_CHANGE_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	CHANGED_BY NUMBER(10,0) NOT NULL,
	CHANGED_DTM TIMESTAMP(6) NOT NULL,
	REMAINING_DEST VARCHAR2(100),
	REMAINING_PCT NUMBER(5,4),
	RETIRED_DTM DATE,
	SUBST_PROC_USE_CHANGE_ID NUMBER(10,0),
	TO_AIR_PCT NUMBER(5,4) NOT NULL,
	TO_PRODUCT_PCT NUMBER(5,4) NOT NULL,
	TO_WASTE_PCT NUMBER(5,4) NOT NULL,
	TO_WATER_PCT NUMBER(5,4) NOT NULL,
	CONSTRAINT PK_CHEM_SUB_PRO_CAS_DES_CHA PRIMARY KEY (CSRIMP_SESSION_ID, SUBST_PROC_CAS_DEST_CHANGE_ID),
	CONSTRAINT FK_CHEM_SUB_PRO_CAS_DES_CHA_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE_AUDIT_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_AUDIT_LOG_ID NUMBER(10,0) NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CHANGED_BY NUMBER(10,0) NOT NULL,
	CHANGED_DTM DATE NOT NULL,
	DESCRIPTION VARCHAR2(1024) NOT NULL,
	PARAM_1 VARCHAR2(1024),
	PARAM_2 VARCHAR2(1024),
	CONSTRAINT PK_CHEM_SUBSTANCE_AUDIT_LOG PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_AUDIT_LOG_ID, SUBSTANCE_ID),
	CONSTRAINT FK_CHEM_SUBSTANCE_AUDIT_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTANCE_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_FILE_ID NUMBER(10,0) NOT NULL,
	DATA BLOB,
	FILENAME VARCHAR2(2048),
	MIME_TYPE VARCHAR2(256) NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	UPLOADED_DTM DATE,
	UPLOADED_USER_SID NUMBER(10,0),
	URL VARCHAR2(2048),
	CONSTRAINT PK_CHEM_SUBSTANCE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_FILE_ID),
	CONSTRAINT FK_CHEM_SUBSTANCE_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBSTAN_PROCESS_USE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_PROCESS_USE_ID NUMBER(10,0) NOT NULL,
	CHANGED_SINCE_PREV_PERIOD NUMBER(1,0) NOT NULL,
	END_DTM DATE,
	ENTRY_MASS_VALUE NUMBER(24,10),
	ENTRY_STD_MEASURE_CONV_ID NUMBER(10,0),
	MASS_VALUE NUMBER(24,10),
	NOTE CLOB,
	PROCESS_ID NUMBER(10,0) NOT NULL,
	REGION_SID NUMBER(10,0) NOT NULL,
	ROOT_DELEGATION_SID NUMBER(10,0) NOT NULL,
	START_DTM DATE,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CONSTRAINT PK_CHEM_SUBSTAN_PROCESS_USE PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_PROCESS_USE_ID),
	CONSTRAINT FK_CHEM_SUBSTAN_PROCESS_USE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBS_PROCE_CAS_DEST (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_PROCESS_USE_ID NUMBER(10,0) NOT NULL,
	CAS_CODE VARCHAR2(50) NOT NULL,
	REMAINING_DEST VARCHAR2(100),
	REMAINING_PCT NUMBER(5,4) NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	TO_AIR_PCT NUMBER(5,4) NOT NULL,
	TO_PRODUCT_PCT NUMBER(5,4) NOT NULL,
	TO_WASTE_PCT NUMBER(5,4) NOT NULL,
	TO_WATER_PCT NUMBER(5,4) NOT NULL,
	CONSTRAINT PK_CHEM_SUBS_PROCE_CAS_DEST PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_PROCESS_USE_ID, CAS_CODE),
	CONSTRAINT FK_CHEM_SUBS_PROCE_CAS_DEST_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_SUBS_PROCE_USE_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	SUBSTANCE_PROCESS_USE_FILE_ID NUMBER(10,0) NOT NULL,
	DATA BLOB,
	FILENAME VARCHAR2(2048),
	MIME_TYPE VARCHAR2(255),
	SUBSTANCE_PROCESS_USE_ID NUMBER(10,0) NOT NULL,
	UPLOADED_DTM DATE,
	UPLOADED_USER_SID NUMBER(10,0),
	CONSTRAINT PK_CHEM_SUBS_PROCE_USE_FILE PRIMARY KEY (CSRIMP_SESSION_ID, SUBSTANCE_PROCESS_USE_FILE_ID),
	CONSTRAINT FK_CHEM_SUBS_PROCE_USE_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.CHEM_USAGE_AUDIT_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	USAGE_AUDIT_LOG_ID NUMBER(10,0) NOT NULL,
	SUBSTANCE_ID NUMBER(10,0) NOT NULL,
	CHANGED_BY NUMBER(10,0) NOT NULL,
	CHANGED_DTM DATE NOT NULL,
	DESCRIPTION VARCHAR2(1024) NOT NULL,
	END_DTM DATE,
	PARAM_1 VARCHAR2(1024),
	PARAM_2 VARCHAR2(1024),
	REGION_SID NUMBER(10,0),
	ROOT_DELEGATION_SID NUMBER(10,0),
	START_DTM DATE,
	CONSTRAINT PK_CHEM_USAGE_AUDIT_LOG PRIMARY KEY (CSRIMP_SESSION_ID, USAGE_AUDIT_LOG_ID, SUBSTANCE_ID),
	CONSTRAINT FK_CHEM_USAGE_AUDIT_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);
--map tables
CREATE TABLE CSRIMP.MAP_CHEM_CAS_GROUP (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_CAS_GROUP_ID NUMBER(10) NOT NULL,
	NEW_CAS_GROUP_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_CAS_GROUP PRIMARY KEY (OLD_CAS_GROUP_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_CAS_GROUP UNIQUE (NEW_CAS_GROUP_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_CAS_GROUP_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_CLASSIFICATION (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_CLASSIFICATION_ID NUMBER(10) NOT NULL,
	NEW_CLASSIFICATION_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_CLASSIFICATION PRIMARY KEY (OLD_CLASSIFICATION_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_CLASSIFICATION UNIQUE (NEW_CLASSIFICATION_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_CLASSIFICATION_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_MANUFACTURER (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_MANUFACTURER_ID NUMBER(10) NOT NULL,
	NEW_MANUFACTURER_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_MANUFACTURER PRIMARY KEY (OLD_MANUFACTURER_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_MANUFACTURER UNIQUE (NEW_MANUFACTURER_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_MANUFACTURER_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_SUBSTANCE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SUBSTANCE_ID NUMBER(10) NOT NULL,
	NEW_SUBSTANCE_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_SUBSTANCE PRIMARY KEY (OLD_SUBSTANCE_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_SUBSTANCE UNIQUE (NEW_SUBSTANCE_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_SUBSTANCE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_SUB_RGN_PRO_PRO (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SUBST_RGN_PROC_PROCESS_ID NUMBER(10) NOT NULL,
	NEW_SUBST_RGN_PROC_PROCESS_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_SUB_RGN_PRO_PRO PRIMARY KEY (OLD_SUBST_RGN_PROC_PROCESS_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_SUB_RGN_PRO_PRO UNIQUE (NEW_SUBST_RGN_PROC_PROCESS_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_SUB_RGN_PRO_PRO_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_USAGE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_USAGE_ID NUMBER(10) NOT NULL,
	NEW_USAGE_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_USAGE PRIMARY KEY (OLD_USAGE_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_USAGE UNIQUE (NEW_USAGE_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_USAGE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_SUB_PRO_USE_CHA (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SUBST_PROC_USE_CHANGE_ID NUMBER(10) NOT NULL,
	NEW_SUBST_PROC_USE_CHANGE_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_SUB_PRO_USE_CHA PRIMARY KEY (OLD_SUBST_PROC_USE_CHANGE_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_SUB_PRO_USE_CHA UNIQUE (NEW_SUBST_PROC_USE_CHANGE_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_SUB_PRO_USE_CHA_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_SU_PR_CA_DE_CHG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SUBST_PROC_CAS_DEST_CHG_ID NUMBER(10) NOT NULL,
	NEW_SUBST_PROC_CAS_DEST_CHG_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_SU_PR_CA_DE_CHG PRIMARY KEY (OLD_SUBST_PROC_CAS_DEST_CHG_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_SU_PR_CA_DE_CHG UNIQUE (NEW_SUBST_PROC_CAS_DEST_CHG_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_SU_PR_CA_DE_CHG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_SUB_AUDIT_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SUB_AUDIT_LOG_ID NUMBER(10) NOT NULL,
	NEW_SUB_AUDIT_LOG_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_SUB_AUDIT_LOG PRIMARY KEY (OLD_SUB_AUDIT_LOG_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_SUB_AUDIT_LOG UNIQUE (NEW_SUB_AUDIT_LOG_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_SUB_AUDIT_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_SUBSTANCE_FILE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SUBSTANCE_FILE_ID NUMBER(10) NOT NULL,
	NEW_SUBSTANCE_FILE_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_SUBSTANCE_FILE PRIMARY KEY (OLD_SUBSTANCE_FILE_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_SUBSTANCE_FILE UNIQUE (NEW_SUBSTANCE_FILE_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_SUBSTANCE_FILE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_SUBST_PROCE_USE (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SUBSTANCE_PROCESS_USE_ID NUMBER(10) NOT NULL,
	NEW_SUBSTANCE_PROCESS_USE_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_SUBST_PROCE_USE PRIMARY KEY (OLD_SUBSTANCE_PROCESS_USE_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_SUBST_PROCE_USE UNIQUE (NEW_SUBSTANCE_PROCESS_USE_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_SUBST_PROCE_USE_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_SUB_PRO_USE_FIL (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_SUBST_PROC_USE_FILE_ID NUMBER(10) NOT NULL,
	NEW_SUBST_PROC_USE_FILE_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_SUB_PRO_USE_FIL PRIMARY KEY (OLD_SUBST_PROC_USE_FILE_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_SUB_PRO_USE_FIL UNIQUE (NEW_SUBST_PROC_USE_FILE_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_SUB_PRO_USE_FIL_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);

CREATE TABLE CSRIMP.MAP_CHEM_USAGE_AUDIT_LOG (
	CSRIMP_SESSION_ID NUMBER(10) DEFAULT SYS_CONTEXT('SECURITY', 'CSRIMP_SESSION_ID') NOT NULL,
	OLD_USAGE_AUDIT_LOG_ID NUMBER(10) NOT NULL,
	NEW_USAGE_AUDIT_LOG_ID NUMBER(10) NOT NULL,
	CONSTRAINT PK_MAP_CHEM_USAGE_AUDIT_LOG PRIMARY KEY (OLD_USAGE_AUDIT_LOG_ID) USING INDEX,
	CONSTRAINT UK_MAP_CHEM_USAGE_AUDIT_LOG UNIQUE (NEW_USAGE_AUDIT_LOG_ID) USING INDEX,
	CONSTRAINT FK_MAP_CHEM_USAGE_AUDIT_LOG_IS FOREIGN KEY (CSRIMP_SESSION_ID) REFERENCES CSRIMP.CSRIMP_SESSION (CSRIMP_SESSION_ID) ON DELETE CASCADE
);


--package grants
grant select, insert, update, delete on csrimp.chem_cas_group to web_user;
grant select, insert, update, delete on csrimp.chem_cas_group_member to web_user;
grant select, insert, update, delete on csrimp.chem_cas_restricted to web_user;
grant select, insert, update, delete on csrimp.chem_classification to web_user;
grant select, insert, update, delete on csrimp.chem_manufacturer to web_user;
grant select, insert, update, delete on csrimp.chem_substance to web_user;
grant select, insert, update, delete on csrimp.chem_substance_cas to web_user;
grant select, insert, update, delete on csrimp.chem_usage to web_user;
grant select, insert, update, delete on csrimp.chem_substance_region to web_user;
grant select, insert, update, delete on csrimp.chem_subst_region_proces to web_user;
grant select, insert, update, delete on csrimp.chem_process_cas_default to web_user;
grant select, insert, update, delete on csrimp.chem_subs_proc_use_chang to web_user;
grant select, insert, update, delete on csrimp.chem_sub_pro_cas_des_cha to web_user;
grant select, insert, update, delete on csrimp.chem_substance_audit_log to web_user;
grant select, insert, update, delete on csrimp.chem_substance_file to web_user;
grant select, insert, update, delete on csrimp.chem_substan_process_use to web_user;
grant select, insert, update, delete on csrimp.chem_subs_proce_cas_dest to web_user;
grant select, insert, update, delete on csrimp.chem_subs_proce_use_file to web_user;
grant select, insert, update, delete on csrimp.chem_usage_audit_log to web_user;

--object grants
grant select, insert, update on chem.cas_group to csrimp;
grant select, insert, update on chem.cas_group to CSR;
grant select, insert, update on chem.cas_group_member to csrimp;
grant select, insert, update on chem.cas_group_member to CSR;
grant select, insert, update on chem.cas_restricted to csrimp;
grant select, insert, update on chem.cas_restricted to CSR;
grant select, insert, update on chem.classification to csrimp;
grant select, insert, update on chem.classification to CSR;
grant select, insert, update on chem.manufacturer to csrimp;
grant select, insert, update on chem.manufacturer to CSR;
grant select, insert, update on chem.substance to csrimp;
grant select, insert, update on chem.substance to CSR;
grant select, insert, update on chem.substance_cas to csrimp;
grant select, insert, update on chem.substance_cas to CSR;
grant select, insert, update on chem.usage to csrimp;
grant select, insert, update on chem.usage to CSR;
grant select, insert, update on chem.substance_region to csrimp;
grant select, insert, update on chem.substance_region to CSR;
grant select, insert, update on chem.substance_region_process to csrimp;
grant select, insert, update on chem.substance_region_process to CSR;
grant select, insert, update on chem.process_cas_default to csrimp;
grant select, insert, update on chem.process_cas_default to CSR;
grant select, insert, update on chem.substance_process_use_change to csrimp;
grant select, insert, update on chem.substance_process_use_change to CSR;
grant select, insert, update on chem.subst_process_cas_dest_change to csrimp;
grant select, insert, update on chem.subst_process_cas_dest_change to CSR;
grant select, insert, update on chem.substance_audit_log to csrimp;
grant select, insert, update on chem.substance_audit_log to CSR;
grant select, insert, update on chem.substance_file to csrimp;
grant select, insert, update on chem.substance_file to CSR;
grant select, insert, update on chem.substance_process_use to csrimp;
grant select, insert, update on chem.substance_process_use to CSR;
grant select, insert, update on chem.substance_process_cas_dest to csrimp;
grant select, insert, update on chem.substance_process_cas_dest to CSR;
grant select, insert, update on chem.substance_process_use_file to csrimp;
grant select, insert, update on chem.substance_process_use_file to CSR;
grant select, insert, update on chem.usage_audit_log to csrimp;
grant select, insert, update on chem.usage_audit_log to CSR;

grant select on chem.cas_group_id_seq to csrimp;
grant select on chem.cas_group_id_seq to CSR;
grant select on chem.classification_id_seq to csrimp;
grant select on chem.classification_id_seq to CSR;
grant select on chem.manufacturer_id_seq to csrimp;
grant select on chem.manufacturer_id_seq to CSR;
grant select on chem.substance_id_seq to csrimp;
grant select on chem.substance_id_seq to CSR;
grant select on chem.subst_rgn_proc_process_id_seq to csrimp;
grant select on chem.subst_rgn_proc_process_id_seq to CSR;
grant select on chem.usage_id_seq to csrimp;
grant select on chem.usage_id_seq to CSR;
grant select on chem.subst_proc_use_change_id_seq to csrimp;
grant select on chem.subst_proc_use_change_id_seq to CSR;
grant select on chem.subst_proc_cas_dest_chg_id_seq to csrimp;
grant select on chem.subst_proc_cas_dest_chg_id_seq to CSR;
grant select on chem.sub_audit_log_id_seq to csrimp;
grant select on chem.sub_audit_log_id_seq to CSR;
grant select on chem.substance_file_id_seq to csrimp;
grant select on chem.substance_file_id_seq to CSR;
grant select on chem.substance_process_use_id_seq to csrimp;
grant select on chem.substance_process_use_id_seq to CSR;
grant select on chem.subst_proc_use_file_id_seq to csrimp;
grant select on chem.subst_proc_use_file_id_seq to CSR;
grant select on chem.usage_audit_log_id_seq to csrimp;
grant select on chem.usage_audit_log_id_seq to CSR;

--compile new packages
@../schema_pkg
@../schema_body
@../csrimp/imp_pkg
@../csrimp/imp_body


@update_tail
