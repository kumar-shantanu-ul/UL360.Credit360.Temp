
CREATE SEQUENCE LETTER_BODY_TEXT_ID_SEQ 
    START WITH 1
    INCREMENT BY 1
    NOMINVALUE
    NOMAXVALUE
    CACHE 20
    NOORDER
;

CREATE SEQUENCE LETTER_TEMPLATE_ID_SEQ 
    START WITH 1
    INCREMENT BY 1
    NOMINVALUE
    NOMAXVALUE
    CACHE 20
    NOORDER
;


CREATE TABLE LETTER_BODY_REGION_GROUP(
    REGION_GROUP_SID       NUMBER(10, 0)    NOT NULL,
    LETTER_BODY_TEXT_ID    NUMBER(10, 0)    NOT NULL,
    DONATION_STATUS_ID     NUMBER(10, 0)    NOT NULL,
    CONSTRAINT PK62 PRIMARY KEY (REGION_GROUP_SID, LETTER_BODY_TEXT_ID, DONATION_STATUS_ID)
);

CREATE TABLE LETTER_BODY_TEXT(
    LETTER_BODY_TEXT_ID    NUMBER(10, 0)    NOT NULL,
    DONATION_STATUS_ID     NUMBER(10, 0)    NOT NULL,
    BODY_TEXT              CLOB,
    CONSTRAINT PK60 PRIMARY KEY (LETTER_BODY_TEXT_ID, DONATION_STATUS_ID)
);

CREATE TABLE LETTER_TEMPLATE(
    LETTER_TEMPLATE_ID    NUMBER(10, 0)    NOT NULL,
    APP_SID               NUMBER(10, 0),
    NAME                  VARCHAR2(512)    NOT NULL,
    DATA                  BLOB,
    CONSTRAINT PK57 PRIMARY KEY (LETTER_TEMPLATE_ID)
);


ALTER TABLE REGION_GROUP ADD (
	LETTER_TEMPLATE_ID    NUMBER(10, 0)
);

ALTER TABLE DONATION ADD (
	LETTER_BODY_TEXT		CLOB
);

ALTER TABLE LETTER_BODY_REGION_GROUP ADD CONSTRAINT RefLETTER_BODY_TEXT93 
    FOREIGN KEY (LETTER_BODY_TEXT_ID, DONATION_STATUS_ID)
    REFERENCES LETTER_BODY_TEXT(LETTER_BODY_TEXT_ID, DONATION_STATUS_ID)
;

ALTER TABLE LETTER_BODY_REGION_GROUP ADD CONSTRAINT RefREGION_GROUP94 
    FOREIGN KEY (REGION_GROUP_SID)
    REFERENCES REGION_GROUP(REGION_GROUP_SID)
;

ALTER TABLE LETTER_BODY_TEXT ADD CONSTRAINT RefDONATION_STATUS95 
    FOREIGN KEY (DONATION_STATUS_ID)
    REFERENCES DONATION_STATUS(DONATION_STATUS_ID)
;

ALTER TABLE REGION_GROUP ADD CONSTRAINT RefLETTER_TEMPLATE96 
    FOREIGN KEY (LETTER_TEMPLATE_ID)
    REFERENCES LETTER_TEMPLATE(LETTER_TEMPLATE_ID)
;

COMMIT;
