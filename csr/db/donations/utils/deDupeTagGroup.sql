BEGIN
    FOR R IN (
        SELECT TAG_ID FROM (
            SELECT T.TAG, T.TAG_ID, 
                ROW_NUMBER() OVER (PARTITION BY T.TAG ORDER BY T.TAG_ID ASC) RN
              FROM DONATIONS.TAG_GROUP_MEMBER TGM, DONATIONS.TAG T 
             WHERE TAG_GROUP_SID = &&tag_group_sid
               AND TGM.TAG_ID = T.TAG_ID) 
         WHERE RN > 1
    )
    LOOP
        DELETE FROM DONATIONS.TAG_GROUP_MEMBER 
         WHERE TAG_ID = R.TAG_ID;
        DELETE FROM DONATIONS.TAG 
         WHERE TAG_ID = R.TAG_ID;
    END LOOP;
END;
/
