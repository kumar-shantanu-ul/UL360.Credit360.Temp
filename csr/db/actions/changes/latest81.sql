-- Please update version.sql too -- this keeps clean builds in sync
define version=81
@update_header


CREATE GLOBAL TEMPORARY TABLE TEMP_CALC(
	XML 				   SYS.XMLType,
	STORED_CALC            NUMBER(1, 0)      DEFAULT 0 NOT NULL
                           CHECK (STORED_CALC IN(0,1))
)
ON COMMIT DELETE ROWS;


ALTER TABLE PROJECT_IND_TEMPLATE ADD (
	ONGOING_TEMPLATE_ID    NUMBER(10, 0),
	MERGED_TEMPLATE_ID     NUMBER(10, 0)
);

ALTER TABLE PROJECT_IND_TEMPLATE ADD CONSTRAINT RefIND_TEMPLATE278 
    FOREIGN KEY (APP_SID, ONGOING_TEMPLATE_ID)
    REFERENCES IND_TEMPLATE(APP_SID, IND_TEMPLATE_ID)
;

ALTER TABLE PROJECT_IND_TEMPLATE ADD CONSTRAINT RefIND_TEMPLATE280 
    FOREIGN KEY (APP_SID, MERGED_TEMPLATE_ID)
    REFERENCES IND_TEMPLATE(APP_SID, IND_TEMPLATE_ID)
;

ALTER TABLE IND_TEMPLATE ADD (
	CALCULATION            SYS.XMLType,
	STORED_CALC            NUMBER(1, 0)      DEFAULT 0 NOT NULL
                           CHECK (STORED_CALC IN(0,1))
);

@update_tail
