-- Please update version.sql too -- this keeps clean builds in sync
define version=66
@update_header

-- 
-- TABLE: GT_SCORE_LOG 
--

CREATE TABLE GT_SCORE_LOG(
    PRODUCT_ID          NUMBER(10, 0)     NOT NULL,
    GT_SCORE_TYPE_ID    NUMBER(10, 0)     NOT NULL,
    DESCRIPTION         VARCHAR2(1023)    NOT NULL,
    PARAM_1             VARCHAR2(2048),
    PARAM_2             VARCHAR2(2048),
    PARAM_3             VARCHAR2(2048)
)
;

-- 
-- TABLE: GT_SCORE_TYPE 
--

CREATE TABLE GT_SCORE_TYPE(
    GT_SCORE_TYPE_ID    NUMBER(10, 0)    NOT NULL,
    SCORE_COL_NAME      VARCHAR2(64)     NOT NULL,
    DESCRIPTION         VARCHAR2(256)    NOT NULL,
    CONSTRAINT PK145 PRIMARY KEY (GT_SCORE_TYPE_ID)
)
;


ALTER TABLE GT_SCORE_LOG ADD CONSTRAINT RefALL_PRODUCT434 
    FOREIGN KEY (PRODUCT_ID)
    REFERENCES ALL_PRODUCT(PRODUCT_ID)
;

ALTER TABLE GT_SCORE_LOG ADD CONSTRAINT RefGT_SCORE_TYPE436 
    FOREIGN KEY (GT_SCORE_TYPE_ID)
    REFERENCES GT_SCORE_TYPE(GT_SCORE_TYPE_ID)
;

-- bug where ratio of pack to product > 999.999% caused error (6,3) - > (10,3)

ALTER TABLE SUPPLIER.GT_PROFILE
MODIFY(RATIO_PROD_PCK_WGHT_PCT NUMBER(10,3));


BEGIN
	
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (0 , 'SCORE_RECOV_PACK', 'Info Only');
	
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (1 , 'SCORE_NAT_DERIVED', 'Naturally Derived Ingredients');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (2 , 'SCORE_CHEMICALS', 'Chemicals - Environmental Risk');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (3 , 'SCORE_SOURCE_BIOD', 'Biodiversity');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (4 , 'SCORE_ACCRED_BIOD', 'Biodiversity Source / Accreditation');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (5 , 'SCORE_FAIR_TRADE', 'Fair / Community Trade');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (6 , 'SCORE_RENEW_PACK', 'Renewable Packaging');
	
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (7 , 'SCORE_WHATS_IN_PROD', 'Number of Ingredients');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (8 , 'SCORE_WATER_IN_PROD', 'Water - Product');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (9 , 'SCORE_ENERGY_IN_PROD', 'Energy - Product');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (10 , 'SCORE_PACK_IMPACT', 'Packaging - Impact');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (11 , 'SCORE_PACK_OPT', 'Packaging - Optimisation');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (12 , 'SCORE_RECYCLED_PACK', 'Recycled / Accredited Packaging');
	
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (13 , 'SCORE_SUPP_MANAGEMENT', 'Supplier Management');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (14 , 'SCORE_TRANS_RAW_MAT', 'Transport - Raw Materials');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (15 , 'SCORE_TRANS_TO_BOOTS', 'Transport - Product to Boots');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (16 , 'SCORE_TRANS_PACKAGING', 'Transit Packaging');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (17 , 'SCORE_TRANS_OPT', 'Transit Optimisation');
	
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (18 , 'SCORE_WATER_USE', 'Water - Product Use');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (19 , 'SCORE_ENERGY_USE', 'Energy - Product Use');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (20 , 'SCORE_ANCILLARY_REQ', 'Ancillary Materials Required');
	
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (21 , 'SCORE_PROD_WASTE', 'Product Waste');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (22 , 'SCORE_RECYCLABLE_PACK', 'Recyclable Packaging');
	INSERT INTO SUPPLIER.GT_SCORE_TYPE (GT_SCORE_TYPE_ID, SCORE_COL_NAME, DESCRIPTION) 
	VALUES (23 , 'SCORE_RECOV_PACK', 'Recoverable Packaging');


	
END;
/


BEGIN
	
	INSERT INTO CSR.AUDIT_TYPE (
   AUDIT_TYPE_ID, LABEL, AUDIT_TYPE_GROUP_ID) 
VALUES (75 , 'GT value saved', 3);

	INSERT INTO CSR.AUDIT_TYPE (
   AUDIT_TYPE_ID, LABEL, AUDIT_TYPE_GROUP_ID) 
VALUES (76 , 'GT score changed', 3);

END;
/

@update_tail
