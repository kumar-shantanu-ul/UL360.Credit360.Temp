/*
UserCreatorDaemon needs write on "Indicators"
RegisteredUsers need "Create users for approval" capability

- show like and follows on activity page
- invite someone to join an activity (send an email)

- goals: we need your help to raise £X (raised to date £Y)
- thermometer next to $amount to inspire people to donate more?

- local events portlet
- volunteering stats 
- "did you attend..." (recent event) - log your hours

- match rates (vary by user type - e.g. full time = 2:1, part-time = 1:1)
*/


CREATE TABLE CSR.GRANT_APPLICANT (
	APP_SID         		NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY','APP') NOT NULL,
	USER_SID				NUMBER(10) 	DEFAULT SYS_CONTEXT('SECURITY','SID') NOT NULL,
	COMPANY_SID				NUMBER(10) 	NOT NULL,
	CONSTRAINT FK_GRANT_APPLICANT_USER FOREIGN KEY (APP_SID, USER_SID) REFERENCES CSR.CSR_USER(APP_SID, CSR_USER_SID) ON DELETE CASCADE,
	CONSTRAINT FK_GRANT_APPLICANT_COMPANY FOREIGN KEY (APP_SID, COMPANY_SID) REFERENCES CSR.SUPPLIER(APP_SID, SUPPLIER_SID) ON DELETE CASCADE,
	CONSTRAINT PK_GRANT_APPLICANT PRIMARY KEY (APP_SID, USER_SID)		
);

CREATE TABLE CSR.GRANT_REGION_ROOT (
	APP_SID         		NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY','APP') NOT NULL,
	REGION_ROOT_SID			NUMBER(10) 	NOT NULL,
	CONSTRAINT FK_GRANT_REGION FOREIGN KEY (APP_SID, REGION_ROOT_SID) REFERENCES CSR.REGION(APP_SID, REGION_SID),
	CONSTRAINT PK_GRANT_REGION_ROOT PRIMARY KEY (APP_SID, REGION_ROOT_SID)			
);

CREATE TABLE CSR.GRANT_FLOW (
	APP_SID         		NUMBER(10)	DEFAULT SYS_CONTEXT('SECURITY','APP') NOT NULL,
	REGION_ROOT_SID			NUMBER(10) 	NOT NULL,
	FLOW_SID				NUMBER(10) 	NOT NULL,
	CONSTRAINT FK_GRANT_FLOW_GRANT_REG_ROOT FOREIGN KEY (APP_SID, REGION_ROOT_SID) REFERENCES CSR.GRANT_REGION_ROOT(APP_SID, REGION_ROOT_SID),
	CONSTRAINT FK_GRANT_FLOW_FLOW FOREIGN KEY (APP_SID, FLOW_SID) REFERENCES CSR.FLOW(APP_SID, FLOW_SID) ON DELETE CASCADE,
	CONSTRAINT PK_GRANT_FLOW PRIMARY KEY (APP_SID, REGION_ROOT_SID, FLOW_SID)			
);

